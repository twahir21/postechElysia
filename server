// @bun
var __create=Object.create;var{getPrototypeOf:__getProtoOf,defineProperty:__defProp,getOwnPropertyNames:__getOwnPropNames}=Object;var __hasOwnProp=Object.prototype.hasOwnProperty;var __toESM=(mod,isNodeMode,target)=>{target=mod!=null?__create(__getProtoOf(mod)):{};let to=isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:!0}):target;for(let key of __getOwnPropNames(mod))if(!__hasOwnProp.call(to,key))__defProp(to,key,{get:()=>mod[key],enumerable:!0});return to};var __commonJS=(cb,mod)=>()=>(mod||cb((mod={exports:{}}).exports,mod),mod.exports);var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0,configurable:!0,set:(newValue)=>all[name]=()=>newValue})};var __require=import.meta.require;var require_dist=__commonJS((exports)=>{Object.defineProperty(exports,"__esModule",{value:!0});exports.parse=parse2;exports.serialize=serialize;var cookieNameRegExp=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,cookieValueRegExp=/^[\u0021-\u003A\u003C-\u007E]*$/,domainValueRegExp=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,pathValueRegExp=/^[\u0020-\u003A\u003D-\u007E]*$/,__toString=Object.prototype.toString,NullObject=(()=>{let C=function(){};return C.prototype=Object.create(null),C})();function parse2(str,options){let obj=new NullObject,len=str.length;if(len<2)return obj;let dec=options?.decode||decode2,index=0;do{let eqIdx=str.indexOf("=",index);if(eqIdx===-1)break;let colonIdx=str.indexOf(";",index),endIdx=colonIdx===-1?len:colonIdx;if(eqIdx>endIdx){index=str.lastIndexOf(";",eqIdx-1)+1;continue}let keyStartIdx=startIndex(str,index,eqIdx),keyEndIdx=endIndex(str,eqIdx,keyStartIdx),key=str.slice(keyStartIdx,keyEndIdx);if(obj[key]===void 0){let valStartIdx=startIndex(str,eqIdx+1,endIdx),valEndIdx=endIndex(str,endIdx,valStartIdx),value=dec(str.slice(valStartIdx,valEndIdx));obj[key]=value}index=endIdx+1}while(index<len);return obj}function startIndex(str,index,max){do{let code=str.charCodeAt(index);if(code!==32&&code!==9)return index}while(++index<max);return max}function endIndex(str,index,min){while(index>min){let code=str.charCodeAt(--index);if(code!==32&&code!==9)return index+1}return min}function serialize(name,val,options){let enc=options?.encode||encodeURIComponent;if(!cookieNameRegExp.test(name))throw new TypeError(`argument name is invalid: ${name}`);let value=enc(val);if(!cookieValueRegExp.test(value))throw new TypeError(`argument val is invalid: ${val}`);let str=name+"="+value;if(!options)return str;if(options.maxAge!==void 0){if(!Number.isInteger(options.maxAge))throw new TypeError(`option maxAge is invalid: ${options.maxAge}`);str+="; Max-Age="+options.maxAge}if(options.domain){if(!domainValueRegExp.test(options.domain))throw new TypeError(`option domain is invalid: ${options.domain}`);str+="; Domain="+options.domain}if(options.path){if(!pathValueRegExp.test(options.path))throw new TypeError(`option path is invalid: ${options.path}`);str+="; Path="+options.path}if(options.expires){if(!isDate(options.expires)||!Number.isFinite(options.expires.valueOf()))throw new TypeError(`option expires is invalid: ${options.expires}`);str+="; Expires="+options.expires.toUTCString()}if(options.httpOnly)str+="; HttpOnly";if(options.secure)str+="; Secure";if(options.partitioned)str+="; Partitioned";if(options.priority)switch(typeof options.priority==="string"?options.priority.toLowerCase():void 0){case"low":str+="; Priority=Low";break;case"medium":str+="; Priority=Medium";break;case"high":str+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${options.priority}`)}if(options.sameSite)switch(typeof options.sameSite==="string"?options.sameSite.toLowerCase():options.sameSite){case!0:case"strict":str+="; SameSite=Strict";break;case"lax":str+="; SameSite=Lax";break;case"none":str+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${options.sameSite}`)}return str}function decode2(str){if(str.indexOf("%")===-1)return str;try{return decodeURIComponent(str)}catch(e){return str}}function isDate(val){return __toString.call(val)==="[object Date]"}});var require_package=__commonJS((exports,module)=>{module.exports={name:"dotenv",version:"16.5.0",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard",pretest:"npm run lint && npm run dts-check",test:"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},homepage:"https://github.com/motdotla/dotenv#readme",funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^18.11.3",decache:"^4.6.2",sinon:"^14.0.1",standard:"^17.0.0","standard-version":"^9.5.0",tap:"^19.2.0",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var require_main=__commonJS((exports,module)=>{var fs=__require("fs"),path=__require("path"),os=__require("os"),crypto2=__require("crypto"),packageJson=require_package(),version2=packageJson.version,LINE=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function parse3(src){let obj={},lines=src.toString();lines=lines.replace(/\r\n?/mg,`
`);let match;while((match=LINE.exec(lines))!=null){let key=match[1],value=match[2]||"";value=value.trim();let maybeQuote=value[0];if(value=value.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),maybeQuote==='"')value=value.replace(/\\n/g,`
`),value=value.replace(/\\r/g,"\r");obj[key]=value}return obj}function _parseVault(options){let vaultPath=_vaultPath(options),result=DotenvModule.configDotenv({path:vaultPath});if(!result.parsed){let err=new Error(`MISSING_DATA: Cannot parse ${vaultPath} for an unknown reason`);throw err.code="MISSING_DATA",err}let keys=_dotenvKey(options).split(","),length=keys.length,decrypted;for(let i=0;i<length;i++)try{let key=keys[i].trim(),attrs=_instructions(result,key);decrypted=DotenvModule.decrypt(attrs.ciphertext,attrs.key);break}catch(error2){if(i+1>=length)throw error2}return DotenvModule.parse(decrypted)}function _warn(message){console.log(`[dotenv@${version2}][WARN] ${message}`)}function _debug(message){console.log(`[dotenv@${version2}][DEBUG] ${message}`)}function _dotenvKey(options){if(options&&options.DOTENV_KEY&&options.DOTENV_KEY.length>0)return options.DOTENV_KEY;if(process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0)return process.env.DOTENV_KEY;return""}function _instructions(result,dotenvKey){let uri2;try{uri2=new URL(dotenvKey)}catch(error2){if(error2.code==="ERR_INVALID_URL"){let err=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw err.code="INVALID_DOTENV_KEY",err}throw error2}let key=uri2.password;if(!key){let err=new Error("INVALID_DOTENV_KEY: Missing key part");throw err.code="INVALID_DOTENV_KEY",err}let environment=uri2.searchParams.get("environment");if(!environment){let err=new Error("INVALID_DOTENV_KEY: Missing environment part");throw err.code="INVALID_DOTENV_KEY",err}let environmentKey=`DOTENV_VAULT_${environment.toUpperCase()}`,ciphertext=result.parsed[environmentKey];if(!ciphertext){let err=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${environmentKey} in your .env.vault file.`);throw err.code="NOT_FOUND_DOTENV_ENVIRONMENT",err}return{ciphertext,key}}function _vaultPath(options){let possibleVaultPath=null;if(options&&options.path&&options.path.length>0)if(Array.isArray(options.path)){for(let filepath of options.path)if(fs.existsSync(filepath))possibleVaultPath=filepath.endsWith(".vault")?filepath:`${filepath}.vault`}else possibleVaultPath=options.path.endsWith(".vault")?options.path:`${options.path}.vault`;else possibleVaultPath=path.resolve(process.cwd(),".env.vault");if(fs.existsSync(possibleVaultPath))return possibleVaultPath;return null}function _resolveHome(envPath){return envPath[0]==="~"?path.join(os.homedir(),envPath.slice(1)):envPath}function _configVault(options){if(Boolean(options&&options.debug))_debug("Loading env from encrypted .env.vault");let parsed=DotenvModule._parseVault(options),processEnv=process.env;if(options&&options.processEnv!=null)processEnv=options.processEnv;return DotenvModule.populate(processEnv,parsed,options),{parsed}}function configDotenv(options){let dotenvPath=path.resolve(process.cwd(),".env"),encoding="utf8",debug=Boolean(options&&options.debug);if(options&&options.encoding)encoding=options.encoding;else if(debug)_debug("No encoding is specified. UTF-8 is used by default");let optionPaths=[dotenvPath];if(options&&options.path)if(!Array.isArray(options.path))optionPaths=[_resolveHome(options.path)];else{optionPaths=[];for(let filepath of options.path)optionPaths.push(_resolveHome(filepath))}let lastError,parsedAll={};for(let path2 of optionPaths)try{let parsed=DotenvModule.parse(fs.readFileSync(path2,{encoding}));DotenvModule.populate(parsedAll,parsed,options)}catch(e){if(debug)_debug(`Failed to load ${path2} ${e.message}`);lastError=e}let processEnv=process.env;if(options&&options.processEnv!=null)processEnv=options.processEnv;if(DotenvModule.populate(processEnv,parsedAll,options),lastError)return{parsed:parsedAll,error:lastError};else return{parsed:parsedAll}}function config(options){if(_dotenvKey(options).length===0)return DotenvModule.configDotenv(options);let vaultPath=_vaultPath(options);if(!vaultPath)return _warn(`You set DOTENV_KEY but you are missing a .env.vault file at ${vaultPath}. Did you forget to build it?`),DotenvModule.configDotenv(options);return DotenvModule._configVault(options)}function decrypt(encrypted,keyStr){let key=Buffer.from(keyStr.slice(-64),"hex"),ciphertext=Buffer.from(encrypted,"base64"),nonce=ciphertext.subarray(0,12),authTag=ciphertext.subarray(-16);ciphertext=ciphertext.subarray(12,-16);try{let aesgcm=crypto2.createDecipheriv("aes-256-gcm",key,nonce);return aesgcm.setAuthTag(authTag),`${aesgcm.update(ciphertext)}${aesgcm.final()}`}catch(error2){let isRange=error2 instanceof RangeError,invalidKeyLength=error2.message==="Invalid key length",decryptionFailed=error2.message==="Unsupported state or unable to authenticate data";if(isRange||invalidKeyLength){let err=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw err.code="INVALID_DOTENV_KEY",err}else if(decryptionFailed){let err=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw err.code="DECRYPTION_FAILED",err}else throw error2}}function populate(processEnv,parsed,options={}){let debug=Boolean(options&&options.debug),override=Boolean(options&&options.override);if(typeof parsed!=="object"){let err=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw err.code="OBJECT_REQUIRED",err}for(let key of Object.keys(parsed))if(Object.prototype.hasOwnProperty.call(processEnv,key)){if(override===!0)processEnv[key]=parsed[key];if(debug)if(override===!0)_debug(`"${key}" is already defined and WAS overwritten`);else _debug(`"${key}" is already defined and was NOT overwritten`)}else processEnv[key]=parsed[key]}var DotenvModule={configDotenv,_configVault,_parseVault,config,decrypt,parse:parse3,populate};exports.configDotenv=DotenvModule.configDotenv;exports._configVault=DotenvModule._configVault;exports._parseVault=DotenvModule._parseVault;exports.config=DotenvModule.config;exports.decrypt=DotenvModule.decrypt;exports.parse=DotenvModule.parse;exports.populate=DotenvModule.populate;module.exports=DotenvModule});var require_env_options=__commonJS((exports,module)=>{var options={};if(process.env.DOTENV_CONFIG_ENCODING!=null)options.encoding=process.env.DOTENV_CONFIG_ENCODING;if(process.env.DOTENV_CONFIG_PATH!=null)options.path=process.env.DOTENV_CONFIG_PATH;if(process.env.DOTENV_CONFIG_DEBUG!=null)options.debug=process.env.DOTENV_CONFIG_DEBUG;if(process.env.DOTENV_CONFIG_OVERRIDE!=null)options.override=process.env.DOTENV_CONFIG_OVERRIDE;if(process.env.DOTENV_CONFIG_DOTENV_KEY!=null)options.DOTENV_KEY=process.env.DOTENV_CONFIG_DOTENV_KEY;module.exports=options});var require_cli_options=__commonJS((exports,module)=>{var re=/^dotenv_config_(encoding|path|debug|override|DOTENV_KEY)=(.+)$/;module.exports=function optionMatcher(args){return args.reduce(function(acc,cur){let matches=cur.match(re);if(matches)acc[matches[1]]=matches[2];return acc},{})}});var require_config=__commonJS(()=>{(function(){require_main().config(Object.assign({},require_env_options(),require_cli_options()(process.argv)))})()});var require_can_promise=__commonJS((exports,module)=>{module.exports=function(){return typeof Promise==="function"&&Promise.prototype&&Promise.prototype.then}});var require_utils=__commonJS((exports)=>{var toSJISFunction,CODEWORDS_COUNT=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];exports.getSymbolSize=function getSymbolSize(version2){if(!version2)throw new Error('"version" cannot be null or undefined');if(version2<1||version2>40)throw new Error('"version" should be in range from 1 to 40');return version2*4+17};exports.getSymbolTotalCodewords=function getSymbolTotalCodewords(version2){return CODEWORDS_COUNT[version2]};exports.getBCHDigit=function(data){let digit=0;while(data!==0)digit++,data>>>=1;return digit};exports.setToSJISFunction=function setToSJISFunction(f){if(typeof f!=="function")throw new Error('"toSJISFunc" is not a valid function.');toSJISFunction=f};exports.isKanjiModeEnabled=function(){return typeof toSJISFunction!=="undefined"};exports.toSJIS=function toSJIS(kanji){return toSJISFunction(kanji)}});var require_error_correction_level=__commonJS((exports)=>{exports.L={bit:1};exports.M={bit:0};exports.Q={bit:3};exports.H={bit:2};function fromString(string){if(typeof string!=="string")throw new Error("Param is not a string");switch(string.toLowerCase()){case"l":case"low":return exports.L;case"m":case"medium":return exports.M;case"q":case"quartile":return exports.Q;case"h":case"high":return exports.H;default:throw new Error("Unknown EC Level: "+string)}}exports.isValid=function isValid(level){return level&&typeof level.bit!=="undefined"&&level.bit>=0&&level.bit<4};exports.from=function from(value,defaultValue){if(exports.isValid(value))return value;try{return fromString(value)}catch(e){return defaultValue}}});var require_bit_buffer=__commonJS((exports,module)=>{function BitBuffer(){this.buffer=[],this.length=0}BitBuffer.prototype={get:function(index2){let bufIndex=Math.floor(index2/8);return(this.buffer[bufIndex]>>>7-index2%8&1)===1},put:function(num,length){for(let i=0;i<length;i++)this.putBit((num>>>length-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(bit2){let bufIndex=Math.floor(this.length/8);if(this.buffer.length<=bufIndex)this.buffer.push(0);if(bit2)this.buffer[bufIndex]|=128>>>this.length%8;this.length++}};module.exports=BitBuffer});var require_bit_matrix=__commonJS((exports,module)=>{function BitMatrix(size){if(!size||size<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=size,this.data=new Uint8Array(size*size),this.reservedBit=new Uint8Array(size*size)}BitMatrix.prototype.set=function(row,col,value,reserved){let index2=row*this.size+col;if(this.data[index2]=value,reserved)this.reservedBit[index2]=!0};BitMatrix.prototype.get=function(row,col){return this.data[row*this.size+col]};BitMatrix.prototype.xor=function(row,col,value){this.data[row*this.size+col]^=value};BitMatrix.prototype.isReserved=function(row,col){return this.reservedBit[row*this.size+col]};module.exports=BitMatrix});var require_alignment_pattern=__commonJS((exports)=>{var getSymbolSize=require_utils().getSymbolSize;exports.getRowColCoords=function getRowColCoords(version2){if(version2===1)return[];let posCount=Math.floor(version2/7)+2,size=getSymbolSize(version2),intervals=size===145?26:Math.ceil((size-13)/(2*posCount-2))*2,positions=[size-7];for(let i=1;i<posCount-1;i++)positions[i]=positions[i-1]-intervals;return positions.push(6),positions.reverse()};exports.getPositions=function getPositions(version2){let coords=[],pos=exports.getRowColCoords(version2),posLength=pos.length;for(let i=0;i<posLength;i++)for(let j=0;j<posLength;j++){if(i===0&&j===0||i===0&&j===posLength-1||i===posLength-1&&j===0)continue;coords.push([pos[i],pos[j]])}return coords}});var require_finder_pattern=__commonJS((exports)=>{var getSymbolSize=require_utils().getSymbolSize;exports.getPositions=function getPositions(version2){let size=getSymbolSize(version2);return[[0,0],[size-7,0],[0,size-7]]}});var require_mask_pattern=__commonJS((exports)=>{exports.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var PenaltyScores={N1:3,N2:3,N3:40,N4:10};exports.isValid=function isValid(mask2){return mask2!=null&&mask2!==""&&!isNaN(mask2)&&mask2>=0&&mask2<=7};exports.from=function from(value){return exports.isValid(value)?parseInt(value,10):void 0};exports.getPenaltyN1=function getPenaltyN1(data){let size=data.size,points=0,sameCountCol=0,sameCountRow=0,lastCol=null,lastRow=null;for(let row=0;row<size;row++){sameCountCol=sameCountRow=0,lastCol=lastRow=null;for(let col=0;col<size;col++){let module2=data.get(row,col);if(module2===lastCol)sameCountCol++;else{if(sameCountCol>=5)points+=PenaltyScores.N1+(sameCountCol-5);lastCol=module2,sameCountCol=1}if(module2=data.get(col,row),module2===lastRow)sameCountRow++;else{if(sameCountRow>=5)points+=PenaltyScores.N1+(sameCountRow-5);lastRow=module2,sameCountRow=1}}if(sameCountCol>=5)points+=PenaltyScores.N1+(sameCountCol-5);if(sameCountRow>=5)points+=PenaltyScores.N1+(sameCountRow-5)}return points};exports.getPenaltyN2=function getPenaltyN2(data){let size=data.size,points=0;for(let row=0;row<size-1;row++)for(let col=0;col<size-1;col++){let last=data.get(row,col)+data.get(row,col+1)+data.get(row+1,col)+data.get(row+1,col+1);if(last===4||last===0)points++}return points*PenaltyScores.N2};exports.getPenaltyN3=function getPenaltyN3(data){let size=data.size,points=0,bitsCol=0,bitsRow=0;for(let row=0;row<size;row++){bitsCol=bitsRow=0;for(let col=0;col<size;col++){if(bitsCol=bitsCol<<1&2047|data.get(row,col),col>=10&&(bitsCol===1488||bitsCol===93))points++;if(bitsRow=bitsRow<<1&2047|data.get(col,row),col>=10&&(bitsRow===1488||bitsRow===93))points++}}return points*PenaltyScores.N3};exports.getPenaltyN4=function getPenaltyN4(data){let darkCount=0,modulesCount=data.data.length;for(let i=0;i<modulesCount;i++)darkCount+=data.data[i];return Math.abs(Math.ceil(darkCount*100/modulesCount/5)-10)*PenaltyScores.N4};function getMaskAt(maskPattern,i,j){switch(maskPattern){case exports.Patterns.PATTERN000:return(i+j)%2===0;case exports.Patterns.PATTERN001:return i%2===0;case exports.Patterns.PATTERN010:return j%3===0;case exports.Patterns.PATTERN011:return(i+j)%3===0;case exports.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(j/3))%2===0;case exports.Patterns.PATTERN101:return i*j%2+i*j%3===0;case exports.Patterns.PATTERN110:return(i*j%2+i*j%3)%2===0;case exports.Patterns.PATTERN111:return(i*j%3+(i+j)%2)%2===0;default:throw new Error("bad maskPattern:"+maskPattern)}}exports.applyMask=function applyMask(pattern,data){let size=data.size;for(let col=0;col<size;col++)for(let row=0;row<size;row++){if(data.isReserved(row,col))continue;data.xor(row,col,getMaskAt(pattern,row,col))}};exports.getBestMask=function getBestMask(data,setupFormatFunc){let numPatterns=Object.keys(exports.Patterns).length,bestPattern=0,lowerPenalty=1/0;for(let p=0;p<numPatterns;p++){setupFormatFunc(p),exports.applyMask(p,data);let penalty=exports.getPenaltyN1(data)+exports.getPenaltyN2(data)+exports.getPenaltyN3(data)+exports.getPenaltyN4(data);if(exports.applyMask(p,data),penalty<lowerPenalty)lowerPenalty=penalty,bestPattern=p}return bestPattern}});var require_error_correction_code=__commonJS((exports)=>{var ECLevel=require_error_correction_level(),EC_BLOCKS_TABLE=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],EC_CODEWORDS_TABLE=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];exports.getBlocksCount=function getBlocksCount(version2,errorCorrectionLevel){switch(errorCorrectionLevel){case ECLevel.L:return EC_BLOCKS_TABLE[(version2-1)*4+0];case ECLevel.M:return EC_BLOCKS_TABLE[(version2-1)*4+1];case ECLevel.Q:return EC_BLOCKS_TABLE[(version2-1)*4+2];case ECLevel.H:return EC_BLOCKS_TABLE[(version2-1)*4+3];default:return}};exports.getTotalCodewordsCount=function getTotalCodewordsCount(version2,errorCorrectionLevel){switch(errorCorrectionLevel){case ECLevel.L:return EC_CODEWORDS_TABLE[(version2-1)*4+0];case ECLevel.M:return EC_CODEWORDS_TABLE[(version2-1)*4+1];case ECLevel.Q:return EC_CODEWORDS_TABLE[(version2-1)*4+2];case ECLevel.H:return EC_CODEWORDS_TABLE[(version2-1)*4+3];default:return}}});var require_galois_field=__commonJS((exports)=>{var EXP_TABLE=new Uint8Array(512),LOG_TABLE=new Uint8Array(256);(function initTables(){let x=1;for(let i=0;i<255;i++)if(EXP_TABLE[i]=x,LOG_TABLE[x]=i,x<<=1,x&256)x^=285;for(let i=255;i<512;i++)EXP_TABLE[i]=EXP_TABLE[i-255]})();exports.log=function log(n){if(n<1)throw new Error("log("+n+")");return LOG_TABLE[n]};exports.exp=function exp(n){return EXP_TABLE[n]};exports.mul=function mul(x,y){if(x===0||y===0)return 0;return EXP_TABLE[LOG_TABLE[x]+LOG_TABLE[y]]}});var require_polynomial=__commonJS((exports)=>{var GF=require_galois_field();exports.mul=function mul(p1,p2){let coeff=new Uint8Array(p1.length+p2.length-1);for(let i=0;i<p1.length;i++)for(let j=0;j<p2.length;j++)coeff[i+j]^=GF.mul(p1[i],p2[j]);return coeff};exports.mod=function mod(divident,divisor){let result=new Uint8Array(divident);while(result.length-divisor.length>=0){let coeff=result[0];for(let i=0;i<divisor.length;i++)result[i]^=GF.mul(divisor[i],coeff);let offset=0;while(offset<result.length&&result[offset]===0)offset++;result=result.slice(offset)}return result};exports.generateECPolynomial=function generateECPolynomial(degree){let poly=new Uint8Array([1]);for(let i=0;i<degree;i++)poly=exports.mul(poly,new Uint8Array([1,GF.exp(i)]));return poly}});var require_reed_solomon_encoder=__commonJS((exports,module)=>{var Polynomial=require_polynomial();function ReedSolomonEncoder(degree){if(this.genPoly=void 0,this.degree=degree,this.degree)this.initialize(this.degree)}ReedSolomonEncoder.prototype.initialize=function initialize(degree){this.degree=degree,this.genPoly=Polynomial.generateECPolynomial(this.degree)};ReedSolomonEncoder.prototype.encode=function encode(data){if(!this.genPoly)throw new Error("Encoder not initialized");let paddedData=new Uint8Array(data.length+this.degree);paddedData.set(data);let remainder=Polynomial.mod(paddedData,this.genPoly),start=this.degree-remainder.length;if(start>0){let buff=new Uint8Array(this.degree);return buff.set(remainder,start),buff}return remainder};module.exports=ReedSolomonEncoder});var require_version_check=__commonJS((exports)=>{exports.isValid=function isValid(version2){return!isNaN(version2)&&version2>=1&&version2<=40}});var require_regex=__commonJS((exports)=>{var kanji="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";kanji=kanji.replace(/u/g,"\\u");var byte2="(?:(?![A-Z0-9 $%*+\\-./:]|"+kanji+`)(?:.|[\r
]))+`;exports.KANJI=new RegExp(kanji,"g");exports.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");exports.BYTE=new RegExp(byte2,"g");exports.NUMERIC=new RegExp("[0-9]+","g");exports.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var TEST_KANJI=new RegExp("^"+kanji+"$"),TEST_NUMERIC=new RegExp("^[0-9]+$"),TEST_ALPHANUMERIC=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");exports.testKanji=function testKanji(str){return TEST_KANJI.test(str)};exports.testNumeric=function testNumeric(str){return TEST_NUMERIC.test(str)};exports.testAlphanumeric=function testAlphanumeric(str){return TEST_ALPHANUMERIC.test(str)}});var require_mode=__commonJS((exports)=>{var VersionCheck=require_version_check(),Regex=require_regex();exports.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};exports.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};exports.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};exports.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};exports.MIXED={bit:-1};exports.getCharCountIndicator=function getCharCountIndicator(mode,version2){if(!mode.ccBits)throw new Error("Invalid mode: "+mode);if(!VersionCheck.isValid(version2))throw new Error("Invalid version: "+version2);if(version2>=1&&version2<10)return mode.ccBits[0];else if(version2<27)return mode.ccBits[1];return mode.ccBits[2]};exports.getBestModeForData=function getBestModeForData(dataStr){if(Regex.testNumeric(dataStr))return exports.NUMERIC;else if(Regex.testAlphanumeric(dataStr))return exports.ALPHANUMERIC;else if(Regex.testKanji(dataStr))return exports.KANJI;else return exports.BYTE};exports.toString=function toString(mode){if(mode&&mode.id)return mode.id;throw new Error("Invalid mode")};exports.isValid=function isValid(mode){return mode&&mode.bit&&mode.ccBits};function fromString(string){if(typeof string!=="string")throw new Error("Param is not a string");switch(string.toLowerCase()){case"numeric":return exports.NUMERIC;case"alphanumeric":return exports.ALPHANUMERIC;case"kanji":return exports.KANJI;case"byte":return exports.BYTE;default:throw new Error("Unknown mode: "+string)}}exports.from=function from(value,defaultValue){if(exports.isValid(value))return value;try{return fromString(value)}catch(e){return defaultValue}}});var require_version=__commonJS((exports)=>{var Utils=require_utils(),ECCode=require_error_correction_code(),ECLevel=require_error_correction_level(),Mode=require_mode(),VersionCheck=require_version_check(),G18_BCH=Utils.getBCHDigit(7973);function getBestVersionForDataLength(mode,length,errorCorrectionLevel){for(let currentVersion=1;currentVersion<=40;currentVersion++)if(length<=exports.getCapacity(currentVersion,errorCorrectionLevel,mode))return currentVersion;return}function getReservedBitsCount(mode,version2){return Mode.getCharCountIndicator(mode,version2)+4}function getTotalBitsFromDataArray(segments,version2){let totalBits=0;return segments.forEach(function(data){let reservedBits=getReservedBitsCount(data.mode,version2);totalBits+=reservedBits+data.getBitsLength()}),totalBits}function getBestVersionForMixedData(segments,errorCorrectionLevel){for(let currentVersion=1;currentVersion<=40;currentVersion++)if(getTotalBitsFromDataArray(segments,currentVersion)<=exports.getCapacity(currentVersion,errorCorrectionLevel,Mode.MIXED))return currentVersion;return}exports.from=function from(value,defaultValue){if(VersionCheck.isValid(value))return parseInt(value,10);return defaultValue};exports.getCapacity=function getCapacity(version2,errorCorrectionLevel,mode){if(!VersionCheck.isValid(version2))throw new Error("Invalid QR Code version");if(typeof mode==="undefined")mode=Mode.BYTE;let totalCodewords=Utils.getSymbolTotalCodewords(version2),ecTotalCodewords=ECCode.getTotalCodewordsCount(version2,errorCorrectionLevel),dataTotalCodewordsBits=(totalCodewords-ecTotalCodewords)*8;if(mode===Mode.MIXED)return dataTotalCodewordsBits;let usableBits=dataTotalCodewordsBits-getReservedBitsCount(mode,version2);switch(mode){case Mode.NUMERIC:return Math.floor(usableBits/10*3);case Mode.ALPHANUMERIC:return Math.floor(usableBits/11*2);case Mode.KANJI:return Math.floor(usableBits/13);case Mode.BYTE:default:return Math.floor(usableBits/8)}};exports.getBestVersionForData=function getBestVersionForData(data,errorCorrectionLevel){let seg,ecl=ECLevel.from(errorCorrectionLevel,ECLevel.M);if(Array.isArray(data)){if(data.length>1)return getBestVersionForMixedData(data,ecl);if(data.length===0)return 1;seg=data[0]}else seg=data;return getBestVersionForDataLength(seg.mode,seg.getLength(),ecl)};exports.getEncodedBits=function getEncodedBits(version2){if(!VersionCheck.isValid(version2)||version2<7)throw new Error("Invalid QR Code version");let d=version2<<12;while(Utils.getBCHDigit(d)-G18_BCH>=0)d^=7973<<Utils.getBCHDigit(d)-G18_BCH;return version2<<12|d}});var require_format_info=__commonJS((exports)=>{var Utils=require_utils(),G15_BCH=Utils.getBCHDigit(1335);exports.getEncodedBits=function getEncodedBits(errorCorrectionLevel,mask2){let data=errorCorrectionLevel.bit<<3|mask2,d=data<<10;while(Utils.getBCHDigit(d)-G15_BCH>=0)d^=1335<<Utils.getBCHDigit(d)-G15_BCH;return(data<<10|d)^21522}});var require_numeric_data=__commonJS((exports,module)=>{var Mode=require_mode();function NumericData(data){this.mode=Mode.NUMERIC,this.data=data.toString()}NumericData.getBitsLength=function getBitsLength(length){return 10*Math.floor(length/3)+(length%3?length%3*3+1:0)};NumericData.prototype.getLength=function getLength(){return this.data.length};NumericData.prototype.getBitsLength=function getBitsLength(){return NumericData.getBitsLength(this.data.length)};NumericData.prototype.write=function write(bitBuffer){let i,group,value;for(i=0;i+3<=this.data.length;i+=3)group=this.data.substr(i,3),value=parseInt(group,10),bitBuffer.put(value,10);let remainingNum=this.data.length-i;if(remainingNum>0)group=this.data.substr(i),value=parseInt(group,10),bitBuffer.put(value,remainingNum*3+1)};module.exports=NumericData});var require_alphanumeric_data=__commonJS((exports,module)=>{var Mode=require_mode(),ALPHA_NUM_CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function AlphanumericData(data){this.mode=Mode.ALPHANUMERIC,this.data=data}AlphanumericData.getBitsLength=function getBitsLength(length){return 11*Math.floor(length/2)+6*(length%2)};AlphanumericData.prototype.getLength=function getLength(){return this.data.length};AlphanumericData.prototype.getBitsLength=function getBitsLength(){return AlphanumericData.getBitsLength(this.data.length)};AlphanumericData.prototype.write=function write(bitBuffer){let i;for(i=0;i+2<=this.data.length;i+=2){let value=ALPHA_NUM_CHARS.indexOf(this.data[i])*45;value+=ALPHA_NUM_CHARS.indexOf(this.data[i+1]),bitBuffer.put(value,11)}if(this.data.length%2)bitBuffer.put(ALPHA_NUM_CHARS.indexOf(this.data[i]),6)};module.exports=AlphanumericData});var require_byte_data=__commonJS((exports,module)=>{var Mode=require_mode();function ByteData(data){if(this.mode=Mode.BYTE,typeof data==="string")this.data=new TextEncoder().encode(data);else this.data=new Uint8Array(data)}ByteData.getBitsLength=function getBitsLength(length){return length*8};ByteData.prototype.getLength=function getLength(){return this.data.length};ByteData.prototype.getBitsLength=function getBitsLength(){return ByteData.getBitsLength(this.data.length)};ByteData.prototype.write=function(bitBuffer){for(let i=0,l=this.data.length;i<l;i++)bitBuffer.put(this.data[i],8)};module.exports=ByteData});var require_kanji_data=__commonJS((exports,module)=>{var Mode=require_mode(),Utils=require_utils();function KanjiData(data){this.mode=Mode.KANJI,this.data=data}KanjiData.getBitsLength=function getBitsLength(length){return length*13};KanjiData.prototype.getLength=function getLength(){return this.data.length};KanjiData.prototype.getBitsLength=function getBitsLength(){return KanjiData.getBitsLength(this.data.length)};KanjiData.prototype.write=function(bitBuffer){let i;for(i=0;i<this.data.length;i++){let value=Utils.toSJIS(this.data[i]);if(value>=33088&&value<=40956)value-=33088;else if(value>=57408&&value<=60351)value-=49472;else throw new Error("Invalid SJIS character: "+this.data[i]+`
Make sure your charset is UTF-8`);value=(value>>>8&255)*192+(value&255),bitBuffer.put(value,13)}};module.exports=KanjiData});var require_dijkstra=__commonJS((exports,module)=>{var dijkstra={single_source_shortest_paths:function(graph,s,d){var predecessors={},costs={};costs[s]=0;var open=dijkstra.PriorityQueue.make();open.push(s,0);var closest,u,v,cost_of_s_to_u,adjacent_nodes,cost_of_e,cost_of_s_to_u_plus_cost_of_e,cost_of_s_to_v,first_visit;while(!open.empty()){closest=open.pop(),u=closest.value,cost_of_s_to_u=closest.cost,adjacent_nodes=graph[u]||{};for(v in adjacent_nodes)if(adjacent_nodes.hasOwnProperty(v)){if(cost_of_e=adjacent_nodes[v],cost_of_s_to_u_plus_cost_of_e=cost_of_s_to_u+cost_of_e,cost_of_s_to_v=costs[v],first_visit=typeof costs[v]==="undefined",first_visit||cost_of_s_to_v>cost_of_s_to_u_plus_cost_of_e)costs[v]=cost_of_s_to_u_plus_cost_of_e,open.push(v,cost_of_s_to_u_plus_cost_of_e),predecessors[v]=u}}if(typeof d!=="undefined"&&typeof costs[d]==="undefined"){var msg=["Could not find a path from ",s," to ",d,"."].join("");throw new Error(msg)}return predecessors},extract_shortest_path_from_predecessor_list:function(predecessors,d){var nodes=[],u=d,predecessor;while(u)nodes.push(u),predecessor=predecessors[u],u=predecessors[u];return nodes.reverse(),nodes},find_path:function(graph,s,d){var predecessors=dijkstra.single_source_shortest_paths(graph,s,d);return dijkstra.extract_shortest_path_from_predecessor_list(predecessors,d)},PriorityQueue:{make:function(opts){var T2=dijkstra.PriorityQueue,t2={},key;opts=opts||{};for(key in T2)if(T2.hasOwnProperty(key))t2[key]=T2[key];return t2.queue=[],t2.sorter=opts.sorter||T2.default_sorter,t2},default_sorter:function(a,b2){return a.cost-b2.cost},push:function(value,cost){var item={value,cost};this.queue.push(item),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};if(typeof module!=="undefined")module.exports=dijkstra});var require_segments=__commonJS((exports)=>{var Mode=require_mode(),NumericData=require_numeric_data(),AlphanumericData=require_alphanumeric_data(),ByteData=require_byte_data(),KanjiData=require_kanji_data(),Regex=require_regex(),Utils=require_utils(),dijkstra=require_dijkstra();function getStringByteLength(str){return unescape(encodeURIComponent(str)).length}function getSegments(regex2,mode,str){let segments=[],result;while((result=regex2.exec(str))!==null)segments.push({data:result[0],index:result.index,mode,length:result[0].length});return segments}function getSegmentsFromString(dataStr){let numSegs=getSegments(Regex.NUMERIC,Mode.NUMERIC,dataStr),alphaNumSegs=getSegments(Regex.ALPHANUMERIC,Mode.ALPHANUMERIC,dataStr),byteSegs,kanjiSegs;if(Utils.isKanjiModeEnabled())byteSegs=getSegments(Regex.BYTE,Mode.BYTE,dataStr),kanjiSegs=getSegments(Regex.KANJI,Mode.KANJI,dataStr);else byteSegs=getSegments(Regex.BYTE_KANJI,Mode.BYTE,dataStr),kanjiSegs=[];return numSegs.concat(alphaNumSegs,byteSegs,kanjiSegs).sort(function(s1,s2){return s1.index-s2.index}).map(function(obj){return{data:obj.data,mode:obj.mode,length:obj.length}})}function getSegmentBitsLength(length,mode){switch(mode){case Mode.NUMERIC:return NumericData.getBitsLength(length);case Mode.ALPHANUMERIC:return AlphanumericData.getBitsLength(length);case Mode.KANJI:return KanjiData.getBitsLength(length);case Mode.BYTE:return ByteData.getBitsLength(length)}}function mergeSegments(segs){return segs.reduce(function(acc,curr){let prevSeg=acc.length-1>=0?acc[acc.length-1]:null;if(prevSeg&&prevSeg.mode===curr.mode)return acc[acc.length-1].data+=curr.data,acc;return acc.push(curr),acc},[])}function buildNodes(segs){let nodes=[];for(let i=0;i<segs.length;i++){let seg=segs[i];switch(seg.mode){case Mode.NUMERIC:nodes.push([seg,{data:seg.data,mode:Mode.ALPHANUMERIC,length:seg.length},{data:seg.data,mode:Mode.BYTE,length:seg.length}]);break;case Mode.ALPHANUMERIC:nodes.push([seg,{data:seg.data,mode:Mode.BYTE,length:seg.length}]);break;case Mode.KANJI:nodes.push([seg,{data:seg.data,mode:Mode.BYTE,length:getStringByteLength(seg.data)}]);break;case Mode.BYTE:nodes.push([{data:seg.data,mode:Mode.BYTE,length:getStringByteLength(seg.data)}])}}return nodes}function buildGraph(nodes,version2){let table={},graph={start:{}},prevNodeIds=["start"];for(let i=0;i<nodes.length;i++){let nodeGroup=nodes[i],currentNodeIds=[];for(let j=0;j<nodeGroup.length;j++){let node=nodeGroup[j],key=""+i+j;currentNodeIds.push(key),table[key]={node,lastCount:0},graph[key]={};for(let n=0;n<prevNodeIds.length;n++){let prevNodeId=prevNodeIds[n];if(table[prevNodeId]&&table[prevNodeId].node.mode===node.mode)graph[prevNodeId][key]=getSegmentBitsLength(table[prevNodeId].lastCount+node.length,node.mode)-getSegmentBitsLength(table[prevNodeId].lastCount,node.mode),table[prevNodeId].lastCount+=node.length;else{if(table[prevNodeId])table[prevNodeId].lastCount=node.length;graph[prevNodeId][key]=getSegmentBitsLength(node.length,node.mode)+4+Mode.getCharCountIndicator(node.mode,version2)}}}prevNodeIds=currentNodeIds}for(let n=0;n<prevNodeIds.length;n++)graph[prevNodeIds[n]].end=0;return{map:graph,table}}function buildSingleSegment(data,modesHint){let mode,bestMode=Mode.getBestModeForData(data);if(mode=Mode.from(modesHint,bestMode),mode!==Mode.BYTE&&mode.bit<bestMode.bit)throw new Error('"'+data+'" cannot be encoded with mode '+Mode.toString(mode)+`.
 Suggested mode is: `+Mode.toString(bestMode));if(mode===Mode.KANJI&&!Utils.isKanjiModeEnabled())mode=Mode.BYTE;switch(mode){case Mode.NUMERIC:return new NumericData(data);case Mode.ALPHANUMERIC:return new AlphanumericData(data);case Mode.KANJI:return new KanjiData(data);case Mode.BYTE:return new ByteData(data)}}exports.fromArray=function fromArray(array){return array.reduce(function(acc,seg){if(typeof seg==="string")acc.push(buildSingleSegment(seg,null));else if(seg.data)acc.push(buildSingleSegment(seg.data,seg.mode));return acc},[])};exports.fromString=function fromString(data,version2){let segs=getSegmentsFromString(data,Utils.isKanjiModeEnabled()),nodes=buildNodes(segs),graph=buildGraph(nodes,version2),path=dijkstra.find_path(graph.map,"start","end"),optimizedSegs=[];for(let i=1;i<path.length-1;i++)optimizedSegs.push(graph.table[path[i]].node);return exports.fromArray(mergeSegments(optimizedSegs))};exports.rawSplit=function rawSplit(data){return exports.fromArray(getSegmentsFromString(data,Utils.isKanjiModeEnabled()))}});var require_qrcode=__commonJS((exports)=>{var Utils=require_utils(),ECLevel=require_error_correction_level(),BitBuffer=require_bit_buffer(),BitMatrix=require_bit_matrix(),AlignmentPattern=require_alignment_pattern(),FinderPattern=require_finder_pattern(),MaskPattern=require_mask_pattern(),ECCode=require_error_correction_code(),ReedSolomonEncoder=require_reed_solomon_encoder(),Version=require_version(),FormatInfo=require_format_info(),Mode=require_mode(),Segments=require_segments();function setupFinderPattern(matrix,version2){let size=matrix.size,pos=FinderPattern.getPositions(version2);for(let i=0;i<pos.length;i++){let row=pos[i][0],col=pos[i][1];for(let r=-1;r<=7;r++){if(row+r<=-1||size<=row+r)continue;for(let c=-1;c<=7;c++){if(col+c<=-1||size<=col+c)continue;if(r>=0&&r<=6&&(c===0||c===6)||c>=0&&c<=6&&(r===0||r===6)||r>=2&&r<=4&&c>=2&&c<=4)matrix.set(row+r,col+c,!0,!0);else matrix.set(row+r,col+c,!1,!0)}}}}function setupTimingPattern(matrix){let size=matrix.size;for(let r=8;r<size-8;r++){let value=r%2===0;matrix.set(r,6,value,!0),matrix.set(6,r,value,!0)}}function setupAlignmentPattern(matrix,version2){let pos=AlignmentPattern.getPositions(version2);for(let i=0;i<pos.length;i++){let row=pos[i][0],col=pos[i][1];for(let r=-2;r<=2;r++)for(let c=-2;c<=2;c++)if(r===-2||r===2||c===-2||c===2||r===0&&c===0)matrix.set(row+r,col+c,!0,!0);else matrix.set(row+r,col+c,!1,!0)}}function setupVersionInfo(matrix,version2){let size=matrix.size,bits=Version.getEncodedBits(version2),row,col,mod;for(let i=0;i<18;i++)row=Math.floor(i/3),col=i%3+size-8-3,mod=(bits>>i&1)===1,matrix.set(row,col,mod,!0),matrix.set(col,row,mod,!0)}function setupFormatInfo(matrix,errorCorrectionLevel,maskPattern){let size=matrix.size,bits=FormatInfo.getEncodedBits(errorCorrectionLevel,maskPattern),i,mod;for(i=0;i<15;i++){if(mod=(bits>>i&1)===1,i<6)matrix.set(i,8,mod,!0);else if(i<8)matrix.set(i+1,8,mod,!0);else matrix.set(size-15+i,8,mod,!0);if(i<8)matrix.set(8,size-i-1,mod,!0);else if(i<9)matrix.set(8,15-i-1+1,mod,!0);else matrix.set(8,15-i-1,mod,!0)}matrix.set(size-8,8,1,!0)}function setupData(matrix,data){let size=matrix.size,inc=-1,row=size-1,bitIndex=7,byteIndex=0;for(let col=size-1;col>0;col-=2){if(col===6)col--;while(!0){for(let c=0;c<2;c++)if(!matrix.isReserved(row,col-c)){let dark=!1;if(byteIndex<data.length)dark=(data[byteIndex]>>>bitIndex&1)===1;if(matrix.set(row,col-c,dark),bitIndex--,bitIndex===-1)byteIndex++,bitIndex=7}if(row+=inc,row<0||size<=row){row-=inc,inc=-inc;break}}}}function createData(version2,errorCorrectionLevel,segments){let buffer2=new BitBuffer;segments.forEach(function(data){buffer2.put(data.mode.bit,4),buffer2.put(data.getLength(),Mode.getCharCountIndicator(data.mode,version2)),data.write(buffer2)});let totalCodewords=Utils.getSymbolTotalCodewords(version2),ecTotalCodewords=ECCode.getTotalCodewordsCount(version2,errorCorrectionLevel),dataTotalCodewordsBits=(totalCodewords-ecTotalCodewords)*8;if(buffer2.getLengthInBits()+4<=dataTotalCodewordsBits)buffer2.put(0,4);while(buffer2.getLengthInBits()%8!==0)buffer2.putBit(0);let remainingByte=(dataTotalCodewordsBits-buffer2.getLengthInBits())/8;for(let i=0;i<remainingByte;i++)buffer2.put(i%2?17:236,8);return createCodewords(buffer2,version2,errorCorrectionLevel)}function createCodewords(bitBuffer,version2,errorCorrectionLevel){let totalCodewords=Utils.getSymbolTotalCodewords(version2),ecTotalCodewords=ECCode.getTotalCodewordsCount(version2,errorCorrectionLevel),dataTotalCodewords=totalCodewords-ecTotalCodewords,ecTotalBlocks=ECCode.getBlocksCount(version2,errorCorrectionLevel),blocksInGroup2=totalCodewords%ecTotalBlocks,blocksInGroup1=ecTotalBlocks-blocksInGroup2,totalCodewordsInGroup1=Math.floor(totalCodewords/ecTotalBlocks),dataCodewordsInGroup1=Math.floor(dataTotalCodewords/ecTotalBlocks),dataCodewordsInGroup2=dataCodewordsInGroup1+1,ecCount=totalCodewordsInGroup1-dataCodewordsInGroup1,rs=new ReedSolomonEncoder(ecCount),offset=0,dcData=new Array(ecTotalBlocks),ecData=new Array(ecTotalBlocks),maxDataSize=0,buffer2=new Uint8Array(bitBuffer.buffer);for(let b2=0;b2<ecTotalBlocks;b2++){let dataSize=b2<blocksInGroup1?dataCodewordsInGroup1:dataCodewordsInGroup2;dcData[b2]=buffer2.slice(offset,offset+dataSize),ecData[b2]=rs.encode(dcData[b2]),offset+=dataSize,maxDataSize=Math.max(maxDataSize,dataSize)}let data=new Uint8Array(totalCodewords),index2=0,i,r;for(i=0;i<maxDataSize;i++)for(r=0;r<ecTotalBlocks;r++)if(i<dcData[r].length)data[index2++]=dcData[r][i];for(i=0;i<ecCount;i++)for(r=0;r<ecTotalBlocks;r++)data[index2++]=ecData[r][i];return data}function createSymbol(data,version2,errorCorrectionLevel,maskPattern){let segments;if(Array.isArray(data))segments=Segments.fromArray(data);else if(typeof data==="string"){let estimatedVersion=version2;if(!estimatedVersion){let rawSegments=Segments.rawSplit(data);estimatedVersion=Version.getBestVersionForData(rawSegments,errorCorrectionLevel)}segments=Segments.fromString(data,estimatedVersion||40)}else throw new Error("Invalid data");let bestVersion=Version.getBestVersionForData(segments,errorCorrectionLevel);if(!bestVersion)throw new Error("The amount of data is too big to be stored in a QR Code");if(!version2)version2=bestVersion;else if(version2<bestVersion)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+bestVersion+`.
`);let dataBits=createData(version2,errorCorrectionLevel,segments),moduleCount=Utils.getSymbolSize(version2),modules=new BitMatrix(moduleCount);if(setupFinderPattern(modules,version2),setupTimingPattern(modules),setupAlignmentPattern(modules,version2),setupFormatInfo(modules,errorCorrectionLevel,0),version2>=7)setupVersionInfo(modules,version2);if(setupData(modules,dataBits),isNaN(maskPattern))maskPattern=MaskPattern.getBestMask(modules,setupFormatInfo.bind(null,modules,errorCorrectionLevel));return MaskPattern.applyMask(maskPattern,modules),setupFormatInfo(modules,errorCorrectionLevel,maskPattern),{modules,version:version2,errorCorrectionLevel,maskPattern,segments}}exports.create=function create(data,options){if(typeof data==="undefined"||data==="")throw new Error("No input text");let errorCorrectionLevel=ECLevel.M,version2,mask2;if(typeof options!=="undefined"){if(errorCorrectionLevel=ECLevel.from(options.errorCorrectionLevel,ECLevel.M),version2=Version.from(options.version),mask2=MaskPattern.from(options.maskPattern),options.toSJISFunc)Utils.setToSJISFunction(options.toSJISFunc)}return createSymbol(data,version2,errorCorrectionLevel,mask2)}});var require_chunkstream=__commonJS((exports,module)=>{var util=__require("util"),Stream3=__require("stream"),ChunkStream=module.exports=function(){Stream3.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};util.inherits(ChunkStream,Stream3);ChunkStream.prototype.read=function(length,callback){this._reads.push({length:Math.abs(length),allowLess:length<0,func:callback}),process.nextTick(function(){if(this._process(),this._paused&&this._reads&&this._reads.length>0)this._paused=!1,this.emit("drain")}.bind(this))};ChunkStream.prototype.write=function(data,encoding){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let dataBuffer;if(Buffer.isBuffer(data))dataBuffer=data;else dataBuffer=Buffer.from(data,encoding||this._encoding);if(this._buffers.push(dataBuffer),this._buffered+=dataBuffer.length,this._process(),this._reads&&this._reads.length===0)this._paused=!0;return this.writable&&!this._paused};ChunkStream.prototype.end=function(data,encoding){if(data)this.write(data,encoding);if(this.writable=!1,!this._buffers)return;if(this._buffers.length===0)this._end();else this._buffers.push(null),this._process()};ChunkStream.prototype.destroySoon=ChunkStream.prototype.end;ChunkStream.prototype._end=function(){if(this._reads.length>0)this.emit("error",new Error("Unexpected end of input"));this.destroy()};ChunkStream.prototype.destroy=function(){if(!this._buffers)return;this.writable=!1,this._reads=null,this._buffers=null,this.emit("close")};ChunkStream.prototype._processReadAllowingLess=function(read){this._reads.shift();let smallerBuf=this._buffers[0];if(smallerBuf.length>read.length)this._buffered-=read.length,this._buffers[0]=smallerBuf.slice(read.length),read.func.call(this,smallerBuf.slice(0,read.length));else this._buffered-=smallerBuf.length,this._buffers.shift(),read.func.call(this,smallerBuf)};ChunkStream.prototype._processRead=function(read){this._reads.shift();let pos=0,count2=0,data=Buffer.alloc(read.length);while(pos<read.length){let buf=this._buffers[count2++],len=Math.min(buf.length,read.length-pos);if(buf.copy(data,pos,0,len),pos+=len,len!==buf.length)this._buffers[--count2]=buf.slice(len)}if(count2>0)this._buffers.splice(0,count2);this._buffered-=read.length,read.func.call(this,data)};ChunkStream.prototype._process=function(){try{while(this._buffered>0&&this._reads&&this._reads.length>0){let read=this._reads[0];if(read.allowLess)this._processReadAllowingLess(read);else if(this._buffered>=read.length)this._processRead(read);else break}if(this._buffers&&!this.writable)this._end()}catch(ex){this.emit("error",ex)}}});var require_interlace=__commonJS((exports)=>{var imagePasses=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];exports.getImagePasses=function(width,height){let images=[],xLeftOver=width%8,yLeftOver=height%8,xRepeats=(width-xLeftOver)/8,yRepeats=(height-yLeftOver)/8;for(let i=0;i<imagePasses.length;i++){let pass=imagePasses[i],passWidth=xRepeats*pass.x.length,passHeight=yRepeats*pass.y.length;for(let j=0;j<pass.x.length;j++)if(pass.x[j]<xLeftOver)passWidth++;else break;for(let j=0;j<pass.y.length;j++)if(pass.y[j]<yLeftOver)passHeight++;else break;if(passWidth>0&&passHeight>0)images.push({width:passWidth,height:passHeight,index:i})}return images};exports.getInterlaceIterator=function(width){return function(x,y,pass){let outerXLeftOver=x%imagePasses[pass].x.length,outerX=(x-outerXLeftOver)/imagePasses[pass].x.length*8+imagePasses[pass].x[outerXLeftOver],outerYLeftOver=y%imagePasses[pass].y.length,outerY=(y-outerYLeftOver)/imagePasses[pass].y.length*8+imagePasses[pass].y[outerYLeftOver];return outerX*4+outerY*width*4}}});var require_paeth_predictor=__commonJS((exports,module)=>{module.exports=function paethPredictor(left,above,upLeft){let paeth=left+above-upLeft,pLeft=Math.abs(paeth-left),pAbove=Math.abs(paeth-above),pUpLeft=Math.abs(paeth-upLeft);if(pLeft<=pAbove&&pLeft<=pUpLeft)return left;if(pAbove<=pUpLeft)return above;return upLeft}});var require_filter_parse=__commonJS((exports,module)=>{var interlaceUtils=require_interlace(),paethPredictor=require_paeth_predictor();function getByteWidth(width,bpp,depth){let byteWidth=width*bpp;if(depth!==8)byteWidth=Math.ceil(byteWidth/(8/depth));return byteWidth}var Filter=module.exports=function(bitmapInfo,dependencies){let{width,height,interlace,bpp,depth}=bitmapInfo;if(this.read=dependencies.read,this.write=dependencies.write,this.complete=dependencies.complete,this._imageIndex=0,this._images=[],interlace){let passes=interlaceUtils.getImagePasses(width,height);for(let i=0;i<passes.length;i++)this._images.push({byteWidth:getByteWidth(passes[i].width,bpp,depth),height:passes[i].height,lineIndex:0})}else this._images.push({byteWidth:getByteWidth(width,bpp,depth),height,lineIndex:0});if(depth===8)this._xComparison=bpp;else if(depth===16)this._xComparison=bpp*2;else this._xComparison=1};Filter.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))};Filter.prototype._unFilterType1=function(rawData,unfilteredLine,byteWidth){let xComparison=this._xComparison,xBiggerThan=xComparison-1;for(let x=0;x<byteWidth;x++){let rawByte=rawData[1+x],f1Left=x>xBiggerThan?unfilteredLine[x-xComparison]:0;unfilteredLine[x]=rawByte+f1Left}};Filter.prototype._unFilterType2=function(rawData,unfilteredLine,byteWidth){let lastLine=this._lastLine;for(let x=0;x<byteWidth;x++){let rawByte=rawData[1+x],f2Up=lastLine?lastLine[x]:0;unfilteredLine[x]=rawByte+f2Up}};Filter.prototype._unFilterType3=function(rawData,unfilteredLine,byteWidth){let xComparison=this._xComparison,xBiggerThan=xComparison-1,lastLine=this._lastLine;for(let x=0;x<byteWidth;x++){let rawByte=rawData[1+x],f3Up=lastLine?lastLine[x]:0,f3Left=x>xBiggerThan?unfilteredLine[x-xComparison]:0,f3Add=Math.floor((f3Left+f3Up)/2);unfilteredLine[x]=rawByte+f3Add}};Filter.prototype._unFilterType4=function(rawData,unfilteredLine,byteWidth){let xComparison=this._xComparison,xBiggerThan=xComparison-1,lastLine=this._lastLine;for(let x=0;x<byteWidth;x++){let rawByte=rawData[1+x],f4Up=lastLine?lastLine[x]:0,f4Left=x>xBiggerThan?unfilteredLine[x-xComparison]:0,f4UpLeft=x>xBiggerThan&&lastLine?lastLine[x-xComparison]:0,f4Add=paethPredictor(f4Left,f4Up,f4UpLeft);unfilteredLine[x]=rawByte+f4Add}};Filter.prototype._reverseFilterLine=function(rawData){let filter=rawData[0],unfilteredLine,currentImage=this._images[this._imageIndex],byteWidth=currentImage.byteWidth;if(filter===0)unfilteredLine=rawData.slice(1,byteWidth+1);else switch(unfilteredLine=Buffer.alloc(byteWidth),filter){case 1:this._unFilterType1(rawData,unfilteredLine,byteWidth);break;case 2:this._unFilterType2(rawData,unfilteredLine,byteWidth);break;case 3:this._unFilterType3(rawData,unfilteredLine,byteWidth);break;case 4:this._unFilterType4(rawData,unfilteredLine,byteWidth);break;default:throw new Error("Unrecognised filter type - "+filter)}if(this.write(unfilteredLine),currentImage.lineIndex++,currentImage.lineIndex>=currentImage.height)this._lastLine=null,this._imageIndex++,currentImage=this._images[this._imageIndex];else this._lastLine=unfilteredLine;if(currentImage)this.read(currentImage.byteWidth+1,this._reverseFilterLine.bind(this));else this._lastLine=null,this.complete()}});var require_filter_parse_async=__commonJS((exports,module)=>{var util=__require("util"),ChunkStream=require_chunkstream(),Filter=require_filter_parse(),FilterAsync=module.exports=function(bitmapInfo){ChunkStream.call(this);let buffers=[],that=this;this._filter=new Filter(bitmapInfo,{read:this.read.bind(this),write:function(buffer2){buffers.push(buffer2)},complete:function(){that.emit("complete",Buffer.concat(buffers))}}),this._filter.start()};util.inherits(FilterAsync,ChunkStream)});var require_constants=__commonJS((exports,module)=>{module.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}});var require_crc=__commonJS((exports,module)=>{var crcTable=[];(function(){for(let i=0;i<256;i++){let currentCrc=i;for(let j=0;j<8;j++)if(currentCrc&1)currentCrc=3988292384^currentCrc>>>1;else currentCrc=currentCrc>>>1;crcTable[i]=currentCrc}})();var CrcCalculator=module.exports=function(){this._crc=-1};CrcCalculator.prototype.write=function(data){for(let i=0;i<data.length;i++)this._crc=crcTable[(this._crc^data[i])&255]^this._crc>>>8;return!0};CrcCalculator.prototype.crc32=function(){return this._crc^-1};CrcCalculator.crc32=function(buf){let crc=-1;for(let i=0;i<buf.length;i++)crc=crcTable[(crc^buf[i])&255]^crc>>>8;return crc^-1}});var require_parser=__commonJS((exports,module)=>{var constants=require_constants(),CrcCalculator=require_crc(),Parser=module.exports=function(options,dependencies){this._options=options,options.checkCRC=options.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[constants.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[constants.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[constants.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[constants.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[constants.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[constants.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=dependencies.read,this.error=dependencies.error,this.metadata=dependencies.metadata,this.gamma=dependencies.gamma,this.transColor=dependencies.transColor,this.palette=dependencies.palette,this.parsed=dependencies.parsed,this.inflateData=dependencies.inflateData,this.finished=dependencies.finished,this.simpleTransparency=dependencies.simpleTransparency,this.headersFinished=dependencies.headersFinished||function(){}};Parser.prototype.start=function(){this.read(constants.PNG_SIGNATURE.length,this._parseSignature.bind(this))};Parser.prototype._parseSignature=function(data){let signature=constants.PNG_SIGNATURE;for(let i=0;i<signature.length;i++)if(data[i]!==signature[i]){this.error(new Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))};Parser.prototype._parseChunkBegin=function(data){let length=data.readUInt32BE(0),type2=data.readUInt32BE(4),name="";for(let i=4;i<8;i++)name+=String.fromCharCode(data[i]);let ancillary=Boolean(data[4]&32);if(!this._hasIHDR&&type2!==constants.TYPE_IHDR){this.error(new Error("Expected IHDR on beggining"));return}if(this._crc=new CrcCalculator,this._crc.write(Buffer.from(name)),this._chunks[type2])return this._chunks[type2](length);if(!ancillary){this.error(new Error("Unsupported critical chunk type "+name));return}this.read(length+4,this._skipChunk.bind(this))};Parser.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))};Parser.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))};Parser.prototype._parseChunkEnd=function(data){let fileCrc=data.readInt32BE(0),calcCrc=this._crc.crc32();if(this._options.checkCRC&&calcCrc!==fileCrc){this.error(new Error("Crc error - "+fileCrc+" - "+calcCrc));return}if(!this._hasIEND)this.read(8,this._parseChunkBegin.bind(this))};Parser.prototype._handleIHDR=function(length){this.read(length,this._parseIHDR.bind(this))};Parser.prototype._parseIHDR=function(data){this._crc.write(data);let width=data.readUInt32BE(0),height=data.readUInt32BE(4),depth=data[8],colorType=data[9],compr=data[10],filter=data[11],interlace=data[12];if(depth!==8&&depth!==4&&depth!==2&&depth!==1&&depth!==16){this.error(new Error("Unsupported bit depth "+depth));return}if(!(colorType in constants.COLORTYPE_TO_BPP_MAP)){this.error(new Error("Unsupported color type"));return}if(compr!==0){this.error(new Error("Unsupported compression method"));return}if(filter!==0){this.error(new Error("Unsupported filter method"));return}if(interlace!==0&&interlace!==1){this.error(new Error("Unsupported interlace method"));return}this._colorType=colorType;let bpp=constants.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width,height,depth,interlace:Boolean(interlace),palette:Boolean(colorType&constants.COLORTYPE_PALETTE),color:Boolean(colorType&constants.COLORTYPE_COLOR),alpha:Boolean(colorType&constants.COLORTYPE_ALPHA),bpp,colorType}),this._handleChunkEnd()};Parser.prototype._handlePLTE=function(length){this.read(length,this._parsePLTE.bind(this))};Parser.prototype._parsePLTE=function(data){this._crc.write(data);let entries=Math.floor(data.length/3);for(let i=0;i<entries;i++)this._palette.push([data[i*3],data[i*3+1],data[i*3+2],255]);this.palette(this._palette),this._handleChunkEnd()};Parser.prototype._handleTRNS=function(length){this.simpleTransparency(),this.read(length,this._parseTRNS.bind(this))};Parser.prototype._parseTRNS=function(data){if(this._crc.write(data),this._colorType===constants.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(new Error("Transparency chunk must be after palette"));return}if(data.length>this._palette.length){this.error(new Error("More transparent colors than palette size"));return}for(let i=0;i<data.length;i++)this._palette[i][3]=data[i];this.palette(this._palette)}if(this._colorType===constants.COLORTYPE_GRAYSCALE)this.transColor([data.readUInt16BE(0)]);if(this._colorType===constants.COLORTYPE_COLOR)this.transColor([data.readUInt16BE(0),data.readUInt16BE(2),data.readUInt16BE(4)]);this._handleChunkEnd()};Parser.prototype._handleGAMA=function(length){this.read(length,this._parseGAMA.bind(this))};Parser.prototype._parseGAMA=function(data){this._crc.write(data),this.gamma(data.readUInt32BE(0)/constants.GAMMA_DIVISION),this._handleChunkEnd()};Parser.prototype._handleIDAT=function(length){if(!this._emittedHeadersFinished)this._emittedHeadersFinished=!0,this.headersFinished();this.read(-length,this._parseIDAT.bind(this,length))};Parser.prototype._parseIDAT=function(length,data){if(this._crc.write(data),this._colorType===constants.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(data);let leftOverLength=length-data.length;if(leftOverLength>0)this._handleIDAT(leftOverLength);else this._handleChunkEnd()};Parser.prototype._handleIEND=function(length){this.read(length,this._parseIEND.bind(this))};Parser.prototype._parseIEND=function(data){if(this._crc.write(data),this._hasIEND=!0,this._handleChunkEnd(),this.finished)this.finished()}});var require_bitmapper=__commonJS((exports)=>{var interlaceUtils=require_interlace(),pixelBppMapper=[function(){},function(pxData,data,pxPos,rawPos){if(rawPos===data.length)throw new Error("Ran out of data");let pixel=data[rawPos];pxData[pxPos]=pixel,pxData[pxPos+1]=pixel,pxData[pxPos+2]=pixel,pxData[pxPos+3]=255},function(pxData,data,pxPos,rawPos){if(rawPos+1>=data.length)throw new Error("Ran out of data");let pixel=data[rawPos];pxData[pxPos]=pixel,pxData[pxPos+1]=pixel,pxData[pxPos+2]=pixel,pxData[pxPos+3]=data[rawPos+1]},function(pxData,data,pxPos,rawPos){if(rawPos+2>=data.length)throw new Error("Ran out of data");pxData[pxPos]=data[rawPos],pxData[pxPos+1]=data[rawPos+1],pxData[pxPos+2]=data[rawPos+2],pxData[pxPos+3]=255},function(pxData,data,pxPos,rawPos){if(rawPos+3>=data.length)throw new Error("Ran out of data");pxData[pxPos]=data[rawPos],pxData[pxPos+1]=data[rawPos+1],pxData[pxPos+2]=data[rawPos+2],pxData[pxPos+3]=data[rawPos+3]}],pixelBppCustomMapper=[function(){},function(pxData,pixelData,pxPos,maxBit){let pixel=pixelData[0];pxData[pxPos]=pixel,pxData[pxPos+1]=pixel,pxData[pxPos+2]=pixel,pxData[pxPos+3]=maxBit},function(pxData,pixelData,pxPos){let pixel=pixelData[0];pxData[pxPos]=pixel,pxData[pxPos+1]=pixel,pxData[pxPos+2]=pixel,pxData[pxPos+3]=pixelData[1]},function(pxData,pixelData,pxPos,maxBit){pxData[pxPos]=pixelData[0],pxData[pxPos+1]=pixelData[1],pxData[pxPos+2]=pixelData[2],pxData[pxPos+3]=maxBit},function(pxData,pixelData,pxPos){pxData[pxPos]=pixelData[0],pxData[pxPos+1]=pixelData[1],pxData[pxPos+2]=pixelData[2],pxData[pxPos+3]=pixelData[3]}];function bitRetriever(data,depth){let leftOver=[],i=0;function split(){if(i===data.length)throw new Error("Ran out of data");let byte2=data[i];i++;let byte8,byte7,byte6,byte5,byte4,byte3,byte22,byte1;switch(depth){default:throw new Error("unrecognised depth");case 16:byte22=data[i],i++,leftOver.push((byte2<<8)+byte22);break;case 4:byte22=byte2&15,byte1=byte2>>4,leftOver.push(byte1,byte22);break;case 2:byte4=byte2&3,byte3=byte2>>2&3,byte22=byte2>>4&3,byte1=byte2>>6&3,leftOver.push(byte1,byte22,byte3,byte4);break;case 1:byte8=byte2&1,byte7=byte2>>1&1,byte6=byte2>>2&1,byte5=byte2>>3&1,byte4=byte2>>4&1,byte3=byte2>>5&1,byte22=byte2>>6&1,byte1=byte2>>7&1,leftOver.push(byte1,byte22,byte3,byte4,byte5,byte6,byte7,byte8);break}}return{get:function(count2){while(leftOver.length<count2)split();let returner=leftOver.slice(0,count2);return leftOver=leftOver.slice(count2),returner},resetAfterLine:function(){leftOver.length=0},end:function(){if(i!==data.length)throw new Error("extra data found")}}}function mapImage8Bit(image,pxData,getPxPos,bpp,data,rawPos){let{width:imageWidth,height:imageHeight,index:imagePass}=image;for(let y=0;y<imageHeight;y++)for(let x=0;x<imageWidth;x++){let pxPos=getPxPos(x,y,imagePass);pixelBppMapper[bpp](pxData,data,pxPos,rawPos),rawPos+=bpp}return rawPos}function mapImageCustomBit(image,pxData,getPxPos,bpp,bits,maxBit){let{width:imageWidth,height:imageHeight,index:imagePass}=image;for(let y=0;y<imageHeight;y++){for(let x=0;x<imageWidth;x++){let pixelData=bits.get(bpp),pxPos=getPxPos(x,y,imagePass);pixelBppCustomMapper[bpp](pxData,pixelData,pxPos,maxBit)}bits.resetAfterLine()}}exports.dataToBitMap=function(data,bitmapInfo){let{width,height,depth,bpp,interlace}=bitmapInfo,bits;if(depth!==8)bits=bitRetriever(data,depth);let pxData;if(depth<=8)pxData=Buffer.alloc(width*height*4);else pxData=new Uint16Array(width*height*4);let maxBit=Math.pow(2,depth)-1,rawPos=0,images,getPxPos;if(interlace)images=interlaceUtils.getImagePasses(width,height),getPxPos=interlaceUtils.getInterlaceIterator(width,height);else{let nonInterlacedPxPos=0;getPxPos=function(){let returner=nonInterlacedPxPos;return nonInterlacedPxPos+=4,returner},images=[{width,height}]}for(let imageIndex=0;imageIndex<images.length;imageIndex++)if(depth===8)rawPos=mapImage8Bit(images[imageIndex],pxData,getPxPos,bpp,data,rawPos);else mapImageCustomBit(images[imageIndex],pxData,getPxPos,bpp,bits,maxBit);if(depth===8){if(rawPos!==data.length)throw new Error("extra data found")}else bits.end();return pxData}});var require_format_normaliser=__commonJS((exports,module)=>{function dePalette(indata,outdata,width,height,palette){let pxPos=0;for(let y=0;y<height;y++)for(let x=0;x<width;x++){let color=palette[indata[pxPos]];if(!color)throw new Error("index "+indata[pxPos]+" not in palette");for(let i=0;i<4;i++)outdata[pxPos+i]=color[i];pxPos+=4}}function replaceTransparentColor(indata,outdata,width,height,transColor){let pxPos=0;for(let y=0;y<height;y++)for(let x=0;x<width;x++){let makeTrans=!1;if(transColor.length===1){if(transColor[0]===indata[pxPos])makeTrans=!0}else if(transColor[0]===indata[pxPos]&&transColor[1]===indata[pxPos+1]&&transColor[2]===indata[pxPos+2])makeTrans=!0;if(makeTrans)for(let i=0;i<4;i++)outdata[pxPos+i]=0;pxPos+=4}}function scaleDepth(indata,outdata,width,height,depth){let maxOutSample=255,maxInSample=Math.pow(2,depth)-1,pxPos=0;for(let y=0;y<height;y++)for(let x=0;x<width;x++){for(let i=0;i<4;i++)outdata[pxPos+i]=Math.floor(indata[pxPos+i]*maxOutSample/maxInSample+0.5);pxPos+=4}}module.exports=function(indata,imageData){let{depth,width,height,colorType,transColor,palette}=imageData,outdata=indata;if(colorType===3)dePalette(indata,outdata,width,height,palette);else{if(transColor)replaceTransparentColor(indata,outdata,width,height,transColor);if(depth!==8){if(depth===16)outdata=Buffer.alloc(width*height*4);scaleDepth(indata,outdata,width,height,depth)}}return outdata}});var require_parser_async=__commonJS((exports,module)=>{var util=__require("util"),zlib=__require("zlib"),ChunkStream=require_chunkstream(),FilterAsync=require_filter_parse_async(),Parser=require_parser(),bitmapper=require_bitmapper(),formatNormaliser=require_format_normaliser(),ParserAsync=module.exports=function(options){ChunkStream.call(this),this._parser=new Parser(options,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=options,this.writable=!0,this._parser.start()};util.inherits(ParserAsync,ChunkStream);ParserAsync.prototype._handleError=function(err){if(this.emit("error",err),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy)this._inflate.destroy();if(this._filter)this._filter.destroy(),this._filter.on("error",function(){});this.errord=!0};ParserAsync.prototype._inflateData=function(data){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=zlib.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let imageSize=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,chunkSize=Math.max(imageSize,zlib.Z_MIN_CHUNK);this._inflate=zlib.createInflate({chunkSize});let leftToInflate=imageSize,emitError=this.emit.bind(this,"error");this._inflate.on("error",function(err){if(!leftToInflate)return;emitError(err)}),this._filter.on("complete",this._complete.bind(this));let filterWrite=this._filter.write.bind(this._filter);this._inflate.on("data",function(chunk){if(!leftToInflate)return;if(chunk.length>leftToInflate)chunk=chunk.slice(0,leftToInflate);leftToInflate-=chunk.length,filterWrite(chunk)}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(data)};ParserAsync.prototype._handleMetaData=function(metaData){this._metaData=metaData,this._bitmapInfo=Object.create(metaData),this._filter=new FilterAsync(this._bitmapInfo)};ParserAsync.prototype._handleTransColor=function(transColor){this._bitmapInfo.transColor=transColor};ParserAsync.prototype._handlePalette=function(palette){this._bitmapInfo.palette=palette};ParserAsync.prototype._simpleTransparency=function(){this._metaData.alpha=!0};ParserAsync.prototype._headersFinished=function(){this.emit("metadata",this._metaData)};ParserAsync.prototype._finished=function(){if(this.errord)return;if(!this._inflate)this.emit("error","No Inflate block");else this._inflate.end()};ParserAsync.prototype._complete=function(filteredData){if(this.errord)return;let normalisedBitmapData;try{let bitmapData=bitmapper.dataToBitMap(filteredData,this._bitmapInfo);normalisedBitmapData=formatNormaliser(bitmapData,this._bitmapInfo),bitmapData=null}catch(ex){this._handleError(ex);return}this.emit("parsed",normalisedBitmapData)}});var require_bitpacker=__commonJS((exports,module)=>{var constants=require_constants();module.exports=function(dataIn,width,height,options){let outHasAlpha=[constants.COLORTYPE_COLOR_ALPHA,constants.COLORTYPE_ALPHA].indexOf(options.colorType)!==-1;if(options.colorType===options.inputColorType){let bigEndian=function(){let buffer2=new ArrayBuffer(2);return new DataView(buffer2).setInt16(0,256,!0),new Int16Array(buffer2)[0]!==256}();if(options.bitDepth===8||options.bitDepth===16&&bigEndian)return dataIn}let data=options.bitDepth!==16?dataIn:new Uint16Array(dataIn.buffer),maxValue=255,inBpp=constants.COLORTYPE_TO_BPP_MAP[options.inputColorType];if(inBpp===4&&!options.inputHasAlpha)inBpp=3;let outBpp=constants.COLORTYPE_TO_BPP_MAP[options.colorType];if(options.bitDepth===16)maxValue=65535,outBpp*=2;let outData=Buffer.alloc(width*height*outBpp),inIndex=0,outIndex=0,bgColor=options.bgColor||{};if(bgColor.red===void 0)bgColor.red=maxValue;if(bgColor.green===void 0)bgColor.green=maxValue;if(bgColor.blue===void 0)bgColor.blue=maxValue;function getRGBA(){let red,green,blue,alpha=maxValue;switch(options.inputColorType){case constants.COLORTYPE_COLOR_ALPHA:alpha=data[inIndex+3],red=data[inIndex],green=data[inIndex+1],blue=data[inIndex+2];break;case constants.COLORTYPE_COLOR:red=data[inIndex],green=data[inIndex+1],blue=data[inIndex+2];break;case constants.COLORTYPE_ALPHA:alpha=data[inIndex+1],red=data[inIndex],green=red,blue=red;break;case constants.COLORTYPE_GRAYSCALE:red=data[inIndex],green=red,blue=red;break;default:throw new Error("input color type:"+options.inputColorType+" is not supported at present")}if(options.inputHasAlpha){if(!outHasAlpha)alpha/=maxValue,red=Math.min(Math.max(Math.round((1-alpha)*bgColor.red+alpha*red),0),maxValue),green=Math.min(Math.max(Math.round((1-alpha)*bgColor.green+alpha*green),0),maxValue),blue=Math.min(Math.max(Math.round((1-alpha)*bgColor.blue+alpha*blue),0),maxValue)}return{red,green,blue,alpha}}for(let y=0;y<height;y++)for(let x=0;x<width;x++){let rgba=getRGBA(data,inIndex);switch(options.colorType){case constants.COLORTYPE_COLOR_ALPHA:case constants.COLORTYPE_COLOR:if(options.bitDepth===8){if(outData[outIndex]=rgba.red,outData[outIndex+1]=rgba.green,outData[outIndex+2]=rgba.blue,outHasAlpha)outData[outIndex+3]=rgba.alpha}else if(outData.writeUInt16BE(rgba.red,outIndex),outData.writeUInt16BE(rgba.green,outIndex+2),outData.writeUInt16BE(rgba.blue,outIndex+4),outHasAlpha)outData.writeUInt16BE(rgba.alpha,outIndex+6);break;case constants.COLORTYPE_ALPHA:case constants.COLORTYPE_GRAYSCALE:{let grayscale=(rgba.red+rgba.green+rgba.blue)/3;if(options.bitDepth===8){if(outData[outIndex]=grayscale,outHasAlpha)outData[outIndex+1]=rgba.alpha}else if(outData.writeUInt16BE(grayscale,outIndex),outHasAlpha)outData.writeUInt16BE(rgba.alpha,outIndex+2);break}default:throw new Error("unrecognised color Type "+options.colorType)}inIndex+=inBpp,outIndex+=outBpp}return outData}});var require_filter_pack=__commonJS((exports,module)=>{var paethPredictor=require_paeth_predictor();function filterNone(pxData,pxPos,byteWidth,rawData,rawPos){for(let x=0;x<byteWidth;x++)rawData[rawPos+x]=pxData[pxPos+x]}function filterSumNone(pxData,pxPos,byteWidth){let sum=0,length=pxPos+byteWidth;for(let i=pxPos;i<length;i++)sum+=Math.abs(pxData[i]);return sum}function filterSub(pxData,pxPos,byteWidth,rawData,rawPos,bpp){for(let x=0;x<byteWidth;x++){let left=x>=bpp?pxData[pxPos+x-bpp]:0,val=pxData[pxPos+x]-left;rawData[rawPos+x]=val}}function filterSumSub(pxData,pxPos,byteWidth,bpp){let sum=0;for(let x=0;x<byteWidth;x++){let left=x>=bpp?pxData[pxPos+x-bpp]:0,val=pxData[pxPos+x]-left;sum+=Math.abs(val)}return sum}function filterUp(pxData,pxPos,byteWidth,rawData,rawPos){for(let x=0;x<byteWidth;x++){let up=pxPos>0?pxData[pxPos+x-byteWidth]:0,val=pxData[pxPos+x]-up;rawData[rawPos+x]=val}}function filterSumUp(pxData,pxPos,byteWidth){let sum=0,length=pxPos+byteWidth;for(let x=pxPos;x<length;x++){let up=pxPos>0?pxData[x-byteWidth]:0,val=pxData[x]-up;sum+=Math.abs(val)}return sum}function filterAvg(pxData,pxPos,byteWidth,rawData,rawPos,bpp){for(let x=0;x<byteWidth;x++){let left=x>=bpp?pxData[pxPos+x-bpp]:0,up=pxPos>0?pxData[pxPos+x-byteWidth]:0,val=pxData[pxPos+x]-(left+up>>1);rawData[rawPos+x]=val}}function filterSumAvg(pxData,pxPos,byteWidth,bpp){let sum=0;for(let x=0;x<byteWidth;x++){let left=x>=bpp?pxData[pxPos+x-bpp]:0,up=pxPos>0?pxData[pxPos+x-byteWidth]:0,val=pxData[pxPos+x]-(left+up>>1);sum+=Math.abs(val)}return sum}function filterPaeth(pxData,pxPos,byteWidth,rawData,rawPos,bpp){for(let x=0;x<byteWidth;x++){let left=x>=bpp?pxData[pxPos+x-bpp]:0,up=pxPos>0?pxData[pxPos+x-byteWidth]:0,upleft=pxPos>0&&x>=bpp?pxData[pxPos+x-(byteWidth+bpp)]:0,val=pxData[pxPos+x]-paethPredictor(left,up,upleft);rawData[rawPos+x]=val}}function filterSumPaeth(pxData,pxPos,byteWidth,bpp){let sum=0;for(let x=0;x<byteWidth;x++){let left=x>=bpp?pxData[pxPos+x-bpp]:0,up=pxPos>0?pxData[pxPos+x-byteWidth]:0,upleft=pxPos>0&&x>=bpp?pxData[pxPos+x-(byteWidth+bpp)]:0,val=pxData[pxPos+x]-paethPredictor(left,up,upleft);sum+=Math.abs(val)}return sum}var filters={0:filterNone,1:filterSub,2:filterUp,3:filterAvg,4:filterPaeth},filterSums={0:filterSumNone,1:filterSumSub,2:filterSumUp,3:filterSumAvg,4:filterSumPaeth};module.exports=function(pxData,width,height,options,bpp){let filterTypes;if(!("filterType"in options)||options.filterType===-1)filterTypes=[0,1,2,3,4];else if(typeof options.filterType==="number")filterTypes=[options.filterType];else throw new Error("unrecognised filter types");if(options.bitDepth===16)bpp*=2;let byteWidth=width*bpp,rawPos=0,pxPos=0,rawData=Buffer.alloc((byteWidth+1)*height),sel=filterTypes[0];for(let y=0;y<height;y++){if(filterTypes.length>1){let min=1/0;for(let i=0;i<filterTypes.length;i++){let sum=filterSums[filterTypes[i]](pxData,pxPos,byteWidth,bpp);if(sum<min)sel=filterTypes[i],min=sum}}rawData[rawPos]=sel,rawPos++,filters[sel](pxData,pxPos,byteWidth,rawData,rawPos,bpp),rawPos+=byteWidth,pxPos+=byteWidth}return rawData}});var require_packer=__commonJS((exports,module)=>{var constants=require_constants(),CrcStream=require_crc(),bitPacker=require_bitpacker(),filter=require_filter_pack(),zlib=__require("zlib"),Packer=module.exports=function(options){if(this._options=options,options.deflateChunkSize=options.deflateChunkSize||32768,options.deflateLevel=options.deflateLevel!=null?options.deflateLevel:9,options.deflateStrategy=options.deflateStrategy!=null?options.deflateStrategy:3,options.inputHasAlpha=options.inputHasAlpha!=null?options.inputHasAlpha:!0,options.deflateFactory=options.deflateFactory||zlib.createDeflate,options.bitDepth=options.bitDepth||8,options.colorType=typeof options.colorType==="number"?options.colorType:constants.COLORTYPE_COLOR_ALPHA,options.inputColorType=typeof options.inputColorType==="number"?options.inputColorType:constants.COLORTYPE_COLOR_ALPHA,[constants.COLORTYPE_GRAYSCALE,constants.COLORTYPE_COLOR,constants.COLORTYPE_COLOR_ALPHA,constants.COLORTYPE_ALPHA].indexOf(options.colorType)===-1)throw new Error("option color type:"+options.colorType+" is not supported at present");if([constants.COLORTYPE_GRAYSCALE,constants.COLORTYPE_COLOR,constants.COLORTYPE_COLOR_ALPHA,constants.COLORTYPE_ALPHA].indexOf(options.inputColorType)===-1)throw new Error("option input color type:"+options.inputColorType+" is not supported at present");if(options.bitDepth!==8&&options.bitDepth!==16)throw new Error("option bit depth:"+options.bitDepth+" is not supported at present")};Packer.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}};Packer.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())};Packer.prototype.filterData=function(data,width,height){let packedData=bitPacker(data,width,height,this._options),bpp=constants.COLORTYPE_TO_BPP_MAP[this._options.colorType];return filter(packedData,width,height,this._options,bpp)};Packer.prototype._packChunk=function(type2,data){let len=data?data.length:0,buf=Buffer.alloc(len+12);if(buf.writeUInt32BE(len,0),buf.writeUInt32BE(type2,4),data)data.copy(buf,8);return buf.writeInt32BE(CrcStream.crc32(buf.slice(4,buf.length-4)),buf.length-4),buf};Packer.prototype.packGAMA=function(gamma){let buf=Buffer.alloc(4);return buf.writeUInt32BE(Math.floor(gamma*constants.GAMMA_DIVISION),0),this._packChunk(constants.TYPE_gAMA,buf)};Packer.prototype.packIHDR=function(width,height){let buf=Buffer.alloc(13);return buf.writeUInt32BE(width,0),buf.writeUInt32BE(height,4),buf[8]=this._options.bitDepth,buf[9]=this._options.colorType,buf[10]=0,buf[11]=0,buf[12]=0,this._packChunk(constants.TYPE_IHDR,buf)};Packer.prototype.packIDAT=function(data){return this._packChunk(constants.TYPE_IDAT,data)};Packer.prototype.packIEND=function(){return this._packChunk(constants.TYPE_IEND,null)}});var require_packer_async=__commonJS((exports,module)=>{var util=__require("util"),Stream3=__require("stream"),constants=require_constants(),Packer=require_packer(),PackerAsync=module.exports=function(opt){Stream3.call(this);let options=opt||{};this._packer=new Packer(options),this._deflate=this._packer.createDeflate(),this.readable=!0};util.inherits(PackerAsync,Stream3);PackerAsync.prototype.pack=function(data,width,height,gamma){if(this.emit("data",Buffer.from(constants.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(width,height)),gamma)this.emit("data",this._packer.packGAMA(gamma));let filteredData=this._packer.filterData(data,width,height);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(compressedData){this.emit("data",this._packer.packIDAT(compressedData))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(filteredData)}});var require_sync_inflate=__commonJS((exports,module)=>{var assert2=__require("assert").ok,zlib=__require("zlib"),util=__require("util"),kMaxLength=__require("buffer").kMaxLength;function Inflate(opts){if(!(this instanceof Inflate))return new Inflate(opts);if(opts&&opts.chunkSize<zlib.Z_MIN_CHUNK)opts.chunkSize=zlib.Z_MIN_CHUNK;if(zlib.Inflate.call(this,opts),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,opts&&opts.maxLength!=null)this._maxLength=opts.maxLength}function createInflate(opts){return new Inflate(opts)}function _close(engine,callback){if(callback)process.nextTick(callback);if(!engine._handle)return;engine._handle.close(),engine._handle=null}Inflate.prototype._processChunk=function(chunk,flushFlag,asyncCb){if(typeof asyncCb==="function")return zlib.Inflate._processChunk.call(this,chunk,flushFlag,asyncCb);let self2=this,availInBefore=chunk&&chunk.length,availOutBefore=this._chunkSize-this._offset,leftToInflate=this._maxLength,inOff=0,buffers=[],nread=0,error2;this.on("error",function(err){error2=err});function handleChunk(availInAfter,availOutAfter){if(self2._hadError)return;let have=availOutBefore-availOutAfter;if(assert2(have>=0,"have should not go down"),have>0){let out=self2._buffer.slice(self2._offset,self2._offset+have);if(self2._offset+=have,out.length>leftToInflate)out=out.slice(0,leftToInflate);if(buffers.push(out),nread+=out.length,leftToInflate-=out.length,leftToInflate===0)return!1}if(availOutAfter===0||self2._offset>=self2._chunkSize)availOutBefore=self2._chunkSize,self2._offset=0,self2._buffer=Buffer.allocUnsafe(self2._chunkSize);if(availOutAfter===0)return inOff+=availInBefore-availInAfter,availInBefore=availInAfter,!0;return!1}assert2(this._handle,"zlib binding closed");let res;do res=this._handle.writeSync(flushFlag,chunk,inOff,availInBefore,this._buffer,this._offset,availOutBefore),res=res||this._writeState;while(!this._hadError&&handleChunk(res[0],res[1]));if(this._hadError)throw error2;if(nread>=kMaxLength)throw _close(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+kMaxLength.toString(16)+" bytes");let buf=Buffer.concat(buffers,nread);return _close(this),buf};util.inherits(Inflate,zlib.Inflate);function zlibBufferSync(engine,buffer2){if(typeof buffer2==="string")buffer2=Buffer.from(buffer2);if(!(buffer2 instanceof Buffer))throw new TypeError("Not a string or buffer");let flushFlag=engine._finishFlushFlag;if(flushFlag==null)flushFlag=zlib.Z_FINISH;return engine._processChunk(buffer2,flushFlag)}function inflateSync(buffer2,opts){return zlibBufferSync(new Inflate(opts),buffer2)}module.exports=exports=inflateSync;exports.Inflate=Inflate;exports.createInflate=createInflate;exports.inflateSync=inflateSync});var require_sync_reader=__commonJS((exports,module)=>{var SyncReader=module.exports=function(buffer2){this._buffer=buffer2,this._reads=[]};SyncReader.prototype.read=function(length,callback){this._reads.push({length:Math.abs(length),allowLess:length<0,func:callback})};SyncReader.prototype.process=function(){while(this._reads.length>0&&this._buffer.length){let read=this._reads[0];if(this._buffer.length&&(this._buffer.length>=read.length||read.allowLess)){this._reads.shift();let buf=this._buffer;this._buffer=buf.slice(read.length),read.func.call(this,buf.slice(0,read.length))}else break}if(this._reads.length>0)return new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)return new Error("unrecognised content at end of stream")}});var require_filter_parse_sync=__commonJS((exports)=>{var SyncReader=require_sync_reader(),Filter=require_filter_parse();exports.process=function(inBuffer,bitmapInfo){let outBuffers=[],reader=new SyncReader(inBuffer);return new Filter(bitmapInfo,{read:reader.read.bind(reader),write:function(bufferPart){outBuffers.push(bufferPart)},complete:function(){}}).start(),reader.process(),Buffer.concat(outBuffers)}});var require_parser_sync=__commonJS((exports,module)=>{var hasSyncZlib=!0,zlib=__require("zlib"),inflateSync=require_sync_inflate();if(!zlib.deflateSync)hasSyncZlib=!1;var SyncReader=require_sync_reader(),FilterSync=require_filter_parse_sync(),Parser=require_parser(),bitmapper=require_bitmapper(),formatNormaliser=require_format_normaliser();module.exports=function(buffer2,options){if(!hasSyncZlib)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let err;function handleError(_err_){err=_err_}let metaData;function handleMetaData(_metaData_){metaData=_metaData_}function handleTransColor(transColor){metaData.transColor=transColor}function handlePalette(palette){metaData.palette=palette}function handleSimpleTransparency(){metaData.alpha=!0}let gamma;function handleGamma(_gamma_){gamma=_gamma_}let inflateDataList=[];function handleInflateData(inflatedData2){inflateDataList.push(inflatedData2)}let reader=new SyncReader(buffer2);if(new Parser(options,{read:reader.read.bind(reader),error:handleError,metadata:handleMetaData,gamma:handleGamma,palette:handlePalette,transColor:handleTransColor,inflateData:handleInflateData,simpleTransparency:handleSimpleTransparency}).start(),reader.process(),err)throw err;let inflateData=Buffer.concat(inflateDataList);inflateDataList.length=0;let inflatedData;if(metaData.interlace)inflatedData=zlib.inflateSync(inflateData);else{let imageSize=((metaData.width*metaData.bpp*metaData.depth+7>>3)+1)*metaData.height;inflatedData=inflateSync(inflateData,{chunkSize:imageSize,maxLength:imageSize})}if(inflateData=null,!inflatedData||!inflatedData.length)throw new Error("bad png - invalid inflate data response");let unfilteredData=FilterSync.process(inflatedData,metaData);inflateData=null;let bitmapData=bitmapper.dataToBitMap(unfilteredData,metaData);unfilteredData=null;let normalisedBitmapData=formatNormaliser(bitmapData,metaData);return metaData.data=normalisedBitmapData,metaData.gamma=gamma||0,metaData}});var require_packer_sync=__commonJS((exports,module)=>{var hasSyncZlib=!0,zlib=__require("zlib");if(!zlib.deflateSync)hasSyncZlib=!1;var constants=require_constants(),Packer=require_packer();module.exports=function(metaData,opt){if(!hasSyncZlib)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let packer=new Packer(opt||{}),chunks=[];if(chunks.push(Buffer.from(constants.PNG_SIGNATURE)),chunks.push(packer.packIHDR(metaData.width,metaData.height)),metaData.gamma)chunks.push(packer.packGAMA(metaData.gamma));let filteredData=packer.filterData(metaData.data,metaData.width,metaData.height),compressedData=zlib.deflateSync(filteredData,packer.getDeflateOptions());if(filteredData=null,!compressedData||!compressedData.length)throw new Error("bad png - invalid compressed data response");return chunks.push(packer.packIDAT(compressedData)),chunks.push(packer.packIEND()),Buffer.concat(chunks)}});var require_png_sync=__commonJS((exports)=>{var parse4=require_parser_sync(),pack=require_packer_sync();exports.read=function(buffer2,options){return parse4(buffer2,options||{})};exports.write=function(png,options){return pack(png,options)}});var require_png=__commonJS((exports)=>{var util=__require("util"),Stream3=__require("stream"),Parser=require_parser_async(),Packer=require_packer_async(),PNGSync=require_png_sync(),PNG=exports.PNG=function(options){if(Stream3.call(this),options=options||{},this.width=options.width|0,this.height=options.height|0,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,options.fill&&this.data)this.data.fill(0);this.gamma=0,this.readable=this.writable=!0,this._parser=new Parser(options),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(data){this.data=data,this.emit("parsed",data)}.bind(this)),this._packer=new Packer(options),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};util.inherits(PNG,Stream3);PNG.sync=PNGSync;PNG.prototype.pack=function(){if(!this.data||!this.data.length)return this.emit("error","No data provided"),this;return process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this};PNG.prototype.parse=function(data,callback){if(callback){let onParsed,onError;onParsed=function(parsedData){this.removeListener("error",onError),this.data=parsedData,callback(null,this)}.bind(this),onError=function(err){this.removeListener("parsed",onParsed),callback(err,null)}.bind(this),this.once("parsed",onParsed),this.once("error",onError)}return this.end(data),this};PNG.prototype.write=function(data){return this._parser.write(data),!0};PNG.prototype.end=function(data){this._parser.end(data)};PNG.prototype._metadata=function(metadata){this.width=metadata.width,this.height=metadata.height,this.emit("metadata",metadata)};PNG.prototype._gamma=function(gamma){this.gamma=gamma};PNG.prototype._handleClose=function(){if(!this._parser.writable&&!this._packer.readable)this.emit("close")};PNG.bitblt=function(src,dst,srcX,srcY,width,height,deltaX,deltaY){if(srcX|=0,srcY|=0,width|=0,height|=0,deltaX|=0,deltaY|=0,srcX>src.width||srcY>src.height||srcX+width>src.width||srcY+height>src.height)throw new Error("bitblt reading outside image");if(deltaX>dst.width||deltaY>dst.height||deltaX+width>dst.width||deltaY+height>dst.height)throw new Error("bitblt writing outside image");for(let y=0;y<height;y++)src.data.copy(dst.data,(deltaY+y)*dst.width+deltaX<<2,(srcY+y)*src.width+srcX<<2,(srcY+y)*src.width+srcX+width<<2)};PNG.prototype.bitblt=function(dst,srcX,srcY,width,height,deltaX,deltaY){return PNG.bitblt(this,dst,srcX,srcY,width,height,deltaX,deltaY),this};PNG.adjustGamma=function(src){if(src.gamma){for(let y=0;y<src.height;y++)for(let x=0;x<src.width;x++){let idx=src.width*y+x<<2;for(let i=0;i<3;i++){let sample=src.data[idx+i]/255;sample=Math.pow(sample,0.45454545454545453/src.gamma),src.data[idx+i]=Math.round(sample*255)}}src.gamma=0}};PNG.prototype.adjustGamma=function(){PNG.adjustGamma(this)}});var require_utils2=__commonJS((exports)=>{function hex2rgba(hex2){if(typeof hex2==="number")hex2=hex2.toString();if(typeof hex2!=="string")throw new Error("Color should be defined as hex string");let hexCode=hex2.slice().replace("#","").split("");if(hexCode.length<3||hexCode.length===5||hexCode.length>8)throw new Error("Invalid hex color: "+hex2);if(hexCode.length===3||hexCode.length===4)hexCode=Array.prototype.concat.apply([],hexCode.map(function(c){return[c,c]}));if(hexCode.length===6)hexCode.push("F","F");let hexValue=parseInt(hexCode.join(""),16);return{r:hexValue>>24&255,g:hexValue>>16&255,b:hexValue>>8&255,a:hexValue&255,hex:"#"+hexCode.slice(0,6).join("")}}exports.getOptions=function getOptions(options){if(!options)options={};if(!options.color)options.color={};let margin=typeof options.margin==="undefined"||options.margin===null||options.margin<0?4:options.margin,width=options.width&&options.width>=21?options.width:void 0,scale=options.scale||4;return{width,scale:width?4:scale,margin,color:{dark:hex2rgba(options.color.dark||"#000000ff"),light:hex2rgba(options.color.light||"#ffffffff")},type:options.type,rendererOpts:options.rendererOpts||{}}};exports.getScale=function getScale(qrSize,opts){return opts.width&&opts.width>=qrSize+opts.margin*2?opts.width/(qrSize+opts.margin*2):opts.scale};exports.getImageWidth=function getImageWidth(qrSize,opts){let scale=exports.getScale(qrSize,opts);return Math.floor((qrSize+opts.margin*2)*scale)};exports.qrToImageData=function qrToImageData(imgData,qr,opts){let size=qr.modules.size,data=qr.modules.data,scale=exports.getScale(size,opts),symbolSize=Math.floor((size+opts.margin*2)*scale),scaledMargin=opts.margin*scale,palette=[opts.color.light,opts.color.dark];for(let i=0;i<symbolSize;i++)for(let j=0;j<symbolSize;j++){let posDst=(i*symbolSize+j)*4,pxColor=opts.color.light;if(i>=scaledMargin&&j>=scaledMargin&&i<symbolSize-scaledMargin&&j<symbolSize-scaledMargin){let iSrc=Math.floor((i-scaledMargin)/scale),jSrc=Math.floor((j-scaledMargin)/scale);pxColor=palette[data[iSrc*size+jSrc]?1:0]}imgData[posDst++]=pxColor.r,imgData[posDst++]=pxColor.g,imgData[posDst++]=pxColor.b,imgData[posDst]=pxColor.a}}});var require_png2=__commonJS((exports)=>{var fs2=__require("fs"),PNG=require_png().PNG,Utils=require_utils2();exports.render=function render(qrData,options){let opts=Utils.getOptions(options),pngOpts=opts.rendererOpts,size=Utils.getImageWidth(qrData.modules.size,opts);pngOpts.width=size,pngOpts.height=size;let pngImage=new PNG(pngOpts);return Utils.qrToImageData(pngImage.data,qrData,opts),pngImage};exports.renderToDataURL=function renderToDataURL(qrData,options,cb){if(typeof cb==="undefined")cb=options,options=void 0;exports.renderToBuffer(qrData,options,function(err,output){if(err)cb(err);let url="data:image/png;base64,";url+=output.toString("base64"),cb(null,url)})};exports.renderToBuffer=function renderToBuffer(qrData,options,cb){if(typeof cb==="undefined")cb=options,options=void 0;let png=exports.render(qrData,options),buffer2=[];png.on("error",cb),png.on("data",function(data){buffer2.push(data)}),png.on("end",function(){cb(null,Buffer.concat(buffer2))}),png.pack()};exports.renderToFile=function renderToFile(path,qrData,options,cb){if(typeof cb==="undefined")cb=options,options=void 0;let called=!1,done=(...args)=>{if(called)return;called=!0,cb.apply(null,args)},stream=fs2.createWriteStream(path);stream.on("error",done),stream.on("close",done),exports.renderToFileStream(stream,qrData,options)};exports.renderToFileStream=function renderToFileStream(stream,qrData,options){exports.render(qrData,options).pack().pipe(stream)}});var require_utf8=__commonJS((exports)=>{var Utils=require_utils2(),BLOCK_CHAR={WW:" ",WB:"\u2584",BB:"\u2588",BW:"\u2580"},INVERTED_BLOCK_CHAR={BB:" ",BW:"\u2584",WW:"\u2588",WB:"\u2580"};function getBlockChar(top,bottom,blocks){if(top&&bottom)return blocks.BB;if(top&&!bottom)return blocks.BW;if(!top&&bottom)return blocks.WB;return blocks.WW}exports.render=function(qrData,options,cb){let opts=Utils.getOptions(options),blocks=BLOCK_CHAR;if(opts.color.dark.hex==="#ffffff"||opts.color.light.hex==="#000000")blocks=INVERTED_BLOCK_CHAR;let size=qrData.modules.size,data=qrData.modules.data,output="",hMargin=Array(size+opts.margin*2+1).join(blocks.WW);hMargin=Array(opts.margin/2+1).join(hMargin+`
`);let vMargin=Array(opts.margin+1).join(blocks.WW);output+=hMargin;for(let i=0;i<size;i+=2){output+=vMargin;for(let j=0;j<size;j++){let topModule=data[i*size+j],bottomModule=data[(i+1)*size+j];output+=getBlockChar(topModule,bottomModule,blocks)}output+=vMargin+`
`}if(output+=hMargin.slice(0,-1),typeof cb==="function")cb(null,output);return output};exports.renderToFile=function renderToFile(path,qrData,options,cb){if(typeof cb==="undefined")cb=options,options=void 0;let fs2=__require("fs"),utf8=exports.render(qrData,options);fs2.writeFile(path,utf8,cb)}});var require_terminal=__commonJS((exports)=>{exports.render=function(qrData,options,cb){let size=qrData.modules.size,data=qrData.modules.data,black="\x1B[40m  \x1B[0m",white="\x1B[47m  \x1B[0m",output="",hMargin=Array(size+3).join("\x1B[47m  \x1B[0m"),vMargin=Array(2).join("\x1B[47m  \x1B[0m");output+=hMargin+`
`;for(let i=0;i<size;++i){output+="\x1B[47m  \x1B[0m";for(let j=0;j<size;j++)output+=data[i*size+j]?"\x1B[40m  \x1B[0m":"\x1B[47m  \x1B[0m";output+=vMargin+`
`}if(output+=hMargin+`
`,typeof cb==="function")cb(null,output);return output}});var require_terminal_small=__commonJS((exports)=>{var lineSetupNormal="\x1B[47m\x1B[30m",lineSetupInverse="\x1B[40m\x1B[37m",createPalette=function(lineSetup,foregroundWhite2,foregroundBlack2){return{"00":"\x1B[0m "+lineSetup,"01":"\x1B[0m"+foregroundWhite2+"\u2584"+lineSetup,"02":"\x1B[0m"+foregroundBlack2+"\u2584"+lineSetup,10:"\x1B[0m"+foregroundWhite2+"\u2580"+lineSetup,11:" ",12:"\u2584",20:"\x1B[0m"+foregroundBlack2+"\u2580"+lineSetup,21:"\u2580",22:"\u2588"}},mkCodePixel=function(modules,size,x,y){let sizePlus=size+1;if(x>=sizePlus||y>=sizePlus||y<-1||x<-1)return"0";if(x>=size||y>=size||y<0||x<0)return"1";let idx=y*size+x;return modules[idx]?"2":"1"},mkCode=function(modules,size,x,y){return mkCodePixel(modules,size,x,y)+mkCodePixel(modules,size,x,y+1)};exports.render=function(qrData,options,cb){let size=qrData.modules.size,data=qrData.modules.data,inverse=!!(options&&options.inverse),lineSetup=options&&options.inverse?lineSetupInverse:lineSetupNormal,palette=createPalette(lineSetup,inverse?"\x1B[30m":"\x1B[37m",inverse?"\x1B[37m":"\x1B[30m"),newLine=`\x1B[0m
`+lineSetup,output=lineSetup;for(let y=-1;y<size+1;y+=2){for(let x=-1;x<size;x++)output+=palette[mkCode(data,size,x,y)];output+=palette[mkCode(data,size,size,y)]+newLine}if(output+="\x1B[0m",typeof cb==="function")cb(null,output);return output}});var require_terminal2=__commonJS((exports)=>{var big=require_terminal(),small=require_terminal_small();exports.render=function(qrData,options,cb){if(options&&options.small)return small.render(qrData,options,cb);return big.render(qrData,options,cb)}});var require_svg_tag=__commonJS((exports)=>{var Utils=require_utils2();function getColorAttrib(color,attrib){let alpha=color.a/255,str=attrib+'="'+color.hex+'"';return alpha<1?str+" "+attrib+'-opacity="'+alpha.toFixed(2).slice(1)+'"':str}function svgCmd(cmd,x,y){let str=cmd+x;if(typeof y!=="undefined")str+=" "+y;return str}function qrToPath(data,size,margin){let path="",moveBy=0,newRow=!1,lineLength=0;for(let i=0;i<data.length;i++){let col=Math.floor(i%size),row=Math.floor(i/size);if(!col&&!newRow)newRow=!0;if(data[i]){if(lineLength++,!(i>0&&col>0&&data[i-1]))path+=newRow?svgCmd("M",col+margin,0.5+row+margin):svgCmd("m",moveBy,0),moveBy=0,newRow=!1;if(!(col+1<size&&data[i+1]))path+=svgCmd("h",lineLength),lineLength=0}else moveBy++}return path}exports.render=function render(qrData,options,cb){let opts=Utils.getOptions(options),size=qrData.modules.size,data=qrData.modules.data,qrcodesize=size+opts.margin*2,bg=!opts.color.light.a?"":"<path "+getColorAttrib(opts.color.light,"fill")+' d="M0 0h'+qrcodesize+"v"+qrcodesize+'H0z"/>',path="<path "+getColorAttrib(opts.color.dark,"stroke")+' d="'+qrToPath(data,size,opts.margin)+'"/>',viewBox='viewBox="0 0 '+qrcodesize+" "+qrcodesize+'"',svgTag='<svg xmlns="http://www.w3.org/2000/svg" '+(!opts.width?"":'width="'+opts.width+'" height="'+opts.width+'" ')+viewBox+' shape-rendering="crispEdges">'+bg+path+`</svg>
`;if(typeof cb==="function")cb(null,svgTag);return svgTag}});var require_svg=__commonJS((exports)=>{var svgTagRenderer=require_svg_tag();exports.render=svgTagRenderer.render;exports.renderToFile=function renderToFile(path,qrData,options,cb){if(typeof cb==="undefined")cb=options,options=void 0;let fs2=__require("fs"),xmlStr='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+exports.render(qrData,options);fs2.writeFile(path,xmlStr,cb)}});var require_canvas=__commonJS((exports)=>{var Utils=require_utils2();function clearCanvas(ctx,canvas,size){if(ctx.clearRect(0,0,canvas.width,canvas.height),!canvas.style)canvas.style={};canvas.height=size,canvas.width=size,canvas.style.height=size+"px",canvas.style.width=size+"px"}function getCanvasElement(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}exports.render=function render(qrData,canvas,options){let opts=options,canvasEl=canvas;if(typeof opts==="undefined"&&(!canvas||!canvas.getContext))opts=canvas,canvas=void 0;if(!canvas)canvasEl=getCanvasElement();opts=Utils.getOptions(opts);let size=Utils.getImageWidth(qrData.modules.size,opts),ctx=canvasEl.getContext("2d"),image=ctx.createImageData(size,size);return Utils.qrToImageData(image.data,qrData,opts),clearCanvas(ctx,canvasEl,size),ctx.putImageData(image,0,0),canvasEl};exports.renderToDataURL=function renderToDataURL(qrData,canvas,options){let opts=options;if(typeof opts==="undefined"&&(!canvas||!canvas.getContext))opts=canvas,canvas=void 0;if(!opts)opts={};let canvasEl=exports.render(qrData,canvas,opts),type2=opts.type||"image/png",rendererOpts=opts.rendererOpts||{};return canvasEl.toDataURL(type2,rendererOpts.quality)}});var require_browser=__commonJS((exports)=>{var canPromise=require_can_promise(),QRCode=require_qrcode(),CanvasRenderer=require_canvas(),SvgRenderer=require_svg_tag();function renderCanvas(renderFunc,canvas,text2,opts,cb){let args=[].slice.call(arguments,1),argsNum=args.length,isLastArgCb=typeof args[argsNum-1]==="function";if(!isLastArgCb&&!canPromise())throw new Error("Callback required as last argument");if(isLastArgCb){if(argsNum<2)throw new Error("Too few arguments provided");if(argsNum===2)cb=text2,text2=canvas,canvas=opts=void 0;else if(argsNum===3)if(canvas.getContext&&typeof cb==="undefined")cb=opts,opts=void 0;else cb=opts,opts=text2,text2=canvas,canvas=void 0}else{if(argsNum<1)throw new Error("Too few arguments provided");if(argsNum===1)text2=canvas,canvas=opts=void 0;else if(argsNum===2&&!canvas.getContext)opts=text2,text2=canvas,canvas=void 0;return new Promise(function(resolve,reject){try{let data=QRCode.create(text2,opts);resolve(renderFunc(data,canvas,opts))}catch(e){reject(e)}})}try{let data=QRCode.create(text2,opts);cb(null,renderFunc(data,canvas,opts))}catch(e){cb(e)}}exports.create=QRCode.create;exports.toCanvas=renderCanvas.bind(null,CanvasRenderer.render);exports.toDataURL=renderCanvas.bind(null,CanvasRenderer.renderToDataURL);exports.toString=renderCanvas.bind(null,function(data,_2,opts){return SvgRenderer.render(data,opts)})});var require_server=__commonJS((exports)=>{var canPromise=require_can_promise(),QRCode=require_qrcode(),PngRenderer=require_png2(),Utf8Renderer=require_utf8(),TerminalRenderer=require_terminal2(),SvgRenderer=require_svg();function checkParams(text2,opts,cb){if(typeof text2==="undefined")throw new Error("String required as first argument");if(typeof cb==="undefined")cb=opts,opts={};if(typeof cb!=="function")if(!canPromise())throw new Error("Callback required as last argument");else opts=cb||{},cb=null;return{opts,cb}}function getTypeFromFilename(path){return path.slice((path.lastIndexOf(".")-1>>>0)+2).toLowerCase()}function getRendererFromType(type2){switch(type2){case"svg":return SvgRenderer;case"txt":case"utf8":return Utf8Renderer;case"png":case"image/png":default:return PngRenderer}}function getStringRendererFromType(type2){switch(type2){case"svg":return SvgRenderer;case"terminal":return TerminalRenderer;case"utf8":default:return Utf8Renderer}}function render(renderFunc,text2,params){if(!params.cb)return new Promise(function(resolve,reject){try{let data=QRCode.create(text2,params.opts);return renderFunc(data,params.opts,function(err,data2){return err?reject(err):resolve(data2)})}catch(e){reject(e)}});try{let data=QRCode.create(text2,params.opts);return renderFunc(data,params.opts,params.cb)}catch(e){params.cb(e)}}exports.create=QRCode.create;exports.toCanvas=require_browser().toCanvas;exports.toString=function toString(text2,opts,cb){let params=checkParams(text2,opts,cb),type2=params.opts?params.opts.type:void 0,renderer=getStringRendererFromType(type2);return render(renderer.render,text2,params)};exports.toDataURL=function toDataURL(text2,opts,cb){let params=checkParams(text2,opts,cb),renderer=getRendererFromType(params.opts.type);return render(renderer.renderToDataURL,text2,params)};exports.toBuffer=function toBuffer(text2,opts,cb){let params=checkParams(text2,opts,cb),renderer=getRendererFromType(params.opts.type);return render(renderer.renderToBuffer,text2,params)};exports.toFile=function toFile(path,text2,opts,cb){if(typeof path!=="string"||!(typeof text2==="string"||typeof text2==="object"))throw new Error("Invalid argument");if(arguments.length<3&&!canPromise())throw new Error("Too few arguments provided");let params=checkParams(text2,opts,cb),type2=params.opts.type||getTypeFromFilename(path),renderToFile=getRendererFromType(type2).renderToFile.bind(null,path);return render(renderToFile,text2,params)};exports.toFileStream=function toFileStream(stream,text2,opts){if(arguments.length<2)throw new Error("Too few arguments provided");let params=checkParams(text2,opts,stream.emit.bind(stream,"error")),renderToFileStream=getRendererFromType("png").renderToFileStream.bind(null,stream);render(renderToFileStream,text2,params)}});var require_is=__commonJS((exports,module)=>{var defined=function(val){return typeof val!=="undefined"&&val!==null},object=function(val){return typeof val==="object"},plainObject=function(val){return Object.prototype.toString.call(val)==="[object Object]"},fn=function(val){return typeof val==="function"},bool=function(val){return typeof val==="boolean"},buffer2=function(val){return val instanceof Buffer},typedArray=function(val){if(defined(val))switch(val.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},arrayBuffer=function(val){return val instanceof ArrayBuffer},string=function(val){return typeof val==="string"&&val.length>0},number=function(val){return typeof val==="number"&&!Number.isNaN(val)},integer2=function(val){return Number.isInteger(val)},inRange=function(val,min,max){return val>=min&&val<=max},inArray2=function(val,list){return list.includes(val)},invalidParameterError=function(name,expected,actual){return new Error(`Expected ${expected} for ${name} but received ${actual} of type ${typeof actual}`)},nativeError=function(native,context){return context.message=native.message,context};module.exports={defined,object,plainObject,fn,bool,buffer:buffer2,typedArray,arrayBuffer,string,number,integer:integer2,inRange,inArray:inArray2,invalidParameterError,nativeError}});var require_process=__commonJS((exports,module)=>{var isLinux=()=>process.platform==="linux",report=null,getReport=()=>{if(!report)if(isLinux()&&process.report){let orig=process.report.excludeNetwork;process.report.excludeNetwork=!0,report=process.report.getReport(),process.report.excludeNetwork=orig}else report={};return report};module.exports={isLinux,getReport}});var require_filesystem=__commonJS((exports,module)=>{var fs2=__require("fs"),readFileSync=(path)=>fs2.readFileSync(path,"utf-8"),readFile=(path)=>new Promise((resolve,reject)=>{fs2.readFile(path,"utf-8",(err,data)=>{if(err)reject(err);else resolve(data)})});module.exports={LDD_PATH:"/usr/bin/ldd",readFileSync,readFile}});var require_detect_libc=__commonJS((exports,module)=>{var childProcess=__require("child_process"),{isLinux,getReport}=require_process(),{LDD_PATH,readFile,readFileSync}=require_filesystem(),cachedFamilyFilesystem,cachedVersionFilesystem,commandOut="",safeCommand=()=>{if(!commandOut)return new Promise((resolve)=>{childProcess.exec("getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",(err,out)=>{commandOut=err?" ":out,resolve(commandOut)})});return commandOut},safeCommandSync=()=>{if(!commandOut)try{commandOut=childProcess.execSync("getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",{encoding:"utf8"})}catch(_err){commandOut=" "}return commandOut},GLIBC="glibc",RE_GLIBC_VERSION=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,MUSL="musl",isFileMusl=(f)=>f.includes("libc.musl-")||f.includes("ld-musl-"),familyFromReport=()=>{let report=getReport();if(report.header&&report.header.glibcVersionRuntime)return GLIBC;if(Array.isArray(report.sharedObjects)){if(report.sharedObjects.some(isFileMusl))return MUSL}return null},familyFromCommand=(out)=>{let[getconf,ldd1]=out.split(/[\r\n]+/);if(getconf&&getconf.includes(GLIBC))return GLIBC;if(ldd1&&ldd1.includes(MUSL))return MUSL;return null},getFamilyFromLddContent=(content)=>{if(content.includes("musl"))return MUSL;if(content.includes("GNU C Library"))return GLIBC;return null},familyFromFilesystem=async()=>{if(cachedFamilyFilesystem!==void 0)return cachedFamilyFilesystem;cachedFamilyFilesystem=null;try{let lddContent=await readFile(LDD_PATH);cachedFamilyFilesystem=getFamilyFromLddContent(lddContent)}catch(e){}return cachedFamilyFilesystem},familyFromFilesystemSync=()=>{if(cachedFamilyFilesystem!==void 0)return cachedFamilyFilesystem;cachedFamilyFilesystem=null;try{let lddContent=readFileSync(LDD_PATH);cachedFamilyFilesystem=getFamilyFromLddContent(lddContent)}catch(e){}return cachedFamilyFilesystem},family=async()=>{let family2=null;if(isLinux()){if(family2=await familyFromFilesystem(),!family2)family2=familyFromReport();if(!family2){let out=await safeCommand();family2=familyFromCommand(out)}}return family2},familySync=()=>{let family2=null;if(isLinux()){if(family2=familyFromFilesystemSync(),!family2)family2=familyFromReport();if(!family2){let out=safeCommandSync();family2=familyFromCommand(out)}}return family2},isNonGlibcLinux=async()=>isLinux()&&await family()!==GLIBC,isNonGlibcLinuxSync=()=>isLinux()&&familySync()!==GLIBC,versionFromFilesystem=async()=>{if(cachedVersionFilesystem!==void 0)return cachedVersionFilesystem;cachedVersionFilesystem=null;try{let versionMatch=(await readFile(LDD_PATH)).match(RE_GLIBC_VERSION);if(versionMatch)cachedVersionFilesystem=versionMatch[1]}catch(e){}return cachedVersionFilesystem},versionFromFilesystemSync=()=>{if(cachedVersionFilesystem!==void 0)return cachedVersionFilesystem;cachedVersionFilesystem=null;try{let versionMatch=readFileSync(LDD_PATH).match(RE_GLIBC_VERSION);if(versionMatch)cachedVersionFilesystem=versionMatch[1]}catch(e){}return cachedVersionFilesystem},versionFromReport=()=>{let report=getReport();if(report.header&&report.header.glibcVersionRuntime)return report.header.glibcVersionRuntime;return null},versionSuffix=(s)=>s.trim().split(/\s+/)[1],versionFromCommand=(out)=>{let[getconf,ldd1,ldd2]=out.split(/[\r\n]+/);if(getconf&&getconf.includes(GLIBC))return versionSuffix(getconf);if(ldd1&&ldd2&&ldd1.includes(MUSL))return versionSuffix(ldd2);return null},version2=async()=>{let version3=null;if(isLinux()){if(version3=await versionFromFilesystem(),!version3)version3=versionFromReport();if(!version3){let out=await safeCommand();version3=versionFromCommand(out)}}return version3},versionSync=()=>{let version3=null;if(isLinux()){if(version3=versionFromFilesystemSync(),!version3)version3=versionFromReport();if(!version3){let out=safeCommandSync();version3=versionFromCommand(out)}}return version3};module.exports={GLIBC,MUSL,family,familySync,isNonGlibcLinux,isNonGlibcLinuxSync,version:version2,versionSync}});var require_debug=__commonJS((exports,module)=>{var debug=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...args)=>console.error("SEMVER",...args):()=>{};module.exports=debug});var require_constants2=__commonJS((exports,module)=>{var MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES=["major","premajor","minor","preminor","patch","prepatch","prerelease"];module.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER,RELEASE_TYPES,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var require_re=__commonJS((exports,module)=>{var{MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_BUILD_LENGTH,MAX_LENGTH}=require_constants2(),debug=require_debug();exports=module.exports={};var re=exports.re=[],safeRe=exports.safeRe=[],src=exports.src=[],safeSrc=exports.safeSrc=[],t2=exports.t={},R=0,LETTERDASHNUMBER="[a-zA-Z0-9-]",safeRegexReplacements=[["\\s",1],["\\d",MAX_LENGTH],[LETTERDASHNUMBER,MAX_SAFE_BUILD_LENGTH]],makeSafeRegex=(value)=>{for(let[token,max]of safeRegexReplacements)value=value.split(`${token}*`).join(`${token}{0,${max}}`).split(`${token}+`).join(`${token}{1,${max}}`);return value},createToken=(name,value,isGlobal)=>{let safe=makeSafeRegex(value),index2=R++;debug(name,index2,value),t2[name]=index2,src[index2]=value,safeSrc[index2]=safe,re[index2]=new RegExp(value,isGlobal?"g":void 0),safeRe[index2]=new RegExp(safe,isGlobal?"g":void 0)};createToken("NUMERICIDENTIFIER","0|[1-9]\\d*");createToken("NUMERICIDENTIFIERLOOSE","\\d+");createToken("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`);createToken("MAINVERSION",`(${src[t2.NUMERICIDENTIFIER]})\\.(${src[t2.NUMERICIDENTIFIER]})\\.(${src[t2.NUMERICIDENTIFIER]})`);createToken("MAINVERSIONLOOSE",`(${src[t2.NUMERICIDENTIFIERLOOSE]})\\.(${src[t2.NUMERICIDENTIFIERLOOSE]})\\.(${src[t2.NUMERICIDENTIFIERLOOSE]})`);createToken("PRERELEASEIDENTIFIER",`(?:${src[t2.NONNUMERICIDENTIFIER]}|${src[t2.NUMERICIDENTIFIER]})`);createToken("PRERELEASEIDENTIFIERLOOSE",`(?:${src[t2.NONNUMERICIDENTIFIER]}|${src[t2.NUMERICIDENTIFIERLOOSE]})`);createToken("PRERELEASE",`(?:-(${src[t2.PRERELEASEIDENTIFIER]}(?:\\.${src[t2.PRERELEASEIDENTIFIER]})*))`);createToken("PRERELEASELOOSE",`(?:-?(${src[t2.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${src[t2.PRERELEASEIDENTIFIERLOOSE]})*))`);createToken("BUILDIDENTIFIER",`${LETTERDASHNUMBER}+`);createToken("BUILD",`(?:\\+(${src[t2.BUILDIDENTIFIER]}(?:\\.${src[t2.BUILDIDENTIFIER]})*))`);createToken("FULLPLAIN",`v?${src[t2.MAINVERSION]}${src[t2.PRERELEASE]}?${src[t2.BUILD]}?`);createToken("FULL",`^${src[t2.FULLPLAIN]}$`);createToken("LOOSEPLAIN",`[v=\\s]*${src[t2.MAINVERSIONLOOSE]}${src[t2.PRERELEASELOOSE]}?${src[t2.BUILD]}?`);createToken("LOOSE",`^${src[t2.LOOSEPLAIN]}$`);createToken("GTLT","((?:<|>)?=?)");createToken("XRANGEIDENTIFIERLOOSE",`${src[t2.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);createToken("XRANGEIDENTIFIER",`${src[t2.NUMERICIDENTIFIER]}|x|X|\\*`);createToken("XRANGEPLAIN",`[v=\\s]*(${src[t2.XRANGEIDENTIFIER]})(?:\\.(${src[t2.XRANGEIDENTIFIER]})(?:\\.(${src[t2.XRANGEIDENTIFIER]})(?:${src[t2.PRERELEASE]})?${src[t2.BUILD]}?)?)?`);createToken("XRANGEPLAINLOOSE",`[v=\\s]*(${src[t2.XRANGEIDENTIFIERLOOSE]})(?:\\.(${src[t2.XRANGEIDENTIFIERLOOSE]})(?:\\.(${src[t2.XRANGEIDENTIFIERLOOSE]})(?:${src[t2.PRERELEASELOOSE]})?${src[t2.BUILD]}?)?)?`);createToken("XRANGE",`^${src[t2.GTLT]}\\s*${src[t2.XRANGEPLAIN]}$`);createToken("XRANGELOOSE",`^${src[t2.GTLT]}\\s*${src[t2.XRANGEPLAINLOOSE]}$`);createToken("COERCEPLAIN",`(^|[^\\d])(\\d{1,${MAX_SAFE_COMPONENT_LENGTH}})(?:\\.(\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?(?:\\.(\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?`);createToken("COERCE",`${src[t2.COERCEPLAIN]}(?:$|[^\\d])`);createToken("COERCEFULL",src[t2.COERCEPLAIN]+`(?:${src[t2.PRERELEASE]})?(?:${src[t2.BUILD]})?(?:$|[^\\d])`);createToken("COERCERTL",src[t2.COERCE],!0);createToken("COERCERTLFULL",src[t2.COERCEFULL],!0);createToken("LONETILDE","(?:~>?)");createToken("TILDETRIM",`(\\s*)${src[t2.LONETILDE]}\\s+`,!0);exports.tildeTrimReplace="$1~";createToken("TILDE",`^${src[t2.LONETILDE]}${src[t2.XRANGEPLAIN]}$`);createToken("TILDELOOSE",`^${src[t2.LONETILDE]}${src[t2.XRANGEPLAINLOOSE]}$`);createToken("LONECARET","(?:\\^)");createToken("CARETTRIM",`(\\s*)${src[t2.LONECARET]}\\s+`,!0);exports.caretTrimReplace="$1^";createToken("CARET",`^${src[t2.LONECARET]}${src[t2.XRANGEPLAIN]}$`);createToken("CARETLOOSE",`^${src[t2.LONECARET]}${src[t2.XRANGEPLAINLOOSE]}$`);createToken("COMPARATORLOOSE",`^${src[t2.GTLT]}\\s*(${src[t2.LOOSEPLAIN]})$|^$`);createToken("COMPARATOR",`^${src[t2.GTLT]}\\s*(${src[t2.FULLPLAIN]})$|^$`);createToken("COMPARATORTRIM",`(\\s*)${src[t2.GTLT]}\\s*(${src[t2.LOOSEPLAIN]}|${src[t2.XRANGEPLAIN]})`,!0);exports.comparatorTrimReplace="$1$2$3";createToken("HYPHENRANGE",`^\\s*(${src[t2.XRANGEPLAIN]})\\s+-\\s+(${src[t2.XRANGEPLAIN]})\\s*$`);createToken("HYPHENRANGELOOSE",`^\\s*(${src[t2.XRANGEPLAINLOOSE]})\\s+-\\s+(${src[t2.XRANGEPLAINLOOSE]})\\s*$`);createToken("STAR","(<|>)?=?\\s*\\*");createToken("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");createToken("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var require_parse_options=__commonJS((exports,module)=>{var looseOption=Object.freeze({loose:!0}),emptyOpts=Object.freeze({}),parseOptions2=(options)=>{if(!options)return emptyOpts;if(typeof options!=="object")return looseOption;return options};module.exports=parseOptions2});var require_identifiers=__commonJS((exports,module)=>{var numeric2=/^[0-9]+$/,compareIdentifiers=(a,b2)=>{let anum=numeric2.test(a),bnum=numeric2.test(b2);if(anum&&bnum)a=+a,b2=+b2;return a===b2?0:anum&&!bnum?-1:bnum&&!anum?1:a<b2?-1:1},rcompareIdentifiers=(a,b2)=>compareIdentifiers(b2,a);module.exports={compareIdentifiers,rcompareIdentifiers}});var require_semver=__commonJS((exports,module)=>{var debug=require_debug(),{MAX_LENGTH,MAX_SAFE_INTEGER}=require_constants2(),{safeRe:re,t:t2}=require_re(),parseOptions2=require_parse_options(),{compareIdentifiers}=require_identifiers();class SemVer{constructor(version2,options){if(options=parseOptions2(options),version2 instanceof SemVer)if(version2.loose===!!options.loose&&version2.includePrerelease===!!options.includePrerelease)return version2;else version2=version2.version;else if(typeof version2!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof version2}".`);if(version2.length>MAX_LENGTH)throw new TypeError(`version is longer than ${MAX_LENGTH} characters`);debug("SemVer",version2,options),this.options=options,this.loose=!!options.loose,this.includePrerelease=!!options.includePrerelease;let m=version2.trim().match(options.loose?re[t2.LOOSE]:re[t2.FULL]);if(!m)throw new TypeError(`Invalid Version: ${version2}`);if(this.raw=version2,this.major=+m[1],this.minor=+m[2],this.patch=+m[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");if(!m[4])this.prerelease=[];else this.prerelease=m[4].split(".").map((id)=>{if(/^[0-9]+$/.test(id)){let num=+id;if(num>=0&&num<MAX_SAFE_INTEGER)return num}return id});this.build=m[5]?m[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare(other){if(debug("SemVer.compare",this.version,this.options,other),!(other instanceof SemVer)){if(typeof other==="string"&&other===this.version)return 0;other=new SemVer(other,this.options)}if(other.version===this.version)return 0;return this.compareMain(other)||this.comparePre(other)}compareMain(other){if(!(other instanceof SemVer))other=new SemVer(other,this.options);return compareIdentifiers(this.major,other.major)||compareIdentifiers(this.minor,other.minor)||compareIdentifiers(this.patch,other.patch)}comparePre(other){if(!(other instanceof SemVer))other=new SemVer(other,this.options);if(this.prerelease.length&&!other.prerelease.length)return-1;else if(!this.prerelease.length&&other.prerelease.length)return 1;else if(!this.prerelease.length&&!other.prerelease.length)return 0;let i=0;do{let a=this.prerelease[i],b2=other.prerelease[i];if(debug("prerelease compare",i,a,b2),a===void 0&&b2===void 0)return 0;else if(b2===void 0)return 1;else if(a===void 0)return-1;else if(a===b2)continue;else return compareIdentifiers(a,b2)}while(++i)}compareBuild(other){if(!(other instanceof SemVer))other=new SemVer(other,this.options);let i=0;do{let a=this.build[i],b2=other.build[i];if(debug("build compare",i,a,b2),a===void 0&&b2===void 0)return 0;else if(b2===void 0)return 1;else if(a===void 0)return-1;else if(a===b2)continue;else return compareIdentifiers(a,b2)}while(++i)}inc(release,identifier,identifierBase){if(release.startsWith("pre")){if(!identifier&&identifierBase===!1)throw new Error("invalid increment argument: identifier is empty");if(identifier){let match=`-${identifier}`.match(this.options.loose?re[t2.PRERELEASELOOSE]:re[t2.PRERELEASE]);if(!match||match[1]!==identifier)throw new Error(`invalid identifier: ${identifier}`)}}switch(release){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",identifier,identifierBase);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",identifier,identifierBase);break;case"prepatch":this.prerelease.length=0,this.inc("patch",identifier,identifierBase),this.inc("pre",identifier,identifierBase);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",identifier,identifierBase);this.inc("pre",identifier,identifierBase);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let base=Number(identifierBase)?1:0;if(this.prerelease.length===0)this.prerelease=[base];else{let i=this.prerelease.length;while(--i>=0)if(typeof this.prerelease[i]==="number")this.prerelease[i]++,i=-2;if(i===-1){if(identifier===this.prerelease.join(".")&&identifierBase===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(base)}}if(identifier){let prerelease=[identifier,base];if(identifierBase===!1)prerelease=[identifier];if(compareIdentifiers(this.prerelease[0],identifier)===0){if(isNaN(this.prerelease[1]))this.prerelease=prerelease}else this.prerelease=prerelease}break}default:throw new Error(`invalid increment argument: ${release}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}module.exports=SemVer});var require_parse=__commonJS((exports,module)=>{var SemVer=require_semver(),parse4=(version2,options,throwErrors=!1)=>{if(version2 instanceof SemVer)return version2;try{return new SemVer(version2,options)}catch(er){if(!throwErrors)return null;throw er}};module.exports=parse4});var require_coerce=__commonJS((exports,module)=>{var SemVer=require_semver(),parse4=require_parse(),{safeRe:re,t:t2}=require_re(),coerce=(version2,options)=>{if(version2 instanceof SemVer)return version2;if(typeof version2==="number")version2=String(version2);if(typeof version2!=="string")return null;options=options||{};let match=null;if(!options.rtl)match=version2.match(options.includePrerelease?re[t2.COERCEFULL]:re[t2.COERCE]);else{let coerceRtlRegex=options.includePrerelease?re[t2.COERCERTLFULL]:re[t2.COERCERTL],next2;while((next2=coerceRtlRegex.exec(version2))&&(!match||match.index+match[0].length!==version2.length)){if(!match||next2.index+next2[0].length!==match.index+match[0].length)match=next2;coerceRtlRegex.lastIndex=next2.index+next2[1].length+next2[2].length}coerceRtlRegex.lastIndex=-1}if(match===null)return null;let major=match[2],minor=match[3]||"0",patch=match[4]||"0",prerelease=options.includePrerelease&&match[5]?`-${match[5]}`:"",build=options.includePrerelease&&match[6]?`+${match[6]}`:"";return parse4(`${major}.${minor}.${patch}${prerelease}${build}`,options)};module.exports=coerce});var require_compare=__commonJS((exports,module)=>{var SemVer=require_semver(),compare=(a,b2,loose)=>new SemVer(a,loose).compare(new SemVer(b2,loose));module.exports=compare});var require_gte=__commonJS((exports,module)=>{var compare=require_compare(),gte2=(a,b2,loose)=>compare(a,b2,loose)>=0;module.exports=gte2});var require_lrucache=__commonJS((exports,module)=>{class LRUCache{constructor(){this.max=1000,this.map=new Map}get(key){let value=this.map.get(key);if(value===void 0)return;else return this.map.delete(key),this.map.set(key,value),value}delete(key){return this.map.delete(key)}set(key,value){if(!this.delete(key)&&value!==void 0){if(this.map.size>=this.max){let firstKey=this.map.keys().next().value;this.delete(firstKey)}this.map.set(key,value)}return this}}module.exports=LRUCache});var require_eq=__commonJS((exports,module)=>{var compare=require_compare(),eq2=(a,b2,loose)=>compare(a,b2,loose)===0;module.exports=eq2});var require_neq=__commonJS((exports,module)=>{var compare=require_compare(),neq=(a,b2,loose)=>compare(a,b2,loose)!==0;module.exports=neq});var require_gt=__commonJS((exports,module)=>{var compare=require_compare(),gt2=(a,b2,loose)=>compare(a,b2,loose)>0;module.exports=gt2});var require_lt=__commonJS((exports,module)=>{var compare=require_compare(),lt2=(a,b2,loose)=>compare(a,b2,loose)<0;module.exports=lt2});var require_lte=__commonJS((exports,module)=>{var compare=require_compare(),lte2=(a,b2,loose)=>compare(a,b2,loose)<=0;module.exports=lte2});var require_cmp=__commonJS((exports,module)=>{var eq2=require_eq(),neq=require_neq(),gt2=require_gt(),gte2=require_gte(),lt2=require_lt(),lte2=require_lte(),cmp=(a,op,b2,loose)=>{switch(op){case"===":if(typeof a==="object")a=a.version;if(typeof b2==="object")b2=b2.version;return a===b2;case"!==":if(typeof a==="object")a=a.version;if(typeof b2==="object")b2=b2.version;return a!==b2;case"":case"=":case"==":return eq2(a,b2,loose);case"!=":return neq(a,b2,loose);case">":return gt2(a,b2,loose);case">=":return gte2(a,b2,loose);case"<":return lt2(a,b2,loose);case"<=":return lte2(a,b2,loose);default:throw new TypeError(`Invalid operator: ${op}`)}};module.exports=cmp});var require_comparator=__commonJS((exports,module)=>{var ANY=Symbol("SemVer ANY");class Comparator{static get ANY(){return ANY}constructor(comp,options){if(options=parseOptions2(options),comp instanceof Comparator)if(comp.loose===!!options.loose)return comp;else comp=comp.value;if(comp=comp.trim().split(/\s+/).join(" "),debug("comparator",comp,options),this.options=options,this.loose=!!options.loose,this.parse(comp),this.semver===ANY)this.value="";else this.value=this.operator+this.semver.version;debug("comp",this)}parse(comp){let r=this.options.loose?re[t2.COMPARATORLOOSE]:re[t2.COMPARATOR],m=comp.match(r);if(!m)throw new TypeError(`Invalid comparator: ${comp}`);if(this.operator=m[1]!==void 0?m[1]:"",this.operator==="=")this.operator="";if(!m[2])this.semver=ANY;else this.semver=new SemVer(m[2],this.options.loose)}toString(){return this.value}test(version2){if(debug("Comparator.test",version2,this.options.loose),this.semver===ANY||version2===ANY)return!0;if(typeof version2==="string")try{version2=new SemVer(version2,this.options)}catch(er){return!1}return cmp(version2,this.operator,this.semver,this.options)}intersects(comp,options){if(!(comp instanceof Comparator))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new Range(comp.value,options).test(this.value)}else if(comp.operator===""){if(comp.value==="")return!0;return new Range(this.value,options).test(comp.semver)}if(options=parseOptions2(options),options.includePrerelease&&(this.value==="<0.0.0-0"||comp.value==="<0.0.0-0"))return!1;if(!options.includePrerelease&&(this.value.startsWith("<0.0.0")||comp.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&comp.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&comp.operator.startsWith("<"))return!0;if(this.semver.version===comp.semver.version&&this.operator.includes("=")&&comp.operator.includes("="))return!0;if(cmp(this.semver,"<",comp.semver,options)&&this.operator.startsWith(">")&&comp.operator.startsWith("<"))return!0;if(cmp(this.semver,">",comp.semver,options)&&this.operator.startsWith("<")&&comp.operator.startsWith(">"))return!0;return!1}}module.exports=Comparator;var parseOptions2=require_parse_options(),{safeRe:re,t:t2}=require_re(),cmp=require_cmp(),debug=require_debug(),SemVer=require_semver(),Range=require_range()});var require_range=__commonJS((exports,module)=>{var SPACE_CHARACTERS=/\s+/g;class Range{constructor(range,options){if(options=parseOptions2(options),range instanceof Range)if(range.loose===!!options.loose&&range.includePrerelease===!!options.includePrerelease)return range;else return new Range(range.raw,options);if(range instanceof Comparator)return this.raw=range.value,this.set=[[range]],this.formatted=void 0,this;if(this.options=options,this.loose=!!options.loose,this.includePrerelease=!!options.includePrerelease,this.raw=range.trim().replace(SPACE_CHARACTERS," "),this.set=this.raw.split("||").map((r)=>this.parseRange(r.trim())).filter((c)=>c.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let first=this.set[0];if(this.set=this.set.filter((c)=>!isNullSet(c[0])),this.set.length===0)this.set=[first];else if(this.set.length>1){for(let c of this.set)if(c.length===1&&isAny(c[0])){this.set=[c];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let i=0;i<this.set.length;i++){if(i>0)this.formatted+="||";let comps=this.set[i];for(let k2=0;k2<comps.length;k2++){if(k2>0)this.formatted+=" ";this.formatted+=comps[k2].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(range){let memoKey=((this.options.includePrerelease&&FLAG_INCLUDE_PRERELEASE)|(this.options.loose&&FLAG_LOOSE))+":"+range,cached=cache.get(memoKey);if(cached)return cached;let loose=this.options.loose,hr=loose?re[t2.HYPHENRANGELOOSE]:re[t2.HYPHENRANGE];range=range.replace(hr,hyphenReplace(this.options.includePrerelease)),debug("hyphen replace",range),range=range.replace(re[t2.COMPARATORTRIM],comparatorTrimReplace),debug("comparator trim",range),range=range.replace(re[t2.TILDETRIM],tildeTrimReplace),debug("tilde trim",range),range=range.replace(re[t2.CARETTRIM],caretTrimReplace),debug("caret trim",range);let rangeList=range.split(" ").map((comp)=>parseComparator(comp,this.options)).join(" ").split(/\s+/).map((comp)=>replaceGTE0(comp,this.options));if(loose)rangeList=rangeList.filter((comp)=>{return debug("loose invalid filter",comp,this.options),!!comp.match(re[t2.COMPARATORLOOSE])});debug("range list",rangeList);let rangeMap=new Map,comparators=rangeList.map((comp)=>new Comparator(comp,this.options));for(let comp of comparators){if(isNullSet(comp))return[comp];rangeMap.set(comp.value,comp)}if(rangeMap.size>1&&rangeMap.has(""))rangeMap.delete("");let result=[...rangeMap.values()];return cache.set(memoKey,result),result}intersects(range,options){if(!(range instanceof Range))throw new TypeError("a Range is required");return this.set.some((thisComparators)=>{return isSatisfiable(thisComparators,options)&&range.set.some((rangeComparators)=>{return isSatisfiable(rangeComparators,options)&&thisComparators.every((thisComparator)=>{return rangeComparators.every((rangeComparator)=>{return thisComparator.intersects(rangeComparator,options)})})})})}test(version2){if(!version2)return!1;if(typeof version2==="string")try{version2=new SemVer(version2,this.options)}catch(er){return!1}for(let i=0;i<this.set.length;i++)if(testSet(this.set[i],version2,this.options))return!0;return!1}}module.exports=Range;var LRU=require_lrucache(),cache=new LRU,parseOptions2=require_parse_options(),Comparator=require_comparator(),debug=require_debug(),SemVer=require_semver(),{safeRe:re,t:t2,comparatorTrimReplace,tildeTrimReplace,caretTrimReplace}=require_re(),{FLAG_INCLUDE_PRERELEASE,FLAG_LOOSE}=require_constants2(),isNullSet=(c)=>c.value==="<0.0.0-0",isAny=(c)=>c.value==="",isSatisfiable=(comparators,options)=>{let result=!0,remainingComparators=comparators.slice(),testComparator=remainingComparators.pop();while(result&&remainingComparators.length)result=remainingComparators.every((otherComparator)=>{return testComparator.intersects(otherComparator,options)}),testComparator=remainingComparators.pop();return result},parseComparator=(comp,options)=>{return debug("comp",comp,options),comp=replaceCarets(comp,options),debug("caret",comp),comp=replaceTildes(comp,options),debug("tildes",comp),comp=replaceXRanges(comp,options),debug("xrange",comp),comp=replaceStars(comp,options),debug("stars",comp),comp},isX=(id)=>!id||id.toLowerCase()==="x"||id==="*",replaceTildes=(comp,options)=>{return comp.trim().split(/\s+/).map((c)=>replaceTilde(c,options)).join(" ")},replaceTilde=(comp,options)=>{let r=options.loose?re[t2.TILDELOOSE]:re[t2.TILDE];return comp.replace(r,(_2,M,m,p,pr)=>{debug("tilde",comp,_2,M,m,p,pr);let ret;if(isX(M))ret="";else if(isX(m))ret=`>=${M}.0.0 <${+M+1}.0.0-0`;else if(isX(p))ret=`>=${M}.${m}.0 <${M}.${+m+1}.0-0`;else if(pr)debug("replaceTilde pr",pr),ret=`>=${M}.${m}.${p}-${pr} <${M}.${+m+1}.0-0`;else ret=`>=${M}.${m}.${p} <${M}.${+m+1}.0-0`;return debug("tilde return",ret),ret})},replaceCarets=(comp,options)=>{return comp.trim().split(/\s+/).map((c)=>replaceCaret(c,options)).join(" ")},replaceCaret=(comp,options)=>{debug("caret",comp,options);let r=options.loose?re[t2.CARETLOOSE]:re[t2.CARET],z=options.includePrerelease?"-0":"";return comp.replace(r,(_2,M,m,p,pr)=>{debug("caret",comp,_2,M,m,p,pr);let ret;if(isX(M))ret="";else if(isX(m))ret=`>=${M}.0.0${z} <${+M+1}.0.0-0`;else if(isX(p))if(M==="0")ret=`>=${M}.${m}.0${z} <${M}.${+m+1}.0-0`;else ret=`>=${M}.${m}.0${z} <${+M+1}.0.0-0`;else if(pr)if(debug("replaceCaret pr",pr),M==="0")if(m==="0")ret=`>=${M}.${m}.${p}-${pr} <${M}.${m}.${+p+1}-0`;else ret=`>=${M}.${m}.${p}-${pr} <${M}.${+m+1}.0-0`;else ret=`>=${M}.${m}.${p}-${pr} <${+M+1}.0.0-0`;else if(debug("no pr"),M==="0")if(m==="0")ret=`>=${M}.${m}.${p}${z} <${M}.${m}.${+p+1}-0`;else ret=`>=${M}.${m}.${p}${z} <${M}.${+m+1}.0-0`;else ret=`>=${M}.${m}.${p} <${+M+1}.0.0-0`;return debug("caret return",ret),ret})},replaceXRanges=(comp,options)=>{return debug("replaceXRanges",comp,options),comp.split(/\s+/).map((c)=>replaceXRange(c,options)).join(" ")},replaceXRange=(comp,options)=>{comp=comp.trim();let r=options.loose?re[t2.XRANGELOOSE]:re[t2.XRANGE];return comp.replace(r,(ret,gtlt,M,m,p,pr)=>{debug("xRange",comp,ret,gtlt,M,m,p,pr);let xM=isX(M),xm=xM||isX(m),xp=xm||isX(p),anyX=xp;if(gtlt==="="&&anyX)gtlt="";if(pr=options.includePrerelease?"-0":"",xM)if(gtlt===">"||gtlt==="<")ret="<0.0.0-0";else ret="*";else if(gtlt&&anyX){if(xm)m=0;if(p=0,gtlt===">")if(gtlt=">=",xm)M=+M+1,m=0,p=0;else m=+m+1,p=0;else if(gtlt==="<=")if(gtlt="<",xm)M=+M+1;else m=+m+1;if(gtlt==="<")pr="-0";ret=`${gtlt+M}.${m}.${p}${pr}`}else if(xm)ret=`>=${M}.0.0${pr} <${+M+1}.0.0-0`;else if(xp)ret=`>=${M}.${m}.0${pr} <${M}.${+m+1}.0-0`;return debug("xRange return",ret),ret})},replaceStars=(comp,options)=>{return debug("replaceStars",comp,options),comp.trim().replace(re[t2.STAR],"")},replaceGTE0=(comp,options)=>{return debug("replaceGTE0",comp,options),comp.trim().replace(re[options.includePrerelease?t2.GTE0PRE:t2.GTE0],"")},hyphenReplace=(incPr)=>($0,from,fM,fm,fp,fpr,fb,to,tM,tm,tp,tpr)=>{if(isX(fM))from="";else if(isX(fm))from=`>=${fM}.0.0${incPr?"-0":""}`;else if(isX(fp))from=`>=${fM}.${fm}.0${incPr?"-0":""}`;else if(fpr)from=`>=${from}`;else from=`>=${from}${incPr?"-0":""}`;if(isX(tM))to="";else if(isX(tm))to=`<${+tM+1}.0.0-0`;else if(isX(tp))to=`<${tM}.${+tm+1}.0-0`;else if(tpr)to=`<=${tM}.${tm}.${tp}-${tpr}`;else if(incPr)to=`<${tM}.${tm}.${+tp+1}-0`;else to=`<=${to}`;return`${from} ${to}`.trim()},testSet=(set2,version2,options)=>{for(let i=0;i<set2.length;i++)if(!set2[i].test(version2))return!1;if(version2.prerelease.length&&!options.includePrerelease){for(let i=0;i<set2.length;i++){if(debug(set2[i].semver),set2[i].semver===Comparator.ANY)continue;if(set2[i].semver.prerelease.length>0){let allowed=set2[i].semver;if(allowed.major===version2.major&&allowed.minor===version2.minor&&allowed.patch===version2.patch)return!0}}return!1}return!0}});var require_satisfies=__commonJS((exports,module)=>{var Range=require_range(),satisfies=(version2,range,options)=>{try{range=new Range(range,options)}catch(er){return!1}return range.test(version2)};module.exports=satisfies});var require_package2=__commonJS((exports,module)=>{module.exports={name:"sharp",description:"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",version:"0.33.5",author:"Lovell Fuller <npm@lovell.info>",homepage:"https://sharp.pixelplumbing.com",contributors:["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb\xE4ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B\xFCnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J\xE9r\xE9my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot\u011B\u0161ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci\xF1o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu\xE9 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],scripts:{install:"node install/check",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build","package-from-github-release":"node npm/from-github-release","docs-build":"node docs/build && node docs/search-index/build","docs-serve":"cd docs && npx serve","docs-publish":"cd docs && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},type:"commonjs",main:"lib/index.js",types:"lib/index.d.ts",files:["install","lib","src/*.{cc,h,gyp}"],repository:{type:"git",url:"git://github.com/lovell/sharp.git"},keywords:["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],dependencies:{color:"^4.2.3","detect-libc":"^2.0.3",semver:"^7.6.3"},optionalDependencies:{"@img/sharp-darwin-arm64":"0.33.5","@img/sharp-darwin-x64":"0.33.5","@img/sharp-libvips-darwin-arm64":"1.0.4","@img/sharp-libvips-darwin-x64":"1.0.4","@img/sharp-libvips-linux-arm":"1.0.5","@img/sharp-libvips-linux-arm64":"1.0.4","@img/sharp-libvips-linux-s390x":"1.0.4","@img/sharp-libvips-linux-x64":"1.0.4","@img/sharp-libvips-linuxmusl-arm64":"1.0.4","@img/sharp-libvips-linuxmusl-x64":"1.0.4","@img/sharp-linux-arm":"0.33.5","@img/sharp-linux-arm64":"0.33.5","@img/sharp-linux-s390x":"0.33.5","@img/sharp-linux-x64":"0.33.5","@img/sharp-linuxmusl-arm64":"0.33.5","@img/sharp-linuxmusl-x64":"0.33.5","@img/sharp-wasm32":"0.33.5","@img/sharp-win32-ia32":"0.33.5","@img/sharp-win32-x64":"0.33.5"},devDependencies:{"@emnapi/runtime":"^1.2.0","@img/sharp-libvips-dev":"1.0.4","@img/sharp-libvips-dev-wasm32":"1.0.5","@img/sharp-libvips-win32-ia32":"1.0.4","@img/sharp-libvips-win32-x64":"1.0.4","@types/node":"*",async:"^3.2.5",cc:"^3.0.1",emnapi:"^1.2.0","exif-reader":"^2.0.1","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^8.0.3","license-checker":"^25.0.1",mocha:"^10.7.3","node-addon-api":"^8.1.0",nyc:"^17.0.0",prebuild:"^13.0.1",semistandard:"^17.0.0","tar-fs":"^3.0.6",tsd:"^0.31.1"},license:"Apache-2.0",engines:{node:"^18.17.0 || ^20.3.0 || >=21.0.0"},config:{libvips:">=8.15.3"},funding:{url:"https://opencollective.com/libvips"},binary:{napi_versions:[9]},semistandard:{env:["mocha"]},cc:{linelength:"120",filter:["build/include"]},nyc:{include:["lib"]},tsd:{directory:"test/types/"}}});var require_libvips=__commonJS((exports,module)=>{var{spawnSync}=__require("child_process"),{createHash}=__require("crypto"),semverCoerce=require_coerce(),semverGreaterThanOrEqualTo=require_gte(),semverSatisfies=require_satisfies(),detectLibc=require_detect_libc(),{config,engines,optionalDependencies}=require_package2(),minimumLibvipsVersionLabelled=process.env.npm_package_config_libvips||config.libvips,minimumLibvipsVersion=semverCoerce(minimumLibvipsVersionLabelled).version,prebuiltPlatforms=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-ia32","win32-x64"],spawnSyncOptions={encoding:"utf8",shell:!0},log=(item)=>{if(item instanceof Error)console.error(`sharp: Installation error: ${item.message}`);else console.log(`sharp: ${item}`)},runtimeLibc=()=>detectLibc.isNonGlibcLinuxSync()?detectLibc.familySync():"",runtimePlatformArch=()=>`${process.platform}${runtimeLibc()}-${process.arch}`,buildPlatformArch=()=>{if(isEmscripten())return"wasm32";let{npm_config_arch,npm_config_platform,npm_config_libc}=process.env,libc=typeof npm_config_libc==="string"?npm_config_libc:runtimeLibc();return`${npm_config_platform||process.platform}${libc}-${npm_config_arch||process.arch}`},buildSharpLibvipsIncludeDir=()=>{try{return __require(`@img/sharp-libvips-dev-${buildPlatformArch()}/include`)}catch{try{return (()=>{throw new Error("Cannot require module "+"@img/sharp-libvips-dev/include");})()}catch{}}return""},buildSharpLibvipsCPlusPlusDir=()=>{try{return (()=>{throw new Error("Cannot require module "+"@img/sharp-libvips-dev/cplusplus");})()}catch{}return""},buildSharpLibvipsLibDir=()=>{try{return __require(`@img/sharp-libvips-dev-${buildPlatformArch()}/lib`)}catch{try{return __require(`@img/sharp-libvips-${buildPlatformArch()}/lib`)}catch{}}return""},isUnsupportedNodeRuntime=()=>{if(process.release?.name==="node"&&process.versions){if(!semverSatisfies(process.versions.node,engines.node))return{found:process.versions.node,expected:engines.node}}},isEmscripten=()=>{let{CC}=process.env;return Boolean(CC&&CC.endsWith("/emcc"))},isRosetta=()=>{if(process.platform==="darwin"&&process.arch==="x64")return(spawnSync("sysctl sysctl.proc_translated",spawnSyncOptions).stdout||"").trim()==="sysctl.proc_translated: 1";return!1},sha512=(s)=>createHash("sha512").update(s).digest("hex"),yarnLocator=()=>{try{let identHash=sha512(`imgsharp-libvips-${buildPlatformArch()}`),npmVersion=semverCoerce(optionalDependencies[`@img/sharp-libvips-${buildPlatformArch()}`]).version;return sha512(`${identHash}npm:${npmVersion}`).slice(0,10)}catch{}return""},spawnRebuild=()=>spawnSync(`node-gyp rebuild --directory=src ${isEmscripten()?"--nodedir=emscripten":""}`,{...spawnSyncOptions,stdio:"inherit"}).status,globalLibvipsVersion=()=>{if(process.platform!=="win32")return(spawnSync("pkg-config --modversion vips-cpp",{...spawnSyncOptions,env:{...process.env,PKG_CONFIG_PATH:pkgConfigPath()}}).stdout||"").trim();else return""},pkgConfigPath=()=>{if(process.platform!=="win32")return[(spawnSync('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',spawnSyncOptions).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":");else return""},skipSearch=(status,reason,logger)=>{if(logger)logger(`Detected ${reason}, skipping search for globally-installed libvips`);return status},useGlobalLibvips=(logger)=>{if(Boolean(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS)===!0)return skipSearch(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",logger);if(Boolean(process.env.SHARP_FORCE_GLOBAL_LIBVIPS)===!0)return skipSearch(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",logger);if(isRosetta())return skipSearch(!1,"Rosetta",logger);let globalVipsVersion=globalLibvipsVersion();return!!globalVipsVersion&&semverGreaterThanOrEqualTo(globalVipsVersion,minimumLibvipsVersion)};module.exports={minimumLibvipsVersion,prebuiltPlatforms,buildPlatformArch,buildSharpLibvipsIncludeDir,buildSharpLibvipsCPlusPlusDir,buildSharpLibvipsLibDir,isUnsupportedNodeRuntime,runtimePlatformArch,log,yarnLocator,spawnRebuild,globalLibvipsVersion,pkgConfigPath,useGlobalLibvips}});var require_sharp=__commonJS((exports,module)=>{var{familySync,versionSync}=require_detect_libc(),{runtimePlatformArch,isUnsupportedNodeRuntime,prebuiltPlatforms,minimumLibvipsVersion}=require_libvips(),runtimePlatform=runtimePlatformArch(),paths=[`../src/build/Release/sharp-${runtimePlatform}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${runtimePlatform}/sharp.node`,"@img/sharp-wasm32/sharp.node"],sharp,errors=[];for(let path of paths)try{sharp=__require(path);break}catch(err){errors.push(err)}if(sharp)module.exports=sharp;else{let[isLinux,isMacOs,isWindows]=["linux","darwin","win32"].map((os2)=>runtimePlatform.startsWith(os2)),help=[`Could not load the "sharp" module using the ${runtimePlatform} runtime`];errors.forEach((err)=>{if(err.code!=="MODULE_NOT_FOUND")help.push(`${err.code}: ${err.message}`)});let messages2=errors.map((err)=>err.message).join(" ");if(help.push("Possible solutions:"),isUnsupportedNodeRuntime()){let{found,expected}=isUnsupportedNodeRuntime();help.push("- Please upgrade Node.js:",`    Found ${found}`,`    Requires ${expected}`)}else if(prebuiltPlatforms.includes(runtimePlatform)){let[os2,cpu]=runtimePlatform.split("-"),libc=os2.endsWith("musl")?" --libc=musl":"";help.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${os2.replace("musl","")}${libc} --cpu=${cpu} sharp`)}else help.push(`- Manually install libvips >= ${minimumLibvipsVersion}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(isLinux&&/(symbol not found|CXXABI_)/i.test(messages2))try{let{config}=__require(`@img/sharp-libvips-${runtimePlatform}/package`),libcFound=`${familySync()} ${versionSync()}`,libcRequires=`${config.musl?"musl":"glibc"} ${config.musl||config.glibc}`;help.push("- Update your OS:",`    Found ${libcFound}`,`    Requires ${libcRequires}`)}catch(errEngines){}if(isLinux&&/\/snap\/core[0-9]{2}/.test(messages2))help.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node");if(isMacOs&&/Incompatible library version/.test(messages2))help.push("- Update Homebrew:","    brew update && brew upgrade vips");if(errors.some((err)=>err.code==="ERR_DLOPEN_DISABLED"))help.push("- Run Node.js without using the --no-addons flag");if(isWindows&&/The specified procedure could not be found/.test(messages2))help.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp");throw help.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(help.join(`
`))}});var require_constructor=__commonJS((exports,module)=>{var util=__require("util"),stream=__require("stream"),is2=require_is();require_sharp();var debuglog=util.debuglog("sharp"),Sharp=function(input,options){if(arguments.length===1&&!is2.defined(input))throw new Error("Invalid input");if(!(this instanceof Sharp))return new Sharp(input,options);return stream.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],useExifOrientation:!1,angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:0.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,resolveWithObject:!1,jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],debuglog:(warning)=>{this.emit("warning",warning),debuglog(warning)},queueListener:function(queueLength){Sharp.queue.emit("change",queueLength)}},this.options.input=this._createInputDescriptor(input,options,{allowStream:!0}),this};Object.setPrototypeOf(Sharp.prototype,stream.Duplex.prototype);Object.setPrototypeOf(Sharp,stream.Duplex);function clone2(){let clone3=this.constructor.call(),{debuglog:debuglog2,queueListener,...options}=this.options;if(clone3.options=structuredClone(options),clone3.options.debuglog=debuglog2,clone3.options.queueListener=queueListener,this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),clone3.options.input.buffer=this.options.input.buffer,clone3.emit("finish")});return clone3}Object.assign(Sharp.prototype,{clone:clone2});module.exports=Sharp});var require_color_name=__commonJS((exports,module)=>{module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var require_is_arrayish=__commonJS((exports,module)=>{module.exports=function isArrayish(obj){if(!obj||typeof obj==="string")return!1;return obj instanceof Array||Array.isArray(obj)||obj.length>=0&&(obj.splice instanceof Function||Object.getOwnPropertyDescriptor(obj,obj.length-1)&&obj.constructor.name!=="String")}});var require_simple_swizzle=__commonJS((exports,module)=>{var isArrayish=require_is_arrayish(),concat2=Array.prototype.concat,slice=Array.prototype.slice,swizzle=module.exports=function swizzle(args){var results=[];for(var i=0,len=args.length;i<len;i++){var arg=args[i];if(isArrayish(arg))results=concat2.call(results,slice.call(arg));else results.push(arg)}return results};swizzle.wrap=function(fn){return function(){return fn(swizzle(arguments))}}});var require_color_string=__commonJS((exports,module)=>{var colorNames=require_color_name(),swizzle=require_simple_swizzle(),hasOwnProperty=Object.hasOwnProperty,reverseNames=Object.create(null);for(name in colorNames)if(hasOwnProperty.call(colorNames,name))reverseNames[colorNames[name]]=name;var name,cs=module.exports={to:{},get:{}};cs.get=function(string){var prefix=string.substring(0,3).toLowerCase(),val,model;switch(prefix){case"hsl":val=cs.get.hsl(string),model="hsl";break;case"hwb":val=cs.get.hwb(string),model="hwb";break;default:val=cs.get.rgb(string),model="rgb";break}if(!val)return null;return{model,value:val}};cs.get.rgb=function(string){if(!string)return null;var abbr=/^#([a-f0-9]{3,4})$/i,hex2=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,rgba=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,per=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,keyword=/^(\w+)$/,rgb=[0,0,0,1],match,i,hexAlpha;if(match=string.match(hex2)){hexAlpha=match[2],match=match[1];for(i=0;i<3;i++){var i2=i*2;rgb[i]=parseInt(match.slice(i2,i2+2),16)}if(hexAlpha)rgb[3]=parseInt(hexAlpha,16)/255}else if(match=string.match(abbr)){match=match[1],hexAlpha=match[3];for(i=0;i<3;i++)rgb[i]=parseInt(match[i]+match[i],16);if(hexAlpha)rgb[3]=parseInt(hexAlpha+hexAlpha,16)/255}else if(match=string.match(rgba)){for(i=0;i<3;i++)rgb[i]=parseInt(match[i+1],0);if(match[4])if(match[5])rgb[3]=parseFloat(match[4])*0.01;else rgb[3]=parseFloat(match[4])}else if(match=string.match(per)){for(i=0;i<3;i++)rgb[i]=Math.round(parseFloat(match[i+1])*2.55);if(match[4])if(match[5])rgb[3]=parseFloat(match[4])*0.01;else rgb[3]=parseFloat(match[4])}else if(match=string.match(keyword)){if(match[1]==="transparent")return[0,0,0,0];if(!hasOwnProperty.call(colorNames,match[1]))return null;return rgb=colorNames[match[1]],rgb[3]=1,rgb}else return null;for(i=0;i<3;i++)rgb[i]=clamp(rgb[i],0,255);return rgb[3]=clamp(rgb[3],0,1),rgb};cs.get.hsl=function(string){if(!string)return null;var hsl=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,match=string.match(hsl);if(match){var alpha=parseFloat(match[4]),h=(parseFloat(match[1])%360+360)%360,s=clamp(parseFloat(match[2]),0,100),l=clamp(parseFloat(match[3]),0,100),a=clamp(isNaN(alpha)?1:alpha,0,1);return[h,s,l,a]}return null};cs.get.hwb=function(string){if(!string)return null;var hwb=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,match=string.match(hwb);if(match){var alpha=parseFloat(match[4]),h=(parseFloat(match[1])%360+360)%360,w=clamp(parseFloat(match[2]),0,100),b2=clamp(parseFloat(match[3]),0,100),a=clamp(isNaN(alpha)?1:alpha,0,1);return[h,w,b2,a]}return null};cs.to.hex=function(){var rgba=swizzle(arguments);return"#"+hexDouble(rgba[0])+hexDouble(rgba[1])+hexDouble(rgba[2])+(rgba[3]<1?hexDouble(Math.round(rgba[3]*255)):"")};cs.to.rgb=function(){var rgba=swizzle(arguments);return rgba.length<4||rgba[3]===1?"rgb("+Math.round(rgba[0])+", "+Math.round(rgba[1])+", "+Math.round(rgba[2])+")":"rgba("+Math.round(rgba[0])+", "+Math.round(rgba[1])+", "+Math.round(rgba[2])+", "+rgba[3]+")"};cs.to.rgb.percent=function(){var rgba=swizzle(arguments),r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b2=Math.round(rgba[2]/255*100);return rgba.length<4||rgba[3]===1?"rgb("+r+"%, "+g+"%, "+b2+"%)":"rgba("+r+"%, "+g+"%, "+b2+"%, "+rgba[3]+")"};cs.to.hsl=function(){var hsla=swizzle(arguments);return hsla.length<4||hsla[3]===1?"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)":"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "+hsla[3]+")"};cs.to.hwb=function(){var hwba=swizzle(arguments),a="";if(hwba.length>=4&&hwba[3]!==1)a=", "+hwba[3];return"hwb("+hwba[0]+", "+hwba[1]+"%, "+hwba[2]+"%"+a+")"};cs.to.keyword=function(rgb){return reverseNames[rgb.slice(0,3)]};function clamp(num,min,max){return Math.min(Math.max(min,num),max)}function hexDouble(num){var str=Math.round(num).toString(16).toUpperCase();return str.length<2?"0"+str:str}});var require_conversions=__commonJS((exports,module)=>{var cssKeywords=require_color_name(),reverseKeywords={};for(let key of Object.keys(cssKeywords))reverseKeywords[cssKeywords[key]]=key;var convert2={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};module.exports=convert2;for(let model of Object.keys(convert2)){if(!("channels"in convert2[model]))throw new Error("missing channels property: "+model);if(!("labels"in convert2[model]))throw new Error("missing channel labels property: "+model);if(convert2[model].labels.length!==convert2[model].channels)throw new Error("channel and label counts mismatch: "+model);let{channels,labels}=convert2[model];delete convert2[model].channels,delete convert2[model].labels,Object.defineProperty(convert2[model],"channels",{value:channels}),Object.defineProperty(convert2[model],"labels",{value:labels})}convert2.rgb.hsl=function(rgb){let r=rgb[0]/255,g=rgb[1]/255,b2=rgb[2]/255,min=Math.min(r,g,b2),max=Math.max(r,g,b2),delta2=max-min,h,s;if(max===min)h=0;else if(r===max)h=(g-b2)/delta2;else if(g===max)h=2+(b2-r)/delta2;else if(b2===max)h=4+(r-g)/delta2;if(h=Math.min(h*60,360),h<0)h+=360;let l=(min+max)/2;if(max===min)s=0;else if(l<=0.5)s=delta2/(max+min);else s=delta2/(2-max-min);return[h,s*100,l*100]};convert2.rgb.hsv=function(rgb){let rdif,gdif,bdif,h,s,r=rgb[0]/255,g=rgb[1]/255,b2=rgb[2]/255,v=Math.max(r,g,b2),diff=v-Math.min(r,g,b2),diffc=function(c){return(v-c)/6/diff+0.5};if(diff===0)h=0,s=0;else{if(s=diff/v,rdif=diffc(r),gdif=diffc(g),bdif=diffc(b2),r===v)h=bdif-gdif;else if(g===v)h=0.3333333333333333+rdif-bdif;else if(b2===v)h=0.6666666666666666+gdif-rdif;if(h<0)h+=1;else if(h>1)h-=1}return[h*360,s*100,v*100]};convert2.rgb.hwb=function(rgb){let r=rgb[0],g=rgb[1],b2=rgb[2],h=convert2.rgb.hsl(rgb)[0],w=0.00392156862745098*Math.min(r,Math.min(g,b2));return b2=1-0.00392156862745098*Math.max(r,Math.max(g,b2)),[h,w*100,b2*100]};convert2.rgb.cmyk=function(rgb){let r=rgb[0]/255,g=rgb[1]/255,b2=rgb[2]/255,k2=Math.min(1-r,1-g,1-b2),c=(1-r-k2)/(1-k2)||0,m=(1-g-k2)/(1-k2)||0,y=(1-b2-k2)/(1-k2)||0;return[c*100,m*100,y*100,k2*100]};function comparativeDistance(x,y){return(x[0]-y[0])**2+(x[1]-y[1])**2+(x[2]-y[2])**2}convert2.rgb.keyword=function(rgb){let reversed=reverseKeywords[rgb];if(reversed)return reversed;let currentClosestDistance=1/0,currentClosestKeyword;for(let keyword of Object.keys(cssKeywords)){let value=cssKeywords[keyword],distance=comparativeDistance(rgb,value);if(distance<currentClosestDistance)currentClosestDistance=distance,currentClosestKeyword=keyword}return currentClosestKeyword};convert2.keyword.rgb=function(keyword){return cssKeywords[keyword]};convert2.rgb.xyz=function(rgb){let r=rgb[0]/255,g=rgb[1]/255,b2=rgb[2]/255;r=r>0.04045?((r+0.055)/1.055)**2.4:r/12.92,g=g>0.04045?((g+0.055)/1.055)**2.4:g/12.92,b2=b2>0.04045?((b2+0.055)/1.055)**2.4:b2/12.92;let x=r*0.4124+g*0.3576+b2*0.1805,y=r*0.2126+g*0.7152+b2*0.0722,z=r*0.0193+g*0.1192+b2*0.9505;return[x*100,y*100,z*100]};convert2.rgb.lab=function(rgb){let xyz=convert2.rgb.xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2];x/=95.047,y/=100,z/=108.883,x=x>0.008856?x**0.3333333333333333:7.787*x+0.13793103448275862,y=y>0.008856?y**0.3333333333333333:7.787*y+0.13793103448275862,z=z>0.008856?z**0.3333333333333333:7.787*z+0.13793103448275862;let l=116*y-16,a=500*(x-y),b2=200*(y-z);return[l,a,b2]};convert2.hsl.rgb=function(hsl){let h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100,t2,t3,val;if(s===0)return val=l*255,[val,val,val];if(l<0.5)t2=l*(1+s);else t2=l+s-l*s;let t1=2*l-t2,rgb=[0,0,0];for(let i=0;i<3;i++){if(t3=h+0.3333333333333333*-(i-1),t3<0)t3++;if(t3>1)t3--;if(6*t3<1)val=t1+(t2-t1)*6*t3;else if(2*t3<1)val=t2;else if(3*t3<2)val=t1+(t2-t1)*(0.6666666666666666-t3)*6;else val=t1;rgb[i]=val*255}return rgb};convert2.hsl.hsv=function(hsl){let h=hsl[0],s=hsl[1]/100,l=hsl[2]/100,smin=s,lmin=Math.max(l,0.01);l*=2,s*=l<=1?l:2-l,smin*=lmin<=1?lmin:2-lmin;let v=(l+s)/2,sv=l===0?2*smin/(lmin+smin):2*s/(l+s);return[h,sv*100,v*100]};convert2.hsv.rgb=function(hsv){let h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6,f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t2=255*v*(1-s*(1-f));switch(v*=255,hi){case 0:return[v,t2,p];case 1:return[q,v,p];case 2:return[p,v,t2];case 3:return[p,q,v];case 4:return[t2,p,v];case 5:return[v,p,q]}};convert2.hsv.hsl=function(hsv){let h=hsv[0],s=hsv[1]/100,v=hsv[2]/100,vmin=Math.max(v,0.01),sl,l;l=(2-s)*v;let lmin=(2-s)*vmin;return sl=s*vmin,sl/=lmin<=1?lmin:2-lmin,sl=sl||0,l/=2,[h,sl*100,l*100]};convert2.hwb.rgb=function(hwb){let h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl,f;if(ratio>1)wh/=ratio,bl/=ratio;let i=Math.floor(6*h),v=1-bl;if(f=6*h-i,(i&1)!==0)f=1-f;let n=wh+f*(v-wh),r,g,b2;switch(i){default:case 6:case 0:r=v,g=n,b2=wh;break;case 1:r=n,g=v,b2=wh;break;case 2:r=wh,g=v,b2=n;break;case 3:r=wh,g=n,b2=v;break;case 4:r=n,g=wh,b2=v;break;case 5:r=v,g=wh,b2=n;break}return[r*255,g*255,b2*255]};convert2.cmyk.rgb=function(cmyk){let c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k2=cmyk[3]/100,r=1-Math.min(1,c*(1-k2)+k2),g=1-Math.min(1,m*(1-k2)+k2),b2=1-Math.min(1,y*(1-k2)+k2);return[r*255,g*255,b2*255]};convert2.xyz.rgb=function(xyz){let x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100,r,g,b2;return r=x*3.2406+y*-1.5372+z*-0.4986,g=x*-0.9689+y*1.8758+z*0.0415,b2=x*0.0557+y*-0.204+z*1.057,r=r>0.0031308?1.055*r**0.4166666666666667-0.055:r*12.92,g=g>0.0031308?1.055*g**0.4166666666666667-0.055:g*12.92,b2=b2>0.0031308?1.055*b2**0.4166666666666667-0.055:b2*12.92,r=Math.min(Math.max(0,r),1),g=Math.min(Math.max(0,g),1),b2=Math.min(Math.max(0,b2),1),[r*255,g*255,b2*255]};convert2.xyz.lab=function(xyz){let x=xyz[0],y=xyz[1],z=xyz[2];x/=95.047,y/=100,z/=108.883,x=x>0.008856?x**0.3333333333333333:7.787*x+0.13793103448275862,y=y>0.008856?y**0.3333333333333333:7.787*y+0.13793103448275862,z=z>0.008856?z**0.3333333333333333:7.787*z+0.13793103448275862;let l=116*y-16,a=500*(x-y),b2=200*(y-z);return[l,a,b2]};convert2.lab.xyz=function(lab){let l=lab[0],a=lab[1],b2=lab[2],x,y,z;y=(l+16)/116,x=a/500+y,z=y-b2/200;let y2=y**3,x2=x**3,z2=z**3;return y=y2>0.008856?y2:(y-0.13793103448275862)/7.787,x=x2>0.008856?x2:(x-0.13793103448275862)/7.787,z=z2>0.008856?z2:(z-0.13793103448275862)/7.787,x*=95.047,y*=100,z*=108.883,[x,y,z]};convert2.lab.lch=function(lab){let l=lab[0],a=lab[1],b2=lab[2],h;if(h=Math.atan2(b2,a)*360/2/Math.PI,h<0)h+=360;let c=Math.sqrt(a*a+b2*b2);return[l,c,h]};convert2.lch.lab=function(lch){let l=lch[0],c=lch[1],hr=lch[2]/360*2*Math.PI,a=c*Math.cos(hr),b2=c*Math.sin(hr);return[l,a,b2]};convert2.rgb.ansi16=function(args,saturation=null){let[r,g,b2]=args,value=saturation===null?convert2.rgb.hsv(args)[2]:saturation;if(value=Math.round(value/50),value===0)return 30;let ansi=30+(Math.round(b2/255)<<2|Math.round(g/255)<<1|Math.round(r/255));if(value===2)ansi+=60;return ansi};convert2.hsv.ansi16=function(args){return convert2.rgb.ansi16(convert2.hsv.rgb(args),args[2])};convert2.rgb.ansi256=function(args){let r=args[0],g=args[1],b2=args[2];if(r===g&&g===b2){if(r<8)return 16;if(r>248)return 231;return Math.round((r-8)/247*24)+232}return 16+36*Math.round(r/255*5)+6*Math.round(g/255*5)+Math.round(b2/255*5)};convert2.ansi16.rgb=function(args){let color=args%10;if(color===0||color===7){if(args>50)color+=3.5;return color=color/10.5*255,[color,color,color]}let mult=(~~(args>50)+1)*0.5,r=(color&1)*mult*255,g=(color>>1&1)*mult*255,b2=(color>>2&1)*mult*255;return[r,g,b2]};convert2.ansi256.rgb=function(args){if(args>=232){let c=(args-232)*10+8;return[c,c,c]}args-=16;let rem,r=Math.floor(args/36)/5*255,g=Math.floor((rem=args%36)/6)/5*255,b2=rem%6/5*255;return[r,g,b2]};convert2.rgb.hex=function(args){let string=(((Math.round(args[0])&255)<<16)+((Math.round(args[1])&255)<<8)+(Math.round(args[2])&255)).toString(16).toUpperCase();return"000000".substring(string.length)+string};convert2.hex.rgb=function(args){let match=args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!match)return[0,0,0];let colorString=match[0];if(match[0].length===3)colorString=colorString.split("").map((char2)=>{return char2+char2}).join("");let integer2=parseInt(colorString,16),r=integer2>>16&255,g=integer2>>8&255,b2=integer2&255;return[r,g,b2]};convert2.rgb.hcg=function(rgb){let r=rgb[0]/255,g=rgb[1]/255,b2=rgb[2]/255,max=Math.max(Math.max(r,g),b2),min=Math.min(Math.min(r,g),b2),chroma=max-min,grayscale,hue;if(chroma<1)grayscale=min/(1-chroma);else grayscale=0;if(chroma<=0)hue=0;else if(max===r)hue=(g-b2)/chroma%6;else if(max===g)hue=2+(b2-r)/chroma;else hue=4+(r-g)/chroma;return hue/=6,hue%=1,[hue*360,chroma*100,grayscale*100]};convert2.hsl.hcg=function(hsl){let s=hsl[1]/100,l=hsl[2]/100,c=l<0.5?2*s*l:2*s*(1-l),f=0;if(c<1)f=(l-0.5*c)/(1-c);return[hsl[0],c*100,f*100]};convert2.hsv.hcg=function(hsv){let s=hsv[1]/100,v=hsv[2]/100,c=s*v,f=0;if(c<1)f=(v-c)/(1-c);return[hsv[0],c*100,f*100]};convert2.hcg.rgb=function(hcg){let h=hcg[0]/360,c=hcg[1]/100,g=hcg[2]/100;if(c===0)return[g*255,g*255,g*255];let pure=[0,0,0],hi=h%1*6,v=hi%1,w=1-v,mg=0;switch(Math.floor(hi)){case 0:pure[0]=1,pure[1]=v,pure[2]=0;break;case 1:pure[0]=w,pure[1]=1,pure[2]=0;break;case 2:pure[0]=0,pure[1]=1,pure[2]=v;break;case 3:pure[0]=0,pure[1]=w,pure[2]=1;break;case 4:pure[0]=v,pure[1]=0,pure[2]=1;break;default:pure[0]=1,pure[1]=0,pure[2]=w}return mg=(1-c)*g,[(c*pure[0]+mg)*255,(c*pure[1]+mg)*255,(c*pure[2]+mg)*255]};convert2.hcg.hsv=function(hcg){let c=hcg[1]/100,g=hcg[2]/100,v=c+g*(1-c),f=0;if(v>0)f=c/v;return[hcg[0],f*100,v*100]};convert2.hcg.hsl=function(hcg){let c=hcg[1]/100,l=hcg[2]/100*(1-c)+0.5*c,s=0;if(l>0&&l<0.5)s=c/(2*l);else if(l>=0.5&&l<1)s=c/(2*(1-l));return[hcg[0],s*100,l*100]};convert2.hcg.hwb=function(hcg){let c=hcg[1]/100,g=hcg[2]/100,v=c+g*(1-c);return[hcg[0],(v-c)*100,(1-v)*100]};convert2.hwb.hcg=function(hwb){let w=hwb[1]/100,v=1-hwb[2]/100,c=v-w,g=0;if(c<1)g=(v-c)/(1-c);return[hwb[0],c*100,g*100]};convert2.apple.rgb=function(apple){return[apple[0]/65535*255,apple[1]/65535*255,apple[2]/65535*255]};convert2.rgb.apple=function(rgb){return[rgb[0]/255*65535,rgb[1]/255*65535,rgb[2]/255*65535]};convert2.gray.rgb=function(args){return[args[0]/100*255,args[0]/100*255,args[0]/100*255]};convert2.gray.hsl=function(args){return[0,0,args[0]]};convert2.gray.hsv=convert2.gray.hsl;convert2.gray.hwb=function(gray){return[0,100,gray[0]]};convert2.gray.cmyk=function(gray){return[0,0,0,gray[0]]};convert2.gray.lab=function(gray){return[gray[0],0,0]};convert2.gray.hex=function(gray){let val=Math.round(gray[0]/100*255)&255,string=((val<<16)+(val<<8)+val).toString(16).toUpperCase();return"000000".substring(string.length)+string};convert2.rgb.gray=function(rgb){return[(rgb[0]+rgb[1]+rgb[2])/3/255*100]}});var require_route=__commonJS((exports,module)=>{var conversions=require_conversions();function buildGraph(){let graph={},models=Object.keys(conversions);for(let len=models.length,i=0;i<len;i++)graph[models[i]]={distance:-1,parent:null};return graph}function deriveBFS(fromModel){let graph=buildGraph(),queue=[fromModel];graph[fromModel].distance=0;while(queue.length){let current=queue.pop(),adjacents=Object.keys(conversions[current]);for(let len=adjacents.length,i=0;i<len;i++){let adjacent=adjacents[i],node=graph[adjacent];if(node.distance===-1)node.distance=graph[current].distance+1,node.parent=current,queue.unshift(adjacent)}}return graph}function link(from,to){return function(args){return to(from(args))}}function wrapConversion(toModel,graph){let path=[graph[toModel].parent,toModel],fn=conversions[graph[toModel].parent][toModel],cur=graph[toModel].parent;while(graph[cur].parent)path.unshift(graph[cur].parent),fn=link(conversions[graph[cur].parent][cur],fn),cur=graph[cur].parent;return fn.conversion=path,fn}module.exports=function(fromModel){let graph=deriveBFS(fromModel),conversion={},models=Object.keys(graph);for(let len=models.length,i=0;i<len;i++){let toModel=models[i];if(graph[toModel].parent===null)continue;conversion[toModel]=wrapConversion(toModel,graph)}return conversion}});var require_color_convert=__commonJS((exports,module)=>{var conversions=require_conversions(),route=require_route(),convert2={},models=Object.keys(conversions);function wrapRaw(fn){let wrappedFn=function(...args){let arg0=args[0];if(arg0===void 0||arg0===null)return arg0;if(arg0.length>1)args=arg0;return fn(args)};if("conversion"in fn)wrappedFn.conversion=fn.conversion;return wrappedFn}function wrapRounded(fn){let wrappedFn=function(...args){let arg0=args[0];if(arg0===void 0||arg0===null)return arg0;if(arg0.length>1)args=arg0;let result=fn(args);if(typeof result==="object")for(let len=result.length,i=0;i<len;i++)result[i]=Math.round(result[i]);return result};if("conversion"in fn)wrappedFn.conversion=fn.conversion;return wrappedFn}models.forEach((fromModel)=>{convert2[fromModel]={},Object.defineProperty(convert2[fromModel],"channels",{value:conversions[fromModel].channels}),Object.defineProperty(convert2[fromModel],"labels",{value:conversions[fromModel].labels});let routes=route(fromModel);Object.keys(routes).forEach((toModel)=>{let fn=routes[toModel];convert2[fromModel][toModel]=wrapRounded(fn),convert2[fromModel][toModel].raw=wrapRaw(fn)})});module.exports=convert2});var require_color=__commonJS((exports,module)=>{var colorString=require_color_string(),convert2=require_color_convert(),skippedModels=["keyword","gray","hex"],hashedModelKeys={};for(let model of Object.keys(convert2))hashedModelKeys[[...convert2[model].labels].sort().join("")]=model;var limiters={};function Color(object,model){if(!(this instanceof Color))return new Color(object,model);if(model&&model in skippedModels)model=null;if(model&&!(model in convert2))throw new Error("Unknown model: "+model);let i,channels;if(object==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(object instanceof Color)this.model=object.model,this.color=[...object.color],this.valpha=object.valpha;else if(typeof object==="string"){let result=colorString.get(object);if(result===null)throw new Error("Unable to parse color from string: "+object);this.model=result.model,channels=convert2[this.model].channels,this.color=result.value.slice(0,channels),this.valpha=typeof result.value[channels]==="number"?result.value[channels]:1}else if(object.length>0){this.model=model||"rgb",channels=convert2[this.model].channels;let newArray=Array.prototype.slice.call(object,0,channels);this.color=zeroArray(newArray,channels),this.valpha=typeof object[channels]==="number"?object[channels]:1}else if(typeof object==="number")this.model="rgb",this.color=[object>>16&255,object>>8&255,object&255],this.valpha=1;else{this.valpha=1;let keys=Object.keys(object);if("alpha"in object)keys.splice(keys.indexOf("alpha"),1),this.valpha=typeof object.alpha==="number"?object.alpha:0;let hashedKeys=keys.sort().join("");if(!(hashedKeys in hashedModelKeys))throw new Error("Unable to parse color from object: "+JSON.stringify(object));this.model=hashedModelKeys[hashedKeys];let{labels}=convert2[this.model],color=[];for(i=0;i<labels.length;i++)color.push(object[labels[i]]);this.color=zeroArray(color)}if(limiters[this.model]){channels=convert2[this.model].channels;for(i=0;i<channels;i++){let limit=limiters[this.model][i];if(limit)this.color[i]=limit(this.color[i])}}if(this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze)Object.freeze(this)}Color.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(places){let self2=this.model in colorString.to?this:this.rgb();self2=self2.round(typeof places==="number"?places:1);let args=self2.valpha===1?self2.color:[...self2.color,this.valpha];return colorString.to[self2.model](args)},percentString(places){let self2=this.rgb().round(typeof places==="number"?places:1),args=self2.valpha===1?self2.color:[...self2.color,this.valpha];return colorString.to.rgb.percent(args)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){let result={},{channels}=convert2[this.model],{labels}=convert2[this.model];for(let i=0;i<channels;i++)result[labels[i]]=this.color[i];if(this.valpha!==1)result.alpha=this.valpha;return result},unitArray(){let rgb=this.rgb().color;if(rgb[0]/=255,rgb[1]/=255,rgb[2]/=255,this.valpha!==1)rgb.push(this.valpha);return rgb},unitObject(){let rgb=this.rgb().object();if(rgb.r/=255,rgb.g/=255,rgb.b/=255,this.valpha!==1)rgb.alpha=this.valpha;return rgb},round(places){return places=Math.max(places||0,0),new Color([...this.color.map(roundToPlace(places)),this.valpha],this.model)},alpha(value){if(value!==void 0)return new Color([...this.color,Math.max(0,Math.min(1,value))],this.model);return this.valpha},red:getset("rgb",0,maxfn(255)),green:getset("rgb",1,maxfn(255)),blue:getset("rgb",2,maxfn(255)),hue:getset(["hsl","hsv","hsl","hwb","hcg"],0,(value)=>(value%360+360)%360),saturationl:getset("hsl",1,maxfn(100)),lightness:getset("hsl",2,maxfn(100)),saturationv:getset("hsv",1,maxfn(100)),value:getset("hsv",2,maxfn(100)),chroma:getset("hcg",1,maxfn(100)),gray:getset("hcg",2,maxfn(100)),white:getset("hwb",1,maxfn(100)),wblack:getset("hwb",2,maxfn(100)),cyan:getset("cmyk",0,maxfn(100)),magenta:getset("cmyk",1,maxfn(100)),yellow:getset("cmyk",2,maxfn(100)),black:getset("cmyk",3,maxfn(100)),x:getset("xyz",0,maxfn(95.047)),y:getset("xyz",1,maxfn(100)),z:getset("xyz",2,maxfn(108.833)),l:getset("lab",0,maxfn(100)),a:getset("lab",1),b:getset("lab",2),keyword(value){if(value!==void 0)return new Color(value);return convert2[this.model].keyword(this.color)},hex(value){if(value!==void 0)return new Color(value);return colorString.to.hex(this.rgb().round().color)},hexa(value){if(value!==void 0)return new Color(value);let rgbArray=this.rgb().round().color,alphaHex=Math.round(this.valpha*255).toString(16).toUpperCase();if(alphaHex.length===1)alphaHex="0"+alphaHex;return colorString.to.hex(rgbArray)+alphaHex},rgbNumber(){let rgb=this.rgb().color;return(rgb[0]&255)<<16|(rgb[1]&255)<<8|rgb[2]&255},luminosity(){let rgb=this.rgb().color,lum=[];for(let[i,element]of rgb.entries()){let chan=element/255;lum[i]=chan<=0.04045?chan/12.92:((chan+0.055)/1.055)**2.4}return 0.2126*lum[0]+0.7152*lum[1]+0.0722*lum[2]},contrast(color2){let lum1=this.luminosity(),lum2=color2.luminosity();if(lum1>lum2)return(lum1+0.05)/(lum2+0.05);return(lum2+0.05)/(lum1+0.05)},level(color2){let contrastRatio=this.contrast(color2);if(contrastRatio>=7)return"AAA";return contrastRatio>=4.5?"AA":""},isDark(){let rgb=this.rgb().color;return(rgb[0]*2126+rgb[1]*7152+rgb[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){let rgb=this.rgb();for(let i=0;i<3;i++)rgb.color[i]=255-rgb.color[i];return rgb},lighten(ratio){let hsl=this.hsl();return hsl.color[2]+=hsl.color[2]*ratio,hsl},darken(ratio){let hsl=this.hsl();return hsl.color[2]-=hsl.color[2]*ratio,hsl},saturate(ratio){let hsl=this.hsl();return hsl.color[1]+=hsl.color[1]*ratio,hsl},desaturate(ratio){let hsl=this.hsl();return hsl.color[1]-=hsl.color[1]*ratio,hsl},whiten(ratio){let hwb=this.hwb();return hwb.color[1]+=hwb.color[1]*ratio,hwb},blacken(ratio){let hwb=this.hwb();return hwb.color[2]+=hwb.color[2]*ratio,hwb},grayscale(){let rgb=this.rgb().color,value=rgb[0]*0.3+rgb[1]*0.59+rgb[2]*0.11;return Color.rgb(value,value,value)},fade(ratio){return this.alpha(this.valpha-this.valpha*ratio)},opaquer(ratio){return this.alpha(this.valpha+this.valpha*ratio)},rotate(degrees){let hsl=this.hsl(),hue=hsl.color[0];return hue=(hue+degrees)%360,hue=hue<0?360+hue:hue,hsl.color[0]=hue,hsl},mix(mixinColor,weight){if(!mixinColor||!mixinColor.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof mixinColor);let color1=mixinColor.rgb(),color2=this.rgb(),p=weight===void 0?0.5:weight,w=2*p-1,a=color1.alpha()-color2.alpha(),w1=((w*a===-1?w:(w+a)/(1+w*a))+1)/2,w2=1-w1;return Color.rgb(w1*color1.red()+w2*color2.red(),w1*color1.green()+w2*color2.green(),w1*color1.blue()+w2*color2.blue(),color1.alpha()*p+color2.alpha()*(1-p))}};for(let model of Object.keys(convert2)){if(skippedModels.includes(model))continue;let{channels}=convert2[model];Color.prototype[model]=function(...args){if(this.model===model)return new Color(this);if(args.length>0)return new Color(args,model);return new Color([...assertArray(convert2[this.model][model].raw(this.color)),this.valpha],model)},Color[model]=function(...args){let color=args[0];if(typeof color==="number")color=zeroArray(args,channels);return new Color(color,model)}}function roundTo(number,places){return Number(number.toFixed(places))}function roundToPlace(places){return function(number){return roundTo(number,places)}}function getset(model,channel,modifier){model=Array.isArray(model)?model:[model];for(let m of model)(limiters[m]||(limiters[m]=[]))[channel]=modifier;return model=model[0],function(value){let result;if(value!==void 0){if(modifier)value=modifier(value);return result=this[model](),result.color[channel]=value,result}if(result=this[model]().color[channel],modifier)result=modifier(result);return result}}function maxfn(max){return function(v){return Math.max(0,Math.min(max,v))}}function assertArray(value){return Array.isArray(value)?value:[value]}function zeroArray(array,length){for(let i=0;i<length;i++)if(typeof array[i]!=="number")array[i]=0;return array}module.exports=Color});var require_input=__commonJS((exports,module)=>{var color=require_color(),is2=require_is(),sharp=require_sharp(),align={left:"low",center:"centre",centre:"centre",right:"high"};function _inputOptionsFromObject(obj){let{raw,density,limitInputPixels,ignoreIcc,unlimited,sequentialRead,failOn,failOnError,animated,page,pages,subifd}=obj;return[raw,density,limitInputPixels,ignoreIcc,unlimited,sequentialRead,failOn,failOnError,animated,page,pages,subifd].some(is2.defined)?{raw,density,limitInputPixels,ignoreIcc,unlimited,sequentialRead,failOn,failOnError,animated,page,pages,subifd}:void 0}function _createInputDescriptor(input,inputOptions,containerOptions){let inputDescriptor={failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(is2.string(input))inputDescriptor.file=input;else if(is2.buffer(input)){if(input.length===0)throw Error("Input Buffer is empty");inputDescriptor.buffer=input}else if(is2.arrayBuffer(input)){if(input.byteLength===0)throw Error("Input bit Array is empty");inputDescriptor.buffer=Buffer.from(input,0,input.byteLength)}else if(is2.typedArray(input)){if(input.length===0)throw Error("Input Bit Array is empty");inputDescriptor.buffer=Buffer.from(input.buffer,input.byteOffset,input.byteLength)}else if(is2.plainObject(input)&&!is2.defined(inputOptions)){if(inputOptions=input,_inputOptionsFromObject(inputOptions))inputDescriptor.buffer=[]}else if(!is2.defined(input)&&!is2.defined(inputOptions)&&is2.object(containerOptions)&&containerOptions.allowStream)inputDescriptor.buffer=[];else throw new Error(`Unsupported input '${input}' of type ${typeof input}${is2.defined(inputOptions)?` when also providing options of type ${typeof inputOptions}`:""}`);if(is2.object(inputOptions)){if(is2.defined(inputOptions.failOnError))if(is2.bool(inputOptions.failOnError))inputDescriptor.failOn=inputOptions.failOnError?"warning":"none";else throw is2.invalidParameterError("failOnError","boolean",inputOptions.failOnError);if(is2.defined(inputOptions.failOn))if(is2.string(inputOptions.failOn)&&is2.inArray(inputOptions.failOn,["none","truncated","error","warning"]))inputDescriptor.failOn=inputOptions.failOn;else throw is2.invalidParameterError("failOn","one of: none, truncated, error, warning",inputOptions.failOn);if(is2.defined(inputOptions.density))if(is2.inRange(inputOptions.density,1,1e5))inputDescriptor.density=inputOptions.density;else throw is2.invalidParameterError("density","number between 1 and 100000",inputOptions.density);if(is2.defined(inputOptions.ignoreIcc))if(is2.bool(inputOptions.ignoreIcc))inputDescriptor.ignoreIcc=inputOptions.ignoreIcc;else throw is2.invalidParameterError("ignoreIcc","boolean",inputOptions.ignoreIcc);if(is2.defined(inputOptions.limitInputPixels))if(is2.bool(inputOptions.limitInputPixels))inputDescriptor.limitInputPixels=inputOptions.limitInputPixels?Math.pow(16383,2):0;else if(is2.integer(inputOptions.limitInputPixels)&&is2.inRange(inputOptions.limitInputPixels,0,Number.MAX_SAFE_INTEGER))inputDescriptor.limitInputPixels=inputOptions.limitInputPixels;else throw is2.invalidParameterError("limitInputPixels","positive integer",inputOptions.limitInputPixels);if(is2.defined(inputOptions.unlimited))if(is2.bool(inputOptions.unlimited))inputDescriptor.unlimited=inputOptions.unlimited;else throw is2.invalidParameterError("unlimited","boolean",inputOptions.unlimited);if(is2.defined(inputOptions.sequentialRead))if(is2.bool(inputOptions.sequentialRead))inputDescriptor.sequentialRead=inputOptions.sequentialRead;else throw is2.invalidParameterError("sequentialRead","boolean",inputOptions.sequentialRead);if(is2.defined(inputOptions.raw))if(is2.object(inputOptions.raw)&&is2.integer(inputOptions.raw.width)&&inputOptions.raw.width>0&&is2.integer(inputOptions.raw.height)&&inputOptions.raw.height>0&&is2.integer(inputOptions.raw.channels)&&is2.inRange(inputOptions.raw.channels,1,4))switch(inputDescriptor.rawWidth=inputOptions.raw.width,inputDescriptor.rawHeight=inputOptions.raw.height,inputDescriptor.rawChannels=inputOptions.raw.channels,inputDescriptor.rawPremultiplied=!!inputOptions.raw.premultiplied,input.constructor){case Uint8Array:case Uint8ClampedArray:inputDescriptor.rawDepth="uchar";break;case Int8Array:inputDescriptor.rawDepth="char";break;case Uint16Array:inputDescriptor.rawDepth="ushort";break;case Int16Array:inputDescriptor.rawDepth="short";break;case Uint32Array:inputDescriptor.rawDepth="uint";break;case Int32Array:inputDescriptor.rawDepth="int";break;case Float32Array:inputDescriptor.rawDepth="float";break;case Float64Array:inputDescriptor.rawDepth="double";break;default:inputDescriptor.rawDepth="uchar";break}else throw new Error("Expected width, height and channels for raw pixel input");if(is2.defined(inputOptions.animated))if(is2.bool(inputOptions.animated))inputDescriptor.pages=inputOptions.animated?-1:1;else throw is2.invalidParameterError("animated","boolean",inputOptions.animated);if(is2.defined(inputOptions.pages))if(is2.integer(inputOptions.pages)&&is2.inRange(inputOptions.pages,-1,1e5))inputDescriptor.pages=inputOptions.pages;else throw is2.invalidParameterError("pages","integer between -1 and 100000",inputOptions.pages);if(is2.defined(inputOptions.page))if(is2.integer(inputOptions.page)&&is2.inRange(inputOptions.page,0,1e5))inputDescriptor.page=inputOptions.page;else throw is2.invalidParameterError("page","integer between 0 and 100000",inputOptions.page);if(is2.defined(inputOptions.level))if(is2.integer(inputOptions.level)&&is2.inRange(inputOptions.level,0,256))inputDescriptor.level=inputOptions.level;else throw is2.invalidParameterError("level","integer between 0 and 256",inputOptions.level);if(is2.defined(inputOptions.subifd))if(is2.integer(inputOptions.subifd)&&is2.inRange(inputOptions.subifd,-1,1e5))inputDescriptor.subifd=inputOptions.subifd;else throw is2.invalidParameterError("subifd","integer between -1 and 100000",inputOptions.subifd);if(is2.defined(inputOptions.create))if(is2.object(inputOptions.create)&&is2.integer(inputOptions.create.width)&&inputOptions.create.width>0&&is2.integer(inputOptions.create.height)&&inputOptions.create.height>0&&is2.integer(inputOptions.create.channels)){if(inputDescriptor.createWidth=inputOptions.create.width,inputDescriptor.createHeight=inputOptions.create.height,inputDescriptor.createChannels=inputOptions.create.channels,is2.defined(inputOptions.create.noise)){if(!is2.object(inputOptions.create.noise))throw new Error("Expected noise to be an object");if(!is2.inArray(inputOptions.create.noise.type,["gaussian"]))throw new Error("Only gaussian noise is supported at the moment");if(!is2.inRange(inputOptions.create.channels,1,4))throw is2.invalidParameterError("create.channels","number between 1 and 4",inputOptions.create.channels);if(inputDescriptor.createNoiseType=inputOptions.create.noise.type,is2.number(inputOptions.create.noise.mean)&&is2.inRange(inputOptions.create.noise.mean,0,1e4))inputDescriptor.createNoiseMean=inputOptions.create.noise.mean;else throw is2.invalidParameterError("create.noise.mean","number between 0 and 10000",inputOptions.create.noise.mean);if(is2.number(inputOptions.create.noise.sigma)&&is2.inRange(inputOptions.create.noise.sigma,0,1e4))inputDescriptor.createNoiseSigma=inputOptions.create.noise.sigma;else throw is2.invalidParameterError("create.noise.sigma","number between 0 and 10000",inputOptions.create.noise.sigma)}else if(is2.defined(inputOptions.create.background)){if(!is2.inRange(inputOptions.create.channels,3,4))throw is2.invalidParameterError("create.channels","number between 3 and 4",inputOptions.create.channels);let background=color(inputOptions.create.background);inputDescriptor.createBackground=[background.red(),background.green(),background.blue(),Math.round(background.alpha()*255)]}else throw new Error("Expected valid noise or background to create a new input image");delete inputDescriptor.buffer}else throw new Error("Expected valid width, height and channels to create a new input image");if(is2.defined(inputOptions.text))if(is2.object(inputOptions.text)&&is2.string(inputOptions.text.text)){if(inputDescriptor.textValue=inputOptions.text.text,is2.defined(inputOptions.text.height)&&is2.defined(inputOptions.text.dpi))throw new Error("Expected only one of dpi or height");if(is2.defined(inputOptions.text.font))if(is2.string(inputOptions.text.font))inputDescriptor.textFont=inputOptions.text.font;else throw is2.invalidParameterError("text.font","string",inputOptions.text.font);if(is2.defined(inputOptions.text.fontfile))if(is2.string(inputOptions.text.fontfile))inputDescriptor.textFontfile=inputOptions.text.fontfile;else throw is2.invalidParameterError("text.fontfile","string",inputOptions.text.fontfile);if(is2.defined(inputOptions.text.width))if(is2.integer(inputOptions.text.width)&&inputOptions.text.width>0)inputDescriptor.textWidth=inputOptions.text.width;else throw is2.invalidParameterError("text.width","positive integer",inputOptions.text.width);if(is2.defined(inputOptions.text.height))if(is2.integer(inputOptions.text.height)&&inputOptions.text.height>0)inputDescriptor.textHeight=inputOptions.text.height;else throw is2.invalidParameterError("text.height","positive integer",inputOptions.text.height);if(is2.defined(inputOptions.text.align))if(is2.string(inputOptions.text.align)&&is2.string(this.constructor.align[inputOptions.text.align]))inputDescriptor.textAlign=this.constructor.align[inputOptions.text.align];else throw is2.invalidParameterError("text.align","valid alignment",inputOptions.text.align);if(is2.defined(inputOptions.text.justify))if(is2.bool(inputOptions.text.justify))inputDescriptor.textJustify=inputOptions.text.justify;else throw is2.invalidParameterError("text.justify","boolean",inputOptions.text.justify);if(is2.defined(inputOptions.text.dpi))if(is2.integer(inputOptions.text.dpi)&&is2.inRange(inputOptions.text.dpi,1,1e6))inputDescriptor.textDpi=inputOptions.text.dpi;else throw is2.invalidParameterError("text.dpi","integer between 1 and 1000000",inputOptions.text.dpi);if(is2.defined(inputOptions.text.rgba))if(is2.bool(inputOptions.text.rgba))inputDescriptor.textRgba=inputOptions.text.rgba;else throw is2.invalidParameterError("text.rgba","bool",inputOptions.text.rgba);if(is2.defined(inputOptions.text.spacing))if(is2.integer(inputOptions.text.spacing)&&is2.inRange(inputOptions.text.spacing,-1e6,1e6))inputDescriptor.textSpacing=inputOptions.text.spacing;else throw is2.invalidParameterError("text.spacing","integer between -1000000 and 1000000",inputOptions.text.spacing);if(is2.defined(inputOptions.text.wrap))if(is2.string(inputOptions.text.wrap)&&is2.inArray(inputOptions.text.wrap,["word","char","word-char","none"]))inputDescriptor.textWrap=inputOptions.text.wrap;else throw is2.invalidParameterError("text.wrap","one of: word, char, word-char, none",inputOptions.text.wrap);delete inputDescriptor.buffer}else throw new Error("Expected a valid string to create an image with text.")}else if(is2.defined(inputOptions))throw new Error("Invalid input options "+inputOptions);return inputDescriptor}function _write(chunk,encoding,callback){if(Array.isArray(this.options.input.buffer))if(is2.buffer(chunk)){if(this.options.input.buffer.length===0)this.on("finish",()=>{this.streamInFinished=!0});this.options.input.buffer.push(chunk),callback()}else callback(new Error("Non-Buffer data on Writable Stream"));else callback(new Error("Unexpected data on Writable Stream"))}function _flattenBufferIn(){if(this._isStreamInput())this.options.input.buffer=Buffer.concat(this.options.input.buffer)}function _isStreamInput(){return Array.isArray(this.options.input.buffer)}function metadata(callback){let stack=Error();if(is2.fn(callback)){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),sharp.metadata(this.options,(err,metadata2)=>{if(err)callback(is2.nativeError(err,stack));else callback(null,metadata2)})});else sharp.metadata(this.options,(err,metadata2)=>{if(err)callback(is2.nativeError(err,stack));else callback(null,metadata2)});return this}else if(this._isStreamInput())return new Promise((resolve,reject)=>{let finished=()=>{this._flattenBufferIn(),sharp.metadata(this.options,(err,metadata2)=>{if(err)reject(is2.nativeError(err,stack));else resolve(metadata2)})};if(this.writableFinished)finished();else this.once("finish",finished)});else return new Promise((resolve,reject)=>{sharp.metadata(this.options,(err,metadata2)=>{if(err)reject(is2.nativeError(err,stack));else resolve(metadata2)})})}function stats(callback){let stack=Error();if(is2.fn(callback)){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),sharp.stats(this.options,(err,stats2)=>{if(err)callback(is2.nativeError(err,stack));else callback(null,stats2)})});else sharp.stats(this.options,(err,stats2)=>{if(err)callback(is2.nativeError(err,stack));else callback(null,stats2)});return this}else if(this._isStreamInput())return new Promise((resolve,reject)=>{this.on("finish",function(){this._flattenBufferIn(),sharp.stats(this.options,(err,stats2)=>{if(err)reject(is2.nativeError(err,stack));else resolve(stats2)})})});else return new Promise((resolve,reject)=>{sharp.stats(this.options,(err,stats2)=>{if(err)reject(is2.nativeError(err,stack));else resolve(stats2)})})}module.exports=function(Sharp){Object.assign(Sharp.prototype,{_inputOptionsFromObject,_createInputDescriptor,_write,_flattenBufferIn,_isStreamInput,metadata,stats}),Sharp.align=align}});var require_resize=__commonJS((exports,module)=>{var is2=require_is(),gravity={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},position={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},extendWith={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},strategy={entropy:16,attention:17},kernel={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3"},fit2={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},mapFitToCanvas={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function isRotationExpected(options){return options.angle%360!==0||options.useExifOrientation===!0||options.rotationAngle!==0}function isResizeExpected(options){return options.width!==-1||options.height!==-1}function resize(widthOrOptions,height,options){if(isResizeExpected(this.options))this.options.debuglog("ignoring previous resize options");if(this.options.widthPost!==-1)this.options.debuglog("operation order will be: extract, resize, extract");if(is2.defined(widthOrOptions))if(is2.object(widthOrOptions)&&!is2.defined(options))options=widthOrOptions;else if(is2.integer(widthOrOptions)&&widthOrOptions>0)this.options.width=widthOrOptions;else throw is2.invalidParameterError("width","positive integer",widthOrOptions);else this.options.width=-1;if(is2.defined(height))if(is2.integer(height)&&height>0)this.options.height=height;else throw is2.invalidParameterError("height","positive integer",height);else this.options.height=-1;if(is2.object(options)){if(is2.defined(options.width))if(is2.integer(options.width)&&options.width>0)this.options.width=options.width;else throw is2.invalidParameterError("width","positive integer",options.width);if(is2.defined(options.height))if(is2.integer(options.height)&&options.height>0)this.options.height=options.height;else throw is2.invalidParameterError("height","positive integer",options.height);if(is2.defined(options.fit)){let canvas=mapFitToCanvas[options.fit];if(is2.string(canvas))this.options.canvas=canvas;else throw is2.invalidParameterError("fit","valid fit",options.fit)}if(is2.defined(options.position)){let pos=is2.integer(options.position)?options.position:strategy[options.position]||position[options.position]||gravity[options.position];if(is2.integer(pos)&&(is2.inRange(pos,0,8)||is2.inRange(pos,16,17)))this.options.position=pos;else throw is2.invalidParameterError("position","valid position/gravity/strategy",options.position)}if(this._setBackgroundColourOption("resizeBackground",options.background),is2.defined(options.kernel))if(is2.string(kernel[options.kernel]))this.options.kernel=kernel[options.kernel];else throw is2.invalidParameterError("kernel","valid kernel name",options.kernel);if(is2.defined(options.withoutEnlargement))this._setBooleanOption("withoutEnlargement",options.withoutEnlargement);if(is2.defined(options.withoutReduction))this._setBooleanOption("withoutReduction",options.withoutReduction);if(is2.defined(options.fastShrinkOnLoad))this._setBooleanOption("fastShrinkOnLoad",options.fastShrinkOnLoad)}if(isRotationExpected(this.options)&&isResizeExpected(this.options))this.options.rotateBeforePreExtract=!0;return this}function extend(extend2){if(is2.integer(extend2)&&extend2>0)this.options.extendTop=extend2,this.options.extendBottom=extend2,this.options.extendLeft=extend2,this.options.extendRight=extend2;else if(is2.object(extend2)){if(is2.defined(extend2.top))if(is2.integer(extend2.top)&&extend2.top>=0)this.options.extendTop=extend2.top;else throw is2.invalidParameterError("top","positive integer",extend2.top);if(is2.defined(extend2.bottom))if(is2.integer(extend2.bottom)&&extend2.bottom>=0)this.options.extendBottom=extend2.bottom;else throw is2.invalidParameterError("bottom","positive integer",extend2.bottom);if(is2.defined(extend2.left))if(is2.integer(extend2.left)&&extend2.left>=0)this.options.extendLeft=extend2.left;else throw is2.invalidParameterError("left","positive integer",extend2.left);if(is2.defined(extend2.right))if(is2.integer(extend2.right)&&extend2.right>=0)this.options.extendRight=extend2.right;else throw is2.invalidParameterError("right","positive integer",extend2.right);if(this._setBackgroundColourOption("extendBackground",extend2.background),is2.defined(extend2.extendWith))if(is2.string(extendWith[extend2.extendWith]))this.options.extendWith=extendWith[extend2.extendWith];else throw is2.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",extend2.extendWith)}else throw is2.invalidParameterError("extend","integer or object",extend2);return this}function extract(options){let suffix=isResizeExpected(this.options)||this.options.widthPre!==-1?"Post":"Pre";if(this.options[`width${suffix}`]!==-1)this.options.debuglog("ignoring previous extract options");if(["left","top","width","height"].forEach(function(name){let value=options[name];if(is2.integer(value)&&value>=0)this.options[name+(name==="left"||name==="top"?"Offset":"")+suffix]=value;else throw is2.invalidParameterError(name,"integer",value)},this),isRotationExpected(this.options)&&!isResizeExpected(this.options)){if(this.options.widthPre===-1||this.options.widthPost===-1)this.options.rotateBeforePreExtract=!0}return this}function trim(options){if(this.options.trimThreshold=10,is2.defined(options))if(is2.object(options)){if(is2.defined(options.background))this._setBackgroundColourOption("trimBackground",options.background);if(is2.defined(options.threshold))if(is2.number(options.threshold)&&options.threshold>=0)this.options.trimThreshold=options.threshold;else throw is2.invalidParameterError("threshold","positive number",options.threshold);if(is2.defined(options.lineArt))this._setBooleanOption("trimLineArt",options.lineArt)}else throw is2.invalidParameterError("trim","object",options);if(isRotationExpected(this.options))this.options.rotateBeforePreExtract=!0;return this}module.exports=function(Sharp){Object.assign(Sharp.prototype,{resize,extend,extract,trim}),Sharp.gravity=gravity,Sharp.strategy=strategy,Sharp.kernel=kernel,Sharp.fit=fit2,Sharp.position=position}});var require_composite=__commonJS((exports,module)=>{var is2=require_is(),blend={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function composite(images){if(!Array.isArray(images))throw is2.invalidParameterError("images to composite","array",images);return this.options.composite=images.map((image)=>{if(!is2.object(image))throw is2.invalidParameterError("image to composite","object",image);let inputOptions=this._inputOptionsFromObject(image),composite2={input:this._createInputDescriptor(image.input,inputOptions,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(is2.defined(image.blend))if(is2.string(blend[image.blend]))composite2.blend=blend[image.blend];else throw is2.invalidParameterError("blend","valid blend name",image.blend);if(is2.defined(image.tile))if(is2.bool(image.tile))composite2.tile=image.tile;else throw is2.invalidParameterError("tile","boolean",image.tile);if(is2.defined(image.left))if(is2.integer(image.left))composite2.left=image.left;else throw is2.invalidParameterError("left","integer",image.left);if(is2.defined(image.top))if(is2.integer(image.top))composite2.top=image.top;else throw is2.invalidParameterError("top","integer",image.top);if(is2.defined(image.top)!==is2.defined(image.left))throw new Error("Expected both left and top to be set");else composite2.hasOffset=is2.integer(image.top)&&is2.integer(image.left);if(is2.defined(image.gravity))if(is2.integer(image.gravity)&&is2.inRange(image.gravity,0,8))composite2.gravity=image.gravity;else if(is2.string(image.gravity)&&is2.integer(this.constructor.gravity[image.gravity]))composite2.gravity=this.constructor.gravity[image.gravity];else throw is2.invalidParameterError("gravity","valid gravity",image.gravity);if(is2.defined(image.premultiplied))if(is2.bool(image.premultiplied))composite2.premultiplied=image.premultiplied;else throw is2.invalidParameterError("premultiplied","boolean",image.premultiplied);return composite2}),this}module.exports=function(Sharp){Sharp.prototype.composite=composite,Sharp.blend=blend}});var require_operation=__commonJS((exports,module)=>{var color=require_color(),is2=require_is(),vipsPrecision={integer:"integer",float:"float",approximate:"approximate"};function rotate(angle,options){if(this.options.useExifOrientation||this.options.angle||this.options.rotationAngle)this.options.debuglog("ignoring previous rotate options");if(!is2.defined(angle))this.options.useExifOrientation=!0;else if(is2.integer(angle)&&!(angle%90))this.options.angle=angle;else if(is2.number(angle)){if(this.options.rotationAngle=angle,is2.object(options)&&options.background){let backgroundColour=color(options.background);this.options.rotationBackground=[backgroundColour.red(),backgroundColour.green(),backgroundColour.blue(),Math.round(backgroundColour.alpha()*255)]}}else throw is2.invalidParameterError("angle","numeric",angle);return this}function flip(flip2){return this.options.flip=is2.bool(flip2)?flip2:!0,this}function flop(flop2){return this.options.flop=is2.bool(flop2)?flop2:!0,this}function affine(matrix,options){let flatMatrix=[].concat(...matrix);if(flatMatrix.length===4&&flatMatrix.every(is2.number))this.options.affineMatrix=flatMatrix;else throw is2.invalidParameterError("matrix","1x4 or 2x2 array",matrix);if(is2.defined(options))if(is2.object(options)){if(this._setBackgroundColourOption("affineBackground",options.background),is2.defined(options.idx))if(is2.number(options.idx))this.options.affineIdx=options.idx;else throw is2.invalidParameterError("options.idx","number",options.idx);if(is2.defined(options.idy))if(is2.number(options.idy))this.options.affineIdy=options.idy;else throw is2.invalidParameterError("options.idy","number",options.idy);if(is2.defined(options.odx))if(is2.number(options.odx))this.options.affineOdx=options.odx;else throw is2.invalidParameterError("options.odx","number",options.odx);if(is2.defined(options.ody))if(is2.number(options.ody))this.options.affineOdy=options.ody;else throw is2.invalidParameterError("options.ody","number",options.ody);if(is2.defined(options.interpolator))if(is2.inArray(options.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=options.interpolator;else throw is2.invalidParameterError("options.interpolator","valid interpolator name",options.interpolator)}else throw is2.invalidParameterError("options","object",options);return this}function sharpen(options,flat,jagged){if(!is2.defined(options))this.options.sharpenSigma=-1;else if(is2.bool(options))this.options.sharpenSigma=options?-1:0;else if(is2.number(options)&&is2.inRange(options,0.01,1e4)){if(this.options.sharpenSigma=options,is2.defined(flat))if(is2.number(flat)&&is2.inRange(flat,0,1e4))this.options.sharpenM1=flat;else throw is2.invalidParameterError("flat","number between 0 and 10000",flat);if(is2.defined(jagged))if(is2.number(jagged)&&is2.inRange(jagged,0,1e4))this.options.sharpenM2=jagged;else throw is2.invalidParameterError("jagged","number between 0 and 10000",jagged)}else if(is2.plainObject(options)){if(is2.number(options.sigma)&&is2.inRange(options.sigma,0.000001,10))this.options.sharpenSigma=options.sigma;else throw is2.invalidParameterError("options.sigma","number between 0.000001 and 10",options.sigma);if(is2.defined(options.m1))if(is2.number(options.m1)&&is2.inRange(options.m1,0,1e6))this.options.sharpenM1=options.m1;else throw is2.invalidParameterError("options.m1","number between 0 and 1000000",options.m1);if(is2.defined(options.m2))if(is2.number(options.m2)&&is2.inRange(options.m2,0,1e6))this.options.sharpenM2=options.m2;else throw is2.invalidParameterError("options.m2","number between 0 and 1000000",options.m2);if(is2.defined(options.x1))if(is2.number(options.x1)&&is2.inRange(options.x1,0,1e6))this.options.sharpenX1=options.x1;else throw is2.invalidParameterError("options.x1","number between 0 and 1000000",options.x1);if(is2.defined(options.y2))if(is2.number(options.y2)&&is2.inRange(options.y2,0,1e6))this.options.sharpenY2=options.y2;else throw is2.invalidParameterError("options.y2","number between 0 and 1000000",options.y2);if(is2.defined(options.y3))if(is2.number(options.y3)&&is2.inRange(options.y3,0,1e6))this.options.sharpenY3=options.y3;else throw is2.invalidParameterError("options.y3","number between 0 and 1000000",options.y3)}else throw is2.invalidParameterError("sigma","number between 0.01 and 10000",options);return this}function median(size){if(!is2.defined(size))this.options.medianSize=3;else if(is2.integer(size)&&is2.inRange(size,1,1000))this.options.medianSize=size;else throw is2.invalidParameterError("size","integer between 1 and 1000",size);return this}function blur(options){let sigma;if(is2.number(options))sigma=options;else if(is2.plainObject(options)){if(!is2.number(options.sigma))throw is2.invalidParameterError("options.sigma","number between 0.3 and 1000",sigma);if(sigma=options.sigma,"precision"in options)if(is2.string(vipsPrecision[options.precision]))this.options.precision=vipsPrecision[options.precision];else throw is2.invalidParameterError("precision","one of: integer, float, approximate",options.precision);if("minAmplitude"in options)if(is2.number(options.minAmplitude)&&is2.inRange(options.minAmplitude,0.001,1))this.options.minAmpl=options.minAmplitude;else throw is2.invalidParameterError("minAmplitude","number between 0.001 and 1",options.minAmplitude)}if(!is2.defined(options))this.options.blurSigma=-1;else if(is2.bool(options))this.options.blurSigma=options?-1:0;else if(is2.number(sigma)&&is2.inRange(sigma,0.3,1000))this.options.blurSigma=sigma;else throw is2.invalidParameterError("sigma","number between 0.3 and 1000",sigma);return this}function flatten(options){if(this.options.flatten=is2.bool(options)?options:!0,is2.object(options))this._setBackgroundColourOption("flattenBackground",options.background);return this}function unflatten(){return this.options.unflatten=!0,this}function gamma(gamma2,gammaOut){if(!is2.defined(gamma2))this.options.gamma=2.2;else if(is2.number(gamma2)&&is2.inRange(gamma2,1,3))this.options.gamma=gamma2;else throw is2.invalidParameterError("gamma","number between 1.0 and 3.0",gamma2);if(!is2.defined(gammaOut))this.options.gammaOut=this.options.gamma;else if(is2.number(gammaOut)&&is2.inRange(gammaOut,1,3))this.options.gammaOut=gammaOut;else throw is2.invalidParameterError("gammaOut","number between 1.0 and 3.0",gammaOut);return this}function negate(options){if(this.options.negate=is2.bool(options)?options:!0,is2.plainObject(options)&&"alpha"in options)if(!is2.bool(options.alpha))throw is2.invalidParameterError("alpha","should be boolean value",options.alpha);else this.options.negateAlpha=options.alpha;return this}function normalise(options){if(is2.plainObject(options)){if(is2.defined(options.lower))if(is2.number(options.lower)&&is2.inRange(options.lower,0,99))this.options.normaliseLower=options.lower;else throw is2.invalidParameterError("lower","number between 0 and 99",options.lower);if(is2.defined(options.upper))if(is2.number(options.upper)&&is2.inRange(options.upper,1,100))this.options.normaliseUpper=options.upper;else throw is2.invalidParameterError("upper","number between 1 and 100",options.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw is2.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function normalize(options){return this.normalise(options)}function clahe(options){if(is2.plainObject(options)){if(is2.integer(options.width)&&options.width>0)this.options.claheWidth=options.width;else throw is2.invalidParameterError("width","integer greater than zero",options.width);if(is2.integer(options.height)&&options.height>0)this.options.claheHeight=options.height;else throw is2.invalidParameterError("height","integer greater than zero",options.height);if(is2.defined(options.maxSlope))if(is2.integer(options.maxSlope)&&is2.inRange(options.maxSlope,0,100))this.options.claheMaxSlope=options.maxSlope;else throw is2.invalidParameterError("maxSlope","integer between 0 and 100",options.maxSlope)}else throw is2.invalidParameterError("options","plain object",options);return this}function convolve(kernel){if(!is2.object(kernel)||!Array.isArray(kernel.kernel)||!is2.integer(kernel.width)||!is2.integer(kernel.height)||!is2.inRange(kernel.width,3,1001)||!is2.inRange(kernel.height,3,1001)||kernel.height*kernel.width!==kernel.kernel.length)throw new Error("Invalid convolution kernel");if(!is2.integer(kernel.scale))kernel.scale=kernel.kernel.reduce(function(a,b2){return a+b2},0);if(kernel.scale<1)kernel.scale=1;if(!is2.integer(kernel.offset))kernel.offset=0;return this.options.convKernel=kernel,this}function threshold(threshold2,options){if(!is2.defined(threshold2))this.options.threshold=128;else if(is2.bool(threshold2))this.options.threshold=threshold2?128:0;else if(is2.integer(threshold2)&&is2.inRange(threshold2,0,255))this.options.threshold=threshold2;else throw is2.invalidParameterError("threshold","integer between 0 and 255",threshold2);if(!is2.object(options)||options.greyscale===!0||options.grayscale===!0)this.options.thresholdGrayscale=!0;else this.options.thresholdGrayscale=!1;return this}function boolean2(operand,operator,options){if(this.options.boolean=this._createInputDescriptor(operand,options),is2.string(operator)&&is2.inArray(operator,["and","or","eor"]))this.options.booleanOp=operator;else throw is2.invalidParameterError("operator","one of: and, or, eor",operator);return this}function linear(a,b2){if(!is2.defined(a)&&is2.number(b2))a=1;else if(is2.number(a)&&!is2.defined(b2))b2=0;if(!is2.defined(a))this.options.linearA=[];else if(is2.number(a))this.options.linearA=[a];else if(Array.isArray(a)&&a.length&&a.every(is2.number))this.options.linearA=a;else throw is2.invalidParameterError("a","number or array of numbers",a);if(!is2.defined(b2))this.options.linearB=[];else if(is2.number(b2))this.options.linearB=[b2];else if(Array.isArray(b2)&&b2.length&&b2.every(is2.number))this.options.linearB=b2;else throw is2.invalidParameterError("b","number or array of numbers",b2);if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function recomb(inputMatrix){if(!Array.isArray(inputMatrix))throw is2.invalidParameterError("inputMatrix","array",inputMatrix);if(inputMatrix.length!==3&&inputMatrix.length!==4)throw is2.invalidParameterError("inputMatrix","3x3 or 4x4 array",inputMatrix.length);let recombMatrix=inputMatrix.flat().map(Number);if(recombMatrix.length!==9&&recombMatrix.length!==16)throw is2.invalidParameterError("inputMatrix","cardinality of 9 or 16",recombMatrix.length);return this.options.recombMatrix=recombMatrix,this}function modulate(options){if(!is2.plainObject(options))throw is2.invalidParameterError("options","plain object",options);if("brightness"in options)if(is2.number(options.brightness)&&options.brightness>=0)this.options.brightness=options.brightness;else throw is2.invalidParameterError("brightness","number above zero",options.brightness);if("saturation"in options)if(is2.number(options.saturation)&&options.saturation>=0)this.options.saturation=options.saturation;else throw is2.invalidParameterError("saturation","number above zero",options.saturation);if("hue"in options)if(is2.integer(options.hue))this.options.hue=options.hue%360;else throw is2.invalidParameterError("hue","number",options.hue);if("lightness"in options)if(is2.number(options.lightness))this.options.lightness=options.lightness;else throw is2.invalidParameterError("lightness","number",options.lightness);return this}module.exports=function(Sharp){Object.assign(Sharp.prototype,{rotate,flip,flop,affine,sharpen,median,blur,flatten,unflatten,gamma,negate,normalise,normalize,clahe,convolve,threshold,boolean:boolean2,linear,recomb,modulate})}});var require_colour=__commonJS((exports,module)=>{var color=require_color(),is2=require_is(),colourspace={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function tint(tint2){return this._setBackgroundColourOption("tint",tint2),this}function greyscale(greyscale2){return this.options.greyscale=is2.bool(greyscale2)?greyscale2:!0,this}function grayscale(grayscale2){return this.greyscale(grayscale2)}function pipelineColourspace(colourspace2){if(!is2.string(colourspace2))throw is2.invalidParameterError("colourspace","string",colourspace2);return this.options.colourspacePipeline=colourspace2,this}function pipelineColorspace(colorspace){return this.pipelineColourspace(colorspace)}function toColourspace(colourspace2){if(!is2.string(colourspace2))throw is2.invalidParameterError("colourspace","string",colourspace2);return this.options.colourspace=colourspace2,this}function toColorspace(colorspace){return this.toColourspace(colorspace)}function _setBackgroundColourOption(key,value){if(is2.defined(value))if(is2.object(value)||is2.string(value)){let colour=color(value);this.options[key]=[colour.red(),colour.green(),colour.blue(),Math.round(colour.alpha()*255)]}else throw is2.invalidParameterError("background","object or string",value)}module.exports=function(Sharp){Object.assign(Sharp.prototype,{tint,greyscale,grayscale,pipelineColourspace,pipelineColorspace,toColourspace,toColorspace,_setBackgroundColourOption}),Sharp.colourspace=colourspace,Sharp.colorspace=colourspace}});var require_channel=__commonJS((exports,module)=>{var is2=require_is(),bool={and:"and",or:"or",eor:"eor"};function removeAlpha(){return this.options.removeAlpha=!0,this}function ensureAlpha(alpha){if(is2.defined(alpha))if(is2.number(alpha)&&is2.inRange(alpha,0,1))this.options.ensureAlpha=alpha;else throw is2.invalidParameterError("alpha","number between 0 and 1",alpha);else this.options.ensureAlpha=1;return this}function extractChannel(channel){let channelMap={red:0,green:1,blue:2,alpha:3};if(Object.keys(channelMap).includes(channel))channel=channelMap[channel];if(is2.integer(channel)&&is2.inRange(channel,0,4))this.options.extractChannel=channel;else throw is2.invalidParameterError("channel","integer or one of: red, green, blue, alpha",channel);return this}function joinChannel(images,options){if(Array.isArray(images))images.forEach(function(image){this.options.joinChannelIn.push(this._createInputDescriptor(image,options))},this);else this.options.joinChannelIn.push(this._createInputDescriptor(images,options));return this}function bandbool(boolOp){if(is2.string(boolOp)&&is2.inArray(boolOp,["and","or","eor"]))this.options.bandBoolOp=boolOp;else throw is2.invalidParameterError("boolOp","one of: and, or, eor",boolOp);return this}module.exports=function(Sharp){Object.assign(Sharp.prototype,{removeAlpha,ensureAlpha,extractChannel,joinChannel,bandbool}),Sharp.bool=bool}});var require_output=__commonJS((exports,module)=>{var path=__require("path"),is2=require_is(),sharp=require_sharp(),formats=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),jp2Regex=/\.(jp[2x]|j2[kc])$/i,errJp2Save=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),bitdepthFromColourCount=(colours)=>1<<31-Math.clz32(Math.ceil(Math.log2(colours)));function toFile(fileOut,callback){let err;if(!is2.string(fileOut))err=new Error("Missing output file path");else if(is2.string(this.options.input.file)&&path.resolve(this.options.input.file)===path.resolve(fileOut))err=new Error("Cannot use same file for input and output");else if(jp2Regex.test(path.extname(fileOut))&&!this.constructor.format.jp2k.output.file)err=errJp2Save();if(err)if(is2.fn(callback))callback(err);else return Promise.reject(err);else{this.options.fileOut=fileOut;let stack=Error();return this._pipeline(callback,stack)}return this}function toBuffer(options,callback){if(is2.object(options))this._setBooleanOption("resolveWithObject",options.resolveWithObject);else if(this.options.resolveWithObject)this.options.resolveWithObject=!1;this.options.fileOut="";let stack=Error();return this._pipeline(is2.fn(options)?options:callback,stack)}function keepExif(){return this.options.keepMetadata|=1,this}function withExif(exif){if(is2.object(exif))for(let[ifd,entries]of Object.entries(exif))if(is2.object(entries))for(let[k2,v]of Object.entries(entries))if(is2.string(v))this.options.withExif[`exif-${ifd.toLowerCase()}-${k2}`]=v;else throw is2.invalidParameterError(`${ifd}.${k2}`,"string",v);else throw is2.invalidParameterError(ifd,"object",entries);else throw is2.invalidParameterError("exif","object",exif);return this.options.withExifMerge=!1,this.keepExif()}function withExifMerge(exif){return this.withExif(exif),this.options.withExifMerge=!0,this}function keepIccProfile(){return this.options.keepMetadata|=8,this}function withIccProfile(icc,options){if(is2.string(icc))this.options.withIccProfile=icc;else throw is2.invalidParameterError("icc","string",icc);if(this.keepIccProfile(),is2.object(options)){if(is2.defined(options.attach))if(is2.bool(options.attach)){if(!options.attach)this.options.keepMetadata&=-9}else throw is2.invalidParameterError("attach","boolean",options.attach)}return this}function keepMetadata(){return this.options.keepMetadata=31,this}function withMetadata(options){if(this.keepMetadata(),this.withIccProfile("srgb"),is2.object(options)){if(is2.defined(options.orientation))if(is2.integer(options.orientation)&&is2.inRange(options.orientation,1,8))this.options.withMetadataOrientation=options.orientation;else throw is2.invalidParameterError("orientation","integer between 1 and 8",options.orientation);if(is2.defined(options.density))if(is2.number(options.density)&&options.density>0)this.options.withMetadataDensity=options.density;else throw is2.invalidParameterError("density","positive number",options.density);if(is2.defined(options.icc))this.withIccProfile(options.icc);if(is2.defined(options.exif))this.withExifMerge(options.exif)}return this}function toFormat(format,options){let actualFormat=formats.get((is2.object(format)&&is2.string(format.id)?format.id:format).toLowerCase());if(!actualFormat)throw is2.invalidParameterError("format",`one of: ${[...formats.keys()].join(", ")}`,format);return this[actualFormat](options)}function jpeg(options){if(is2.object(options)){if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,1,100))this.options.jpegQuality=options.quality;else throw is2.invalidParameterError("quality","integer between 1 and 100",options.quality);if(is2.defined(options.progressive))this._setBooleanOption("jpegProgressive",options.progressive);if(is2.defined(options.chromaSubsampling))if(is2.string(options.chromaSubsampling)&&is2.inArray(options.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=options.chromaSubsampling;else throw is2.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",options.chromaSubsampling);let optimiseCoding=is2.bool(options.optimizeCoding)?options.optimizeCoding:options.optimiseCoding;if(is2.defined(optimiseCoding))this._setBooleanOption("jpegOptimiseCoding",optimiseCoding);if(is2.defined(options.mozjpeg))if(is2.bool(options.mozjpeg)){if(options.mozjpeg)this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3}else throw is2.invalidParameterError("mozjpeg","boolean",options.mozjpeg);let trellisQuantisation=is2.bool(options.trellisQuantization)?options.trellisQuantization:options.trellisQuantisation;if(is2.defined(trellisQuantisation))this._setBooleanOption("jpegTrellisQuantisation",trellisQuantisation);if(is2.defined(options.overshootDeringing))this._setBooleanOption("jpegOvershootDeringing",options.overshootDeringing);let optimiseScans=is2.bool(options.optimizeScans)?options.optimizeScans:options.optimiseScans;if(is2.defined(optimiseScans)){if(this._setBooleanOption("jpegOptimiseScans",optimiseScans),optimiseScans)this.options.jpegProgressive=!0}let quantisationTable=is2.number(options.quantizationTable)?options.quantizationTable:options.quantisationTable;if(is2.defined(quantisationTable))if(is2.integer(quantisationTable)&&is2.inRange(quantisationTable,0,8))this.options.jpegQuantisationTable=quantisationTable;else throw is2.invalidParameterError("quantisationTable","integer between 0 and 8",quantisationTable)}return this._updateFormatOut("jpeg",options)}function png(options){if(is2.object(options)){if(is2.defined(options.progressive))this._setBooleanOption("pngProgressive",options.progressive);if(is2.defined(options.compressionLevel))if(is2.integer(options.compressionLevel)&&is2.inRange(options.compressionLevel,0,9))this.options.pngCompressionLevel=options.compressionLevel;else throw is2.invalidParameterError("compressionLevel","integer between 0 and 9",options.compressionLevel);if(is2.defined(options.adaptiveFiltering))this._setBooleanOption("pngAdaptiveFiltering",options.adaptiveFiltering);let colours=options.colours||options.colors;if(is2.defined(colours))if(is2.integer(colours)&&is2.inRange(colours,2,256))this.options.pngBitdepth=bitdepthFromColourCount(colours);else throw is2.invalidParameterError("colours","integer between 2 and 256",colours);if(is2.defined(options.palette))this._setBooleanOption("pngPalette",options.palette);else if([options.quality,options.effort,options.colours,options.colors,options.dither].some(is2.defined))this._setBooleanOption("pngPalette",!0);if(this.options.pngPalette){if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,0,100))this.options.pngQuality=options.quality;else throw is2.invalidParameterError("quality","integer between 0 and 100",options.quality);if(is2.defined(options.effort))if(is2.integer(options.effort)&&is2.inRange(options.effort,1,10))this.options.pngEffort=options.effort;else throw is2.invalidParameterError("effort","integer between 1 and 10",options.effort);if(is2.defined(options.dither))if(is2.number(options.dither)&&is2.inRange(options.dither,0,1))this.options.pngDither=options.dither;else throw is2.invalidParameterError("dither","number between 0.0 and 1.0",options.dither)}}return this._updateFormatOut("png",options)}function webp(options){if(is2.object(options)){if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,1,100))this.options.webpQuality=options.quality;else throw is2.invalidParameterError("quality","integer between 1 and 100",options.quality);if(is2.defined(options.alphaQuality))if(is2.integer(options.alphaQuality)&&is2.inRange(options.alphaQuality,0,100))this.options.webpAlphaQuality=options.alphaQuality;else throw is2.invalidParameterError("alphaQuality","integer between 0 and 100",options.alphaQuality);if(is2.defined(options.lossless))this._setBooleanOption("webpLossless",options.lossless);if(is2.defined(options.nearLossless))this._setBooleanOption("webpNearLossless",options.nearLossless);if(is2.defined(options.smartSubsample))this._setBooleanOption("webpSmartSubsample",options.smartSubsample);if(is2.defined(options.preset))if(is2.string(options.preset)&&is2.inArray(options.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=options.preset;else throw is2.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",options.preset);if(is2.defined(options.effort))if(is2.integer(options.effort)&&is2.inRange(options.effort,0,6))this.options.webpEffort=options.effort;else throw is2.invalidParameterError("effort","integer between 0 and 6",options.effort);if(is2.defined(options.minSize))this._setBooleanOption("webpMinSize",options.minSize);if(is2.defined(options.mixed))this._setBooleanOption("webpMixed",options.mixed)}return trySetAnimationOptions(options,this.options),this._updateFormatOut("webp",options)}function gif(options){if(is2.object(options)){if(is2.defined(options.reuse))this._setBooleanOption("gifReuse",options.reuse);if(is2.defined(options.progressive))this._setBooleanOption("gifProgressive",options.progressive);let colours=options.colours||options.colors;if(is2.defined(colours))if(is2.integer(colours)&&is2.inRange(colours,2,256))this.options.gifBitdepth=bitdepthFromColourCount(colours);else throw is2.invalidParameterError("colours","integer between 2 and 256",colours);if(is2.defined(options.effort))if(is2.number(options.effort)&&is2.inRange(options.effort,1,10))this.options.gifEffort=options.effort;else throw is2.invalidParameterError("effort","integer between 1 and 10",options.effort);if(is2.defined(options.dither))if(is2.number(options.dither)&&is2.inRange(options.dither,0,1))this.options.gifDither=options.dither;else throw is2.invalidParameterError("dither","number between 0.0 and 1.0",options.dither);if(is2.defined(options.interFrameMaxError))if(is2.number(options.interFrameMaxError)&&is2.inRange(options.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=options.interFrameMaxError;else throw is2.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",options.interFrameMaxError);if(is2.defined(options.interPaletteMaxError))if(is2.number(options.interPaletteMaxError)&&is2.inRange(options.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=options.interPaletteMaxError;else throw is2.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",options.interPaletteMaxError)}return trySetAnimationOptions(options,this.options),this._updateFormatOut("gif",options)}function jp2(options){if(!this.constructor.format.jp2k.output.buffer)throw errJp2Save();if(is2.object(options)){if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,1,100))this.options.jp2Quality=options.quality;else throw is2.invalidParameterError("quality","integer between 1 and 100",options.quality);if(is2.defined(options.lossless))if(is2.bool(options.lossless))this.options.jp2Lossless=options.lossless;else throw is2.invalidParameterError("lossless","boolean",options.lossless);if(is2.defined(options.tileWidth))if(is2.integer(options.tileWidth)&&is2.inRange(options.tileWidth,1,32768))this.options.jp2TileWidth=options.tileWidth;else throw is2.invalidParameterError("tileWidth","integer between 1 and 32768",options.tileWidth);if(is2.defined(options.tileHeight))if(is2.integer(options.tileHeight)&&is2.inRange(options.tileHeight,1,32768))this.options.jp2TileHeight=options.tileHeight;else throw is2.invalidParameterError("tileHeight","integer between 1 and 32768",options.tileHeight);if(is2.defined(options.chromaSubsampling))if(is2.string(options.chromaSubsampling)&&is2.inArray(options.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=options.chromaSubsampling;else throw is2.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",options.chromaSubsampling)}return this._updateFormatOut("jp2",options)}function trySetAnimationOptions(source,target){if(is2.object(source)&&is2.defined(source.loop))if(is2.integer(source.loop)&&is2.inRange(source.loop,0,65535))target.loop=source.loop;else throw is2.invalidParameterError("loop","integer between 0 and 65535",source.loop);if(is2.object(source)&&is2.defined(source.delay))if(is2.integer(source.delay)&&is2.inRange(source.delay,0,65535))target.delay=[source.delay];else if(Array.isArray(source.delay)&&source.delay.every(is2.integer)&&source.delay.every((v)=>is2.inRange(v,0,65535)))target.delay=source.delay;else throw is2.invalidParameterError("delay","integer or an array of integers between 0 and 65535",source.delay)}function tiff(options){if(is2.object(options)){if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,1,100))this.options.tiffQuality=options.quality;else throw is2.invalidParameterError("quality","integer between 1 and 100",options.quality);if(is2.defined(options.bitdepth))if(is2.integer(options.bitdepth)&&is2.inArray(options.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=options.bitdepth;else throw is2.invalidParameterError("bitdepth","1, 2, 4 or 8",options.bitdepth);if(is2.defined(options.tile))this._setBooleanOption("tiffTile",options.tile);if(is2.defined(options.tileWidth))if(is2.integer(options.tileWidth)&&options.tileWidth>0)this.options.tiffTileWidth=options.tileWidth;else throw is2.invalidParameterError("tileWidth","integer greater than zero",options.tileWidth);if(is2.defined(options.tileHeight))if(is2.integer(options.tileHeight)&&options.tileHeight>0)this.options.tiffTileHeight=options.tileHeight;else throw is2.invalidParameterError("tileHeight","integer greater than zero",options.tileHeight);if(is2.defined(options.miniswhite))this._setBooleanOption("tiffMiniswhite",options.miniswhite);if(is2.defined(options.pyramid))this._setBooleanOption("tiffPyramid",options.pyramid);if(is2.defined(options.xres))if(is2.number(options.xres)&&options.xres>0)this.options.tiffXres=options.xres;else throw is2.invalidParameterError("xres","number greater than zero",options.xres);if(is2.defined(options.yres))if(is2.number(options.yres)&&options.yres>0)this.options.tiffYres=options.yres;else throw is2.invalidParameterError("yres","number greater than zero",options.yres);if(is2.defined(options.compression))if(is2.string(options.compression)&&is2.inArray(options.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=options.compression;else throw is2.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",options.compression);if(is2.defined(options.predictor))if(is2.string(options.predictor)&&is2.inArray(options.predictor,["none","horizontal","float"]))this.options.tiffPredictor=options.predictor;else throw is2.invalidParameterError("predictor","one of: none, horizontal, float",options.predictor);if(is2.defined(options.resolutionUnit))if(is2.string(options.resolutionUnit)&&is2.inArray(options.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=options.resolutionUnit;else throw is2.invalidParameterError("resolutionUnit","one of: inch, cm",options.resolutionUnit)}return this._updateFormatOut("tiff",options)}function avif(options){return this.heif({...options,compression:"av1"})}function heif(options){if(is2.object(options)){if(is2.string(options.compression)&&is2.inArray(options.compression,["av1","hevc"]))this.options.heifCompression=options.compression;else throw is2.invalidParameterError("compression","one of: av1, hevc",options.compression);if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,1,100))this.options.heifQuality=options.quality;else throw is2.invalidParameterError("quality","integer between 1 and 100",options.quality);if(is2.defined(options.lossless))if(is2.bool(options.lossless))this.options.heifLossless=options.lossless;else throw is2.invalidParameterError("lossless","boolean",options.lossless);if(is2.defined(options.effort))if(is2.integer(options.effort)&&is2.inRange(options.effort,0,9))this.options.heifEffort=options.effort;else throw is2.invalidParameterError("effort","integer between 0 and 9",options.effort);if(is2.defined(options.chromaSubsampling))if(is2.string(options.chromaSubsampling)&&is2.inArray(options.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=options.chromaSubsampling;else throw is2.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",options.chromaSubsampling);if(is2.defined(options.bitdepth))if(is2.integer(options.bitdepth)&&is2.inArray(options.bitdepth,[8,10,12])){if(options.bitdepth!==8&&this.constructor.versions.heif)throw is2.invalidParameterError("bitdepth when using prebuilt binaries",8,options.bitdepth);this.options.heifBitdepth=options.bitdepth}else throw is2.invalidParameterError("bitdepth","8, 10 or 12",options.bitdepth)}else throw is2.invalidParameterError("options","Object",options);return this._updateFormatOut("heif",options)}function jxl(options){if(is2.object(options)){if(is2.defined(options.quality))if(is2.integer(options.quality)&&is2.inRange(options.quality,1,100))this.options.jxlDistance=options.quality>=30?0.1+(100-options.quality)*0.09:0.017666666666666667*options.quality*options.quality-1.15*options.quality+25;else throw is2.invalidParameterError("quality","integer between 1 and 100",options.quality);else if(is2.defined(options.distance))if(is2.number(options.distance)&&is2.inRange(options.distance,0,15))this.options.jxlDistance=options.distance;else throw is2.invalidParameterError("distance","number between 0.0 and 15.0",options.distance);if(is2.defined(options.decodingTier))if(is2.integer(options.decodingTier)&&is2.inRange(options.decodingTier,0,4))this.options.jxlDecodingTier=options.decodingTier;else throw is2.invalidParameterError("decodingTier","integer between 0 and 4",options.decodingTier);if(is2.defined(options.lossless))if(is2.bool(options.lossless))this.options.jxlLossless=options.lossless;else throw is2.invalidParameterError("lossless","boolean",options.lossless);if(is2.defined(options.effort))if(is2.integer(options.effort)&&is2.inRange(options.effort,3,9))this.options.jxlEffort=options.effort;else throw is2.invalidParameterError("effort","integer between 3 and 9",options.effort)}return this._updateFormatOut("jxl",options)}function raw(options){if(is2.object(options)){if(is2.defined(options.depth))if(is2.string(options.depth)&&is2.inArray(options.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=options.depth;else throw is2.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",options.depth)}return this._updateFormatOut("raw")}function tile(options){if(is2.object(options)){if(is2.defined(options.size))if(is2.integer(options.size)&&is2.inRange(options.size,1,8192))this.options.tileSize=options.size;else throw is2.invalidParameterError("size","integer between 1 and 8192",options.size);if(is2.defined(options.overlap))if(is2.integer(options.overlap)&&is2.inRange(options.overlap,0,8192)){if(options.overlap>this.options.tileSize)throw is2.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,options.overlap);this.options.tileOverlap=options.overlap}else throw is2.invalidParameterError("overlap","integer between 0 and 8192",options.overlap);if(is2.defined(options.container))if(is2.string(options.container)&&is2.inArray(options.container,["fs","zip"]))this.options.tileContainer=options.container;else throw is2.invalidParameterError("container","one of: fs, zip",options.container);if(is2.defined(options.layout))if(is2.string(options.layout)&&is2.inArray(options.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=options.layout;else throw is2.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",options.layout);if(is2.defined(options.angle))if(is2.integer(options.angle)&&!(options.angle%90))this.options.tileAngle=options.angle;else throw is2.invalidParameterError("angle","positive/negative multiple of 90",options.angle);if(this._setBackgroundColourOption("tileBackground",options.background),is2.defined(options.depth))if(is2.string(options.depth)&&is2.inArray(options.depth,["onepixel","onetile","one"]))this.options.tileDepth=options.depth;else throw is2.invalidParameterError("depth","one of: onepixel, onetile, one",options.depth);if(is2.defined(options.skipBlanks))if(is2.integer(options.skipBlanks)&&is2.inRange(options.skipBlanks,-1,65535))this.options.tileSkipBlanks=options.skipBlanks;else throw is2.invalidParameterError("skipBlanks","integer between -1 and 255/65535",options.skipBlanks);else if(is2.defined(options.layout)&&options.layout==="google")this.options.tileSkipBlanks=5;let centre=is2.bool(options.center)?options.center:options.centre;if(is2.defined(centre))this._setBooleanOption("tileCentre",centre);if(is2.defined(options.id))if(is2.string(options.id))this.options.tileId=options.id;else throw is2.invalidParameterError("id","string",options.id);if(is2.defined(options.basename))if(is2.string(options.basename))this.options.tileBasename=options.basename;else throw is2.invalidParameterError("basename","string",options.basename)}if(is2.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw is2.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function timeout(options){if(!is2.plainObject(options))throw is2.invalidParameterError("options","object",options);if(is2.integer(options.seconds)&&is2.inRange(options.seconds,0,3600))this.options.timeoutSeconds=options.seconds;else throw is2.invalidParameterError("seconds","integer between 0 and 3600",options.seconds);return this}function _updateFormatOut(formatOut,options){if(!(is2.object(options)&&options.force===!1))this.options.formatOut=formatOut;return this}function _setBooleanOption(key,val){if(is2.bool(val))this.options[key]=val;else throw is2.invalidParameterError(key,"boolean",val)}function _read(){if(!this.options.streamOut){this.options.streamOut=!0;let stack=Error();this._pipeline(void 0,stack)}}function _pipeline(callback,stack){if(typeof callback==="function"){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),sharp.pipeline(this.options,(err,data,info)=>{if(err)callback(is2.nativeError(err,stack));else callback(null,data,info)})});else sharp.pipeline(this.options,(err,data,info)=>{if(err)callback(is2.nativeError(err,stack));else callback(null,data,info)});return this}else if(this.options.streamOut){if(this._isStreamInput()){if(this.once("finish",()=>{this._flattenBufferIn(),sharp.pipeline(this.options,(err,data,info)=>{if(err)this.emit("error",is2.nativeError(err,stack));else this.emit("info",info),this.push(data);this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished)this.emit("finish")}else sharp.pipeline(this.options,(err,data,info)=>{if(err)this.emit("error",is2.nativeError(err,stack));else this.emit("info",info),this.push(data);this.push(null),this.on("end",()=>this.emit("close"))});return this}else if(this._isStreamInput())return new Promise((resolve,reject)=>{this.once("finish",()=>{this._flattenBufferIn(),sharp.pipeline(this.options,(err,data,info)=>{if(err)reject(is2.nativeError(err,stack));else if(this.options.resolveWithObject)resolve({data,info});else resolve(data)})})});else return new Promise((resolve,reject)=>{sharp.pipeline(this.options,(err,data,info)=>{if(err)reject(is2.nativeError(err,stack));else if(this.options.resolveWithObject)resolve({data,info});else resolve(data)})})}module.exports=function(Sharp){Object.assign(Sharp.prototype,{toFile,toBuffer,keepExif,withExif,withExifMerge,keepIccProfile,withIccProfile,keepMetadata,withMetadata,toFormat,jpeg,jp2,png,webp,tiff,avif,heif,jxl,gif,raw,tile,timeout,_updateFormatOut,_setBooleanOption,_read,_pipeline})}});var require_utility=__commonJS((exports,module)=>{var events=__require("events"),detectLibc=require_detect_libc(),is2=require_is(),{runtimePlatformArch}=require_libvips(),sharp=require_sharp(),runtimePlatform=runtimePlatformArch(),libvipsVersion=sharp.libvipsVersion(),format=sharp.format();format.heif.output.alias=["avif","heic"];format.jpeg.output.alias=["jpe","jpg"];format.tiff.output.alias=["tif"];format.jp2k.output.alias=["j2c","j2k","jp2","jpx"];var interpolators={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"},versions={vips:libvipsVersion.semver};if(!libvipsVersion.isGlobal)if(!libvipsVersion.isWasm)try{versions=__require(`@img/sharp-${runtimePlatform}/versions`)}catch(_2){try{versions=__require(`@img/sharp-libvips-${runtimePlatform}/versions`)}catch(_3){}}else try{versions=(()=>{throw new Error("Cannot require module "+"@img/sharp-wasm32/versions");})()}catch(_2){}versions.sharp=require_package2().version;if(versions.heif&&format.heif)format.heif.input.fileSuffix=[".avif"],format.heif.output.alias=["avif"];function cache(options){if(is2.bool(options))if(options)return sharp.cache(50,20,100);else return sharp.cache(0,0,0);else if(is2.object(options))return sharp.cache(options.memory,options.files,options.items);else return sharp.cache()}cache(!0);function concurrency(concurrency2){return sharp.concurrency(is2.integer(concurrency2)?concurrency2:null)}if(detectLibc.familySync()===detectLibc.GLIBC&&!sharp._isUsingJemalloc())sharp.concurrency(1);else if(detectLibc.familySync()===detectLibc.MUSL&&sharp.concurrency()===1024)sharp.concurrency(__require("os").availableParallelism());var queue=new events.EventEmitter;function counters(){return sharp.counters()}function simd(simd2){return sharp.simd(is2.bool(simd2)?simd2:null)}function block(options){if(is2.object(options))if(Array.isArray(options.operation)&&options.operation.every(is2.string))sharp.block(options.operation,!0);else throw is2.invalidParameterError("operation","Array<string>",options.operation);else throw is2.invalidParameterError("options","object",options)}function unblock(options){if(is2.object(options))if(Array.isArray(options.operation)&&options.operation.every(is2.string))sharp.block(options.operation,!1);else throw is2.invalidParameterError("operation","Array<string>",options.operation);else throw is2.invalidParameterError("options","object",options)}module.exports=function(Sharp){Sharp.cache=cache,Sharp.concurrency=concurrency,Sharp.counters=counters,Sharp.simd=simd,Sharp.format=format,Sharp.interpolators=interpolators,Sharp.versions=versions,Sharp.queue=queue,Sharp.block=block,Sharp.unblock=unblock}});var require_lib=__commonJS((exports,module)=>{var Sharp=require_constructor();require_input()(Sharp);require_resize()(Sharp);require_composite()(Sharp);require_operation()(Sharp);require_colour()(Sharp);require_channel()(Sharp);require_output()(Sharp);require_utility()(Sharp);module.exports=Sharp});var require_tslib=__commonJS((exports,module)=>{/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__spreadArrays,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet2,__classPrivateFieldSet2,__createBinding;(function(factory){var root=typeof global==="object"?global:typeof self==="object"?self:typeof this==="object"?this:{};if(typeof define==="function"&&define.amd)define("tslib",["exports"],function(exports2){factory(createExporter(root,createExporter(exports2)))});else if(typeof module==="object"&&typeof exports==="object")factory(createExporter(root,createExporter(exports)));else factory(createExporter(root));function createExporter(exports2,previous){if(exports2!==root)if(typeof Object.create==="function")Object.defineProperty(exports2,"__esModule",{value:!0});else exports2.__esModule=!0;return function(id,v){return exports2[id]=previous?previous(id,v):v}}})(function(exporter){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b2){d.__proto__=b2}||function(d,b2){for(var p in b2)if(b2.hasOwnProperty(p))d[p]=b2[p]};__extends=function(d,b2){extendStatics(d,b2);function __(){this.constructor=d}d.prototype=b2===null?Object.create(b2):(__.prototype=b2.prototype,new __)},__assign=Object.assign||function(t2){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t2[p]=s[p]}return t2},__rest=function(s,e){var t2={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t2[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function"){for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t2[p[i]]=s[p[i]]}return t2},__decorate=function(decorators,target,key,desc2){var c=arguments.length,r=c<3?target:desc2===null?desc2=Object.getOwnPropertyDescriptor(target,key):desc2,d;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(decorators,target,key,desc2);else for(var i=decorators.length-1;i>=0;i--)if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r;return c>3&&r&&Object.defineProperty(target,key,r),r},__param=function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},__metadata=function(metadataKey,metadataValue){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(metadataKey,metadataValue)},__awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=function(thisArg,body){var _2={label:0,sent:function(){if(t2[0]&1)throw t2[1];return t2[1]},trys:[],ops:[]},f,y,t2,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_2)try{if(f=1,y&&(t2=op[0]&2?y.return:op[0]?y.throw||((t2=y.return)&&t2.call(y),0):y.next)&&!(t2=t2.call(y,op[1])).done)return t2;if(y=0,t2)op=[op[0]&2,t2.value];switch(op[0]){case 0:case 1:t2=op;break;case 4:return _2.label++,{value:op[1],done:!1};case 5:_2.label++,y=op[1],op=[0];continue;case 7:op=_2.ops.pop(),_2.trys.pop();continue;default:if((t2=_2.trys,!(t2=t2.length>0&&t2[t2.length-1]))&&(op[0]===6||op[0]===2)){_2=0;continue}if(op[0]===3&&(!t2||op[1]>t2[0]&&op[1]<t2[3])){_2.label=op[1];break}if(op[0]===6&&_2.label<t2[1]){_2.label=t2[1],t2=op;break}if(t2&&_2.label<t2[2]){_2.label=t2[2],_2.ops.push(op);break}if(t2[2])_2.ops.pop();_2.trys.pop();continue}op=body.call(thisArg,_2)}catch(e){op=[6,e],y=0}finally{f=t2=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},__createBinding=function(o,m,k2,k22){if(k22===void 0)k22=k2;o[k22]=m[k2]},__exportStar=function(m,exports2){for(var p in m)if(p!=="default"&&!exports2.hasOwnProperty(p))exports2[p]=m[p]},__values=function(o){var s=typeof Symbol==="function"&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&typeof o.length==="number")return{next:function(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-- >0)&&!(r=i.next()).done)ar.push(r.value)}catch(error2){e={error:error2}}finally{try{if(r&&!r.done&&(m=i.return))m.call(i)}finally{if(e)throw e.error}}return ar},__spread=function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},__spreadArrays=function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k2=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k2++)r[k2]=a[j];return r},__await=function(v){return this instanceof __await?(this.v=v,this):new __await(v)},__asyncGenerator=function(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=generator.apply(thisArg,_arguments||[]),i,q=[];return i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){if(g[n])i[n]=function(v){return new Promise(function(a,b2){q.push([n,v,a,b2])>1||resume(n,v)})}}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume("next",value)}function reject(value){resume("throw",value)}function settle(f,v){if(f(v),q.shift(),q.length)resume(q[0][0],q[0][1])}},__asyncDelegator=function(o){var i,p;return i={},verb("next"),verb("throw",function(e){throw e}),verb("return"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){i[n]=o[n]?function(v){return(p=!p)?{value:__await(o[n](v)),done:n==="return"}:f?f(v):v}:f}},__asyncValues=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=o[Symbol.asyncIterator],i;return m?m.call(o):(o=typeof __values==="function"?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise(function(resolve,reject){v=o[n](v),settle(resolve,reject,v.done,v.value)})}}function settle(resolve,reject,d,v){Promise.resolve(v).then(function(v2){resolve({value:v2,done:d})},reject)}},__makeTemplateObject=function(cooked,raw){if(Object.defineProperty)Object.defineProperty(cooked,"raw",{value:raw});else cooked.raw=raw;return cooked},__importStar=function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null){for(var k2 in mod)if(Object.hasOwnProperty.call(mod,k2))result[k2]=mod[k2]}return result.default=mod,result},__importDefault=function(mod){return mod&&mod.__esModule?mod:{default:mod}},__classPrivateFieldGet2=function(receiver,privateMap){if(!privateMap.has(receiver))throw new TypeError("attempted to get private field on non-instance");return privateMap.get(receiver)},__classPrivateFieldSet2=function(receiver,privateMap,value){if(!privateMap.has(receiver))throw new TypeError("attempted to set private field on non-instance");return privateMap.set(receiver,value),value},exporter("__extends",__extends),exporter("__assign",__assign),exporter("__rest",__rest),exporter("__decorate",__decorate),exporter("__param",__param),exporter("__metadata",__metadata),exporter("__awaiter",__awaiter),exporter("__generator",__generator),exporter("__exportStar",__exportStar),exporter("__createBinding",__createBinding),exporter("__values",__values),exporter("__read",__read),exporter("__spread",__spread),exporter("__spreadArrays",__spreadArrays),exporter("__await",__await),exporter("__asyncGenerator",__asyncGenerator),exporter("__asyncDelegator",__asyncDelegator),exporter("__asyncValues",__asyncValues),exporter("__makeTemplateObject",__makeTemplateObject),exporter("__importStar",__importStar),exporter("__importDefault",__importDefault),exporter("__classPrivateFieldGet",__classPrivateFieldGet2),exporter("__classPrivateFieldSet",__classPrivateFieldSet2)})});var require_common=__commonJS((exports)=>{var TYPED_OK=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";function _has(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.assign=function(obj){var sources=Array.prototype.slice.call(arguments,1);while(sources.length){var source=sources.shift();if(!source)continue;if(typeof source!=="object")throw new TypeError(source+"must be non-object");for(var p in source)if(_has(source,p))obj[p]=source[p]}return obj};exports.shrinkBuf=function(buf,size){if(buf.length===size)return buf;if(buf.subarray)return buf.subarray(0,size);return buf.length=size,buf};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray){dest.set(src.subarray(src_offs,src_offs+len),dest_offs);return}for(var i2=0;i2<len;i2++)dest[dest_offs+i2]=src[src_offs+i2]},flattenChunks:function(chunks){var i2,l,len,pos,chunk,result;len=0;for(i2=0,l=chunks.length;i2<l;i2++)len+=chunks[i2].length;result=new Uint8Array(len),pos=0;for(i2=0,l=chunks.length;i2<l;i2++)chunk=chunks[i2],result.set(chunk,pos),pos+=chunk.length;return result}},fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i2=0;i2<len;i2++)dest[dest_offs+i2]=src[src_offs+i2]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){if(on)exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,fnTyped);else exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,fnUntyped)};exports.setTyped(TYPED_OK)});var require_trees=__commonJS((exports)=>{var utils=require_common(),Z_FIXED=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN=2;function zero(buf){var len=buf.length;while(--len>=0)buf[len]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES+2)*2);zero(static_ltree);var static_dtree=new Array(D_CODES*2);zero(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero(_dist_code);var _length_code=new Array(MAX_MATCH-MIN_MATCH+1);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var base_dist=new Array(D_CODES);zero(base_dist);function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}function d_code(dist){return dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)]}function put_short(s,w){s.pending_buf[s.pending++]=w&255,s.pending_buf[s.pending++]=w>>>8&255}function send_bits(s,value,length){if(s.bi_valid>Buf_size-length)s.bi_buf|=value<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=value>>Buf_size-s.bi_valid,s.bi_valid+=length-Buf_size;else s.bi_buf|=value<<s.bi_valid&65535,s.bi_valid+=length}function send_code(s,c,tree){send_bits(s,tree[c*2],tree[c*2+1])}function bi_reverse(code,len){var res=0;do res|=code&1,code>>>=1,res<<=1;while(--len>0);return res>>>1}function bi_flush(s){if(s.bi_valid===16)put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0;else if(s.bi_valid>=8)s.pending_buf[s.pending++]=s.bi_buf&255,s.bi_buf>>=8,s.bi_valid-=8}function gen_bitlen(s,desc2){var{dyn_tree:tree,max_code}=desc2,stree=desc2.stat_desc.static_tree,has_stree=desc2.stat_desc.has_stree,extra=desc2.stat_desc.extra_bits,base=desc2.stat_desc.extra_base,max_length=desc2.stat_desc.max_length,h,n,m,bits,xbits,f,overflow=0;for(bits=0;bits<=MAX_BITS;bits++)s.bl_count[bits]=0;tree[s.heap[s.heap_max]*2+1]=0;for(h=s.heap_max+1;h<HEAP_SIZE;h++){if(n=s.heap[h],bits=tree[tree[n*2+1]*2+1]+1,bits>max_length)bits=max_length,overflow++;if(tree[n*2+1]=bits,n>max_code)continue;if(s.bl_count[bits]++,xbits=0,n>=base)xbits=extra[n-base];if(f=tree[n*2],s.opt_len+=f*(bits+xbits),has_stree)s.static_len+=f*(stree[n*2+1]+xbits)}if(overflow===0)return;do{bits=max_length-1;while(s.bl_count[bits]===0)bits--;s.bl_count[bits]--,s.bl_count[bits+1]+=2,s.bl_count[max_length]--,overflow-=2}while(overflow>0);for(bits=max_length;bits!==0;bits--){n=s.bl_count[bits];while(n!==0){if(m=s.heap[--h],m>max_code)continue;if(tree[m*2+1]!==bits)s.opt_len+=(bits-tree[m*2+1])*tree[m*2],tree[m*2+1]=bits;n--}}}function gen_codes(tree,max_code,bl_count){var next_code=new Array(MAX_BITS+1),code=0,bits,n;for(bits=1;bits<=MAX_BITS;bits++)next_code[bits]=code=code+bl_count[bits-1]<<1;for(n=0;n<=max_code;n++){var len=tree[n*2+1];if(len===0)continue;tree[n*2]=bi_reverse(next_code[len]++,len)}}function tr_static_init(){var n,bits,length,code,dist,bl_count=new Array(MAX_BITS+1);length=0;for(code=0;code<LENGTH_CODES-1;code++){base_length[code]=length;for(n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code}_length_code[length-1]=code,dist=0;for(code=0;code<16;code++){base_dist[code]=dist;for(n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=code}dist>>=7;for(;code<D_CODES;code++){base_dist[code]=dist<<7;for(n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code}for(bits=0;bits<=MAX_BITS;bits++)bl_count[bits]=0;n=0;while(n<=143)static_ltree[n*2+1]=8,n++,bl_count[8]++;while(n<=255)static_ltree[n*2+1]=9,n++,bl_count[9]++;while(n<=279)static_ltree[n*2+1]=7,n++,bl_count[7]++;while(n<=287)static_ltree[n*2+1]=8,n++,bl_count[8]++;gen_codes(static_ltree,L_CODES+1,bl_count);for(n=0;n<D_CODES;n++)static_dtree[n*2+1]=5,static_dtree[n*2]=bi_reverse(n,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}function init_block(s){var n;for(n=0;n<L_CODES;n++)s.dyn_ltree[n*2]=0;for(n=0;n<D_CODES;n++)s.dyn_dtree[n*2]=0;for(n=0;n<BL_CODES;n++)s.bl_tree[n*2]=0;s.dyn_ltree[END_BLOCK*2]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0}function bi_windup(s){if(s.bi_valid>8)put_short(s,s.bi_buf);else if(s.bi_valid>0)s.pending_buf[s.pending++]=s.bi_buf;s.bi_buf=0,s.bi_valid=0}function copy_block(s,buf,len,header){if(bi_windup(s),header)put_short(s,len),put_short(s,~len);utils.arraySet(s.pending_buf,s.window,buf,len,s.pending),s.pending+=len}function smaller(tree,n,m,depth){var _n2=n*2,_m2=m*2;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]}function pqdownheap(s,tree,k2){var v=s.heap[k2],j=k2<<1;while(j<=s.heap_len){if(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth))j++;if(smaller(tree,v,s.heap[j],s.depth))break;s.heap[k2]=s.heap[j],k2=j,j<<=1}s.heap[k2]=v}function compress_block(s,ltree,dtree){var dist,lc,lx=0,code,extra;if(s.last_lit!==0)do if(dist=s.pending_buf[s.d_buf+lx*2]<<8|s.pending_buf[s.d_buf+lx*2+1],lc=s.pending_buf[s.l_buf+lx],lx++,dist===0)send_code(s,lc,ltree);else{if(code=_length_code[lc],send_code(s,code+LITERALS+1,ltree),extra=extra_lbits[code],extra!==0)lc-=base_length[code],send_bits(s,lc,extra);if(dist--,code=d_code(dist),send_code(s,code,dtree),extra=extra_dbits[code],extra!==0)dist-=base_dist[code],send_bits(s,dist,extra)}while(lx<s.last_lit);send_code(s,END_BLOCK,ltree)}function build_tree(s,desc2){var tree=desc2.dyn_tree,stree=desc2.stat_desc.static_tree,has_stree=desc2.stat_desc.has_stree,elems=desc2.stat_desc.elems,n,m,max_code=-1,node;s.heap_len=0,s.heap_max=HEAP_SIZE;for(n=0;n<elems;n++)if(tree[n*2]!==0)s.heap[++s.heap_len]=max_code=n,s.depth[n]=0;else tree[n*2+1]=0;while(s.heap_len<2)if(node=s.heap[++s.heap_len]=max_code<2?++max_code:0,tree[node*2]=1,s.depth[node]=0,s.opt_len--,has_stree)s.static_len-=stree[node*2+1];desc2.max_code=max_code;for(n=s.heap_len>>1;n>=1;n--)pqdownheap(s,tree,n);node=elems;do n=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,tree,1),m=s.heap[1],s.heap[--s.heap_max]=n,s.heap[--s.heap_max]=m,tree[node*2]=tree[n*2]+tree[m*2],s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1,tree[n*2+1]=tree[m*2+1]=node,s.heap[1]=node++,pqdownheap(s,tree,1);while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],gen_bitlen(s,desc2),gen_codes(tree,max_code,s.bl_count)}function scan_tree(s,tree,max_code){var n,prevlen=-1,curlen,nextlen=tree[1],count2=0,max_count=7,min_count=4;if(nextlen===0)max_count=138,min_count=3;tree[(max_code+1)*2+1]=65535;for(n=0;n<=max_code;n++){if(curlen=nextlen,nextlen=tree[(n+1)*2+1],++count2<max_count&&curlen===nextlen)continue;else if(count2<min_count)s.bl_tree[curlen*2]+=count2;else if(curlen!==0){if(curlen!==prevlen)s.bl_tree[curlen*2]++;s.bl_tree[REP_3_6*2]++}else if(count2<=10)s.bl_tree[REPZ_3_10*2]++;else s.bl_tree[REPZ_11_138*2]++;if(count2=0,prevlen=curlen,nextlen===0)max_count=138,min_count=3;else if(curlen===nextlen)max_count=6,min_count=3;else max_count=7,min_count=4}}function send_tree(s,tree,max_code){var n,prevlen=-1,curlen,nextlen=tree[1],count2=0,max_count=7,min_count=4;if(nextlen===0)max_count=138,min_count=3;for(n=0;n<=max_code;n++){if(curlen=nextlen,nextlen=tree[(n+1)*2+1],++count2<max_count&&curlen===nextlen)continue;else if(count2<min_count)do send_code(s,curlen,s.bl_tree);while(--count2!==0);else if(curlen!==0){if(curlen!==prevlen)send_code(s,curlen,s.bl_tree),count2--;send_code(s,REP_3_6,s.bl_tree),send_bits(s,count2-3,2)}else if(count2<=10)send_code(s,REPZ_3_10,s.bl_tree),send_bits(s,count2-3,3);else send_code(s,REPZ_11_138,s.bl_tree),send_bits(s,count2-11,7);if(count2=0,prevlen=curlen,nextlen===0)max_count=138,min_count=3;else if(curlen===nextlen)max_count=6,min_count=3;else max_count=7,min_count=4}}function build_bl_tree(s){var max_blindex;scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc);for(max_blindex=BL_CODES-1;max_blindex>=3;max_blindex--)if(s.bl_tree[bl_order[max_blindex]*2+1]!==0)break;return s.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex}function send_all_trees(s,lcodes,dcodes,blcodes){var rank;send_bits(s,lcodes-257,5),send_bits(s,dcodes-1,5),send_bits(s,blcodes-4,4);for(rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[bl_order[rank]*2+1],3);send_tree(s,s.dyn_ltree,lcodes-1),send_tree(s,s.dyn_dtree,dcodes-1)}function detect_data_type(s){var black_mask=4093624447,n;for(n=0;n<=31;n++,black_mask>>>=1)if(black_mask&1&&s.dyn_ltree[n*2]!==0)return Z_BINARY;if(s.dyn_ltree[18]!==0||s.dyn_ltree[20]!==0||s.dyn_ltree[26]!==0)return Z_TEXT;for(n=32;n<LITERALS;n++)if(s.dyn_ltree[n*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(s){if(!static_init_done)tr_static_init(),static_init_done=!0;s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)}function _tr_stored_block(s,buf,stored_len,last2){send_bits(s,(STORED_BLOCK<<1)+(last2?1:0),3),copy_block(s,buf,stored_len,!0)}function _tr_align(s){send_bits(s,STATIC_TREES<<1,3),send_code(s,END_BLOCK,static_ltree),bi_flush(s)}function _tr_flush_block(s,buf,stored_len,last2){var opt_lenb,static_lenb,max_blindex=0;if(s.level>0){if(s.strm.data_type===Z_UNKNOWN)s.strm.data_type=detect_data_type(s);if(build_tree(s,s.l_desc),build_tree(s,s.d_desc),max_blindex=build_bl_tree(s),opt_lenb=s.opt_len+3+7>>>3,static_lenb=s.static_len+3+7>>>3,static_lenb<=opt_lenb)opt_lenb=static_lenb}else opt_lenb=static_lenb=stored_len+5;if(stored_len+4<=opt_lenb&&buf!==-1)_tr_stored_block(s,buf,stored_len,last2);else if(s.strategy===Z_FIXED||static_lenb===opt_lenb)send_bits(s,(STATIC_TREES<<1)+(last2?1:0),3),compress_block(s,static_ltree,static_dtree);else send_bits(s,(DYN_TREES<<1)+(last2?1:0),3),send_all_trees(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1),compress_block(s,s.dyn_ltree,s.dyn_dtree);if(init_block(s),last2)bi_windup(s)}function _tr_tally(s,dist,lc){if(s.pending_buf[s.d_buf+s.last_lit*2]=dist>>>8&255,s.pending_buf[s.d_buf+s.last_lit*2+1]=dist&255,s.pending_buf[s.l_buf+s.last_lit]=lc&255,s.last_lit++,dist===0)s.dyn_ltree[lc*2]++;else s.matches++,dist--,s.dyn_ltree[(_length_code[lc]+LITERALS+1)*2]++,s.dyn_dtree[d_code(dist)*2]++;return s.last_lit===s.lit_bufsize-1}exports._tr_init=_tr_init;exports._tr_stored_block=_tr_stored_block;exports._tr_flush_block=_tr_flush_block;exports._tr_tally=_tr_tally;exports._tr_align=_tr_align});var require_adler32=__commonJS((exports,module)=>{function adler32(adler,buf,len,pos){var s1=adler&65535|0,s2=adler>>>16&65535|0,n=0;while(len!==0){n=len>2000?2000:len,len-=n;do s1=s1+buf[pos++]|0,s2=s2+s1|0;while(--n);s1%=65521,s2%=65521}return s1|s2<<16|0}module.exports=adler32});var require_crc32=__commonJS((exports,module)=>{function makeTable(){var c,table=[];for(var n=0;n<256;n++){c=n;for(var k2=0;k2<8;k2++)c=c&1?3988292384^c>>>1:c>>>1;table[n]=c}return table}var crcTable=makeTable();function crc32(crc,buf,len,pos){var t2=crcTable,end=pos+len;crc^=-1;for(var i2=pos;i2<end;i2++)crc=crc>>>8^t2[(crc^buf[i2])&255];return crc^-1}module.exports=crc32});var require_messages=__commonJS((exports,module)=>{module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var require_deflate=__commonJS((exports)=>{var utils=require_common(),trees=require_trees(),adler32=require_adler32(),crc32=require_crc32(),msg=require_messages(),Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH=4,Z_BLOCK=5,Z_OK=0,Z_STREAM_END=1,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY=0,Z_UNKNOWN=2,Z_DEFLATED=8,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(strm,errorCode){return strm.msg=msg[errorCode],errorCode}function rank(f){return(f<<1)-(f>4?9:0)}function zero(buf){var len=buf.length;while(--len>=0)buf[len]=0}function flush_pending(strm){var s=strm.state,len=s.pending;if(len>strm.avail_out)len=strm.avail_out;if(len===0)return;if(utils.arraySet(strm.output,s.pending_buf,s.pending_out,len,strm.next_out),strm.next_out+=len,s.pending_out+=len,strm.total_out+=len,strm.avail_out-=len,s.pending-=len,s.pending===0)s.pending_out=0}function flush_block_only(s,last2){trees._tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,last2),s.block_start=s.strstart,flush_pending(s.strm)}function put_byte(s,b2){s.pending_buf[s.pending++]=b2}function putShortMSB(s,b2){s.pending_buf[s.pending++]=b2>>>8&255,s.pending_buf[s.pending++]=b2&255}function read_buf(strm,buf,start,size){var len=strm.avail_in;if(len>size)len=size;if(len===0)return 0;if(strm.avail_in-=len,utils.arraySet(buf,strm.input,strm.next_in,len,start),strm.state.wrap===1)strm.adler=adler32(strm.adler,buf,len,start);else if(strm.state.wrap===2)strm.adler=crc32(strm.adler,buf,len,start);return strm.next_in+=len,strm.total_in+=len,len}function longest_match(s,cur_match){var{max_chain_length:chain_length,strstart:scan}=s,match,len,best_len=s.prev_length,nice_match=s.nice_match,limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0,_win=s.window,wmask=s.w_mask,prev=s.prev,strend=s.strstart+MAX_MATCH,scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];if(s.prev_length>=s.good_match)chain_length>>=2;if(nice_match>s.lookahead)nice_match=s.lookahead;do{if(match=cur_match,_win[match+best_len]!==scan_end||_win[match+best_len-1]!==scan_end1||_win[match]!==_win[scan]||_win[++match]!==_win[scan+1])continue;scan+=2,match++;do;while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);if(len=MAX_MATCH-(strend-scan),scan=strend-MAX_MATCH,len>best_len){if(s.match_start=cur_match,best_len=len,len>=nice_match)break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}while((cur_match=prev[cur_match&wmask])>limit&&--chain_length!==0);if(best_len<=s.lookahead)return best_len;return s.lookahead}function fill_window(s){var _w_size=s.w_size,p,n,m,more,str;do{if(more=s.window_size-s.lookahead-s.strstart,s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){utils.arraySet(s.window,s.window,_w_size,_w_size,0),s.match_start-=_w_size,s.strstart-=_w_size,s.block_start-=_w_size,n=s.hash_size,p=n;do m=s.head[--p],s.head[p]=m>=_w_size?m-_w_size:0;while(--n);n=_w_size,p=n;do m=s.prev[--p],s.prev[p]=m>=_w_size?m-_w_size:0;while(--n);more+=_w_size}if(s.strm.avail_in===0)break;if(n=read_buf(s.strm,s.window,s.strstart+s.lookahead,more),s.lookahead+=n,s.lookahead+s.insert>=MIN_MATCH){str=s.strstart-s.insert,s.ins_h=s.window[str],s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+1])&s.hash_mask;while(s.insert)if(s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,s.insert--,s.lookahead+s.insert<MIN_MATCH)break}}while(s.lookahead<MIN_LOOKAHEAD&&s.strm.avail_in!==0)}function deflate_stored(s,flush){var max_block_size=65535;if(max_block_size>s.pending_buf_size-5)max_block_size=s.pending_buf_size-5;for(;;){if(s.lookahead<=1){if(fill_window(s),s.lookahead===0&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}s.strstart+=s.lookahead,s.lookahead=0;var max_start=s.block_start+max_block_size;if(s.strstart===0||s.strstart>=max_start){if(s.lookahead=s.strstart-max_start,s.strstart=max_start,flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}}if(s.insert=0,flush===Z_FINISH){if(flush_block_only(s,!0),s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.strstart>s.block_start){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}return BS_NEED_MORE}function deflate_fast(s,flush){var hash_head,bflush;for(;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}if(hash_head=0,s.lookahead>=MIN_MATCH)s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;if(hash_head!==0&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD)s.match_length=longest_match(s,hash_head);if(s.match_length>=MIN_MATCH)if(bflush=trees._tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){s.match_length--;do s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;while(--s.match_length!==0);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}}if(s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH){if(flush_block_only(s,!0),s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function deflate_slow(s,flush){var hash_head,bflush,max_insert;for(;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}if(hash_head=0,s.lookahead>=MIN_MATCH)s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;if(s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=MIN_MATCH-1,hash_head!==0&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD){if(s.match_length=longest_match(s,hash_head),s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&s.strstart-s.match_start>4096))s.match_length=MIN_MATCH-1}if(s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){max_insert=s.strstart+s.lookahead-MIN_MATCH,bflush=trees._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH),s.lookahead-=s.prev_length-1,s.prev_length-=2;do if(++s.strstart<=max_insert)s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;while(--s.prev_length!==0);if(s.match_available=0,s.match_length=MIN_MATCH-1,s.strstart++,bflush){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}}else if(s.match_available){if(bflush=trees._tr_tally(s,0,s.window[s.strstart-1]),bflush)flush_block_only(s,!1);if(s.strstart++,s.lookahead--,s.strm.avail_out===0)return BS_NEED_MORE}else s.match_available=1,s.strstart++,s.lookahead--}if(s.match_available)bflush=trees._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0;if(s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH){if(flush_block_only(s,!0),s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function deflate_rle(s,flush){var bflush,prev,scan,strend,_win=s.window;for(;;){if(s.lookahead<=MAX_MATCH){if(fill_window(s),s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=MIN_MATCH&&s.strstart>0){if(scan=s.strstart-1,prev=_win[scan],prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]){strend=s.strstart+MAX_MATCH;do;while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);if(s.match_length=MAX_MATCH-(strend-scan),s.match_length>s.lookahead)s.match_length=s.lookahead}}if(s.match_length>=MIN_MATCH)bflush=trees._tr_tally(s,1,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0;else bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}}if(s.insert=0,flush===Z_FINISH){if(flush_block_only(s,!0),s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function deflate_huff(s,flush){var bflush;for(;;){if(s.lookahead===0){if(fill_window(s),s.lookahead===0){if(flush===Z_NO_FLUSH)return BS_NEED_MORE;break}}if(s.match_length=0,bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,bflush){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}}if(s.insert=0,flush===Z_FINISH){if(flush_block_only(s,!0),s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){if(flush_block_only(s,!1),s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(s){s.window_size=2*s.w_size,zero(s.head),s.max_lazy_match=configuration_table[s.level].max_lazy,s.good_match=configuration_table[s.level].good_length,s.nice_match=configuration_table[s.level].nice_length,s.max_chain_length=configuration_table[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,s.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils.Buf16(MAX_BITS+1),this.heap=new utils.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(strm){var s;if(!strm||!strm.state)return err(strm,Z_STREAM_ERROR);if(strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN,s=strm.state,s.pending=0,s.pending_out=0,s.wrap<0)s.wrap=-s.wrap;return s.status=s.wrap?INIT_STATE:BUSY_STATE,strm.adler=s.wrap===2?0:1,s.last_flush=Z_NO_FLUSH,trees._tr_init(s),Z_OK}function deflateReset(strm){var ret=deflateResetKeep(strm);if(ret===Z_OK)lm_init(strm.state);return ret}function deflateSetHeader(strm,head){if(!strm||!strm.state)return Z_STREAM_ERROR;if(strm.state.wrap!==2)return Z_STREAM_ERROR;return strm.state.gzhead=head,Z_OK}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm)return Z_STREAM_ERROR;var wrap=1;if(level===Z_DEFAULT_COMPRESSION)level=6;if(windowBits<0)wrap=0,windowBits=-windowBits;else if(windowBits>15)wrap=2,windowBits-=16;if(memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED)return err(strm,Z_STREAM_ERROR);if(windowBits===8)windowBits=9;var s=new DeflateState;return strm.state=s,s.strm=strm,s.wrap=wrap,s.gzhead=null,s.w_bits=windowBits,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=memLevel+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH),s.window=new utils.Buf8(s.w_size*2),s.head=new utils.Buf16(s.hash_size),s.prev=new utils.Buf16(s.w_size),s.lit_bufsize=1<<memLevel+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new utils.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=level,s.strategy=strategy,s.method=method,deflateReset(strm)}function deflateInit(strm,level){return deflateInit2(strm,level,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)}function deflate(strm,flush){var old_flush,s,beg,val;if(!strm||!strm.state||flush>Z_BLOCK||flush<0)return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR;if(s=strm.state,!strm.output||!strm.input&&strm.avail_in!==0||s.status===FINISH_STATE&&flush!==Z_FINISH)return err(strm,strm.avail_out===0?Z_BUF_ERROR:Z_STREAM_ERROR);if(s.strm=strm,old_flush=s.last_flush,s.last_flush=flush,s.status===INIT_STATE)if(s.wrap===2)if(strm.adler=0,put_byte(s,31),put_byte(s,139),put_byte(s,8),!s.gzhead)put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,s.level===9?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,OS_CODE),s.status=BUSY_STATE;else{if(put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(!s.gzhead.extra?0:4)+(!s.gzhead.name?0:8)+(!s.gzhead.comment?0:16)),put_byte(s,s.gzhead.time&255),put_byte(s,s.gzhead.time>>8&255),put_byte(s,s.gzhead.time>>16&255),put_byte(s,s.gzhead.time>>24&255),put_byte(s,s.level===9?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length)put_byte(s,s.gzhead.extra.length&255),put_byte(s,s.gzhead.extra.length>>8&255);if(s.gzhead.hcrc)strm.adler=crc32(strm.adler,s.pending_buf,s.pending,0);s.gzindex=0,s.status=EXTRA_STATE}else{var header=Z_DEFLATED+(s.w_bits-8<<4)<<8,level_flags=-1;if(s.strategy>=Z_HUFFMAN_ONLY||s.level<2)level_flags=0;else if(s.level<6)level_flags=1;else if(s.level===6)level_flags=2;else level_flags=3;if(header|=level_flags<<6,s.strstart!==0)header|=PRESET_DICT;if(header+=31-header%31,s.status=BUSY_STATE,putShortMSB(s,header),s.strstart!==0)putShortMSB(s,strm.adler>>>16),putShortMSB(s,strm.adler&65535);strm.adler=1}if(s.status===EXTRA_STATE)if(s.gzhead.extra){beg=s.pending;while(s.gzindex<(s.gzhead.extra.length&65535)){if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)break}put_byte(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++}if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(s.gzindex===s.gzhead.extra.length)s.gzindex=0,s.status=NAME_STATE}else s.status=NAME_STATE;if(s.status===NAME_STATE)if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size){val=1;break}}if(s.gzindex<s.gzhead.name.length)val=s.gzhead.name.charCodeAt(s.gzindex++)&255;else val=0;put_byte(s,val)}while(val!==0);if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(val===0)s.gzindex=0,s.status=COMMENT_STATE}else s.status=COMMENT_STATE;if(s.status===COMMENT_STATE)if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size){val=1;break}}if(s.gzindex<s.gzhead.comment.length)val=s.gzhead.comment.charCodeAt(s.gzindex++)&255;else val=0;put_byte(s,val)}while(val!==0);if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(val===0)s.status=HCRC_STATE}else s.status=HCRC_STATE;if(s.status===HCRC_STATE)if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size)flush_pending(strm);if(s.pending+2<=s.pending_buf_size)put_byte(s,strm.adler&255),put_byte(s,strm.adler>>8&255),strm.adler=0,s.status=BUSY_STATE}else s.status=BUSY_STATE;if(s.pending!==0){if(flush_pending(strm),strm.avail_out===0)return s.last_flush=-1,Z_OK}else if(strm.avail_in===0&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH)return err(strm,Z_BUF_ERROR);if(s.status===FINISH_STATE&&strm.avail_in!==0)return err(strm,Z_BUF_ERROR);if(strm.avail_in!==0||s.lookahead!==0||flush!==Z_NO_FLUSH&&s.status!==FINISH_STATE){var bstate=s.strategy===Z_HUFFMAN_ONLY?deflate_huff(s,flush):s.strategy===Z_RLE?deflate_rle(s,flush):configuration_table[s.level].func(s,flush);if(bstate===BS_FINISH_STARTED||bstate===BS_FINISH_DONE)s.status=FINISH_STATE;if(bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED){if(strm.avail_out===0)s.last_flush=-1;return Z_OK}if(bstate===BS_BLOCK_DONE){if(flush===Z_PARTIAL_FLUSH)trees._tr_align(s);else if(flush!==Z_BLOCK){if(trees._tr_stored_block(s,0,0,!1),flush===Z_FULL_FLUSH){if(zero(s.head),s.lookahead===0)s.strstart=0,s.block_start=0,s.insert=0}}if(flush_pending(strm),strm.avail_out===0)return s.last_flush=-1,Z_OK}}if(flush!==Z_FINISH)return Z_OK;if(s.wrap<=0)return Z_STREAM_END;if(s.wrap===2)put_byte(s,strm.adler&255),put_byte(s,strm.adler>>8&255),put_byte(s,strm.adler>>16&255),put_byte(s,strm.adler>>24&255),put_byte(s,strm.total_in&255),put_byte(s,strm.total_in>>8&255),put_byte(s,strm.total_in>>16&255),put_byte(s,strm.total_in>>24&255);else putShortMSB(s,strm.adler>>>16),putShortMSB(s,strm.adler&65535);if(flush_pending(strm),s.wrap>0)s.wrap=-s.wrap;return s.pending!==0?Z_OK:Z_STREAM_END}function deflateEnd(strm){var status;if(!strm||!strm.state)return Z_STREAM_ERROR;if(status=strm.state.status,status!==INIT_STATE&&status!==EXTRA_STATE&&status!==NAME_STATE&&status!==COMMENT_STATE&&status!==HCRC_STATE&&status!==BUSY_STATE&&status!==FINISH_STATE)return err(strm,Z_STREAM_ERROR);return strm.state=null,status===BUSY_STATE?err(strm,Z_DATA_ERROR):Z_OK}function deflateSetDictionary(strm,dictionary){var dictLength=dictionary.length,s,str,n,wrap,avail,next2,input,tmpDict;if(!strm||!strm.state)return Z_STREAM_ERROR;if(s=strm.state,wrap=s.wrap,wrap===2||wrap===1&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR;if(wrap===1)strm.adler=adler32(strm.adler,dictionary,dictLength,0);if(s.wrap=0,dictLength>=s.w_size){if(wrap===0)zero(s.head),s.strstart=0,s.block_start=0,s.insert=0;tmpDict=new utils.Buf8(s.w_size),utils.arraySet(tmpDict,dictionary,dictLength-s.w_size,s.w_size,0),dictionary=tmpDict,dictLength=s.w_size}avail=strm.avail_in,next2=strm.next_in,input=strm.input,strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s);while(s.lookahead>=MIN_MATCH){str=s.strstart,n=s.lookahead-(MIN_MATCH-1);do s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++;while(--n);s.strstart=str,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,strm.next_in=next2,strm.input=input,strm.avail_in=avail,s.wrap=wrap,Z_OK}exports.deflateInit=deflateInit;exports.deflateInit2=deflateInit2;exports.deflateReset=deflateReset;exports.deflateResetKeep=deflateResetKeep;exports.deflateSetHeader=deflateSetHeader;exports.deflate=deflate;exports.deflateEnd=deflateEnd;exports.deflateSetDictionary=deflateSetDictionary;exports.deflateInfo="pako deflate (from Nodeca project)"});var require_strings=__commonJS((exports)=>{var utils=require_common(),STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}var _utf8len=new utils.Buf8(256);for(q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;var q;_utf8len[254]=_utf8len[254]=1;exports.string2buf=function(str){var buf,c,c2,m_pos,i2,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++){if(c=str.charCodeAt(m_pos),(c&64512)===55296&&m_pos+1<str_len){if(c2=str.charCodeAt(m_pos+1),(c2&64512)===56320)c=65536+(c-55296<<10)+(c2-56320),m_pos++}buf_len+=c<128?1:c<2048?2:c<65536?3:4}buf=new utils.Buf8(buf_len);for(i2=0,m_pos=0;i2<buf_len;m_pos++){if(c=str.charCodeAt(m_pos),(c&64512)===55296&&m_pos+1<str_len){if(c2=str.charCodeAt(m_pos+1),(c2&64512)===56320)c=65536+(c-55296<<10)+(c2-56320),m_pos++}if(c<128)buf[i2++]=c;else if(c<2048)buf[i2++]=192|c>>>6,buf[i2++]=128|c&63;else if(c<65536)buf[i2++]=224|c>>>12,buf[i2++]=128|c>>>6&63,buf[i2++]=128|c&63;else buf[i2++]=240|c>>>18,buf[i2++]=128|c>>>12&63,buf[i2++]=128|c>>>6&63,buf[i2++]=128|c&63}return buf};function buf2binstring(buf,len){if(len<65534){if(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK)return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len))}var result="";for(var i2=0;i2<len;i2++)result+=String.fromCharCode(buf[i2]);return result}exports.buf2binstring=function(buf){return buf2binstring(buf,buf.length)};exports.binstring2buf=function(str){var buf=new utils.Buf8(str.length);for(var i2=0,len=buf.length;i2<len;i2++)buf[i2]=str.charCodeAt(i2);return buf};exports.buf2string=function(buf,max){var i2,out,c,c_len,len=max||buf.length,utf16buf=new Array(len*2);for(out=0,i2=0;i2<len;){if(c=buf[i2++],c<128){utf16buf[out++]=c;continue}if(c_len=_utf8len[c],c_len>4){utf16buf[out++]=65533,i2+=c_len-1;continue}c&=c_len===2?31:c_len===3?15:7;while(c_len>1&&i2<len)c=c<<6|buf[i2++]&63,c_len--;if(c_len>1){utf16buf[out++]=65533;continue}if(c<65536)utf16buf[out++]=c;else c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|c&1023}return buf2binstring(utf16buf,out)};exports.utf8border=function(buf,max){var pos;if(max=max||buf.length,max>buf.length)max=buf.length;pos=max-1;while(pos>=0&&(buf[pos]&192)===128)pos--;if(pos<0)return max;if(pos===0)return max;return pos+_utf8len[buf[pos]]>max?pos:max}});var require_zstream=__commonJS((exports,module)=>{function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}module.exports=ZStream});var require_deflate2=__commonJS((exports)=>{var zlib_deflate=require_deflate(),utils=require_common(),strings=require_strings(),msg=require_messages(),ZStream=require_zstream(),toString=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH=4,Z_OK=0,Z_STREAM_END=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED=8;function Deflate(options){if(!(this instanceof Deflate))return new Deflate(options);this.options=utils.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},options||{});var opt=this.options;if(opt.raw&&opt.windowBits>0)opt.windowBits=-opt.windowBits;else if(opt.gzip&&opt.windowBits>0&&opt.windowBits<16)opt.windowBits+=16;this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_deflate.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK)throw new Error(msg[status]);if(opt.header)zlib_deflate.deflateSetHeader(this.strm,opt.header);if(opt.dictionary){var dict;if(typeof opt.dictionary==="string")dict=strings.string2buf(opt.dictionary);else if(toString.call(opt.dictionary)==="[object ArrayBuffer]")dict=new Uint8Array(opt.dictionary);else dict=opt.dictionary;if(status=zlib_deflate.deflateSetDictionary(this.strm,dict),status!==Z_OK)throw new Error(msg[status]);this._dict_set=!0}}Deflate.prototype.push=function(data,mode){var strm=this.strm,chunkSize=this.options.chunkSize,status,_mode;if(this.ended)return!1;if(_mode=mode===~~mode?mode:mode===!0?Z_FINISH:Z_NO_FLUSH,typeof data==="string")strm.input=strings.string2buf(data);else if(toString.call(data)==="[object ArrayBuffer]")strm.input=new Uint8Array(data);else strm.input=data;strm.next_in=0,strm.avail_in=strm.input.length;do{if(strm.avail_out===0)strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize;if(status=zlib_deflate.deflate(strm,_mode),status!==Z_STREAM_END&&status!==Z_OK)return this.onEnd(status),this.ended=!0,!1;if(strm.avail_out===0||strm.avail_in===0&&(_mode===Z_FINISH||_mode===Z_SYNC_FLUSH))if(this.options.to==="string")this.onData(strings.buf2binstring(utils.shrinkBuf(strm.output,strm.next_out)));else this.onData(utils.shrinkBuf(strm.output,strm.next_out))}while((strm.avail_in>0||strm.avail_out===0)&&status!==Z_STREAM_END);if(_mode===Z_FINISH)return status=zlib_deflate.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK;if(_mode===Z_SYNC_FLUSH)return this.onEnd(Z_OK),strm.avail_out=0,!0;return!0};Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)};Deflate.prototype.onEnd=function(status){if(status===Z_OK)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=utils.flattenChunks(this.chunks);this.chunks=[],this.err=status,this.msg=this.strm.msg};function deflate(input,options){var deflator=new Deflate(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||msg[deflator.err];return deflator.result}function deflateRaw(input,options){return options=options||{},options.raw=!0,deflate(input,options)}function gzip(input,options){return options=options||{},options.gzip=!0,deflate(input,options)}exports.Deflate=Deflate;exports.deflate=deflate;exports.deflateRaw=deflateRaw;exports.gzip=gzip});var require_inffast=__commonJS((exports,module)=>{var BAD=30,TYPE=12;module.exports=function inflate_fast(strm,start){var state,_in,last2,_out,beg,end,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;state=strm.state,_in=strm.next_in,input=strm.input,last2=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{if(bits<15)hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8;here=lcode[hold&lmask];dolen:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,op===0)output[_out++]=here&65535;else if(op&16){if(len=here&65535,op&=15,op){if(bits<op)hold+=input[_in++]<<bits,bits+=8;len+=hold&(1<<op)-1,hold>>>=op,bits-=op}if(bits<15)hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8;here=dcode[hold&dmask];dodist:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,op&16){if(dist=here&65535,op&=15,bits<op){if(hold+=input[_in++]<<bits,bits+=8,bits<op)hold+=input[_in++]<<bits,bits+=8}if(dist+=hold&(1<<op)-1,dist>dmax){strm.msg="invalid distance too far back",state.mode=BAD;break top}if(hold>>>=op,bits-=op,op=_out-beg,dist>op){if(op=dist-op,op>whave){if(state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break top}}if(from=0,from_source=s_window,wnext===0){if(from+=wsize-op,op<len){len-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,op-=wnext,op<len){len-=op;do output[_out++]=s_window[from++];while(--op);if(from=0,wnext<len){op=wnext,len-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){len-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist,from_source=output}while(len>2)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;if(len){if(output[_out++]=from_source[from++],len>1)output[_out++]=from_source[from++]}}else{from=_out-dist;do output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len-=3;while(len>2);if(len){if(output[_out++]=output[from++],len>1)output[_out++]=output[from++]}}}else if((op&64)===0){here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}else{strm.msg="invalid distance code",state.mode=BAD;break top}break}}else if((op&64)===0){here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}else if(op&32){state.mode=TYPE;break top}else{strm.msg="invalid literal/length code",state.mode=BAD;break top}break}}while(_in<last2&&_out<end);len=bits>>3,_in-=len,bits-=len<<3,hold&=(1<<bits)-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last2?5+(last2-_in):5-(_in-last2),strm.avail_out=_out<end?257+(end-_out):257-(_out-end),state.hold=hold,state.bits=bits;return}});var require_inftrees=__commonJS((exports,module)=>{var utils=require_common(),MAXBITS=15,ENOUGH_LENS=852,ENOUGH_DISTS=592,CODES=0,LENS=1,DISTS=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function inflate_table(type2,lens,lens_index,codes,table,table_index,work,opts){var bits=opts.bits,len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,incr,fill,low,mask2,next2,base=null,base_index=0,end,count2=new utils.Buf16(MAXBITS+1),offs=new utils.Buf16(MAXBITS+1),extra=null,extra_index=0,here_bits,here_op,here_val;for(len=0;len<=MAXBITS;len++)count2[len]=0;for(sym=0;sym<codes;sym++)count2[lens[lens_index+sym]]++;root=bits;for(max=MAXBITS;max>=1;max--)if(count2[max]!==0)break;if(root>max)root=max;if(max===0)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max;min++)if(count2[min]!==0)break;if(root<min)root=min;left=1;for(len=1;len<=MAXBITS;len++)if(left<<=1,left-=count2[len],left<0)return-1;if(left>0&&(type2===CODES||max!==1))return-1;offs[1]=0;for(len=1;len<MAXBITS;len++)offs[len+1]=offs[len]+count2[len];for(sym=0;sym<codes;sym++)if(lens[lens_index+sym]!==0)work[offs[lens[lens_index+sym]]++]=sym;if(type2===CODES)base=extra=work,end=19;else if(type2===LENS)base=lbase,base_index-=257,extra=lext,extra_index-=257,end=256;else base=dbase,extra=dext,end=-1;if(huff=0,sym=0,len=min,next2=table_index,curr=root,drop=0,low=-1,used=1<<root,mask2=used-1,type2===LENS&&used>ENOUGH_LENS||type2===DISTS&&used>ENOUGH_DISTS)return 1;for(;;){if(here_bits=len-drop,work[sym]<end)here_op=0,here_val=work[sym];else if(work[sym]>end)here_op=extra[extra_index+work[sym]],here_val=base[base_index+work[sym]];else here_op=96,here_val=0;incr=1<<len-drop,fill=1<<curr,min=fill;do fill-=incr,table[next2+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0;while(fill!==0);incr=1<<len-1;while(huff&incr)incr>>=1;if(incr!==0)huff&=incr-1,huff+=incr;else huff=0;if(sym++,--count2[len]===0){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask2)!==low){if(drop===0)drop=root;next2+=min,curr=len-drop,left=1<<curr;while(curr+drop<max){if(left-=count2[curr+drop],left<=0)break;curr++,left<<=1}if(used+=1<<curr,type2===LENS&&used>ENOUGH_LENS||type2===DISTS&&used>ENOUGH_DISTS)return 1;low=huff&mask2,table[low]=root<<24|curr<<16|next2-table_index|0}}if(huff!==0)table[next2+huff]=len-drop<<24|4194304|0;return opts.bits=root,0}});var require_inflate=__commonJS((exports)=>{var utils=require_common(),adler32=require_adler32(),crc32=require_crc32(),inflate_fast=require_inffast(),inflate_table=require_inftrees(),CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME2=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((q&65280)<<8)+((q&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils.Buf16(320),this.work=new utils.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(strm){var state;if(!strm||!strm.state)return Z_STREAM_ERROR;if(state=strm.state,strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap)strm.adler=state.wrap&1;return state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new utils.Buf32(ENOUGH_LENS),state.distcode=state.distdyn=new utils.Buf32(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK}function inflateReset(strm){var state;if(!strm||!strm.state)return Z_STREAM_ERROR;return state=strm.state,state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)}function inflateReset2(strm,windowBits){var wrap,state;if(!strm||!strm.state)return Z_STREAM_ERROR;if(state=strm.state,windowBits<0)wrap=0,windowBits=-windowBits;else if(wrap=(windowBits>>4)+1,windowBits<48)windowBits&=15;if(windowBits&&(windowBits<8||windowBits>15))return Z_STREAM_ERROR;if(state.window!==null&&state.wbits!==windowBits)state.window=null;return state.wrap=wrap,state.wbits=windowBits,inflateReset(strm)}function inflateInit2(strm,windowBits){var ret,state;if(!strm)return Z_STREAM_ERROR;if(state=new InflateState,strm.state=state,state.window=null,ret=inflateReset2(strm,windowBits),ret!==Z_OK)strm.state=null;return ret}function inflateInit(strm){return inflateInit2(strm,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(state){if(virgin){var sym;lenfix=new utils.Buf32(512),distfix=new utils.Buf32(32),sym=0;while(sym<144)state.lens[sym++]=8;while(sym<256)state.lens[sym++]=9;while(sym<280)state.lens[sym++]=7;while(sym<288)state.lens[sym++]=8;inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;while(sym<32)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5}function updatewindow(strm,src,end,copy){var dist,state=strm.state;if(state.window===null)state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new utils.Buf8(state.wsize);if(copy>=state.wsize)utils.arraySet(state.window,src,end-state.wsize,state.wsize,0),state.wnext=0,state.whave=state.wsize;else{if(dist=state.wsize-state.wnext,dist>copy)dist=copy;if(utils.arraySet(state.window,src,end-copy,dist,state.wnext),copy-=dist,copy)utils.arraySet(state.window,src,end-copy,copy,0),state.wnext=copy,state.whave=state.wsize;else{if(state.wnext+=dist,state.wnext===state.wsize)state.wnext=0;if(state.whave<state.wsize)state.whave+=dist}}return 0}function inflate(strm,flush){var state,input,output,next2,put,have,left,hold,bits,_in,_out,copy,from,from_source,here=0,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret,hbuf=new utils.Buf8(4),opts,n,order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&strm.avail_in!==0)return Z_STREAM_ERROR;if(state=strm.state,state.mode===TYPE)state.mode=TYPEDO;put=strm.next_out,output=strm.output,left=strm.avail_out,next2=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(state.wrap===0){state.mode=TYPEDO;break}while(bits<16){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(state.wrap&2&&hold===35615){state.check=0,hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0),hold=0,bits=0,state.mode=FLAGS;break}if(state.flags=0,state.head)state.head.done=!1;if(!(state.wrap&1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(hold>>>=4,bits-=4,len=(hold&15)+8,state.wbits===0)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size",state.mode=BAD;break}state.dmax=1<<len,strm.adler=state.check=1,state.mode=hold&512?DICTID:TYPE,hold=0,bits=0;break;case FLAGS:while(bits<16){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(state.flags=hold,(state.flags&255)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(state.flags&57344){strm.msg="unknown header flags set",state.mode=BAD;break}if(state.head)state.head.text=hold>>8&1;if(state.flags&512)hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0);hold=0,bits=0,state.mode=TIME2;case TIME2:while(bits<32){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(state.head)state.head.time=hold;if(state.flags&512)hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32(state.check,hbuf,4,0);hold=0,bits=0,state.mode=OS;case OS:while(bits<16){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(state.head)state.head.xflags=hold&255,state.head.os=hold>>8;if(state.flags&512)hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0);hold=0,bits=0,state.mode=EXLEN;case EXLEN:if(state.flags&1024){while(bits<16){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(state.length=hold,state.head)state.head.extra_len=hold;if(state.flags&512)hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0);hold=0,bits=0}else if(state.head)state.head.extra=null;state.mode=EXTRA;case EXTRA:if(state.flags&1024){if(copy=state.length,copy>have)copy=have;if(copy){if(state.head){if(len=state.head.extra_len-state.length,!state.head.extra)state.head.extra=new Array(state.head.extra_len);utils.arraySet(state.head.extra,input,next2,copy,len)}if(state.flags&512)state.check=crc32(state.check,input,copy,next2);have-=copy,next2+=copy,state.length-=copy}if(state.length)break inf_leave}state.length=0,state.mode=NAME;case NAME:if(state.flags&2048){if(have===0)break inf_leave;copy=0;do if(len=input[next2+copy++],state.head&&len&&state.length<65536)state.head.name+=String.fromCharCode(len);while(len&&copy<have);if(state.flags&512)state.check=crc32(state.check,input,copy,next2);if(have-=copy,next2+=copy,len)break inf_leave}else if(state.head)state.head.name=null;state.length=0,state.mode=COMMENT;case COMMENT:if(state.flags&4096){if(have===0)break inf_leave;copy=0;do if(len=input[next2+copy++],state.head&&len&&state.length<65536)state.head.comment+=String.fromCharCode(len);while(len&&copy<have);if(state.flags&512)state.check=crc32(state.check,input,copy,next2);if(have-=copy,next2+=copy,len)break inf_leave}else if(state.head)state.head.comment=null;state.mode=HCRC;case HCRC:if(state.flags&512){while(bits<16){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(hold!==(state.check&65535)){strm.msg="header crc mismatch",state.mode=BAD;break}hold=0,bits=0}if(state.head)state.head.hcrc=state.flags>>9&1,state.head.done=!0;strm.adler=state.check=0,state.mode=TYPE;break;case DICTID:while(bits<32){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=DICT;case DICT:if(state.havedict===0)return strm.next_out=put,strm.avail_out=left,strm.next_in=next2,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT;strm.adler=state.check=1,state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=bits&7,bits-=bits&7,state.mode=CHECK;break}while(bits<3){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}switch(state.last=hold&1,hold>>>=1,bits-=1,hold&3){case 0:state.mode=STORED;break;case 1:if(fixedtables(state),state.mode=LEN_,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg="invalid block type",state.mode=BAD}hold>>>=2,bits-=2;break;case STORED:hold>>>=bits&7,bits-=bits&7;while(bits<32){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if((hold&65535)!==(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=BAD;break}if(state.length=hold&65535,hold=0,bits=0,state.mode=COPY_,flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:if(copy=state.length,copy){if(copy>have)copy=have;if(copy>left)copy=left;if(copy===0)break inf_leave;utils.arraySet(output,input,next2,copy,put),have-=copy,next2+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=TYPE;break;case TABLE:while(bits<14){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(state.nlen=(hold&31)+257,hold>>>=5,bits-=5,state.ndist=(hold&31)+1,hold>>>=5,bits-=5,state.ncode=(hold&15)+4,hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols",state.mode=BAD;break}state.have=0,state.mode=LENLENS;case LENLENS:while(state.have<state.ncode){while(bits<3){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}state.lens[order[state.have++]]=hold&7,hold>>>=3,bits-=3}while(state.have<19)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inflate_table(CODES,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=BAD;break}state.have=0,state.mode=CODELENS;case CODELENS:while(state.have<state.nlen+state.ndist){for(;;){if(here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,here_bits<=bits)break;if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(here_val===16){n=here_bits+2;while(bits<n){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,state.have===0){strm.msg="invalid bit length repeat",state.mode=BAD;break}len=state.lens[state.have-1],copy=3+(hold&3),hold>>>=2,bits-=2}else if(here_val===17){n=here_bits+3;while(bits<n){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=3+(hold&7),hold>>>=3,bits-=3}else{n=here_bits+7;while(bits<n){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=11+(hold&127),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=BAD;break}while(copy--)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(state.lens[256]===0){strm.msg="invalid code -- missing end-of-block",state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=BAD;break}if(state.mode=LEN_,flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){if(strm.next_out=put,strm.avail_out=left,strm.next_in=next2,strm.avail_in=have,state.hold=hold,state.bits=bits,inflate_fast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next2=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,state.mode===TYPE)state.back=-1;break}state.back=0;for(;;){if(here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,here_bits<=bits)break;if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(here_op&&(here_op&240)===0){last_bits=here_bits,last_op=here_op,last_val=here_val;for(;;){if(here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,last_bits+here_bits<=bits)break;if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,here_op===0){state.mode=LIT;break}if(here_op&32){state.back=-1,state.mode=TYPE;break}if(here_op&64){strm.msg="invalid literal/length code",state.mode=BAD;break}state.extra=here_op&15,state.mode=LENEXT;case LENEXT:if(state.extra){n=state.extra;while(bits<n){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=DIST;case DIST:for(;;){if(here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,here_bits<=bits)break;if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if((here_op&240)===0){last_bits=here_bits,last_op=here_op,last_val=here_val;for(;;){if(here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,last_bits+here_bits<=bits)break;if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,here_op&64){strm.msg="invalid distance code",state.mode=BAD;break}state.offset=here_val,state.extra=here_op&15,state.mode=DISTEXT;case DISTEXT:if(state.extra){n=state.extra;while(bits<n){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=BAD;break}state.mode=MATCH;case MATCH:if(left===0)break inf_leave;if(copy=_out-left,state.offset>copy){if(copy=state.offset-copy,copy>state.whave){if(state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break}}if(copy>state.wnext)copy-=state.wnext,from=state.wsize-copy;else from=state.wnext-copy;if(copy>state.length)copy=state.length;from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;if(copy>left)copy=left;left-=copy,state.length-=copy;do output[put++]=from_source[from++];while(--copy);if(state.length===0)state.mode=LEN;break;case LIT:if(left===0)break inf_leave;output[put++]=state.length,left--,state.mode=LEN;break;case CHECK:if(state.wrap){while(bits<32){if(have===0)break inf_leave;have--,hold|=input[next2++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out)strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out);if(_out=left,(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=BAD;break}hold=0,bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){while(bits<32){if(have===0)break inf_leave;have--,hold+=input[next2++]<<bits,bits+=8}if(hold!==(state.total&4294967295)){strm.msg="incorrect length check",state.mode=BAD;break}hold=0,bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}if(strm.next_out=put,strm.avail_out=left,strm.next_in=next2,strm.avail_in=have,state.hold=hold,state.bits=bits,state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH)){if(updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out))return state.mode=MEM,Z_MEM_ERROR}if(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out)strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out);if(strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0),(_in===0&&_out===0||flush===Z_FINISH)&&ret===Z_OK)ret=Z_BUF_ERROR;return ret}function inflateEnd(strm){if(!strm||!strm.state)return Z_STREAM_ERROR;var state=strm.state;if(state.window)state.window=null;return strm.state=null,Z_OK}function inflateGetHeader(strm,head){var state;if(!strm||!strm.state)return Z_STREAM_ERROR;if(state=strm.state,(state.wrap&2)===0)return Z_STREAM_ERROR;return state.head=head,head.done=!1,Z_OK}function inflateSetDictionary(strm,dictionary){var dictLength=dictionary.length,state,dictid,ret;if(!strm||!strm.state)return Z_STREAM_ERROR;if(state=strm.state,state.wrap!==0&&state.mode!==DICT)return Z_STREAM_ERROR;if(state.mode===DICT){if(dictid=1,dictid=adler32(dictid,dictionary,dictLength,0),dictid!==state.check)return Z_DATA_ERROR}if(ret=updatewindow(strm,dictionary,dictLength,dictLength),ret)return state.mode=MEM,Z_MEM_ERROR;return state.havedict=1,Z_OK}exports.inflateReset=inflateReset;exports.inflateReset2=inflateReset2;exports.inflateResetKeep=inflateResetKeep;exports.inflateInit=inflateInit;exports.inflateInit2=inflateInit2;exports.inflate=inflate;exports.inflateEnd=inflateEnd;exports.inflateGetHeader=inflateGetHeader;exports.inflateSetDictionary=inflateSetDictionary;exports.inflateInfo="pako inflate (from Nodeca project)"});var require_constants3=__commonJS((exports,module)=>{module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var require_gzheader=__commonJS((exports,module)=>{function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}module.exports=GZheader});var require_inflate2=__commonJS((exports)=>{var zlib_inflate=require_inflate(),utils=require_common(),strings=require_strings(),c=require_constants3(),msg=require_messages(),ZStream=require_zstream(),GZheader=require_gzheader(),toString=Object.prototype.toString;function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;if(opt.raw&&opt.windowBits>=0&&opt.windowBits<16){if(opt.windowBits=-opt.windowBits,opt.windowBits===0)opt.windowBits=-15}if(opt.windowBits>=0&&opt.windowBits<16&&!(options&&options.windowBits))opt.windowBits+=32;if(opt.windowBits>15&&opt.windowBits<48){if((opt.windowBits&15)===0)opt.windowBits|=15}this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK)throw new Error(msg[status]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),opt.dictionary){if(typeof opt.dictionary==="string")opt.dictionary=strings.string2buf(opt.dictionary);else if(toString.call(opt.dictionary)==="[object ArrayBuffer]")opt.dictionary=new Uint8Array(opt.dictionary);if(opt.raw){if(status=zlib_inflate.inflateSetDictionary(this.strm,opt.dictionary),status!==c.Z_OK)throw new Error(msg[status])}}}Inflate.prototype.push=function(data,mode){var strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary,status,_mode,next_out_utf8,tail,utf8str,allowBufError=!1;if(this.ended)return!1;if(_mode=mode===~~mode?mode:mode===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof data==="string")strm.input=strings.binstring2buf(data);else if(toString.call(data)==="[object ArrayBuffer]")strm.input=new Uint8Array(data);else strm.input=data;strm.next_in=0,strm.avail_in=strm.input.length;do{if(strm.avail_out===0)strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize;if(status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH),status===c.Z_NEED_DICT&&dictionary)status=zlib_inflate.inflateSetDictionary(this.strm,dictionary);if(status===c.Z_BUF_ERROR&&allowBufError===!0)status=c.Z_OK,allowBufError=!1;if(status!==c.Z_STREAM_END&&status!==c.Z_OK)return this.onEnd(status),this.ended=!0,!1;if(strm.next_out){if(strm.avail_out===0||status===c.Z_STREAM_END||strm.avail_in===0&&(_mode===c.Z_FINISH||_mode===c.Z_SYNC_FLUSH))if(this.options.to==="string"){if(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail)utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0);this.onData(utf8str)}else this.onData(utils.shrinkBuf(strm.output,strm.next_out))}if(strm.avail_in===0&&strm.avail_out===0)allowBufError=!0}while((strm.avail_in>0||strm.avail_out===0)&&status!==c.Z_STREAM_END);if(status===c.Z_STREAM_END)_mode=c.Z_FINISH;if(_mode===c.Z_FINISH)return status=zlib_inflate.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===c.Z_OK;if(_mode===c.Z_SYNC_FLUSH)return this.onEnd(c.Z_OK),strm.avail_out=0,!0;return!0};Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)};Inflate.prototype.onEnd=function(status){if(status===c.Z_OK)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=utils.flattenChunks(this.chunks);this.chunks=[],this.err=status,this.msg=this.strm.msg};function inflate(input,options){var inflator=new Inflate(options);if(inflator.push(input,!0),inflator.err)throw inflator.msg||msg[inflator.err];return inflator.result}function inflateRaw(input,options){return options=options||{},options.raw=!0,inflate(input,options)}exports.Inflate=Inflate;exports.inflate=inflate;exports.inflateRaw=inflateRaw;exports.ungzip=inflate});var require_pako=__commonJS((exports,module)=>{var assign=require_common().assign,deflate=require_deflate2(),inflate=require_inflate2(),constants=require_constants3(),pako={};assign(pako,deflate,inflate,constants);module.exports=pako});var require_format=__commonJS((exports,module)=>{var idRegex=/^[a-z0-9-]{1,32}$/,nameRegex=/^[a-z0-9-]{1,32}$/,valueRegex=/^[a-zA-Z0-9/+.-]+$/,b64Regex=/^([a-zA-Z0-9/+.-]+|)$/,decimalRegex=/^((-)?[1-9]\d*|0)$/,versionRegex=/^v=(\d+)$/;function objToKeyVal(obj){return objectKeys(obj).map((k2)=>[k2,obj[k2]].join("=")).join(",")}function keyValtoObj(str){let obj={};return str.split(",").forEach((ps)=>{let pss=ps.split("=");if(pss.length<2)throw new TypeError("params must be in the format name=value");obj[pss.shift()]=pss.join("=")}),obj}function objectKeys(object){return Object.keys(object)}function objectValues(object){if(typeof Object.values==="function")return Object.values(object);return objectKeys(object).map((k2)=>object[k2])}function serialize2(opts){let fields=[""];if(typeof opts!=="object"||opts===null)throw new TypeError("opts must be an object");if(typeof opts.id!=="string")throw new TypeError("id must be a string");if(!idRegex.test(opts.id))throw new TypeError(`id must satisfy ${idRegex}`);if(fields.push(opts.id),typeof opts.version!=="undefined"){if(typeof opts.version!=="number"||opts.version<0||!Number.isInteger(opts.version))throw new TypeError("version must be a positive integer number");fields.push(`v=${opts.version}`)}if(typeof opts.params!=="undefined"){if(typeof opts.params!=="object"||opts.params===null)throw new TypeError("params must be an object");let pk=objectKeys(opts.params);if(!pk.every((p)=>nameRegex.test(p)))throw new TypeError(`params names must satisfy ${nameRegex}`);pk.forEach((k2)=>{if(typeof opts.params[k2]==="number")opts.params[k2]=opts.params[k2].toString();else if(Buffer.isBuffer(opts.params[k2]))opts.params[k2]=opts.params[k2].toString("base64").split("=")[0]});let pv=objectValues(opts.params);if(!pv.every((v)=>typeof v==="string"))throw new TypeError("params values must be strings");if(!pv.every((v)=>valueRegex.test(v)))throw new TypeError(`params values must satisfy ${valueRegex}`);let strpar=objToKeyVal(opts.params);fields.push(strpar)}if(typeof opts.salt!=="undefined"){if(!Buffer.isBuffer(opts.salt))throw new TypeError("salt must be a Buffer");if(fields.push(opts.salt.toString("base64").split("=")[0]),typeof opts.hash!=="undefined"){if(!Buffer.isBuffer(opts.hash))throw new TypeError("hash must be a Buffer");fields.push(opts.hash.toString("base64").split("=")[0])}}return fields.join("$")}function deserialize(phcstr){if(typeof phcstr!=="string"||phcstr==="")throw new TypeError("pchstr must be a non-empty string");if(phcstr[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let fields=phcstr.split("$");fields.shift();let maxf=5;if(!versionRegex.test(fields[1]))maxf--;if(fields.length>maxf)throw new TypeError(`pchstr contains too many fileds: ${fields.length}/${maxf}`);let id=fields.shift();if(!idRegex.test(id))throw new TypeError(`id must satisfy ${idRegex}`);let version2;if(versionRegex.test(fields[0]))version2=parseInt(fields.shift().match(versionRegex)[1],10);let hash2,salt;if(b64Regex.test(fields[fields.length-1]))if(fields.length>1&&b64Regex.test(fields[fields.length-2]))hash2=Buffer.from(fields.pop(),"base64"),salt=Buffer.from(fields.pop(),"base64");else salt=Buffer.from(fields.pop(),"base64");let params;if(fields.length>0){let parstr=fields.pop();if(params=keyValtoObj(parstr),!objectKeys(params).every((p)=>nameRegex.test(p)))throw new TypeError(`params names must satisfy ${nameRegex}`);if(!objectValues(params).every((v)=>valueRegex.test(v)))throw new TypeError(`params values must satisfy ${valueRegex}`);objectKeys(params).forEach((k2)=>{params[k2]=decimalRegex.test(params[k2])?parseInt(params[k2],10):params[k2]})}if(fields.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${fields}`);let phcobj={id};if(version2)phcobj.version=version2;if(params)phcobj.params=params;if(salt)phcobj.salt=salt;if(hash2)phcobj.hash=hash2;return phcobj}module.exports={serialize:serialize2,deserialize}});var require_node_gyp_build=__commonJS((exports,module)=>{var fs4=__require("fs"),path2=__require("path"),os2=__require("os"),runtimeRequire=typeof __webpack_require__==="function"?__non_webpack_require__:__require,vars=process.config&&process.config.variables||{},prebuildsOnly=!!process.env.PREBUILDS_ONLY,abi=process.versions.modules,runtime=isElectron()?"electron":isNwjs()?"node-webkit":"node",arch=process.env.npm_config_arch||os2.arch(),platform=process.env.npm_config_platform||os2.platform(),libc=process.env.LIBC||(isAlpine(platform)?"musl":"glibc"),armv=process.env.ARM_VERSION||(arch==="arm64"?"8":vars.arm_version)||"",uv=(process.versions.uv||"").split(".")[0];module.exports=load;function load(dir){return runtimeRequire(load.resolve(dir))}load.resolve=load.path=function(dir){dir=path2.resolve(dir||".");try{var name=runtimeRequire(path2.join(dir,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[name+"_PREBUILD"])dir=process.env[name+"_PREBUILD"]}catch(err){}if(!prebuildsOnly){var release=getFirst(path2.join(dir,"build/Release"),matchBuild);if(release)return release;var debug=getFirst(path2.join(dir,"build/Debug"),matchBuild);if(debug)return debug}var prebuild=resolve(dir);if(prebuild)return prebuild;var nearby=resolve(path2.dirname(process.execPath));if(nearby)return nearby;var target=["platform="+platform,"arch="+arch,"runtime="+runtime,"abi="+abi,"uv="+uv,armv?"armv="+armv:"","libc="+libc,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+target+`
    loaded from: `+dir+`
`);function resolve(dir2){var tuples2=readdirSync(path2.join(dir2,"prebuilds")).map(parseTuple),tuple=tuples2.filter(matchTuple(platform,arch)).sort(compareTuples)[0];if(!tuple)return;var prebuilds=path2.join(dir2,"prebuilds",tuple.name),parsed=readdirSync(prebuilds).map(parseTags),candidates=parsed.filter(matchTags(runtime,abi)),winner=candidates.sort(compareTags(runtime))[0];if(winner)return path2.join(prebuilds,winner.file)}};function readdirSync(dir){try{return fs4.readdirSync(dir)}catch(err){return[]}}function getFirst(dir,filter){var files=readdirSync(dir).filter(filter);return files[0]&&path2.join(dir,files[0])}function matchBuild(name){return/\.node$/.test(name)}function parseTuple(name){var arr=name.split("-");if(arr.length!==2)return;var platform2=arr[0],architectures=arr[1].split("+");if(!platform2)return;if(!architectures.length)return;if(!architectures.every(Boolean))return;return{name,platform:platform2,architectures}}function matchTuple(platform2,arch2){return function(tuple){if(tuple==null)return!1;if(tuple.platform!==platform2)return!1;return tuple.architectures.includes(arch2)}}function compareTuples(a,b2){return a.architectures.length-b2.architectures.length}function parseTags(file){var arr=file.split("."),extension=arr.pop(),tags={file,specificity:0};if(extension!=="node")return;for(var i3=0;i3<arr.length;i3++){var tag=arr[i3];if(tag==="node"||tag==="electron"||tag==="node-webkit")tags.runtime=tag;else if(tag==="napi")tags.napi=!0;else if(tag.slice(0,3)==="abi")tags.abi=tag.slice(3);else if(tag.slice(0,2)==="uv")tags.uv=tag.slice(2);else if(tag.slice(0,4)==="armv")tags.armv=tag.slice(4);else if(tag==="glibc"||tag==="musl")tags.libc=tag;else continue;tags.specificity++}return tags}function matchTags(runtime2,abi2){return function(tags){if(tags==null)return!1;if(tags.runtime&&tags.runtime!==runtime2&&!runtimeAgnostic(tags))return!1;if(tags.abi&&tags.abi!==abi2&&!tags.napi)return!1;if(tags.uv&&tags.uv!==uv)return!1;if(tags.armv&&tags.armv!==armv)return!1;if(tags.libc&&tags.libc!==libc)return!1;return!0}}function runtimeAgnostic(tags){return tags.runtime==="node"&&tags.napi}function compareTags(runtime2){return function(a,b2){if(a.runtime!==b2.runtime)return a.runtime===runtime2?-1:1;else if(a.abi!==b2.abi)return a.abi?-1:1;else if(a.specificity!==b2.specificity)return a.specificity>b2.specificity?-1:1;else return 0}}function isNwjs(){return!!(process.versions&&process.versions.nw)}function isElectron(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function isAlpine(platform2){return platform2==="linux"&&fs4.existsSync("/etc/alpine-release")}load.parseTags=parseTags;load.matchTags=matchTags;load.compareTags=compareTags;load.parseTuple=parseTuple;load.matchTuple=matchTuple;load.compareTuples=compareTuples});var require_node_gyp_build2=__commonJS((exports,module)=>{var runtimeRequire=typeof __webpack_require__==="function"?__non_webpack_require__:__require;if(typeof runtimeRequire.addon==="function")module.exports=runtimeRequire.addon.bind(runtimeRequire);else module.exports=require_node_gyp_build()});var require_argon2=__commonJS((exports,module)=>{var __dirname="/home/twahir/Desktop/PosTech/server/node_modules/argon2",assert2=__require("assert"),{randomBytes,timingSafeEqual}=__require("crypto"),{promisify}=__require("util"),{deserialize,serialize:serialize2}=require_format(),gypBuild=require_node_gyp_build2(),{hash:bindingsHash}=gypBuild(__dirname),generateSalt=promisify(randomBytes);exports.argon2d=0;exports.argon2i=1;exports.argon2id=2;var types4=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),names=Object.freeze({[types4.argon2d]:"argon2d",[types4.argon2i]:"argon2i",[types4.argon2id]:"argon2id"}),defaults=Object.freeze({hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19}),limits=Object.freeze({hashLength:{min:4,max:4294967295},memoryCost:{min:1024,max:4294967295},timeCost:{min:2,max:4294967295},parallelism:{min:1,max:16777215}});exports.limits=limits;async function hash2(password,options){let{raw,salt,...rest}={...defaults,...options};for(let[key,{min,max}]of Object.entries(limits)){let value=rest[key];assert2(min<=value&&value<=max,`Invalid ${key}, must be between ${min} and ${max}.`)}salt=salt??await generateSalt(16);let{hashLength,secret=Buffer.alloc(0),type:type2,version:version2,memoryCost:m,timeCost:t2,parallelism:p,associatedData:data=Buffer.alloc(0)}=rest,hash3=await bindingsHash({password:Buffer.from(password),salt,secret,data,hashLength,m,t:t2,p,version:version2,type:type2});if(raw)return hash3;return serialize2({id:names[type2],version:version2,params:{m,t:t2,p,...data.byteLength>0?{data}:{}},salt,hash:hash3})}exports.hash=hash2;function needsRehash(digest,options={}){let{memoryCost,timeCost,version:version2}={...defaults,...options},{version:v,params:{m,t:t2}}=deserialize(digest);return+v!==+version2||+m!==+memoryCost||+t2!==+timeCost}exports.needsRehash=needsRehash;async function verify2(digest,password,options={}){let{id,...rest}=deserialize(digest);if(!(id in types4))return!1;let{version:version2=16,params:{m,t:t2,p,data=""},salt,hash:hash3}=rest,{secret=Buffer.alloc(0)}=options;return timingSafeEqual(await bindingsHash({password:Buffer.from(password),salt,secret,data:Buffer.from(data,"base64"),hashLength:hash3.byteLength,m:+m,t:+t2,p:+p,version:+version2,type:types4[id]}),hash3)}exports.verify=verify2});var require_default=__commonJS((exports)=>{function getDefaultWhiteList(){var whiteList={};return whiteList["align-content"]=!1,whiteList["align-items"]=!1,whiteList["align-self"]=!1,whiteList["alignment-adjust"]=!1,whiteList["alignment-baseline"]=!1,whiteList.all=!1,whiteList["anchor-point"]=!1,whiteList.animation=!1,whiteList["animation-delay"]=!1,whiteList["animation-direction"]=!1,whiteList["animation-duration"]=!1,whiteList["animation-fill-mode"]=!1,whiteList["animation-iteration-count"]=!1,whiteList["animation-name"]=!1,whiteList["animation-play-state"]=!1,whiteList["animation-timing-function"]=!1,whiteList.azimuth=!1,whiteList["backface-visibility"]=!1,whiteList.background=!0,whiteList["background-attachment"]=!0,whiteList["background-clip"]=!0,whiteList["background-color"]=!0,whiteList["background-image"]=!0,whiteList["background-origin"]=!0,whiteList["background-position"]=!0,whiteList["background-repeat"]=!0,whiteList["background-size"]=!0,whiteList["baseline-shift"]=!1,whiteList.binding=!1,whiteList.bleed=!1,whiteList["bookmark-label"]=!1,whiteList["bookmark-level"]=!1,whiteList["bookmark-state"]=!1,whiteList.border=!0,whiteList["border-bottom"]=!0,whiteList["border-bottom-color"]=!0,whiteList["border-bottom-left-radius"]=!0,whiteList["border-bottom-right-radius"]=!0,whiteList["border-bottom-style"]=!0,whiteList["border-bottom-width"]=!0,whiteList["border-collapse"]=!0,whiteList["border-color"]=!0,whiteList["border-image"]=!0,whiteList["border-image-outset"]=!0,whiteList["border-image-repeat"]=!0,whiteList["border-image-slice"]=!0,whiteList["border-image-source"]=!0,whiteList["border-image-width"]=!0,whiteList["border-left"]=!0,whiteList["border-left-color"]=!0,whiteList["border-left-style"]=!0,whiteList["border-left-width"]=!0,whiteList["border-radius"]=!0,whiteList["border-right"]=!0,whiteList["border-right-color"]=!0,whiteList["border-right-style"]=!0,whiteList["border-right-width"]=!0,whiteList["border-spacing"]=!0,whiteList["border-style"]=!0,whiteList["border-top"]=!0,whiteList["border-top-color"]=!0,whiteList["border-top-left-radius"]=!0,whiteList["border-top-right-radius"]=!0,whiteList["border-top-style"]=!0,whiteList["border-top-width"]=!0,whiteList["border-width"]=!0,whiteList.bottom=!1,whiteList["box-decoration-break"]=!0,whiteList["box-shadow"]=!0,whiteList["box-sizing"]=!0,whiteList["box-snap"]=!0,whiteList["box-suppress"]=!0,whiteList["break-after"]=!0,whiteList["break-before"]=!0,whiteList["break-inside"]=!0,whiteList["caption-side"]=!1,whiteList.chains=!1,whiteList.clear=!0,whiteList.clip=!1,whiteList["clip-path"]=!1,whiteList["clip-rule"]=!1,whiteList.color=!0,whiteList["color-interpolation-filters"]=!0,whiteList["column-count"]=!1,whiteList["column-fill"]=!1,whiteList["column-gap"]=!1,whiteList["column-rule"]=!1,whiteList["column-rule-color"]=!1,whiteList["column-rule-style"]=!1,whiteList["column-rule-width"]=!1,whiteList["column-span"]=!1,whiteList["column-width"]=!1,whiteList.columns=!1,whiteList.contain=!1,whiteList.content=!1,whiteList["counter-increment"]=!1,whiteList["counter-reset"]=!1,whiteList["counter-set"]=!1,whiteList.crop=!1,whiteList.cue=!1,whiteList["cue-after"]=!1,whiteList["cue-before"]=!1,whiteList.cursor=!1,whiteList.direction=!1,whiteList.display=!0,whiteList["display-inside"]=!0,whiteList["display-list"]=!0,whiteList["display-outside"]=!0,whiteList["dominant-baseline"]=!1,whiteList.elevation=!1,whiteList["empty-cells"]=!1,whiteList.filter=!1,whiteList.flex=!1,whiteList["flex-basis"]=!1,whiteList["flex-direction"]=!1,whiteList["flex-flow"]=!1,whiteList["flex-grow"]=!1,whiteList["flex-shrink"]=!1,whiteList["flex-wrap"]=!1,whiteList.float=!1,whiteList["float-offset"]=!1,whiteList["flood-color"]=!1,whiteList["flood-opacity"]=!1,whiteList["flow-from"]=!1,whiteList["flow-into"]=!1,whiteList.font=!0,whiteList["font-family"]=!0,whiteList["font-feature-settings"]=!0,whiteList["font-kerning"]=!0,whiteList["font-language-override"]=!0,whiteList["font-size"]=!0,whiteList["font-size-adjust"]=!0,whiteList["font-stretch"]=!0,whiteList["font-style"]=!0,whiteList["font-synthesis"]=!0,whiteList["font-variant"]=!0,whiteList["font-variant-alternates"]=!0,whiteList["font-variant-caps"]=!0,whiteList["font-variant-east-asian"]=!0,whiteList["font-variant-ligatures"]=!0,whiteList["font-variant-numeric"]=!0,whiteList["font-variant-position"]=!0,whiteList["font-weight"]=!0,whiteList.grid=!1,whiteList["grid-area"]=!1,whiteList["grid-auto-columns"]=!1,whiteList["grid-auto-flow"]=!1,whiteList["grid-auto-rows"]=!1,whiteList["grid-column"]=!1,whiteList["grid-column-end"]=!1,whiteList["grid-column-start"]=!1,whiteList["grid-row"]=!1,whiteList["grid-row-end"]=!1,whiteList["grid-row-start"]=!1,whiteList["grid-template"]=!1,whiteList["grid-template-areas"]=!1,whiteList["grid-template-columns"]=!1,whiteList["grid-template-rows"]=!1,whiteList["hanging-punctuation"]=!1,whiteList.height=!0,whiteList.hyphens=!1,whiteList.icon=!1,whiteList["image-orientation"]=!1,whiteList["image-resolution"]=!1,whiteList["ime-mode"]=!1,whiteList["initial-letters"]=!1,whiteList["inline-box-align"]=!1,whiteList["justify-content"]=!1,whiteList["justify-items"]=!1,whiteList["justify-self"]=!1,whiteList.left=!1,whiteList["letter-spacing"]=!0,whiteList["lighting-color"]=!0,whiteList["line-box-contain"]=!1,whiteList["line-break"]=!1,whiteList["line-grid"]=!1,whiteList["line-height"]=!1,whiteList["line-snap"]=!1,whiteList["line-stacking"]=!1,whiteList["line-stacking-ruby"]=!1,whiteList["line-stacking-shift"]=!1,whiteList["line-stacking-strategy"]=!1,whiteList["list-style"]=!0,whiteList["list-style-image"]=!0,whiteList["list-style-position"]=!0,whiteList["list-style-type"]=!0,whiteList.margin=!0,whiteList["margin-bottom"]=!0,whiteList["margin-left"]=!0,whiteList["margin-right"]=!0,whiteList["margin-top"]=!0,whiteList["marker-offset"]=!1,whiteList["marker-side"]=!1,whiteList.marks=!1,whiteList.mask=!1,whiteList["mask-box"]=!1,whiteList["mask-box-outset"]=!1,whiteList["mask-box-repeat"]=!1,whiteList["mask-box-slice"]=!1,whiteList["mask-box-source"]=!1,whiteList["mask-box-width"]=!1,whiteList["mask-clip"]=!1,whiteList["mask-image"]=!1,whiteList["mask-origin"]=!1,whiteList["mask-position"]=!1,whiteList["mask-repeat"]=!1,whiteList["mask-size"]=!1,whiteList["mask-source-type"]=!1,whiteList["mask-type"]=!1,whiteList["max-height"]=!0,whiteList["max-lines"]=!1,whiteList["max-width"]=!0,whiteList["min-height"]=!0,whiteList["min-width"]=!0,whiteList["move-to"]=!1,whiteList["nav-down"]=!1,whiteList["nav-index"]=!1,whiteList["nav-left"]=!1,whiteList["nav-right"]=!1,whiteList["nav-up"]=!1,whiteList["object-fit"]=!1,whiteList["object-position"]=!1,whiteList.opacity=!1,whiteList.order=!1,whiteList.orphans=!1,whiteList.outline=!1,whiteList["outline-color"]=!1,whiteList["outline-offset"]=!1,whiteList["outline-style"]=!1,whiteList["outline-width"]=!1,whiteList.overflow=!1,whiteList["overflow-wrap"]=!1,whiteList["overflow-x"]=!1,whiteList["overflow-y"]=!1,whiteList.padding=!0,whiteList["padding-bottom"]=!0,whiteList["padding-left"]=!0,whiteList["padding-right"]=!0,whiteList["padding-top"]=!0,whiteList.page=!1,whiteList["page-break-after"]=!1,whiteList["page-break-before"]=!1,whiteList["page-break-inside"]=!1,whiteList["page-policy"]=!1,whiteList.pause=!1,whiteList["pause-after"]=!1,whiteList["pause-before"]=!1,whiteList.perspective=!1,whiteList["perspective-origin"]=!1,whiteList.pitch=!1,whiteList["pitch-range"]=!1,whiteList["play-during"]=!1,whiteList.position=!1,whiteList["presentation-level"]=!1,whiteList.quotes=!1,whiteList["region-fragment"]=!1,whiteList.resize=!1,whiteList.rest=!1,whiteList["rest-after"]=!1,whiteList["rest-before"]=!1,whiteList.richness=!1,whiteList.right=!1,whiteList.rotation=!1,whiteList["rotation-point"]=!1,whiteList["ruby-align"]=!1,whiteList["ruby-merge"]=!1,whiteList["ruby-position"]=!1,whiteList["shape-image-threshold"]=!1,whiteList["shape-outside"]=!1,whiteList["shape-margin"]=!1,whiteList.size=!1,whiteList.speak=!1,whiteList["speak-as"]=!1,whiteList["speak-header"]=!1,whiteList["speak-numeral"]=!1,whiteList["speak-punctuation"]=!1,whiteList["speech-rate"]=!1,whiteList.stress=!1,whiteList["string-set"]=!1,whiteList["tab-size"]=!1,whiteList["table-layout"]=!1,whiteList["text-align"]=!0,whiteList["text-align-last"]=!0,whiteList["text-combine-upright"]=!0,whiteList["text-decoration"]=!0,whiteList["text-decoration-color"]=!0,whiteList["text-decoration-line"]=!0,whiteList["text-decoration-skip"]=!0,whiteList["text-decoration-style"]=!0,whiteList["text-emphasis"]=!0,whiteList["text-emphasis-color"]=!0,whiteList["text-emphasis-position"]=!0,whiteList["text-emphasis-style"]=!0,whiteList["text-height"]=!0,whiteList["text-indent"]=!0,whiteList["text-justify"]=!0,whiteList["text-orientation"]=!0,whiteList["text-overflow"]=!0,whiteList["text-shadow"]=!0,whiteList["text-space-collapse"]=!0,whiteList["text-transform"]=!0,whiteList["text-underline-position"]=!0,whiteList["text-wrap"]=!0,whiteList.top=!1,whiteList.transform=!1,whiteList["transform-origin"]=!1,whiteList["transform-style"]=!1,whiteList.transition=!1,whiteList["transition-delay"]=!1,whiteList["transition-duration"]=!1,whiteList["transition-property"]=!1,whiteList["transition-timing-function"]=!1,whiteList["unicode-bidi"]=!1,whiteList["vertical-align"]=!1,whiteList.visibility=!1,whiteList["voice-balance"]=!1,whiteList["voice-duration"]=!1,whiteList["voice-family"]=!1,whiteList["voice-pitch"]=!1,whiteList["voice-range"]=!1,whiteList["voice-rate"]=!1,whiteList["voice-stress"]=!1,whiteList["voice-volume"]=!1,whiteList.volume=!1,whiteList["white-space"]=!1,whiteList.widows=!1,whiteList.width=!0,whiteList["will-change"]=!1,whiteList["word-break"]=!0,whiteList["word-spacing"]=!0,whiteList["word-wrap"]=!0,whiteList["wrap-flow"]=!1,whiteList["wrap-through"]=!1,whiteList["writing-mode"]=!1,whiteList["z-index"]=!1,whiteList}function onAttr(name,value,options){}function onIgnoreAttr(name,value,options){}var REGEXP_URL_JAVASCRIPT=/javascript\s*\:/img;function safeAttrValue(name,value){if(REGEXP_URL_JAVASCRIPT.test(value))return"";return value}exports.whiteList=getDefaultWhiteList();exports.getDefaultWhiteList=getDefaultWhiteList;exports.onAttr=onAttr;exports.onIgnoreAttr=onIgnoreAttr;exports.safeAttrValue=safeAttrValue});var require_util=__commonJS((exports,module)=>{module.exports={indexOf:function(arr,item){var i3,j;if(Array.prototype.indexOf)return arr.indexOf(item);for(i3=0,j=arr.length;i3<j;i3++)if(arr[i3]===item)return i3;return-1},forEach:function(arr,fn,scope){var i3,j;if(Array.prototype.forEach)return arr.forEach(fn,scope);for(i3=0,j=arr.length;i3<j;i3++)fn.call(scope,arr[i3],i3,arr)},trim:function(str){if(String.prototype.trim)return str.trim();return str.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(str){if(String.prototype.trimRight)return str.trimRight();return str.replace(/(\s*$)/g,"")}}});var require_parser2=__commonJS((exports,module)=>{var _2=require_util();function parseStyle(css,onAttr){if(css=_2.trimRight(css),css[css.length-1]!==";")css+=";";var cssLength=css.length,isParenthesisOpen=!1,lastPos=0,i3=0,retCSS="";function addNewAttr(){if(!isParenthesisOpen){var source=_2.trim(css.slice(lastPos,i3)),j2=source.indexOf(":");if(j2!==-1){var name=_2.trim(source.slice(0,j2)),value=_2.trim(source.slice(j2+1));if(name){var ret=onAttr(lastPos,retCSS.length,name,value,source);if(ret)retCSS+=ret+"; "}}}lastPos=i3+1}for(;i3<cssLength;i3++){var c=css[i3];if(c==="/"&&css[i3+1]==="*"){var j=css.indexOf("*/",i3+2);if(j===-1)break;i3=j+1,lastPos=i3+1,isParenthesisOpen=!1}else if(c==="(")isParenthesisOpen=!0;else if(c===")")isParenthesisOpen=!1;else if(c===";")if(isParenthesisOpen);else addNewAttr();else if(c===`
`)addNewAttr()}return _2.trim(retCSS)}module.exports=parseStyle});var require_css=__commonJS((exports,module)=>{var DEFAULT=require_default(),parseStyle=require_parser2(),_2=require_util();function isNull2(obj){return obj===void 0||obj===null}function shallowCopyObject(obj){var ret={};for(var i3 in obj)ret[i3]=obj[i3];return ret}function FilterCSS(options){options=shallowCopyObject(options||{}),options.whiteList=options.whiteList||DEFAULT.whiteList,options.onAttr=options.onAttr||DEFAULT.onAttr,options.onIgnoreAttr=options.onIgnoreAttr||DEFAULT.onIgnoreAttr,options.safeAttrValue=options.safeAttrValue||DEFAULT.safeAttrValue,this.options=options}FilterCSS.prototype.process=function(css){if(css=css||"",css=css.toString(),!css)return"";var me=this,options=me.options,whiteList=options.whiteList,onAttr=options.onAttr,onIgnoreAttr=options.onIgnoreAttr,safeAttrValue=options.safeAttrValue,retCSS=parseStyle(css,function(sourcePosition,position,name,value,source){var check2=whiteList[name],isWhite=!1;if(check2===!0)isWhite=check2;else if(typeof check2==="function")isWhite=check2(value);else if(check2 instanceof RegExp)isWhite=check2.test(value);if(isWhite!==!0)isWhite=!1;if(value=safeAttrValue(name,value),!value)return;var opts={position,sourcePosition,source,isWhite};if(isWhite){var ret=onAttr(name,value,opts);if(isNull2(ret))return name+":"+value;else return ret}else{var ret=onIgnoreAttr(name,value,opts);if(!isNull2(ret))return ret}});return retCSS};module.exports=FilterCSS});var require_lib2=__commonJS((exports,module)=>{var DEFAULT=require_default(),FilterCSS=require_css();function filterCSS(html,options){var xss=new FilterCSS(options);return xss.process(html)}exports=module.exports=filterCSS;exports.FilterCSS=FilterCSS;for(i3 in DEFAULT)exports[i3]=DEFAULT[i3];var i3;if(typeof window!=="undefined")window.filterCSS=module.exports});var require_util2=__commonJS((exports,module)=>{module.exports={indexOf:function(arr,item){var i3,j;if(Array.prototype.indexOf)return arr.indexOf(item);for(i3=0,j=arr.length;i3<j;i3++)if(arr[i3]===item)return i3;return-1},forEach:function(arr,fn,scope){var i3,j;if(Array.prototype.forEach)return arr.forEach(fn,scope);for(i3=0,j=arr.length;i3<j;i3++)fn.call(scope,arr[i3],i3,arr)},trim:function(str){if(String.prototype.trim)return str.trim();return str.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(str){var reg=/\s|\n|\t/,match=reg.exec(str);return match?match.index:-1}}});var require_default2=__commonJS((exports)=>{var FilterCSS=require_lib2().FilterCSS,getDefaultCSSWhiteList=require_lib2().getDefaultWhiteList,_2=require_util2();function getDefaultWhiteList(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var defaultCSSFilter=new FilterCSS;function onTag(tag,html,options){}function onIgnoreTag(tag,html,options){}function onTagAttr(tag,name,value){}function onIgnoreTagAttr(tag,name,value){}function escapeHtml(html){return html.replace(REGEXP_LT,"&lt;").replace(REGEXP_GT,"&gt;")}function safeAttrValue(tag,name,value,cssFilter){if(value=friendlyAttrValue(value),name==="href"||name==="src"){if(value=_2.trim(value),value==="#")return"#";if(!(value.substr(0,7)==="http://"||value.substr(0,8)==="https://"||value.substr(0,7)==="mailto:"||value.substr(0,4)==="tel:"||value.substr(0,11)==="data:image/"||value.substr(0,6)==="ftp://"||value.substr(0,2)==="./"||value.substr(0,3)==="../"||value[0]==="#"||value[0]==="/"))return""}else if(name==="background"){if(REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value))return""}else if(name==="style"){if(REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value))return"";if(REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)){if(REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value))return""}if(cssFilter!==!1)cssFilter=cssFilter||defaultCSSFilter,value=cssFilter.process(value)}return value=escapeAttrValue(value),value}var REGEXP_LT=/</g,REGEXP_GT=/>/g,REGEXP_QUOTE=/"/g,REGEXP_QUOTE_2=/&quot;/g,REGEXP_ATTR_VALUE_1=/&#([a-zA-Z0-9]*);?/gim,REGEXP_ATTR_VALUE_COLON=/&colon;?/gim,REGEXP_ATTR_VALUE_NEWLINE=/&newline;?/gim,REGEXP_DEFAULT_ON_TAG_ATTR_4=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,REGEXP_DEFAULT_ON_TAG_ATTR_7=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,REGEXP_DEFAULT_ON_TAG_ATTR_8=/u\s*r\s*l\s*\(.*/gi;function escapeQuote2(str){return str.replace(REGEXP_QUOTE,"&quot;")}function unescapeQuote(str){return str.replace(REGEXP_QUOTE_2,'"')}function escapeHtmlEntities(str){return str.replace(REGEXP_ATTR_VALUE_1,function replaceUnicode(str2,code){return code[0]==="x"||code[0]==="X"?String.fromCharCode(parseInt(code.substr(1),16)):String.fromCharCode(parseInt(code,10))})}function escapeDangerHtml5Entities(str){return str.replace(REGEXP_ATTR_VALUE_COLON,":").replace(REGEXP_ATTR_VALUE_NEWLINE," ")}function clearNonPrintableCharacter(str){var str2="";for(var i3=0,len3=str.length;i3<len3;i3++)str2+=str.charCodeAt(i3)<32?" ":str.charAt(i3);return _2.trim(str2)}function friendlyAttrValue(str){return str=unescapeQuote(str),str=escapeHtmlEntities(str),str=escapeDangerHtml5Entities(str),str=clearNonPrintableCharacter(str),str}function escapeAttrValue(str){return str=escapeQuote2(str),str=escapeHtml(str),str}function onIgnoreTagStripAll(){return""}function StripTagBody(tags,next2){if(typeof next2!=="function")next2=function(){};var isRemoveAllTag=!Array.isArray(tags);function isRemoveTag(tag){if(isRemoveAllTag)return!0;return _2.indexOf(tags,tag)!==-1}var removeList=[],posStart=!1;return{onIgnoreTag:function(tag,html,options){if(isRemoveTag(tag))if(options.isClosing){var ret="[/removed]",end=options.position+ret.length;return removeList.push([posStart!==!1?posStart:options.position,end]),posStart=!1,ret}else{if(!posStart)posStart=options.position;return"[removed]"}else return next2(tag,html,options)},remove:function(html){var rethtml="",lastPos=0;return _2.forEach(removeList,function(pos){rethtml+=html.slice(lastPos,pos[0]),lastPos=pos[1]}),rethtml+=html.slice(lastPos),rethtml}}}function stripCommentTag(html){var retHtml="",lastPos=0;while(lastPos<html.length){var i3=html.indexOf("<!--",lastPos);if(i3===-1){retHtml+=html.slice(lastPos);break}retHtml+=html.slice(lastPos,i3);var j=html.indexOf("-->",i3);if(j===-1)break;lastPos=j+3}return retHtml}function stripBlankChar(html){var chars3=html.split("");return chars3=chars3.filter(function(char2){var c=char2.charCodeAt(0);if(c===127)return!1;if(c<=31){if(c===10||c===13)return!0;return!1}return!0}),chars3.join("")}exports.whiteList=getDefaultWhiteList();exports.getDefaultWhiteList=getDefaultWhiteList;exports.onTag=onTag;exports.onIgnoreTag=onIgnoreTag;exports.onTagAttr=onTagAttr;exports.onIgnoreTagAttr=onIgnoreTagAttr;exports.safeAttrValue=safeAttrValue;exports.escapeHtml=escapeHtml;exports.escapeQuote=escapeQuote2;exports.unescapeQuote=unescapeQuote;exports.escapeHtmlEntities=escapeHtmlEntities;exports.escapeDangerHtml5Entities=escapeDangerHtml5Entities;exports.clearNonPrintableCharacter=clearNonPrintableCharacter;exports.friendlyAttrValue=friendlyAttrValue;exports.escapeAttrValue=escapeAttrValue;exports.onIgnoreTagStripAll=onIgnoreTagStripAll;exports.StripTagBody=StripTagBody;exports.stripCommentTag=stripCommentTag;exports.stripBlankChar=stripBlankChar;exports.attributeWrapSign='"';exports.cssFilter=defaultCSSFilter;exports.getDefaultCSSWhiteList=getDefaultCSSWhiteList});var require_parser3=__commonJS((exports)=>{var _2=require_util2();function getTagName(html){var i3=_2.spaceIndex(html),tagName;if(i3===-1)tagName=html.slice(1,-1);else tagName=html.slice(1,i3+1);if(tagName=_2.trim(tagName).toLowerCase(),tagName.slice(0,1)==="/")tagName=tagName.slice(1);if(tagName.slice(-1)==="/")tagName=tagName.slice(0,-1);return tagName}function isClosing(html){return html.slice(0,2)==="</"}function parseTag(html,onTag,escapeHtml){var rethtml="",lastPos=0,tagStart=!1,quoteStart=!1,currentPos=0,len3=html.length,currentTagName="",currentHtml="";chariterator:for(currentPos=0;currentPos<len3;currentPos++){var c=html.charAt(currentPos);if(tagStart===!1){if(c==="<"){tagStart=currentPos;continue}}else if(quoteStart===!1){if(c==="<"){rethtml+=escapeHtml(html.slice(lastPos,currentPos)),tagStart=currentPos,lastPos=currentPos;continue}if(c===">"||currentPos===len3-1){rethtml+=escapeHtml(html.slice(lastPos,tagStart)),currentHtml=html.slice(tagStart,currentPos+1),currentTagName=getTagName(currentHtml),rethtml+=onTag(tagStart,rethtml.length,currentTagName,currentHtml,isClosing(currentHtml)),lastPos=currentPos+1,tagStart=!1;continue}if(c==='"'||c==="'"){var i3=1,ic=html.charAt(currentPos-i3);while(ic.trim()===""||ic==="="){if(ic==="="){quoteStart=c;continue chariterator}ic=html.charAt(currentPos-++i3)}}}else if(c===quoteStart){quoteStart=!1;continue}}if(lastPos<len3)rethtml+=escapeHtml(html.substr(lastPos));return rethtml}var REGEXP_ILLEGAL_ATTR_NAME=/[^a-zA-Z0-9\\_:.-]/gim;function parseAttr(html,onAttr){var lastPos=0,lastMarkPos=0,retAttrs=[],tmpName=!1,len3=html.length;function addAttr(name,value){if(name=_2.trim(name),name=name.replace(REGEXP_ILLEGAL_ATTR_NAME,"").toLowerCase(),name.length<1)return;var ret=onAttr(name,value||"");if(ret)retAttrs.push(ret)}for(var i3=0;i3<len3;i3++){var c=html.charAt(i3),v,j;if(tmpName===!1&&c==="="){tmpName=html.slice(lastPos,i3),lastPos=i3+1,lastMarkPos=html.charAt(lastPos)==='"'||html.charAt(lastPos)==="'"?lastPos:findNextQuotationMark(html,i3+1);continue}if(tmpName!==!1){if(i3===lastMarkPos)if(j=html.indexOf(c,i3+1),j===-1)break;else{v=_2.trim(html.slice(lastMarkPos+1,j)),addAttr(tmpName,v),tmpName=!1,i3=j,lastPos=i3+1;continue}}if(/\s|\n|\t/.test(c))if(html=html.replace(/\s|\n|\t/g," "),tmpName===!1)if(j=findNextEqual(html,i3),j===-1){v=_2.trim(html.slice(lastPos,i3)),addAttr(v),tmpName=!1,lastPos=i3+1;continue}else{i3=j-1;continue}else if(j=findBeforeEqual(html,i3-1),j===-1){v=_2.trim(html.slice(lastPos,i3)),v=stripQuoteWrap(v),addAttr(tmpName,v),tmpName=!1,lastPos=i3+1;continue}else continue}if(lastPos<html.length)if(tmpName===!1)addAttr(html.slice(lastPos));else addAttr(tmpName,stripQuoteWrap(_2.trim(html.slice(lastPos))));return _2.trim(retAttrs.join(" "))}function findNextEqual(str,i3){for(;i3<str.length;i3++){var c=str[i3];if(c===" ")continue;if(c==="=")return i3;return-1}}function findNextQuotationMark(str,i3){for(;i3<str.length;i3++){var c=str[i3];if(c===" ")continue;if(c==="'"||c==='"')return i3;return-1}}function findBeforeEqual(str,i3){for(;i3>0;i3--){var c=str[i3];if(c===" ")continue;if(c==="=")return i3;return-1}}function isQuoteWrapString(text3){if(text3[0]==='"'&&text3[text3.length-1]==='"'||text3[0]==="'"&&text3[text3.length-1]==="'")return!0;else return!1}function stripQuoteWrap(text3){if(isQuoteWrapString(text3))return text3.substr(1,text3.length-2);else return text3}exports.parseTag=parseTag;exports.parseAttr=parseAttr});var require_xss=__commonJS((exports,module)=>{var FilterCSS=require_lib2().FilterCSS,DEFAULT=require_default2(),parser=require_parser3(),parseTag=parser.parseTag,parseAttr=parser.parseAttr,_2=require_util2();function isNull2(obj){return obj===void 0||obj===null}function getAttrs(html){var i3=_2.spaceIndex(html);if(i3===-1)return{html:"",closing:html[html.length-2]==="/"};html=_2.trim(html.slice(i3+1,-1));var isClosing=html[html.length-1]==="/";if(isClosing)html=_2.trim(html.slice(0,-1));return{html,closing:isClosing}}function shallowCopyObject(obj){var ret={};for(var i3 in obj)ret[i3]=obj[i3];return ret}function keysToLowerCase(obj){var ret={};for(var i3 in obj)if(Array.isArray(obj[i3]))ret[i3.toLowerCase()]=obj[i3].map(function(item){return item.toLowerCase()});else ret[i3.toLowerCase()]=obj[i3];return ret}function FilterXSS(options){if(options=shallowCopyObject(options||{}),options.stripIgnoreTag){if(options.onIgnoreTag)console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time');options.onIgnoreTag=DEFAULT.onIgnoreTagStripAll}if(options.whiteList||options.allowList)options.whiteList=keysToLowerCase(options.whiteList||options.allowList);else options.whiteList=DEFAULT.whiteList;if(this.attributeWrapSign=options.singleQuotedAttributeValue===!0?"'":DEFAULT.attributeWrapSign,options.onTag=options.onTag||DEFAULT.onTag,options.onTagAttr=options.onTagAttr||DEFAULT.onTagAttr,options.onIgnoreTag=options.onIgnoreTag||DEFAULT.onIgnoreTag,options.onIgnoreTagAttr=options.onIgnoreTagAttr||DEFAULT.onIgnoreTagAttr,options.safeAttrValue=options.safeAttrValue||DEFAULT.safeAttrValue,options.escapeHtml=options.escapeHtml||DEFAULT.escapeHtml,this.options=options,options.css===!1)this.cssFilter=!1;else options.css=options.css||{},this.cssFilter=new FilterCSS(options.css)}FilterXSS.prototype.process=function(html){if(html=html||"",html=html.toString(),!html)return"";var me=this,options=me.options,whiteList=options.whiteList,onTag=options.onTag,onIgnoreTag=options.onIgnoreTag,onTagAttr=options.onTagAttr,onIgnoreTagAttr=options.onIgnoreTagAttr,safeAttrValue=options.safeAttrValue,escapeHtml=options.escapeHtml,attributeWrapSign=me.attributeWrapSign,cssFilter=me.cssFilter;if(options.stripBlankChar)html=DEFAULT.stripBlankChar(html);if(!options.allowCommentTag)html=DEFAULT.stripCommentTag(html);var stripIgnoreTagBody=!1;if(options.stripIgnoreTagBody)stripIgnoreTagBody=DEFAULT.StripTagBody(options.stripIgnoreTagBody,onIgnoreTag),onIgnoreTag=stripIgnoreTagBody.onIgnoreTag;var retHtml=parseTag(html,function(sourcePosition,position,tag,html2,isClosing){var info={sourcePosition,position,isClosing,isWhite:Object.prototype.hasOwnProperty.call(whiteList,tag)},ret=onTag(tag,html2,info);if(!isNull2(ret))return ret;if(info.isWhite){if(info.isClosing)return"</"+tag+">";var attrs=getAttrs(html2),whiteAttrList=whiteList[tag],attrsHtml=parseAttr(attrs.html,function(name,value){var isWhiteAttr=_2.indexOf(whiteAttrList,name)!==-1,ret2=onTagAttr(tag,name,value,isWhiteAttr);if(!isNull2(ret2))return ret2;if(isWhiteAttr)if(value=safeAttrValue(tag,name,value,cssFilter),value)return name+"="+attributeWrapSign+value+attributeWrapSign;else return name;else{if(ret2=onIgnoreTagAttr(tag,name,value,isWhiteAttr),!isNull2(ret2))return ret2;return}});if(html2="<"+tag,attrsHtml)html2+=" "+attrsHtml;if(attrs.closing)html2+=" /";return html2+=">",html2}else{if(ret=onIgnoreTag(tag,html2,info),!isNull2(ret))return ret;return escapeHtml(html2)}},escapeHtml);if(stripIgnoreTagBody)retHtml=stripIgnoreTagBody.remove(retHtml);return retHtml};module.exports=FilterXSS});var require_lib3=__commonJS((exports,module)=>{var DEFAULT=require_default2(),parser=require_parser3(),FilterXSS=require_xss();function filterXSS(html,options){var xss=new FilterXSS(options);return xss.process(html)}exports=module.exports=filterXSS;exports.filterXSS=filterXSS;exports.FilterXSS=FilterXSS;(function(){for(var i3 in DEFAULT)exports[i3]=DEFAULT[i3];for(var j in parser)exports[j]=parser[j]})();if(typeof window!=="undefined")window.filterXSS=module.exports;function isWorkerEnv(){return typeof self!=="undefined"&&typeof DedicatedWorkerGlobalScope!=="undefined"&&self instanceof DedicatedWorkerGlobalScope}if(isWorkerEnv())self.filterXSS=module.exports});var require_cookies=__commonJS((exports,module)=>{var urllib=__require("url");class Cookies{constructor(options){this.options=options||{},this.cookies=[]}set(cookieStr,url){let urlparts=urllib.parse(url||""),cookie=this.parse(cookieStr),domain;if(cookie.domain){if(domain=cookie.domain.replace(/^\./,""),urlparts.hostname.length<domain.length||("."+urlparts.hostname).substr(-domain.length+1)!=="."+domain)cookie.domain=urlparts.hostname}else cookie.domain=urlparts.hostname;if(!cookie.path)cookie.path=this.getPath(urlparts.pathname);if(!cookie.expires)cookie.expires=new Date(Date.now()+(Number(this.options.sessionTimeout||1800)||1800)*1000);return this.add(cookie)}get(url){return this.list(url).map((cookie)=>cookie.name+"="+cookie.value).join("; ")}list(url){let result=[],i3,cookie;for(i3=this.cookies.length-1;i3>=0;i3--){if(cookie=this.cookies[i3],this.isExpired(cookie)){this.cookies.splice(i3,i3);continue}if(this.match(cookie,url))result.unshift(cookie)}return result}parse(cookieStr){let cookie={};return(cookieStr||"").toString().split(";").forEach((cookiePart)=>{let valueParts=cookiePart.split("="),key=valueParts.shift().trim().toLowerCase(),value=valueParts.join("=").trim(),domain;if(!key)return;switch(key){case"expires":if(value=new Date(value),value.toString()!=="Invalid Date")cookie.expires=value;break;case"path":cookie.path=value;break;case"domain":if(domain=value.toLowerCase(),domain.length&&domain.charAt(0)!==".")domain="."+domain;cookie.domain=domain;break;case"max-age":cookie.expires=new Date(Date.now()+(Number(value)||0)*1000);break;case"secure":cookie.secure=!0;break;case"httponly":cookie.httponly=!0;break;default:if(!cookie.name)cookie.name=key,cookie.value=value}}),cookie}match(cookie,url){let urlparts=urllib.parse(url||"");if(urlparts.hostname!==cookie.domain&&(cookie.domain.charAt(0)!=="."||("."+urlparts.hostname).substr(-cookie.domain.length)!==cookie.domain))return!1;if(this.getPath(urlparts.pathname).substr(0,cookie.path.length)!==cookie.path)return!1;if(cookie.secure&&urlparts.protocol!=="https:")return!1;return!0}add(cookie){let i3,len3;if(!cookie||!cookie.name)return!1;for(i3=0,len3=this.cookies.length;i3<len3;i3++)if(this.compare(this.cookies[i3],cookie)){if(this.isExpired(cookie))return this.cookies.splice(i3,1),!1;return this.cookies[i3]=cookie,!0}if(!this.isExpired(cookie))this.cookies.push(cookie);return!0}compare(a,b2){return a.name===b2.name&&a.path===b2.path&&a.domain===b2.domain&&a.secure===b2.secure&&a.httponly===a.httponly}isExpired(cookie){return cookie.expires&&cookie.expires<new Date||!cookie.value}getPath(pathname){let path2=(pathname||"/").split("/");if(path2.pop(),path2=path2.join("/").trim(),path2.charAt(0)!=="/")path2="/"+path2;if(path2.substr(-1)!=="/")path2+="/";return path2}}module.exports=Cookies});var require_package3=__commonJS((exports,module)=>{module.exports={name:"nodemailer",version:"6.10.1",description:"Easy as cake e-mail sending from your Node.js applications",main:"lib/nodemailer.js",scripts:{test:"node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js","test:coverage":"c8 node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js",lint:"eslint .",update:"rm -rf node_modules/ package-lock.json && ncu -u && npm install"},repository:{type:"git",url:"https://github.com/nodemailer/nodemailer.git"},keywords:["Nodemailer"],author:"Andris Reinman",license:"MIT-0",bugs:{url:"https://github.com/nodemailer/nodemailer/issues"},homepage:"https://nodemailer.com/",devDependencies:{"@aws-sdk/client-ses":"3.731.1",bunyan:"1.8.15",c8:"10.1.3",eslint:"8.57.0","eslint-config-nodemailer":"1.2.0","eslint-config-prettier":"9.1.0",libbase64:"1.3.0",libmime:"5.3.6",libqp:"2.1.1","nodemailer-ntlm-auth":"1.0.4",proxy:"1.0.2","proxy-test-server":"1.0.0","smtp-server":"3.13.6"},engines:{node:">=6.0.0"}}});var require_fetch=__commonJS((exports,module)=>{var http=__require("http"),https=__require("https"),urllib=__require("url"),zlib=__require("zlib"),PassThrough=__require("stream").PassThrough,Cookies=require_cookies(),packageData=require_package3(),net2=__require("net");module.exports=function(url,options){return nmfetch(url,options)};module.exports.Cookies=Cookies;function nmfetch(url,options){if(options=options||{},options.fetchRes=options.fetchRes||new PassThrough,options.cookies=options.cookies||new Cookies,options.redirects=options.redirects||0,options.maxRedirects=isNaN(options.maxRedirects)?5:options.maxRedirects,options.cookie)[].concat(options.cookie||[]).forEach((cookie)=>{options.cookies.set(cookie,url)}),options.cookie=!1;let fetchRes=options.fetchRes,parsed=urllib.parse(url),method=(options.method||"").toString().trim().toUpperCase()||"GET",finished=!1,cookies,body,handler=parsed.protocol==="https:"?https:http,headers={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+packageData.version};if(Object.keys(options.headers||{}).forEach((key)=>{headers[key.toLowerCase().trim()]=options.headers[key]}),options.userAgent)headers["user-agent"]=options.userAgent;if(parsed.auth)headers.Authorization="Basic "+Buffer.from(parsed.auth).toString("base64");if(cookies=options.cookies.get(url))headers.cookie=cookies;if(options.body){if(options.contentType!==!1)headers["Content-Type"]=options.contentType||"application/x-www-form-urlencoded";if(typeof options.body.pipe==="function")headers["Transfer-Encoding"]="chunked",body=options.body,body.on("error",(err)=>{if(finished)return;finished=!0,err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err)});else{if(options.body instanceof Buffer)body=options.body;else if(typeof options.body==="object")try{body=Buffer.from(Object.keys(options.body).map((key)=>{let value=options.body[key].toString().trim();return encodeURIComponent(key)+"="+encodeURIComponent(value)}).join("&"))}catch(E){if(finished)return;finished=!0,E.type="FETCH",E.sourceUrl=url,fetchRes.emit("error",E);return}else body=Buffer.from(options.body.toString().trim());headers["Content-Type"]=options.contentType||"application/x-www-form-urlencoded",headers["Content-Length"]=body.length}method=(options.method||"").toString().trim().toUpperCase()||"POST"}let req,reqOptions={method,host:parsed.hostname,path:parsed.path,port:parsed.port?parsed.port:parsed.protocol==="https:"?443:80,headers,rejectUnauthorized:!1,agent:!1};if(options.tls)Object.keys(options.tls).forEach((key)=>{reqOptions[key]=options.tls[key]});if(parsed.protocol==="https:"&&parsed.hostname&&parsed.hostname!==reqOptions.host&&!net2.isIP(parsed.hostname)&&!reqOptions.servername)reqOptions.servername=parsed.hostname;try{req=handler.request(reqOptions)}catch(E){return finished=!0,setImmediate(()=>{E.type="FETCH",E.sourceUrl=url,fetchRes.emit("error",E)}),fetchRes}if(options.timeout)req.setTimeout(options.timeout,()=>{if(finished)return;finished=!0,req.abort();let err=new Error("Request Timeout");err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err)});return req.on("error",(err)=>{if(finished)return;finished=!0,err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err)}),req.on("response",(res)=>{let inflate;if(finished)return;switch(res.headers["content-encoding"]){case"gzip":case"deflate":inflate=zlib.createUnzip();break}if(res.headers["set-cookie"])[].concat(res.headers["set-cookie"]||[]).forEach((cookie)=>{options.cookies.set(cookie,url)});if([301,302,303,307,308].includes(res.statusCode)&&res.headers.location){if(options.redirects++,options.redirects>options.maxRedirects){finished=!0;let err=new Error("Maximum redirect count exceeded");err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err),req.abort();return}return options.method="GET",options.body=!1,nmfetch(urllib.resolve(url,res.headers.location),options)}if(fetchRes.statusCode=res.statusCode,fetchRes.headers=res.headers,res.statusCode>=300&&!options.allowErrorResponse){finished=!0;let err=new Error("Invalid status code "+res.statusCode);err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err),req.abort();return}if(res.on("error",(err)=>{if(finished)return;finished=!0,err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err),req.abort()}),inflate)res.pipe(inflate).pipe(fetchRes),inflate.on("error",(err)=>{if(finished)return;finished=!0,err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err),req.abort()});else res.pipe(fetchRes)}),setImmediate(()=>{if(body)try{if(typeof body.pipe==="function")return body.pipe(req);else req.write(body)}catch(err){finished=!0,err.type="FETCH",err.sourceUrl=url,fetchRes.emit("error",err);return}req.end()}),fetchRes}});var require_shared=__commonJS((exports,module)=>{var urllib=__require("url"),util=__require("util"),fs4=__require("fs"),nmfetch=require_fetch(),dns=__require("dns"),net2=__require("net"),os2=__require("os"),networkInterfaces;try{networkInterfaces=os2.networkInterfaces()}catch(err){}exports.networkInterfaces=networkInterfaces;var isFamilySupported=(family,allowInternal)=>{let networkInterfaces2=exports.networkInterfaces;if(!networkInterfaces2)return!0;return Object.keys(networkInterfaces2).map((key)=>networkInterfaces2[key]).reduce((acc,val)=>acc.concat(val),[]).filter((i3)=>!i3.internal||allowInternal).filter((i3)=>i3.family==="IPv"+family||i3.family===family).length>0},resolver=(family,hostname,options,callback)=>{if(options=options||{},!isFamilySupported(family,options.allowInternalNetworkInterfaces))return callback(null,[]);(dns.Resolver?new dns.Resolver(options):dns)["resolve"+family](hostname,(err,addresses)=>{if(err){switch(err.code){case dns.NODATA:case dns.NOTFOUND:case dns.NOTIMP:case dns.SERVFAIL:case dns.CONNREFUSED:case dns.REFUSED:case"EAI_AGAIN":return callback(null,[])}return callback(err)}return callback(null,Array.isArray(addresses)?addresses:[].concat(addresses||[]))})},dnsCache=exports.dnsCache=new Map,formatDNSValue=(value,extra)=>{if(!value)return Object.assign({},extra||{});return Object.assign({servername:value.servername,host:!value.addresses||!value.addresses.length?null:value.addresses.length===1?value.addresses[0]:value.addresses[Math.floor(Math.random()*value.addresses.length)]},extra||{})};exports.resolveHostname=(options,callback)=>{if(options=options||{},!options.host&&options.servername)options.host=options.servername;if(!options.host||net2.isIP(options.host)){let value={addresses:[options.host],servername:options.servername||!1};return callback(null,formatDNSValue(value,{cached:!1}))}let cached;if(dnsCache.has(options.host)){if(cached=dnsCache.get(options.host),!cached.expires||cached.expires>=Date.now())return callback(null,formatDNSValue(cached.value,{cached:!0}))}resolver(4,options.host,options,(err,addresses)=>{if(err){if(cached)return callback(null,formatDNSValue(cached.value,{cached:!0,error:err}));return callback(err)}if(addresses&&addresses.length){let value={addresses,servername:options.servername||options.host};return dnsCache.set(options.host,{value,expires:Date.now()+(options.dnsTtl||300000)}),callback(null,formatDNSValue(value,{cached:!1}))}resolver(6,options.host,options,(err2,addresses2)=>{if(err2){if(cached)return callback(null,formatDNSValue(cached.value,{cached:!0,error:err2}));return callback(err2)}if(addresses2&&addresses2.length){let value={addresses:addresses2,servername:options.servername||options.host};return dnsCache.set(options.host,{value,expires:Date.now()+(options.dnsTtl||300000)}),callback(null,formatDNSValue(value,{cached:!1}))}try{dns.lookup(options.host,{all:!0},(err3,addresses3)=>{if(err3){if(cached)return callback(null,formatDNSValue(cached.value,{cached:!0,error:err3}));return callback(err3)}let address=addresses3?addresses3.filter((addr)=>isFamilySupported(addr.family)).map((addr)=>addr.address).shift():!1;if(addresses3&&addresses3.length&&!address)console.warn(`Failed to resolve IPv${addresses3[0].family} addresses with current network`);if(!address&&cached)return callback(null,formatDNSValue(cached.value,{cached:!0}));let value={addresses:address?[address]:[options.host],servername:options.servername||options.host};return dnsCache.set(options.host,{value,expires:Date.now()+(options.dnsTtl||300000)}),callback(null,formatDNSValue(value,{cached:!1}))})}catch(err3){if(cached)return callback(null,formatDNSValue(cached.value,{cached:!0,error:err3}));return callback(err3)}})})};exports.parseConnectionUrl=(str)=>{str=str||"";let options={};return[urllib.parse(str,!0)].forEach((url)=>{let auth;switch(url.protocol){case"smtp:":options.secure=!1;break;case"smtps:":options.secure=!0;break;case"direct:":options.direct=!0;break}if(!isNaN(url.port)&&Number(url.port))options.port=Number(url.port);if(url.hostname)options.host=url.hostname;if(url.auth){if(auth=url.auth.split(":"),!options.auth)options.auth={};options.auth.user=auth.shift(),options.auth.pass=auth.join(":")}Object.keys(url.query||{}).forEach((key)=>{let obj=options,lKey=key,value=url.query[key];if(!isNaN(value))value=Number(value);switch(value){case"true":value=!0;break;case"false":value=!1;break}if(key.indexOf("tls.")===0){if(lKey=key.substr(4),!options.tls)options.tls={};obj=options.tls}else if(key.indexOf(".")>=0)return;if(!(lKey in obj))obj[lKey]=value})}),options};exports._logFunc=(logger,level,defaults,data,message2,...args)=>{let entry={};Object.keys(defaults||{}).forEach((key)=>{if(key!=="level")entry[key]=defaults[key]}),Object.keys(data||{}).forEach((key)=>{if(key!=="level")entry[key]=data[key]}),logger[level](entry,message2,...args)};exports.getLogger=(options,defaults)=>{options=options||{};let response={},levels=["trace","debug","info","warn","error","fatal"];if(!options.logger)return levels.forEach((level)=>{response[level]=()=>!1}),response;let logger=options.logger;if(options.logger===!0)logger=createDefaultLogger(levels);return levels.forEach((level)=>{response[level]=(data,message2,...args)=>{exports._logFunc(logger,level,defaults,data,message2,...args)}}),response};exports.callbackPromise=(resolve,reject)=>function(){let args=Array.from(arguments),err=args.shift();if(err)reject(err);else resolve(...args)};exports.parseDataURI=(uri2)=>{let input=uri2,commaPos=input.indexOf(",");if(!commaPos)return uri2;let data=input.substring(commaPos+1),metaStr=input.substring(5,commaPos),encoding,metaEntries=metaStr.split(";"),lastMetaEntry=metaEntries.length>1?metaEntries[metaEntries.length-1]:!1;if(lastMetaEntry&&lastMetaEntry.indexOf("=")<0)encoding=lastMetaEntry.toLowerCase(),metaEntries.pop();let contentType=metaEntries.shift()||"application/octet-stream",params={};for(let entry of metaEntries){let sep=entry.indexOf("=");if(sep>=0){let key=entry.substring(0,sep),value=entry.substring(sep+1);params[key]=value}}switch(encoding){case"base64":data=Buffer.from(data,"base64");break;case"utf8":data=Buffer.from(data);break;default:try{data=Buffer.from(decodeURIComponent(data))}catch(err){data=Buffer.from(data)}data=Buffer.from(data)}return{data,encoding,contentType,params}};exports.resolveContent=(data,key,callback)=>{let promise;if(!callback)promise=new Promise((resolve,reject)=>{callback=exports.callbackPromise(resolve,reject)});let content=data&&data[key]&&data[key].content||data[key],contentStream,encoding=(typeof data[key]==="object"&&data[key].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!content)return callback(null,content);if(typeof content==="object"){if(typeof content.pipe==="function")return resolveStream(content,(err,value)=>{if(err)return callback(err);if(data[key].content)data[key].content=value;else data[key]=value;callback(null,value)});else if(/^https?:\/\//i.test(content.path||content.href))return contentStream=nmfetch(content.path||content.href),resolveStream(contentStream,callback);else if(/^data:/i.test(content.path||content.href)){let parsedDataUri=exports.parseDataURI(content.path||content.href);if(!parsedDataUri||!parsedDataUri.data)return callback(null,Buffer.from(0));return callback(null,parsedDataUri.data)}else if(content.path)return resolveStream(fs4.createReadStream(content.path),callback)}if(typeof data[key].content==="string"&&!["utf8","usascii","ascii"].includes(encoding))content=Buffer.from(data[key].content,encoding);return setImmediate(()=>callback(null,content)),promise};exports.assign=function(){let args=Array.from(arguments),target=args.shift()||{};return args.forEach((source)=>{Object.keys(source||{}).forEach((key)=>{if(["tls","auth"].includes(key)&&source[key]&&typeof source[key]==="object"){if(!target[key])target[key]={};Object.keys(source[key]).forEach((subKey)=>{target[key][subKey]=source[key][subKey]})}else target[key]=source[key]})}),target};exports.encodeXText=(str)=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(str))return str;let buf=Buffer.from(str),result="";for(let i3=0,len3=buf.length;i3<len3;i3++){let c=buf[i3];if(c<33||c>126||c===43||c===61)result+="+"+(c<16?"0":"")+c.toString(16).toUpperCase();else result+=String.fromCharCode(c)}return result};function resolveStream(stream2,callback){let responded=!1,chunks=[],chunklen=0;stream2.on("error",(err)=>{if(responded)return;responded=!0,callback(err)}),stream2.on("readable",()=>{let chunk;while((chunk=stream2.read())!==null)chunks.push(chunk),chunklen+=chunk.length}),stream2.on("end",()=>{if(responded)return;responded=!0;let value;try{value=Buffer.concat(chunks,chunklen)}catch(E){return callback(E)}callback(null,value)})}function createDefaultLogger(levels){let levelMaxLen=0,levelNames=new Map;levels.forEach((level)=>{if(level.length>levelMaxLen)levelMaxLen=level.length}),levels.forEach((level)=>{let levelName=level.toUpperCase();if(levelName.length<levelMaxLen)levelName+=" ".repeat(levelMaxLen-levelName.length);levelNames.set(level,levelName)});let print=(level,entry,message2,...args)=>{let prefix="";if(entry){if(entry.tnx==="server")prefix="S: ";else if(entry.tnx==="client")prefix="C: ";if(entry.sid)prefix="["+entry.sid+"] "+prefix;if(entry.cid)prefix="[#"+entry.cid+"] "+prefix}message2=util.format(message2,...args),message2.split(/\r?\n/).forEach((line2)=>{console.log("[%s] %s %s",new Date().toISOString().substr(0,19).replace(/T/," "),levelNames.get(level),prefix+line2)})},logger={};return levels.forEach((level)=>{logger[level]=print.bind(null,level)}),logger}});var require_mime_types=__commonJS((exports,module)=>{var path2=__require("path"),mimeTypes=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/geo+json","geojson"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["application/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]),extensions=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","application/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);module.exports={detectMimeType(filename){if(!filename)return"application/octet-stream";let parsed=path2.parse(filename),extension=(parsed.ext.substr(1)||parsed.name||"").split("?").shift().trim().toLowerCase(),value="application/octet-stream";if(extensions.has(extension))value=extensions.get(extension);if(Array.isArray(value))return value[0];return value},detectExtension(mimeType){if(!mimeType)return"bin";let parts=(mimeType||"").toLowerCase().trim().split("/"),rootType=parts.shift().trim(),subType=parts.join("/").trim();if(mimeTypes.has(rootType+"/"+subType)){let value=mimeTypes.get(rootType+"/"+subType);if(Array.isArray(value))return value[0];return value}switch(rootType){case"text":return"txt";default:return"bin"}}}});var require_punycode=__commonJS((exports,module)=>{var regexPunycode=/^xn--/,regexNonASCII=/[^\0-\x7F]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors4={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error3(type2){throw new RangeError(errors4[type2])}function map3(array,callback){let result=[],length=array.length;while(length--)result[length]=callback(array[length]);return result}function mapDomain(domain,callback){let parts=domain.split("@"),result="";if(parts.length>1)result=parts[0]+"@",domain=parts[1];domain=domain.replace(regexSeparators,".");let labels=domain.split("."),encoded=map3(labels,callback).join(".");return result+encoded}function ucs2decode(string){let output=[],counter=0,length=string.length;while(counter<length){let value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){let extra=string.charCodeAt(counter++);if((extra&64512)==56320)output.push(((value&1023)<<10)+(extra&1023)+65536);else output.push(value),counter--}else output.push(value)}return output}var ucs2encode=(codePoints)=>String.fromCodePoint(...codePoints),basicToDigit=function(codePoint){if(codePoint>=48&&codePoint<58)return 26+(codePoint-48);if(codePoint>=65&&codePoint<91)return codePoint-65;if(codePoint>=97&&codePoint<123)return codePoint-97;return 36},digitToBasic=function(digit,flag3){return digit+22+75*(digit<26)-((flag3!=0)<<5)},adapt=function(delta2,numPoints,firstTime){let k2=0;delta2=firstTime?floor(delta2/700):delta2>>1,delta2+=floor(delta2/numPoints);for(;delta2>455;k2+=36)delta2=floor(delta2/35);return floor(k2+36*delta2/(delta2+38))},decode4=function(input){let output=[],inputLength=input.length,i3=0,n=128,bias=72,basic=input.lastIndexOf("-");if(basic<0)basic=0;for(let j=0;j<basic;++j){if(input.charCodeAt(j)>=128)error3("not-basic");output.push(input.charCodeAt(j))}for(let index2=basic>0?basic+1:0;index2<inputLength;){let oldi=i3;for(let w=1,k2=36;;k2+=36){if(index2>=inputLength)error3("invalid-input");let digit=basicToDigit(input.charCodeAt(index2++));if(digit>=36)error3("invalid-input");if(digit>floor((2147483647-i3)/w))error3("overflow");i3+=digit*w;let t2=k2<=bias?1:k2>=bias+26?26:k2-bias;if(digit<t2)break;let baseMinusT=36-t2;if(w>floor(2147483647/baseMinusT))error3("overflow");w*=baseMinusT}let out=output.length+1;if(bias=adapt(i3-oldi,out,oldi==0),floor(i3/out)>2147483647-n)error3("overflow");n+=floor(i3/out),i3%=out,output.splice(i3++,0,n)}return String.fromCodePoint(...output)},encode3=function(input){let output=[];input=ucs2decode(input);let inputLength=input.length,n=128,delta2=0,bias=72;for(let currentValue of input)if(currentValue<128)output.push(stringFromCharCode(currentValue));let basicLength=output.length,handledCPCount=basicLength;if(basicLength)output.push("-");while(handledCPCount<inputLength){let m=2147483647;for(let currentValue of input)if(currentValue>=n&&currentValue<m)m=currentValue;let handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((2147483647-delta2)/handledCPCountPlusOne))error3("overflow");delta2+=(m-n)*handledCPCountPlusOne,n=m;for(let currentValue of input){if(currentValue<n&&++delta2>2147483647)error3("overflow");if(currentValue===n){let q=delta2;for(let k2=36;;k2+=36){let t2=k2<=bias?1:k2>=bias+26?26:k2-bias;if(q<t2)break;let qMinusT=q-t2,baseMinusT=36-t2;output.push(stringFromCharCode(digitToBasic(t2+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta2,handledCPCountPlusOne,handledCPCount===basicLength),delta2=0,++handledCPCount}}++delta2,++n}return output.join("")},toUnicode=function(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode4(string.slice(4).toLowerCase()):string})},toASCII=function(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode3(string):string})},punycode={version:"2.3.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode4,encode:encode3,toASCII,toUnicode};module.exports=punycode});var require_base64=__commonJS((exports,module)=>{var Transform3=__require("stream").Transform;function encode3(buffer2){if(typeof buffer2==="string")buffer2=Buffer.from(buffer2,"utf-8");return buffer2.toString("base64")}function wrap(str,lineLength){if(str=(str||"").toString(),lineLength=lineLength||76,str.length<=lineLength)return str;let result=[],pos=0,chunkLength=lineLength*1024;while(pos<str.length){let wrappedLines=str.substr(pos,chunkLength).replace(new RegExp(".{"+lineLength+"}","g"),`$&\r
`).trim();result.push(wrappedLines),pos+=chunkLength}return result.join(`\r
`).trim()}class Encoder extends Transform3{constructor(options){super();if(this.options=options||{},this.options.lineLength!==!1)this.options.lineLength=this.options.lineLength||76;this._curLine="",this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(chunk,encoding,done){if(encoding!=="buffer")chunk=Buffer.from(chunk,encoding);if(!chunk||!chunk.length)return setImmediate(done);if(this.inputBytes+=chunk.length,this._remainingBytes&&this._remainingBytes.length)chunk=Buffer.concat([this._remainingBytes,chunk],this._remainingBytes.length+chunk.length),this._remainingBytes=!1;if(chunk.length%3)this._remainingBytes=chunk.slice(chunk.length-chunk.length%3),chunk=chunk.slice(0,chunk.length-chunk.length%3);else this._remainingBytes=!1;let b64=this._curLine+encode3(chunk);if(this.options.lineLength){b64=wrap(b64,this.options.lineLength);let lastLF=b64.lastIndexOf(`
`);if(lastLF<0)this._curLine=b64,b64="";else if(lastLF===b64.length-1)this._curLine="";else this._curLine=b64.substr(lastLF+1),b64=b64.substr(0,lastLF+1)}if(b64)this.outputBytes+=b64.length,this.push(Buffer.from(b64,"ascii"));setImmediate(done)}_flush(done){if(this._remainingBytes&&this._remainingBytes.length)this._curLine+=encode3(this._remainingBytes);if(this._curLine)this._curLine=wrap(this._curLine,this.options.lineLength),this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii"),this._curLine="";done()}}module.exports={encode:encode3,wrap,Encoder}});var require_qp=__commonJS((exports,module)=>{var Transform3=__require("stream").Transform;function encode3(buffer2){if(typeof buffer2==="string")buffer2=Buffer.from(buffer2,"utf-8");let ranges=[[9],[10],[13],[32,60],[62,126]],result="",ord;for(let i3=0,len3=buffer2.length;i3<len3;i3++){if(ord=buffer2[i3],checkRanges(ord,ranges)&&!((ord===32||ord===9)&&(i3===len3-1||buffer2[i3+1]===10||buffer2[i3+1]===13))){result+=String.fromCharCode(ord);continue}result+="="+(ord<16?"0":"")+ord.toString(16).toUpperCase()}return result}function wrap(str,lineLength){if(str=(str||"").toString(),lineLength=lineLength||76,str.length<=lineLength)return str;let pos=0,len3=str.length,match,code,line2,lineMargin=Math.floor(lineLength/3),result="";while(pos<len3){if(line2=str.substr(pos,lineLength),match=line2.match(/\r\n/)){line2=line2.substr(0,match.index+match[0].length),result+=line2,pos+=line2.length;continue}if(line2.substr(-1)===`
`){result+=line2,pos+=line2.length;continue}else if(match=line2.substr(-lineMargin).match(/\n.*?$/)){line2=line2.substr(0,line2.length-(match[0].length-1)),result+=line2,pos+=line2.length;continue}else if(line2.length>lineLength-lineMargin&&(match=line2.substr(-lineMargin).match(/[ \t.,!?][^ \t.,!?]*$/)))line2=line2.substr(0,line2.length-(match[0].length-1));else if(line2.match(/[=][\da-f]{0,2}$/i)){if(match=line2.match(/[=][\da-f]{0,1}$/i))line2=line2.substr(0,line2.length-match[0].length);while(line2.length>3&&line2.length<len3-pos&&!line2.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(match=line2.match(/[=][\da-f]{2}$/gi))){if(code=parseInt(match[0].substr(1,2),16),code<128)break;if(line2=line2.substr(0,line2.length-3),code>=192)break}}if(pos+line2.length<len3&&line2.substr(-1)!==`
`){if(line2.length===lineLength&&line2.match(/[=][\da-f]{2}$/i))line2=line2.substr(0,line2.length-3);else if(line2.length===lineLength)line2=line2.substr(0,line2.length-1);pos+=line2.length,line2+=`=\r
`}else pos+=line2.length;result+=line2}return result}function checkRanges(nr,ranges){for(let i3=ranges.length-1;i3>=0;i3--){if(!ranges[i3].length)continue;if(ranges[i3].length===1&&nr===ranges[i3][0])return!0;if(ranges[i3].length===2&&nr>=ranges[i3][0]&&nr<=ranges[i3][1])return!0}return!1}class Encoder extends Transform3{constructor(options){super();if(this.options=options||{},this.options.lineLength!==!1)this.options.lineLength=this.options.lineLength||76;this._curLine="",this.inputBytes=0,this.outputBytes=0}_transform(chunk,encoding,done){let qp;if(encoding!=="buffer")chunk=Buffer.from(chunk,encoding);if(!chunk||!chunk.length)return done();if(this.inputBytes+=chunk.length,this.options.lineLength){if(qp=this._curLine+encode3(chunk),qp=wrap(qp,this.options.lineLength),qp=qp.replace(/(^|\n)([^\n]*)$/,(match,lineBreak,lastLine)=>{return this._curLine=lastLine,lineBreak}),qp)this.outputBytes+=qp.length,this.push(qp)}else qp=encode3(chunk),this.outputBytes+=qp.length,this.push(qp,"ascii");done()}_flush(done){if(this._curLine)this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii");done()}}module.exports={encode:encode3,wrap,Encoder}});var require_mime_funcs=__commonJS((exports,module)=>{var base642=require_base64(),qp=require_qp(),mimeTypes=require_mime_types();module.exports={isPlainText(value,isParam){if(typeof value!=="string"||(isParam?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(value))return!1;else return!0},hasLongerLines(str,lineLength){if(str.length>131072)return!0;return new RegExp("^.{"+(lineLength+1)+",}","m").test(str)},encodeWord(data,mimeWordEncoding,maxLength){mimeWordEncoding=(mimeWordEncoding||"Q").toString().toUpperCase().trim().charAt(0),maxLength=maxLength||0;let encodedStr,toCharset="UTF-8";if(maxLength&&maxLength>7+toCharset.length)maxLength-=7+toCharset.length;if(mimeWordEncoding==="Q")encodedStr=qp.encode(data).replace(/[^a-z0-9!*+\-/=]/gi,(chr)=>{let ord=chr.charCodeAt(0).toString(16).toUpperCase();if(chr===" ")return"_";else return"="+(ord.length===1?"0"+ord:ord)});else if(mimeWordEncoding==="B")encodedStr=typeof data==="string"?data:base642.encode(data),maxLength=maxLength?Math.max(3,(maxLength-maxLength%4)/4*3):0;if(maxLength&&(mimeWordEncoding!=="B"?encodedStr:base642.encode(data)).length>maxLength)if(mimeWordEncoding==="Q")encodedStr=this.splitMimeEncodedString(encodedStr,maxLength).join("?= =?"+toCharset+"?"+mimeWordEncoding+"?");else{let parts=[],lpart="";for(let i3=0,len3=encodedStr.length;i3<len3;i3++){let chr=encodedStr.charAt(i3);if(/[\ud83c\ud83d\ud83e]/.test(chr)&&i3<len3-1)chr+=encodedStr.charAt(++i3);if(Buffer.byteLength(lpart+chr)<=maxLength||i3===0)lpart+=chr;else parts.push(base642.encode(lpart)),lpart=chr}if(lpart)parts.push(base642.encode(lpart));if(parts.length>1)encodedStr=parts.join("?= =?"+toCharset+"?"+mimeWordEncoding+"?");else encodedStr=parts.join("")}else if(mimeWordEncoding==="B")encodedStr=base642.encode(data);return"=?"+toCharset+"?"+mimeWordEncoding+"?"+encodedStr+(encodedStr.substr(-2)==="?="?"":"?=")},encodeWords(value,mimeWordEncoding,maxLength,encodeAll){maxLength=maxLength||0;let encodedValue,firstMatch=value.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!firstMatch)return value;if(encodeAll)return this.encodeWord(value,mimeWordEncoding,maxLength);let lastMatch=value.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!lastMatch)return value;let startIndex=firstMatch.index+(firstMatch[0].match(/[^\s]/)||{index:0}).index,endIndex=lastMatch.index+(lastMatch[1]||"").length;return encodedValue=(startIndex?value.substr(0,startIndex):"")+this.encodeWord(value.substring(startIndex,endIndex),mimeWordEncoding||"Q",maxLength)+(endIndex<value.length?value.substr(endIndex):""),encodedValue},buildHeaderValue(structured){let paramsArray=[];return Object.keys(structured.params||{}).forEach((param)=>{let value=structured.params[param];if(!this.isPlainText(value,!0)||value.length>=75)this.buildHeaderParam(param,value,50).forEach((encodedParam)=>{if(!/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(encodedParam.value)||encodedParam.key.substr(-1)==="*")paramsArray.push(encodedParam.key+"="+encodedParam.value);else paramsArray.push(encodedParam.key+"="+JSON.stringify(encodedParam.value))});else if(/[\s'"\\;:/=(),<>@[\]?]|^-/.test(value))paramsArray.push(param+"="+JSON.stringify(value));else paramsArray.push(param+"="+value)}),structured.value+(paramsArray.length?"; "+paramsArray.join("; "):"")},buildHeaderParam(key,data,maxLength){let list=[],encodedStr=typeof data==="string"?data:(data||"").toString(),encodedStrArr,chr,ord,line2,startPos=0,i3,len3;if(maxLength=maxLength||50,this.isPlainText(data,!0)){if(encodedStr.length<=maxLength)return[{key,value:encodedStr}];if(encodedStr=encodedStr.replace(new RegExp(".{"+maxLength+"}","g"),(str)=>{return list.push({line:str}),""}),encodedStr)list.push({line:encodedStr})}else{if(/[\uD800-\uDBFF]/.test(encodedStr)){encodedStrArr=[];for(i3=0,len3=encodedStr.length;i3<len3;i3++)if(chr=encodedStr.charAt(i3),ord=chr.charCodeAt(0),ord>=55296&&ord<=56319&&i3<len3-1)chr+=encodedStr.charAt(i3+1),encodedStrArr.push(chr),i3++;else encodedStrArr.push(chr);encodedStr=encodedStrArr}line2="utf-8''";let encoded=!0;startPos=0;for(i3=0,len3=encodedStr.length;i3<len3;i3++){if(chr=encodedStr[i3],encoded)chr=this.safeEncodeURIComponent(chr);else if(chr=chr===" "?chr:this.safeEncodeURIComponent(chr),chr!==encodedStr[i3])if((this.safeEncodeURIComponent(line2)+chr).length>=maxLength)list.push({line:line2,encoded}),line2="",startPos=i3-1;else{encoded=!0,i3=startPos,line2="";continue}if((line2+chr).length>=maxLength)if(list.push({line:line2,encoded}),line2=chr=encodedStr[i3]===" "?" ":this.safeEncodeURIComponent(encodedStr[i3]),chr===encodedStr[i3])encoded=!1,startPos=i3-1;else encoded=!0;else line2+=chr}if(line2)list.push({line:line2,encoded})}return list.map((item,i4)=>({key:key+"*"+i4+(item.encoded?"*":""),value:item.line}))},parseHeaderValue(str){let response={value:!1,params:{}},key=!1,value="",type2="value",quote=!1,escaped=!1,chr;for(let i3=0,len3=str.length;i3<len3;i3++)if(chr=str.charAt(i3),type2==="key"){if(chr==="="){key=value.trim().toLowerCase(),type2="value",value="";continue}value+=chr}else{if(escaped)value+=chr;else if(chr==="\\"){escaped=!0;continue}else if(quote&&chr===quote)quote=!1;else if(!quote&&chr==='"')quote=chr;else if(!quote&&chr===";"){if(key===!1)response.value=value.trim();else response.params[key]=value.trim();type2="key",value=""}else value+=chr;escaped=!1}if(type2==="value")if(key===!1)response.value=value.trim();else response.params[key]=value.trim();else if(value.trim())response.params[value.trim().toLowerCase()]="";return Object.keys(response.params).forEach((key2)=>{let actualKey,nr,match,value2;if(match=key2.match(/(\*(\d+)|\*(\d+)\*|\*)$/)){if(actualKey=key2.substr(0,match.index),nr=Number(match[2]||match[3])||0,!response.params[actualKey]||typeof response.params[actualKey]!=="object")response.params[actualKey]={charset:!1,values:[]};if(value2=response.params[key2],nr===0&&match[0].substr(-1)==="*"&&(match=value2.match(/^([^']*)'[^']*'(.*)$/)))response.params[actualKey].charset=match[1]||"iso-8859-1",value2=match[2];response.params[actualKey].values[nr]=value2,delete response.params[key2]}}),Object.keys(response.params).forEach((key2)=>{let value2;if(response.params[key2]&&Array.isArray(response.params[key2].values))if(value2=response.params[key2].values.map((val)=>val||"").join(""),response.params[key2].charset)response.params[key2]="=?"+response.params[key2].charset+"?Q?"+value2.replace(/[=?_\s]/g,(s)=>{let c=s.charCodeAt(0).toString(16);if(s===" ")return"_";else return"%"+(c.length<2?"0":"")+c}).replace(/%/g,"=")+"?=";else response.params[key2]=value2}),response},detectExtension:(mimeType)=>mimeTypes.detectExtension(mimeType),detectMimeType:(extension)=>mimeTypes.detectMimeType(extension),foldLines(str,lineLength,afterSpace){str=(str||"").toString(),lineLength=lineLength||76;let pos=0,len3=str.length,result="",line2,match;while(pos<len3){if(line2=str.substr(pos,lineLength),line2.length<lineLength){result+=line2;break}if(match=line2.match(/^[^\n\r]*(\r?\n|\r)/)){line2=match[0],result+=line2,pos+=line2.length;continue}else if((match=line2.match(/(\s+)[^\s]*$/))&&match[0].length-(afterSpace?(match[1]||"").length:0)<line2.length)line2=line2.substr(0,line2.length-(match[0].length-(afterSpace?(match[1]||"").length:0)));else if(match=str.substr(pos+line2.length).match(/^[^\s]+(\s*)/))line2=line2+match[0].substr(0,match[0].length-(!afterSpace?(match[1]||"").length:0));if(result+=line2,pos+=line2.length,pos<len3)result+=`\r
`}return result},splitMimeEncodedString:(str,maxlen)=>{let curLine,match,chr,done,lines=[];maxlen=Math.max(maxlen||0,12);while(str.length){if(curLine=str.substr(0,maxlen),match=curLine.match(/[=][0-9A-F]?$/i))curLine=curLine.substr(0,match.index);done=!1;while(!done)if(done=!0,match=str.substr(curLine.length).match(/^[=]([0-9A-F]{2})/i)){if(chr=parseInt(match[1],16),chr<194&&chr>127)curLine=curLine.substr(0,curLine.length-3),done=!1}if(curLine.length)lines.push(curLine);str=str.substr(curLine.length)}return lines},encodeURICharComponent:(chr)=>{let res="",ord=chr.charCodeAt(0).toString(16).toUpperCase();if(ord.length%2)ord="0"+ord;if(ord.length>2)for(let i3=0,len3=ord.length/2;i3<len3;i3++)res+="%"+ord.substr(i3,2);else res+="%"+ord;return res},safeEncodeURIComponent(str){str=(str||"").toString();try{str=encodeURIComponent(str)}catch(E){return str.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return str.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,(chr)=>this.encodeURICharComponent(chr))}}});var require_addressparser=__commonJS((exports,module)=>{function _handleAddress(tokens){let isGroup=!1,state="text",address,addresses=[],data={address:[],comment:[],group:[],text:[]},i3,len3;for(i3=0,len3=tokens.length;i3<len3;i3++){let token=tokens[i3],prevToken=i3?tokens[i3-1]:null;if(token.type==="operator")switch(token.value){case"<":state="address";break;case"(":state="comment";break;case":":state="group",isGroup=!0;break;default:state="text";break}else if(token.value){if(state==="address")token.value=token.value.replace(/^[^<]*<\s*/,"");if(prevToken&&prevToken.noBreak&&data[state].length)data[state][data[state].length-1]+=token.value;else data[state].push(token.value)}}if(!data.text.length&&data.comment.length)data.text=data.comment,data.comment=[];if(isGroup)data.text=data.text.join(" "),addresses.push({name:data.text||address&&address.name,group:data.group.length?addressparser(data.group.join(",")):[]});else{if(!data.address.length&&data.text.length){for(i3=data.text.length-1;i3>=0;i3--)if(data.text[i3].match(/^[^@\s]+@[^@\s]+$/)){data.address=data.text.splice(i3,1);break}let _regexHandler=function(address2){if(!data.address.length)return data.address=[address2.trim()]," ";else return address2};if(!data.address.length){for(i3=data.text.length-1;i3>=0;i3--)if(data.text[i3]=data.text[i3].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,_regexHandler).trim(),data.address.length)break}}if(!data.text.length&&data.comment.length)data.text=data.comment,data.comment=[];if(data.address.length>1)data.text=data.text.concat(data.address.splice(1));if(data.text=data.text.join(" "),data.address=data.address.join(" "),!data.address&&isGroup)return[];else{if(address={address:data.address||data.text||"",name:data.text||data.address||""},address.address===address.name)if((address.address||"").match(/@/))address.name="";else address.address="";addresses.push(address)}}return addresses}class Tokenizer{constructor(str){this.str=(str||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let list=[];for(let i3=0,len3=this.str.length;i3<len3;i3++){let chr=this.str.charAt(i3),nextChr=i3<len3-1?this.str.charAt(i3+1):null;this.checkChar(chr,nextChr)}return this.list.forEach((node)=>{if(node.value=(node.value||"").toString().trim(),node.value)list.push(node)}),list}checkChar(chr,nextChr){if(this.escaped);else if(chr===this.operatorExpecting){if(this.node={type:"operator",value:chr},nextChr&&![" ","\t","\r",`
`,",",";"].includes(nextChr))this.node.noBreak=!0;this.list.push(this.node),this.node=null,this.operatorExpecting="",this.escaped=!1;return}else if(!this.operatorExpecting&&chr in this.operators){this.node={type:"operator",value:chr},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[chr],this.escaped=!1;return}else if(['"',"'"].includes(this.operatorExpecting)&&chr==="\\"){this.escaped=!0;return}if(!this.node)this.node={type:"text",value:""},this.list.push(this.node);if(chr===`
`)chr=" ";if(chr.charCodeAt(0)>=33||[" ","\t"].includes(chr))this.node.value+=chr;this.escaped=!1}}function addressparser(str,options){options=options||{};let tokens=new Tokenizer(str).tokenize(),addresses=[],address=[],parsedAddresses=[];if(tokens.forEach((token)=>{if(token.type==="operator"&&(token.value===","||token.value===";")){if(address.length)addresses.push(address);address=[]}else address.push(token)}),address.length)addresses.push(address);if(addresses.forEach((address2)=>{if(address2=_handleAddress(address2),address2.length)parsedAddresses=parsedAddresses.concat(address2)}),options.flatten){let addresses2=[],walkAddressList=(list)=>{list.forEach((address2)=>{if(address2.group)return walkAddressList(address2.group);else addresses2.push(address2)})};return walkAddressList(parsedAddresses),addresses2}return parsedAddresses}module.exports=addressparser});var require_last_newline=__commonJS((exports,module)=>{var Transform3=__require("stream").Transform;class LastNewline extends Transform3{constructor(){super();this.lastByte=!1}_transform(chunk,encoding,done){if(chunk.length)this.lastByte=chunk[chunk.length-1];this.push(chunk),done()}_flush(done){if(this.lastByte===10)return done();if(this.lastByte===13)return this.push(Buffer.from(`
`)),done();return this.push(Buffer.from(`\r
`)),done()}}module.exports=LastNewline});var require_le_windows=__commonJS((exports,module)=>{var stream2=__require("stream"),Transform3=stream2.Transform;class LeWindows extends Transform3{constructor(options){super(options);this.options=options||{},this.lastByte=!1}_transform(chunk,encoding,done){let buf,lastPos=0;for(let i3=0,len3=chunk.length;i3<len3;i3++)if(chunk[i3]===10){if(i3&&chunk[i3-1]!==13||!i3&&this.lastByte!==13){if(i3>lastPos)buf=chunk.slice(lastPos,i3),this.push(buf);this.push(Buffer.from(`\r
`)),lastPos=i3+1}}if(lastPos&&lastPos<chunk.length)buf=chunk.slice(lastPos),this.push(buf);else if(!lastPos)this.push(chunk);this.lastByte=chunk[chunk.length-1],done()}}module.exports=LeWindows});var require_le_unix=__commonJS((exports,module)=>{var stream2=__require("stream"),Transform3=stream2.Transform;class LeWindows extends Transform3{constructor(options){super(options);this.options=options||{}}_transform(chunk,encoding,done){let buf,lastPos=0;for(let i3=0,len3=chunk.length;i3<len3;i3++)if(chunk[i3]===13)buf=chunk.slice(lastPos,i3),lastPos=i3+1,this.push(buf);if(lastPos&&lastPos<chunk.length)buf=chunk.slice(lastPos),this.push(buf);else if(!lastPos)this.push(chunk);done()}}module.exports=LeWindows});var require_mime_node=__commonJS((exports,module)=>{var crypto3=__require("crypto"),fs4=__require("fs"),punycode=require_punycode(),PassThrough=__require("stream").PassThrough,shared=require_shared(),mimeFuncs=require_mime_funcs(),qp=require_qp(),base642=require_base64(),addressparser=require_addressparser(),nmfetch=require_fetch(),LastNewline=require_last_newline(),LeWindows=require_le_windows(),LeUnix=require_le_unix();class MimeNode{constructor(contentType,options){if(this.nodeCounter=0,options=options||{},this.baseBoundary=options.baseBoundary||crypto3.randomBytes(8).toString("hex"),this.boundaryPrefix=options.boundaryPrefix||"--_NmP",this.disableFileAccess=!!options.disableFileAccess,this.disableUrlAccess=!!options.disableUrlAccess,this.normalizeHeaderKey=options.normalizeHeaderKey,this.date=new Date,this.rootNode=options.rootNode||this,this.keepBcc=!!options.keepBcc,options.filename){if(this.filename=options.filename,!contentType)contentType=mimeFuncs.detectMimeType(this.filename.split(".").pop())}if(this.textEncoding=(options.textEncoding||"").toString().trim().charAt(0).toUpperCase(),this.parentNode=options.parentNode,this.hostname=options.hostname,this.newline=options.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],contentType)this.setHeader("Content-Type",contentType)}createChild(contentType,options){if(!options&&typeof contentType==="object")options=contentType,contentType=void 0;let node=new MimeNode(contentType,options);return this.appendChild(node),node}appendChild(childNode){if(childNode.rootNode!==this.rootNode)childNode.rootNode=this.rootNode,childNode._nodeId=++this.rootNode.nodeCounter;return childNode.parentNode=this,this.childNodes.push(childNode),childNode}replace(node){if(node===this)return this;return this.parentNode.childNodes.forEach((childNode,i3)=>{if(childNode===this)node.rootNode=this.rootNode,node.parentNode=this.parentNode,node._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,node.parentNode.childNodes[i3]=node}),node}remove(){if(!this.parentNode)return this;for(let i3=this.parentNode.childNodes.length-1;i3>=0;i3--)if(this.parentNode.childNodes[i3]===this)return this.parentNode.childNodes.splice(i3,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(key,value){let added=!1,headerValue;if(!value&&key&&typeof key==="object"){if(key.key&&"value"in key)this.setHeader(key.key,key.value);else if(Array.isArray(key))key.forEach((i3)=>{this.setHeader(i3.key,i3.value)});else Object.keys(key).forEach((i3)=>{this.setHeader(i3,key[i3])});return this}key=this._normalizeHeaderKey(key),headerValue={key,value};for(let i3=0,len3=this._headers.length;i3<len3;i3++)if(this._headers[i3].key===key)if(!added)this._headers[i3]=headerValue,added=!0;else this._headers.splice(i3,1),i3--,len3--;if(!added)this._headers.push(headerValue);return this}addHeader(key,value){if(!value&&key&&typeof key==="object"){if(key.key&&key.value)this.addHeader(key.key,key.value);else if(Array.isArray(key))key.forEach((i3)=>{this.addHeader(i3.key,i3.value)});else Object.keys(key).forEach((i3)=>{this.addHeader(i3,key[i3])});return this}else if(Array.isArray(value))return value.forEach((val)=>{this.addHeader(key,val)}),this;return this._headers.push({key:this._normalizeHeaderKey(key),value}),this}getHeader(key){key=this._normalizeHeaderKey(key);for(let i3=0,len3=this._headers.length;i3<len3;i3++)if(this._headers[i3].key===key)return this._headers[i3].value}setContent(content){if(this.content=content,typeof this.content.pipe==="function")this._contentErrorHandler=(err)=>{this.content.removeListener("error",this._contentErrorHandler),this.content=err},this.content.once("error",this._contentErrorHandler);else if(typeof this.content==="string"){if(this._isPlainText=mimeFuncs.isPlainText(this.content),this._isPlainText&&mimeFuncs.hasLongerLines(this.content,76))this._hasLongLines=!0}return this}build(callback){let promise;if(!callback)promise=new Promise((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)});let stream2=this.createReadStream(),buf=[],buflen=0,returned=!1;return stream2.on("readable",()=>{let chunk;while((chunk=stream2.read())!==null)buf.push(chunk),buflen+=chunk.length}),stream2.once("error",(err)=>{if(returned)return;return returned=!0,callback(err)}),stream2.once("end",(chunk)=>{if(returned)return;if(returned=!0,chunk&&chunk.length)buf.push(chunk),buflen+=chunk.length;return callback(null,Buffer.concat(buf,buflen))}),promise}getTransferEncoding(){let transferEncoding=!1,contentType=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();if(this.content){if(transferEncoding=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim(),!transferEncoding||!["base64","quoted-printable"].includes(transferEncoding)){if(/^text\//i.test(contentType))if(this._isPlainText&&!this._hasLongLines)transferEncoding="7bit";else if(typeof this.content==="string"||this.content instanceof Buffer)transferEncoding=this._getTextEncoding(this.content)==="Q"?"quoted-printable":"base64";else transferEncoding=this.textEncoding==="B"?"base64":"quoted-printable";else if(!/^(multipart|message)\//i.test(contentType))transferEncoding=transferEncoding||"base64"}}return transferEncoding}buildHeaders(){let transferEncoding=this.getTransferEncoding(),headers=[];if(transferEncoding)this.setHeader("Content-Transfer-Encoding",transferEncoding);if(this.filename&&!this.getHeader("Content-Disposition"))this.setHeader("Content-Disposition","attachment");if(this.rootNode===this){if(!this.getHeader("Date"))this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000"));if(this.messageId(),!this.getHeader("MIME-Version"))this.setHeader("MIME-Version","1.0");for(let i3=this._headers.length-2;i3>=0;i3--){let header=this._headers[i3];if(header.key==="Content-Type")this._headers.splice(i3,1),this._headers.push(header)}}return this._headers.forEach((header)=>{let{key,value}=header,structured,param,options={};if(value&&typeof value==="object"&&!["From","Sender","To","Cc","Bcc","Reply-To","Date","References"].includes(key)){if(Object.keys(value).forEach((key2)=>{if(key2!=="value")options[key2]=value[key2]}),value=(value.value||"").toString(),!value.trim())return}if(options.prepared){if(options.foldLines)headers.push(mimeFuncs.foldLines(key+": "+value));else headers.push(key+": "+value);return}switch(header.key){case"Content-Disposition":if(structured=mimeFuncs.parseHeaderValue(value),this.filename)structured.params.filename=this.filename;value=mimeFuncs.buildHeaderValue(structured);break;case"Content-Type":if(structured=mimeFuncs.parseHeaderValue(value),this._handleContentType(structured),structured.value.match(/^text\/plain\b/)&&typeof this.content==="string"&&/[\u0080-\uFFFF]/.test(this.content))structured.params.charset="utf-8";if(value=mimeFuncs.buildHeaderValue(structured),this.filename){if(param=this._encodeWords(this.filename),param!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(param))param='"'+param+'"';value+="; name="+param}break;case"Bcc":if(!this.keepBcc)return;break}if(value=this._encodeHeaderValue(key,value),!(value||"").toString().trim())return;if(typeof this.normalizeHeaderKey==="function"){let normalized=this.normalizeHeaderKey(key,value);if(normalized&&typeof normalized==="string"&&normalized.length)key=normalized}headers.push(mimeFuncs.foldLines(key+": "+value,76))}),headers.join(`\r
`)}createReadStream(options){options=options||{};let stream2=new PassThrough(options),outputStream=stream2,transform2;this.stream(stream2,options,(err)=>{if(err){outputStream.emit("error",err);return}stream2.end()});for(let i3=0,len3=this._transforms.length;i3<len3;i3++)transform2=typeof this._transforms[i3]==="function"?this._transforms[i3]():this._transforms[i3],outputStream.once("error",(err)=>{transform2.emit("error",err)}),outputStream=outputStream.pipe(transform2);transform2=new LastNewline,outputStream.once("error",(err)=>{transform2.emit("error",err)}),outputStream=outputStream.pipe(transform2);for(let i3=0,len3=this._processFuncs.length;i3<len3;i3++)transform2=this._processFuncs[i3],outputStream=transform2(outputStream);if(this.newline){let newlineTransform=["win","windows","dos",`\r
`].includes(this.newline.toString().toLowerCase())?new LeWindows:new LeUnix,stream3=outputStream.pipe(newlineTransform);return outputStream.on("error",(err)=>stream3.emit("error",err)),stream3}return outputStream}transform(transform2){this._transforms.push(transform2)}processFunc(processFunc){this._processFuncs.push(processFunc)}stream(outputStream,options,done){let transferEncoding=this.getTransferEncoding(),contentStream,localStream,returned=!1,callback=(err)=>{if(returned)return;returned=!0,done(err)},finalize=()=>{let childId=0,processChildNode=()=>{if(childId>=this.childNodes.length)return outputStream.write(`\r
--`+this.boundary+`--\r
`),callback();let child=this.childNodes[childId++];outputStream.write((childId>1?`\r
`:"")+"--"+this.boundary+`\r
`),child.stream(outputStream,options,(err)=>{if(err)return callback(err);setImmediate(processChildNode)})};if(this.multipart)setImmediate(processChildNode);else return callback()},sendContent=()=>{if(this.content){if(Object.prototype.toString.call(this.content)==="[object Error]")return callback(this.content);if(typeof this.content.pipe==="function")this.content.removeListener("error",this._contentErrorHandler),this._contentErrorHandler=(err)=>callback(err),this.content.once("error",this._contentErrorHandler);let createStream=()=>{if(["quoted-printable","base64"].includes(transferEncoding))contentStream=new(transferEncoding==="base64"?base642:qp).Encoder(options),contentStream.pipe(outputStream,{end:!1}),contentStream.once("end",finalize),contentStream.once("error",(err)=>callback(err)),localStream=this._getStream(this.content),localStream.pipe(contentStream);else localStream=this._getStream(this.content),localStream.pipe(outputStream,{end:!1}),localStream.once("end",finalize);localStream.once("error",(err)=>callback(err))};if(this.content._resolve){let chunks=[],chunklen=0,returned2=!1,sourceStream=this._getStream(this.content);sourceStream.on("error",(err)=>{if(returned2)return;returned2=!0,callback(err)}),sourceStream.on("readable",()=>{let chunk;while((chunk=sourceStream.read())!==null)chunks.push(chunk),chunklen+=chunk.length}),sourceStream.on("end",()=>{if(returned2)return;returned2=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(chunks,chunklen),setImmediate(createStream)})}else setImmediate(createStream);return}else return setImmediate(finalize)};if(this._raw)setImmediate(()=>{if(Object.prototype.toString.call(this._raw)==="[object Error]")return callback(this._raw);if(typeof this._raw.pipe==="function")this._raw.removeListener("error",this._contentErrorHandler);let raw=this._getStream(this._raw);raw.pipe(outputStream,{end:!1}),raw.on("error",(err)=>outputStream.emit("error",err)),raw.on("end",finalize)});else outputStream.write(this.buildHeaders()+`\r
\r
`),setImmediate(sendContent)}setEnvelope(envelope){let list;if(this._envelope={from:!1,to:[]},envelope.from){if(list=[],this._convertAddresses(this._parseAddresses(envelope.from),list),list=list.filter((address)=>address&&address.address),list.length&&list[0])this._envelope.from=list[0].address}["to","cc","bcc"].forEach((key)=>{if(envelope[key])this._convertAddresses(this._parseAddresses(envelope[key]),this._envelope.to)}),this._envelope.to=this._envelope.to.map((to)=>to.address).filter((address)=>address);let standardFields=["to","cc","bcc","from"];return Object.keys(envelope).forEach((key)=>{if(!standardFields.includes(key))this._envelope[key]=envelope[key]}),this}getAddresses(){let addresses={};return this._headers.forEach((header)=>{let key=header.key.toLowerCase();if(["from","sender","reply-to","to","cc","bcc"].includes(key)){if(!Array.isArray(addresses[key]))addresses[key]=[];this._convertAddresses(this._parseAddresses(header.value),addresses[key])}}),addresses}getEnvelope(){if(this._envelope)return this._envelope;let envelope={from:!1,to:[]};return this._headers.forEach((header)=>{let list=[];if(header.key==="From"||!envelope.from&&["Reply-To","Sender"].includes(header.key)){if(this._convertAddresses(this._parseAddresses(header.value),list),list.length&&list[0])envelope.from=list[0].address}else if(["To","Cc","Bcc"].includes(header.key))this._convertAddresses(this._parseAddresses(header.value),envelope.to)}),envelope.to=envelope.to.map((to)=>to.address),envelope}messageId(){let messageId=this.getHeader("Message-ID");if(!messageId)messageId=this._generateMessageId(),this.setHeader("Message-ID",messageId);return messageId}setRaw(raw){if(this._raw=raw,this._raw&&typeof this._raw.pipe==="function")this._contentErrorHandler=(err)=>{this._raw.removeListener("error",this._contentErrorHandler),this._raw=err},this._raw.once("error",this._contentErrorHandler);return this}_getStream(content){let contentStream;if(content._resolvedValue)return contentStream=new PassThrough,setImmediate(()=>{try{contentStream.end(content._resolvedValue)}catch(err){contentStream.emit("error",err)}}),contentStream;else if(typeof content.pipe==="function")return content;else if(content&&typeof content.path==="string"&&!content.href){if(this.disableFileAccess)return contentStream=new PassThrough,setImmediate(()=>contentStream.emit("error",new Error("File access rejected for "+content.path))),contentStream;return fs4.createReadStream(content.path)}else if(content&&typeof content.href==="string"){if(this.disableUrlAccess)return contentStream=new PassThrough,setImmediate(()=>contentStream.emit("error",new Error("Url access rejected for "+content.href))),contentStream;return nmfetch(content.href,{headers:content.httpHeaders})}else return contentStream=new PassThrough,setImmediate(()=>{try{contentStream.end(content||"")}catch(err){contentStream.emit("error",err)}}),contentStream}_parseAddresses(addresses){return[].concat.apply([],[].concat(addresses).map((address)=>{if(address&&address.address)return address.address=this._normalizeAddress(address.address),address.name=address.name||"",[address];return addressparser(address)}))}_normalizeHeaderKey(key){return key=(key||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,(c)=>c.toUpperCase()).replace(/^Content-Features$/i,"Content-features"),key}_handleContentType(structured){if(this.contentType=structured.value.trim().toLowerCase(),this.multipart=/^multipart\//i.test(this.contentType)?this.contentType.substr(this.contentType.indexOf("/")+1):!1,this.multipart)this.boundary=structured.params.boundary=structured.params.boundary||this.boundary||this._generateBoundary();else this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(key,value){switch(key=this._normalizeHeaderKey(key),key){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(value));case"Message-ID":case"In-Reply-To":case"Content-Id":if(value=(value||"").toString().replace(/\r?\n|\r/g," "),value.charAt(0)!=="<")value="<"+value;if(value.charAt(value.length-1)!==">")value=value+">";return value;case"References":return value=[].concat.apply([],[].concat(value||"").map((elm)=>{return elm=(elm||"").toString().replace(/\r?\n|\r/g," ").trim(),elm.replace(/<[^>]*>/g,(str)=>str.replace(/\s/g,"")).split(/\s+/)})).map((elm)=>{if(elm.charAt(0)!=="<")elm="<"+elm;if(elm.charAt(elm.length-1)!==">")elm=elm+">";return elm}),value.join(" ").trim();case"Date":if(Object.prototype.toString.call(value)==="[object Date]")return value.toUTCString().replace(/GMT/,"+0000");return value=(value||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(value);case"Content-Type":case"Content-Disposition":return(value||"").toString().replace(/\r?\n|\r/g," ");default:return value=(value||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(value)}}_convertAddresses(addresses,uniqueList){let values3=[];return uniqueList=uniqueList||[],[].concat(addresses||[]).forEach((address)=>{if(address.address){if(address.address=this._normalizeAddress(address.address),!address.name)values3.push(address.address.indexOf(" ")>=0?`<${address.address}>`:`${address.address}`);else if(address.name)values3.push(`${this._encodeAddressName(address.name)} <${address.address}>`);if(address.address){if(!uniqueList.filter((a)=>a.address===address.address).length)uniqueList.push(address)}}else if(address.group){let groupListAddresses=(address.group.length?this._convertAddresses(address.group,uniqueList):"").trim();values3.push(`${this._encodeAddressName(address.name)}:${groupListAddresses};`)}}),values3.join(", ")}_normalizeAddress(address){address=(address||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim();let lastAt=address.lastIndexOf("@");if(lastAt<0)return address;let user=address.substr(0,lastAt),domain=address.substr(lastAt+1),encodedDomain;try{encodedDomain=punycode.toASCII(domain.toLowerCase())}catch(err){}if(user.indexOf(" ")>=0){if(user.charAt(0)!=='"')user='"'+user;if(user.substr(-1)!=='"')user=user+'"'}return`${user}@${encodedDomain}`}_encodeAddressName(name){if(!/^[\w ]*$/.test(name))if(/^[\x20-\x7e]*$/.test(name))return'"'+name.replace(/([\\"])/g,"\\$1")+'"';else return mimeFuncs.encodeWord(name,this._getTextEncoding(name),52);return name}_encodeWords(value){return mimeFuncs.encodeWords(value,this._getTextEncoding(value),52,!0)}_getTextEncoding(value){value=(value||"").toString();let encoding=this.textEncoding,latinLen,nonLatinLen;if(!encoding)nonLatinLen=(value.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,latinLen=(value.match(/[a-z]/gi)||[]).length,encoding=nonLatinLen<latinLen?"Q":"B";return encoding}_generateMessageId(){return"<"+[2,2,2,6].reduce((prev,len3)=>prev+"-"+crypto3.randomBytes(len3).toString("hex"),crypto3.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||"localhost").split("@").pop()+">"}}module.exports=MimeNode});var require_mail_composer=__commonJS((exports,module)=>{var MimeNode=require_mime_node(),mimeFuncs=require_mime_funcs(),parseDataURI=require_shared().parseDataURI;class MailComposer{constructor(mail){this.mail=mail||{},this.message=!1}compile(){if(this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter((alternative)=>/^text\/html\b/i.test(alternative.contentType)).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!!(this._htmlNode&&this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&this._attachments.attached.length===1,this.mail.raw)this.message=new MimeNode("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw);else if(this._useMixed)this.message=this._createMixed();else if(this._useAlternative)this.message=this._createAlternative();else if(this._useRelated)this.message=this._createRelated();else this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""});if(this.mail.headers)this.message.addHeader(this.mail.headers);if(["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach((header)=>{let key=header.replace(/-(\w)/g,(o,c)=>c.toUpperCase());if(this.mail[key])this.message.setHeader(header,this.mail[key])}),this.mail.envelope)this.message.setEnvelope(this.mail.envelope);return this.message.messageId(),this.message}getAttachments(findRelated){let icalEvent,eventObject,attachments=[].concat(this.mail.attachments||[]).map((attachment,i3)=>{let data,isMessageNode=/^message\//i.test(attachment.contentType);if(/^data:/i.test(attachment.path||attachment.href))attachment=this._processDataUrl(attachment);let contentType=attachment.contentType||mimeFuncs.detectMimeType(attachment.filename||attachment.path||attachment.href||"bin"),isImage=/^image\//i.test(contentType),contentDisposition=attachment.contentDisposition||(isMessageNode||isImage&&attachment.cid?"inline":"attachment");if(data={contentType,contentDisposition,contentTransferEncoding:"contentTransferEncoding"in attachment?attachment.contentTransferEncoding:"base64"},attachment.filename)data.filename=attachment.filename;else if(!isMessageNode&&attachment.filename!==!1){if(data.filename=(attachment.path||attachment.href||"").split("/").pop().split("?").shift()||"attachment-"+(i3+1),data.filename.indexOf(".")<0)data.filename+="."+mimeFuncs.detectExtension(data.contentType)}if(/^https?:\/\//i.test(attachment.path))attachment.href=attachment.path,attachment.path=void 0;if(attachment.cid)data.cid=attachment.cid;if(attachment.raw)data.raw=attachment.raw;else if(attachment.path)data.content={path:attachment.path};else if(attachment.href)data.content={href:attachment.href,httpHeaders:attachment.httpHeaders};else data.content=attachment.content||"";if(attachment.encoding)data.encoding=attachment.encoding;if(attachment.headers)data.headers=attachment.headers;return data});if(this.mail.icalEvent){if(typeof this.mail.icalEvent==="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw))icalEvent=this.mail.icalEvent;else icalEvent={content:this.mail.icalEvent};if(eventObject={},Object.keys(icalEvent).forEach((key)=>{eventObject[key]=icalEvent[key]}),eventObject.contentType="application/ics",!eventObject.headers)eventObject.headers={};eventObject.filename=eventObject.filename||"invite.ics",eventObject.headers["Content-Disposition"]="attachment",eventObject.headers["Content-Transfer-Encoding"]="base64"}if(!findRelated)return{attached:attachments.concat(eventObject||[]),related:[]};else return{attached:attachments.filter((attachment)=>!attachment.cid).concat(eventObject||[]),related:attachments.filter((attachment)=>!!attachment.cid)}}getAlternatives(){let alternatives=[],text3,html,watchHtml,amp,icalEvent,eventObject;if(this.mail.text){if(typeof this.mail.text==="object"&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw))text3=this.mail.text;else text3={content:this.mail.text};text3.contentType="text/plain; charset=utf-8"}if(this.mail.watchHtml){if(typeof this.mail.watchHtml==="object"&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw))watchHtml=this.mail.watchHtml;else watchHtml={content:this.mail.watchHtml};watchHtml.contentType="text/watch-html; charset=utf-8"}if(this.mail.amp){if(typeof this.mail.amp==="object"&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw))amp=this.mail.amp;else amp={content:this.mail.amp};amp.contentType="text/x-amp-html; charset=utf-8"}if(this.mail.icalEvent){if(typeof this.mail.icalEvent==="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw))icalEvent=this.mail.icalEvent;else icalEvent={content:this.mail.icalEvent};if(eventObject={},Object.keys(icalEvent).forEach((key)=>{eventObject[key]=icalEvent[key]}),eventObject.content&&typeof eventObject.content==="object")eventObject.content._resolve=!0;if(eventObject.filename=!1,eventObject.contentType="text/calendar; charset=utf-8; method="+(eventObject.method||"PUBLISH").toString().trim().toUpperCase(),!eventObject.headers)eventObject.headers={}}if(this.mail.html){if(typeof this.mail.html==="object"&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw))html=this.mail.html;else html={content:this.mail.html};html.contentType="text/html; charset=utf-8"}return[].concat(text3||[]).concat(watchHtml||[]).concat(amp||[]).concat(html||[]).concat(eventObject||[]).concat(this.mail.alternatives||[]).forEach((alternative)=>{let data;if(/^data:/i.test(alternative.path||alternative.href))alternative=this._processDataUrl(alternative);if(data={contentType:alternative.contentType||mimeFuncs.detectMimeType(alternative.filename||alternative.path||alternative.href||"txt"),contentTransferEncoding:alternative.contentTransferEncoding},alternative.filename)data.filename=alternative.filename;if(/^https?:\/\//i.test(alternative.path))alternative.href=alternative.path,alternative.path=void 0;if(alternative.raw)data.raw=alternative.raw;else if(alternative.path)data.content={path:alternative.path};else if(alternative.href)data.content={href:alternative.href};else data.content=alternative.content||"";if(alternative.encoding)data.encoding=alternative.encoding;if(alternative.headers)data.headers=alternative.headers;alternatives.push(data)}),alternatives}_createMixed(parentNode){let node;if(!parentNode)node=new MimeNode("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});else node=parentNode.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});if(this._useAlternative)this._createAlternative(node);else if(this._useRelated)this._createRelated(node);return[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach((element)=>{if(!this._useRelated||element!==this._htmlNode)this._createContentNode(node,element)}),node}_createAlternative(parentNode){let node;if(!parentNode)node=new MimeNode("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});else node=parentNode.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});return this._alternatives.forEach((alternative)=>{if(this._useRelated&&this._htmlNode===alternative)this._createRelated(node);else this._createContentNode(node,alternative)}),node}_createRelated(parentNode){let node;if(!parentNode)node=new MimeNode('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});else node=parentNode.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});return this._createContentNode(node,this._htmlNode),this._attachments.related.forEach((alternative)=>this._createContentNode(node,alternative)),node}_createContentNode(parentNode,element){element=element||{},element.content=element.content||"";let node,encoding=(element.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!parentNode)node=new MimeNode(element.contentType,{filename:element.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});else node=parentNode.createChild(element.contentType,{filename:element.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline});if(element.headers)node.addHeader(element.headers);if(element.cid)node.setHeader("Content-Id","<"+element.cid.replace(/[<>]/g,"")+">");if(element.contentTransferEncoding)node.setHeader("Content-Transfer-Encoding",element.contentTransferEncoding);else if(this.mail.encoding&&/^text\//i.test(element.contentType))node.setHeader("Content-Transfer-Encoding",this.mail.encoding);if(!/^text\//i.test(element.contentType)||element.contentDisposition)node.setHeader("Content-Disposition",element.contentDisposition||(element.cid&&/^image\//i.test(element.contentType)?"inline":"attachment"));if(typeof element.content==="string"&&!["utf8","usascii","ascii"].includes(encoding))element.content=Buffer.from(element.content,encoding);if(element.raw)node.setRaw(element.raw);else node.setContent(element.content);return node}_processDataUrl(element){let parsedDataUri;if((element.path||element.href).match(/^data:/))parsedDataUri=parseDataURI(element.path||element.href);if(!parsedDataUri)return element;if(element.content=parsedDataUri.data,element.contentType=element.contentType||parsedDataUri.contentType,"path"in element)element.path=!1;if("href"in element)element.href=!1;return element}}module.exports=MailComposer});var require_message_parser=__commonJS((exports,module)=>{var Transform3=__require("stream").Transform;class MessageParser extends Transform3{constructor(options){super(options);this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(data){let lblen=this.lastBytes.length,nblen=Math.min(data.length,lblen);for(let i3=0,len3=lblen-nblen;i3<len3;i3++)this.lastBytes[i3]=this.lastBytes[i3+nblen];for(let i3=1;i3<=nblen;i3++)this.lastBytes[lblen-i3]=data[data.length-i3]}checkHeaders(data){if(this.headersParsed)return!0;let lblen=this.lastBytes.length,headerPos=0;this.curLinePos=0;for(let i3=0,len3=this.lastBytes.length+data.length;i3<len3;i3++){let chr;if(i3<lblen)chr=this.lastBytes[i3];else chr=data[i3-lblen];if(chr===10&&i3){let pr1=i3-1<lblen?this.lastBytes[i3-1]:data[i3-1-lblen],pr2=i3>1?i3-2<lblen?this.lastBytes[i3-2]:data[i3-2-lblen]:!1;if(pr1===10){this.headersParsed=!0,headerPos=i3-lblen+1,this.headerBytes+=headerPos;break}else if(pr1===13&&pr2===10){this.headersParsed=!0,headerPos=i3-lblen+1,this.headerBytes+=headerPos;break}}}if(this.headersParsed){if(this.headerChunks.push(data.slice(0,headerPos)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit("headers",this.parseHeaders()),data.length-1>headerPos){let chunk=data.slice(headerPos);this.bodySize+=chunk.length,setImmediate(()=>this.push(chunk))}return!1}else this.headerBytes+=data.length,this.headerChunks.push(data);return this.updateLastBytes(data),!1}_transform(chunk,encoding,callback){if(!chunk||!chunk.length)return callback();if(typeof chunk==="string")chunk=Buffer.from(chunk,encoding);let headersFound;try{headersFound=this.checkHeaders(chunk)}catch(E){return callback(E)}if(headersFound)this.bodySize+=chunk.length,this.push(chunk);setImmediate(callback)}_flush(callback){if(this.headerChunks){let chunk=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=chunk.length,this.push(chunk),this.headerChunks=null}callback()}parseHeaders(){let lines=(this.rawHeaders||"").toString().split(/\r?\n/);for(let i3=lines.length-1;i3>0;i3--)if(/^\s/.test(lines[i3]))lines[i3-1]+=`
`+lines[i3],lines.splice(i3,1);return lines.filter((line2)=>line2.trim()).map((line2)=>({key:line2.substr(0,line2.indexOf(":")).trim().toLowerCase(),line:line2}))}}module.exports=MessageParser});var require_relaxed_body=__commonJS((exports,module)=>{var Transform3=__require("stream").Transform,crypto3=__require("crypto");class RelaxedBody extends Transform3{constructor(options){super();options=options||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=crypto3.createHash(options.hashAlgo||"sha1"),this.remainder="",this.byteLength=0,this.debug=options.debug,this._debugBody=options.debug?[]:!1}updateHash(chunk){let bodyStr,nextRemainder="",state="file";for(let i3=chunk.length-1;i3>=0;i3--){let c=chunk[i3];if(state==="file"&&(c===10||c===13));else if(state==="file"&&(c===9||c===32))state="line";else if(state==="line"&&(c===9||c===32));else if(state==="file"||state==="line"){if(state="body",i3===chunk.length-1)break}if(i3===0){if(state==="file"&&(!this.remainder||/[\r\n]$/.test(this.remainder))||state==="line"&&(!this.remainder||/[ \t]$/.test(this.remainder))){this.remainder+=chunk.toString("binary");return}else if(state==="line"||state==="file"){nextRemainder=chunk.toString("binary"),chunk=!1;break}}if(state!=="body")continue;nextRemainder=chunk.slice(i3+1).toString("binary"),chunk=chunk.slice(0,i3+1);break}let needsFixing=!!this.remainder;if(chunk&&!needsFixing){for(let i3=0,len3=chunk.length;i3<len3;i3++)if(i3&&chunk[i3]===10&&chunk[i3-1]!==13){needsFixing=!0;break}else if(i3&&chunk[i3]===13&&chunk[i3-1]===32){needsFixing=!0;break}else if(i3&&chunk[i3]===32&&chunk[i3-1]===32){needsFixing=!0;break}else if(chunk[i3]===9){needsFixing=!0;break}}if(needsFixing)bodyStr=this.remainder+(chunk?chunk.toString("binary"):""),this.remainder=nextRemainder,bodyStr=bodyStr.replace(/\r?\n/g,`
`).replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,`\r
`),chunk=Buffer.from(bodyStr,"binary");else if(nextRemainder)this.remainder=nextRemainder;if(this.debug)this._debugBody.push(chunk);this.bodyHash.update(chunk)}_transform(chunk,encoding,callback){if(!chunk||!chunk.length)return callback();if(typeof chunk==="string")chunk=Buffer.from(chunk,encoding);this.updateHash(chunk),this.byteLength+=chunk.length,this.push(chunk),callback()}_flush(callback){if(/[\r\n]$/.test(this.remainder)&&this.byteLength>2)this.bodyHash.update(Buffer.from(`\r
`));if(!this.byteLength)this.push(Buffer.from(`\r
`));this.emit("hash",this.bodyHash.digest("base64"),this.debug?Buffer.concat(this._debugBody):!1),callback()}}module.exports=RelaxedBody});var require_sign=__commonJS((exports,module)=>{var punycode=require_punycode(),mimeFuncs=require_mime_funcs(),crypto3=__require("crypto");module.exports=(headers,hashAlgo,bodyHash,options)=>{options=options||{};let defaultFieldNames="From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",fieldNames=options.headerFieldNames||defaultFieldNames,canonicalizedHeaderData=relaxedHeaders(headers,fieldNames,options.skipFields),dkimHeader=generateDKIMHeader(options.domainName,options.keySelector,canonicalizedHeaderData.fieldNames,hashAlgo,bodyHash),signer,signature;canonicalizedHeaderData.headers+="dkim-signature:"+relaxedHeaderLine(dkimHeader),signer=crypto3.createSign(("rsa-"+hashAlgo).toUpperCase()),signer.update(canonicalizedHeaderData.headers);try{signature=signer.sign(options.privateKey,"base64")}catch(E){return!1}return dkimHeader+signature.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,`$&\r
 `).trim()};module.exports.relaxedHeaders=relaxedHeaders;function generateDKIMHeader(domainName,keySelector,fieldNames,hashAlgo,bodyHash){let dkim=["v=1","a=rsa-"+hashAlgo,"c=relaxed/relaxed","d="+punycode.toASCII(domainName),"q=dns/txt","s="+keySelector,"bh="+bodyHash,"h="+fieldNames].join("; ");return mimeFuncs.foldLines("DKIM-Signature: "+dkim,76)+`;\r
 b=`}function relaxedHeaders(headers,fieldNames,skipFields){let includedFields=new Set,skip=new Set,headerFields=new Map;(skipFields||"").toLowerCase().split(":").forEach((field)=>{skip.add(field.trim())}),(fieldNames||"").toLowerCase().split(":").filter((field)=>!skip.has(field.trim())).forEach((field)=>{includedFields.add(field.trim())});for(let i3=headers.length-1;i3>=0;i3--){let line2=headers[i3];if(includedFields.has(line2.key)&&!headerFields.has(line2.key))headerFields.set(line2.key,relaxedHeaderLine(line2.line))}let headersList=[],fields=[];return includedFields.forEach((field)=>{if(headerFields.has(field))fields.push(field),headersList.push(field+":"+headerFields.get(field))}),{headers:headersList.join(`\r
`)+`\r
`,fieldNames:fields.join(":")}}function relaxedHeaderLine(line2){return line2.substr(line2.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}});var require_dkim=__commonJS((exports,module)=>{var MessageParser=require_message_parser(),RelaxedBody=require_relaxed_body(),sign2=require_sign(),PassThrough=__require("stream").PassThrough,fs4=__require("fs"),path2=__require("path"),crypto3=__require("crypto");class DKIMSigner{constructor(options,keys,input,output){this.options=options||{},this.keys=keys,this.cacheTreshold=Number(this.options.cacheTreshold)||131072,this.hashAlgo=this.options.hashAlgo||"sha256",this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=this.cacheDir?path2.join(this.cacheDir,"message."+Date.now()+"-"+crypto3.randomBytes(14).toString("hex")):!1,this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=input,this.output=output,this.output.usingCache=!1,this.hasErrored=!1,this.input.on("error",(err)=>{this.hasErrored=!0,this.cleanup(),output.emit("error",err)})}cleanup(){if(!this.cache||!this.cachePath)return;fs4.unlink(this.cachePath,()=>!1)}createReadCache(){this.cache=fs4.createReadStream(this.cachePath),this.cache.once("error",(err)=>{this.cleanup(),this.output.emit("error",err)}),this.cache.once("close",()=>{this.cleanup()}),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length){if(!this.cache)return this.output.end();return this.createReadCache()}let chunk=this.chunks[this.readPos++];if(this.output.write(chunk)===!1)return this.output.once("drain",()=>{this.sendNextChunk()});setImmediate(()=>this.sendNextChunk())}sendSignedOutput(){let keyPos=0,signNextKey=()=>{if(keyPos>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate(()=>this.sendNextChunk());let key=this.keys[keyPos++],dkimField=sign2(this.headers,this.hashAlgo,this.bodyHash,{domainName:key.domainName,keySelector:key.keySelector,privateKey:key.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});if(dkimField)this.output.write(Buffer.from(dkimField+`\r
`));return setImmediate(signNextKey)};if(this.bodyHash&&this.headers)return signNextKey();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=fs4.createWriteStream(this.cachePath),this.cache.once("error",(err)=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on("readable",()=>{while(this.relaxedBody.read()!==null);}),this.hasErrored=!0,this.output.emit("error",err)}),this.cache.once("close",()=>{this.sendSignedOutput()}),this.relaxedBody.removeAllListeners("readable"),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new MessageParser,this.relaxedBody=new RelaxedBody({hashAlgo:this.hashAlgo}),this.parser.on("headers",(value)=>{this.headers=value}),this.relaxedBody.on("hash",(value)=>{this.bodyHash=value}),this.relaxedBody.on("readable",()=>{let chunk;if(this.cache)return;while((chunk=this.relaxedBody.read())!==null)if(this.chunks.push(chunk),this.chunklen+=chunk.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()}),this.relaxedBody.on("end",()=>{if(this.cache)return;this.sendSignedOutput()}),this.parser.pipe(this.relaxedBody),setImmediate(()=>this.input.pipe(this.parser))}}class DKIM{constructor(options){this.options=options||{},this.keys=[].concat(this.options.keys||{domainName:options.domainName,keySelector:options.keySelector,privateKey:options.privateKey})}sign(input,extraOptions){let output=new PassThrough,inputStream=input,writeValue=!1;if(Buffer.isBuffer(input))writeValue=input,inputStream=new PassThrough;else if(typeof input==="string")writeValue=Buffer.from(input),inputStream=new PassThrough;let options=this.options;if(extraOptions&&Object.keys(extraOptions).length)options={},Object.keys(this.options||{}).forEach((key)=>{options[key]=this.options[key]}),Object.keys(extraOptions||{}).forEach((key)=>{if(!(key in options))options[key]=extraOptions[key]});let signer=new DKIMSigner(options,this.keys,inputStream,output);return setImmediate(()=>{if(signer.signStream(),writeValue)setImmediate(()=>{inputStream.end(writeValue)})}),output}}module.exports=DKIM});var require_http_proxy_client=__commonJS((exports,module)=>{var net2=__require("net"),tls2=__require("tls"),urllib=__require("url");function httpProxyClient(proxyUrl,destinationPort,destinationHost,callback){let proxy=urllib.parse(proxyUrl),options,connect,socket;if(options={host:proxy.hostname,port:Number(proxy.port)?Number(proxy.port):proxy.protocol==="https:"?443:80},proxy.protocol==="https:")options.rejectUnauthorized=!1,connect=tls2.connect.bind(tls2);else connect=net2.connect.bind(net2);let finished=!1,tempSocketErr=(err)=>{if(finished)return;finished=!0;try{socket.destroy()}catch(E){}callback(err)},timeoutErr=()=>{let err=new Error("Proxy socket timed out");err.code="ETIMEDOUT",tempSocketErr(err)};socket=connect(options,()=>{if(finished)return;let reqHeaders={Host:destinationHost+":"+destinationPort,Connection:"close"};if(proxy.auth)reqHeaders["Proxy-Authorization"]="Basic "+Buffer.from(proxy.auth).toString("base64");socket.write("CONNECT "+destinationHost+":"+destinationPort+` HTTP/1.1\r
`+Object.keys(reqHeaders).map((key)=>key+": "+reqHeaders[key]).join(`\r
`)+`\r
\r
`);let headers="",onSocketData=(chunk)=>{let match,remainder;if(finished)return;if(headers+=chunk.toString("binary"),match=headers.match(/\r\n\r\n/)){if(socket.removeListener("data",onSocketData),remainder=headers.substr(match.index+match[0].length),headers=headers.substr(0,match.index),remainder)socket.unshift(Buffer.from(remainder,"binary"));if(finished=!0,match=headers.match(/^HTTP\/\d+\.\d+ (\d+)/i),!match||(match[1]||"").charAt(0)!=="2"){try{socket.destroy()}catch(E){}return callback(new Error("Invalid response from proxy"+(match&&": "+match[1]||"")))}return socket.removeListener("error",tempSocketErr),socket.removeListener("timeout",timeoutErr),socket.setTimeout(0),callback(null,socket)}};socket.on("data",onSocketData)}),socket.setTimeout(httpProxyClient.timeout||30000),socket.on("timeout",timeoutErr),socket.once("error",tempSocketErr)}module.exports=httpProxyClient});var require_mail_message=__commonJS((exports,module)=>{var shared=require_shared(),MimeNode=require_mime_node(),mimeFuncs=require_mime_funcs();class MailMessage{constructor(mailer,data){this.mailer=mailer,this.data={},this.message=null,data=data||{};let options=mailer.options||{},defaults=mailer._defaults||{};Object.keys(data).forEach((key)=>{this.data[key]=data[key]}),this.data.headers=this.data.headers||{},Object.keys(defaults).forEach((key)=>{if(!(key in this.data))this.data[key]=defaults[key];else if(key==="headers")Object.keys(defaults.headers).forEach((key2)=>{if(!(key2 in this.data.headers))this.data.headers[key2]=defaults.headers[key2]})}),["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach((key)=>{if(key in options)this.data[key]=options[key]})}resolveContent(...args){return shared.resolveContent(...args)}resolveAll(callback){let keys=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];if(this.data.alternatives&&this.data.alternatives.length)this.data.alternatives.forEach((alternative,i3)=>{keys.push([this.data.alternatives,i3])});if(this.data.attachments&&this.data.attachments.length)this.data.attachments.forEach((attachment,i3)=>{if(!attachment.filename){if(attachment.filename=(attachment.path||attachment.href||"").split("/").pop().split("?").shift()||"attachment-"+(i3+1),attachment.filename.indexOf(".")<0)attachment.filename+="."+mimeFuncs.detectExtension(attachment.contentType)}if(!attachment.contentType)attachment.contentType=mimeFuncs.detectMimeType(attachment.filename||attachment.path||attachment.href||"bin");keys.push([this.data.attachments,i3])});let mimeNode=new MimeNode;["from","to","cc","bcc","sender","replyTo"].forEach((address)=>{let value;if(this.message)value=[].concat(mimeNode._parseAddresses(this.message.getHeader(address==="replyTo"?"reply-to":address))||[]);else if(this.data[address])value=[].concat(mimeNode._parseAddresses(this.data[address])||[]);if(value&&value.length)this.data[address]=value;else if(address in this.data)this.data[address]=null}),["from","sender"].forEach((address)=>{if(this.data[address])this.data[address]=this.data[address].shift()});let pos=0,resolveNext=()=>{if(pos>=keys.length)return callback(null,this.data);let args=keys[pos++];if(!args[0]||!args[0][args[1]])return resolveNext();shared.resolveContent(...args,(err,value)=>{if(err)return callback(err);let node={content:value};if(args[0][args[1]]&&typeof args[0][args[1]]==="object"&&!Buffer.isBuffer(args[0][args[1]]))Object.keys(args[0][args[1]]).forEach((key)=>{if(!(key in node)&&!["content","path","href","raw"].includes(key))node[key]=args[0][args[1]][key]});args[0][args[1]]=node,resolveNext()})};setImmediate(()=>resolveNext())}normalize(callback){let envelope=this.data.envelope||this.message.getEnvelope(),messageId=this.message.messageId();this.resolveAll((err,data)=>{if(err)return callback(err);if(data.envelope=envelope,data.messageId=messageId,["html","text","watchHtml","amp"].forEach((key)=>{if(data[key]&&data[key].content){if(typeof data[key].content==="string")data[key]=data[key].content;else if(Buffer.isBuffer(data[key].content))data[key]=data[key].content.toString()}}),data.icalEvent&&Buffer.isBuffer(data.icalEvent.content))data.icalEvent.content=data.icalEvent.content.toString("base64"),data.icalEvent.encoding="base64";if(data.alternatives&&data.alternatives.length)data.alternatives.forEach((alternative)=>{if(alternative&&alternative.content&&Buffer.isBuffer(alternative.content))alternative.content=alternative.content.toString("base64"),alternative.encoding="base64"});if(data.attachments&&data.attachments.length)data.attachments.forEach((attachment)=>{if(attachment&&attachment.content&&Buffer.isBuffer(attachment.content))attachment.content=attachment.content.toString("base64"),attachment.encoding="base64"});if(data.normalizedHeaders={},Object.keys(data.headers||{}).forEach((key)=>{let value=[].concat(data.headers[key]||[]).shift();if(value=value&&value.value||value,value){if(["references","in-reply-to","message-id","content-id"].includes(key))value=this.message._encodeHeaderValue(key,value);data.normalizedHeaders[key]=value}}),data.list&&typeof data.list==="object")this._getListHeaders(data.list).forEach((entry)=>{data.normalizedHeaders[entry.key]=entry.value.map((val)=>val&&val.value||val).join(", ")});if(data.references)data.normalizedHeaders.references=this.message._encodeHeaderValue("references",data.references);if(data.inReplyTo)data.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",data.inReplyTo);return callback(null,data)})}setMailerHeader(){if(!this.message||!this.data.xMailer)return;this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(!this.message||!this.data.priority)return;switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)"),this.message.setHeader("X-MSMail-Priority","High"),this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)"),this.message.setHeader("X-MSMail-Priority","Low"),this.message.setHeader("Importance","Low");break;default:}}setListHeaders(){if(!this.message||!this.data.list||typeof this.data.list!=="object")return;if(this.data.list&&typeof this.data.list==="object")this._getListHeaders(this.data.list).forEach((listHeader)=>{listHeader.value.forEach((value)=>{this.message.addHeader(listHeader.key,value)})})}_getListHeaders(listData){return Object.keys(listData).map((key)=>({key:"list-"+key.toLowerCase().trim(),value:[].concat(listData[key]||[]).map((value)=>({prepared:!0,foldLines:!0,value:[].concat(value||[]).map((value2)=>{if(typeof value2==="string")value2={url:value2};if(value2&&value2.url){if(key.toLowerCase().trim()==="id"){let comment2=value2.comment||"";if(mimeFuncs.isPlainText(comment2))comment2='"'+comment2+'"';else comment2=mimeFuncs.encodeWord(comment2);return(value2.comment?comment2+" ":"")+this._formatListUrl(value2.url).replace(/^<[^:]+\/{,2}/,"")}let comment=value2.comment||"";if(!mimeFuncs.isPlainText(comment))comment=mimeFuncs.encodeWord(comment);return this._formatListUrl(value2.url)+(value2.comment?" ("+comment+")":"")}return""}).filter((value2)=>value2).join(", ")}))}))}_formatListUrl(url){if(url=url.replace(/[\s<]+|[\s>]+/g,""),/^(https?|mailto|ftp):/.test(url))return"<"+url+">";if(/^[^@]+@[^@]+$/.test(url))return"<mailto:"+url+">";return"<http://"+url+">"}}module.exports=MailMessage});var require_mailer=__commonJS((exports,module)=>{var EventEmitter=__require("events"),shared=require_shared(),mimeTypes=require_mime_types(),MailComposer=require_mail_composer(),DKIM=require_dkim(),httpProxyClient=require_http_proxy_client(),util=__require("util"),urllib=__require("url"),packageData=require_package3(),MailMessage=require_mail_message(),net2=__require("net"),dns=__require("dns"),crypto3=__require("crypto");class Mail extends EventEmitter{constructor(transporter,options,defaults){super();if(this.options=options||{},this._defaults=defaults||{},this._defaultPlugins={compile:[(...args)=>this._convertDataImages(...args)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=this.options.dkim?new DKIM(this.options.dkim):!1,this.transporter=transporter,this.transporter.mailer=this,this.logger=shared.getLogger(this.options,{component:this.options.component||"mail"}),this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString()),typeof this.transporter.on==="function")this.transporter.on("log",(log)=>{this.logger.debug({tnx:"transport"},"%s: %s",log.type,log.message)}),this.transporter.on("error",(err)=>{this.logger.error({err,tnx:"transport"},"Transport Error: %s",err.message),this.emit("error",err)}),this.transporter.on("idle",(...args)=>{this.emit("idle",...args)});if(["close","isIdle","verify"].forEach((method)=>{this[method]=(...args)=>{if(typeof this.transporter[method]==="function"){if(method==="verify"&&typeof this.getSocket==="function")this.transporter.getSocket=this.getSocket,this.getSocket=!1;return this.transporter[method](...args)}else return this.logger.warn({tnx:"transport",methodName:method},"Non existing method %s called for transport",method),!1}}),this.options.proxy&&typeof this.options.proxy==="string")this.setupProxy(this.options.proxy)}use(step,plugin){if(step=(step||"").toString(),!this._userPlugins.hasOwnProperty(step))this._userPlugins[step]=[plugin];else this._userPlugins[step].push(plugin);return this}sendMail(data,callback=null){let promise;if(!callback)promise=new Promise((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)});if(typeof this.getSocket==="function")this.transporter.getSocket=this.getSocket,this.getSocket=!1;let mail=new MailMessage(this,data);return this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version),this._processPlugins("compile",mail,(err)=>{if(err)return this.logger.error({err,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",err.message),callback(err);mail.message=new MailComposer(mail.data).compile(),mail.setMailerHeader(),mail.setPriorityHeaders(),mail.setListHeaders(),this._processPlugins("stream",mail,(err2)=>{if(err2)return this.logger.error({err:err2,tnx:"plugin",action:"stream"},"PluginStream Error: %s",err2.message),callback(err2);if(mail.data.dkim||this.dkim)mail.message.processFunc((input)=>{let dkim=mail.data.dkim?new DKIM(mail.data.dkim):this.dkim;return this.logger.debug({tnx:"DKIM",messageId:mail.message.messageId(),dkimDomains:dkim.keys.map((key)=>key.keySelector+"."+key.domainName).join(", ")},"Signing outgoing message with %s keys",dkim.keys.length),dkim.sign(input,mail.data._dkim)});this.transporter.send(mail,(...args)=>{if(args[0])this.logger.error({err:args[0],tnx:"transport",action:"send"},"Send Error: %s",args[0].message);callback(...args)})})}),promise}getVersionString(){return util.format("%s (%s; +%s; %s/%s)",packageData.name,packageData.version,packageData.homepage,this.transporter.name,this.transporter.version)}_processPlugins(step,mail,callback){if(step=(step||"").toString(),!this._userPlugins.hasOwnProperty(step))return callback();let userPlugins=this._userPlugins[step]||[],defaultPlugins=this._defaultPlugins[step]||[];if(userPlugins.length)this.logger.debug({tnx:"transaction",pluginCount:userPlugins.length,step},"Using %s plugins for %s",userPlugins.length,step);if(userPlugins.length+defaultPlugins.length===0)return callback();let pos=0,block="default",processPlugins=()=>{let curplugins=block==="default"?defaultPlugins:userPlugins;if(pos>=curplugins.length)if(block==="default"&&userPlugins.length)block="user",pos=0,curplugins=userPlugins;else return callback();let plugin=curplugins[pos++];plugin(mail,(err)=>{if(err)return callback(err);processPlugins()})};processPlugins()}setupProxy(proxyUrl){let proxy=urllib.parse(proxyUrl);this.getSocket=(options,callback)=>{let protocol=proxy.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+protocol))return this.meta.get("proxy_handler_"+protocol)(proxy,options,callback);switch(protocol){case"http":case"https":httpProxyClient(proxy.href,options.port,options.host,(err,socket)=>{if(err)return callback(err);return callback(null,{connection:socket})});return;case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module"))return callback(new Error("Socks module not loaded"));let connect=(ipaddress)=>{let proxyV2=!!this.meta.get("proxy_socks_module").SocksClient,socksClient=proxyV2?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module"),proxyType=Number(proxy.protocol.replace(/\D/g,""))||5,connectionOpts={proxy:{ipaddress,port:Number(proxy.port),type:proxyType},[proxyV2?"destination":"target"]:{host:options.host,port:options.port},command:"connect"};if(proxy.auth){let username=decodeURIComponent(proxy.auth.split(":").shift()),password=decodeURIComponent(proxy.auth.split(":").pop());if(proxyV2)connectionOpts.proxy.userId=username,connectionOpts.proxy.password=password;else if(proxyType===4)connectionOpts.userid=username;else connectionOpts.authentication={username,password}}socksClient.createConnection(connectionOpts,(err,info)=>{if(err)return callback(err);return callback(null,{connection:info.socket||info})})};if(net2.isIP(proxy.hostname))return connect(proxy.hostname);return dns.resolve(proxy.hostname,(err,address)=>{if(err)return callback(err);connect(Array.isArray(address)?address[0]:address)})}}callback(new Error("Unknown proxy configuration"))}}_convertDataImages(mail,callback){if(!this.options.attachDataUrls&&!mail.data.attachDataUrls||!mail.data.html)return callback();mail.resolveContent(mail.data,"html",(err,html)=>{if(err)return callback(err);let cidCounter=0;html=(html||"").toString().replace(/(<img\b[^<>]{0,1024} src\s{0,20}=[\s"']{0,20})(data:([^;]+);[^"'>\s]+)/gi,(match,prefix,dataUri,mimeType)=>{let cid=crypto3.randomBytes(10).toString("hex")+"@localhost";if(!mail.data.attachments)mail.data.attachments=[];if(!Array.isArray(mail.data.attachments))mail.data.attachments=[].concat(mail.data.attachments||[]);return mail.data.attachments.push({path:dataUri,cid,filename:"image-"+ ++cidCounter+"."+mimeTypes.detectExtension(mimeType)}),prefix+"cid:"+cid}),mail.data.html=html,callback()})}set(key,value){return this.meta.set(key,value)}get(key){return this.meta.get(key)}}module.exports=Mail});var require_data_stream=__commonJS((exports,module)=>{var stream2=__require("stream"),Transform3=stream2.Transform;class DataStream extends Transform3{constructor(options){super(options);this.options=options||{},this._curLine="",this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(chunk,encoding,done){let chunks=[],chunklen=0,i3,len3,lastPos=0,buf;if(!chunk||!chunk.length)return done();if(typeof chunk==="string")chunk=Buffer.from(chunk);this.inByteCount+=chunk.length;for(i3=0,len3=chunk.length;i3<len3;i3++)if(chunk[i3]===46){if(i3&&chunk[i3-1]===10||!i3&&(!this.lastByte||this.lastByte===10))buf=chunk.slice(lastPos,i3+1),chunks.push(buf),chunks.push(Buffer.from(".")),chunklen+=buf.length+1,lastPos=i3+1}else if(chunk[i3]===10){if(i3&&chunk[i3-1]!==13||!i3&&this.lastByte!==13){if(i3>lastPos)buf=chunk.slice(lastPos,i3),chunks.push(buf),chunklen+=buf.length+2;else chunklen+=2;chunks.push(Buffer.from(`\r
`)),lastPos=i3+1}}if(chunklen){if(lastPos<chunk.length)buf=chunk.slice(lastPos),chunks.push(buf),chunklen+=buf.length;this.outByteCount+=chunklen,this.push(Buffer.concat(chunks,chunklen))}else this.outByteCount+=chunk.length,this.push(chunk);this.lastByte=chunk[chunk.length-1],done()}_flush(done){let buf;if(this.lastByte===10)buf=Buffer.from(`.\r
`);else if(this.lastByte===13)buf=Buffer.from(`
.\r
`);else buf=Buffer.from(`\r
.\r
`);this.outByteCount+=buf.length,this.push(buf),done()}}module.exports=DataStream});var require_smtp_connection=__commonJS((exports,module)=>{var packageInfo=require_package3(),EventEmitter=__require("events").EventEmitter,net2=__require("net"),tls2=__require("tls"),os2=__require("os"),crypto3=__require("crypto"),DataStream=require_data_stream(),PassThrough=__require("stream").PassThrough,shared=require_shared();class SMTPConnection extends EventEmitter{constructor(options){super(options);if(this.id=crypto3.randomBytes(8).toString("base64").replace(/\W/g,""),this.stage="init",this.options=options||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||"localhost",this.servername=this.options.servername?this.options.servername:!net2.isIP(this.host)?this.host:!1,this.allowInternalNetworkInterfaces=this.options.allowInternalNetworkInterfaces||!1,typeof this.options.secure==="undefined"&&this.port===465)this.secureConnection=!0;this.name=this.options.name||this._getHostname(),this.logger=shared.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach((key)=>{let mapKey=(key||"").toString().trim().toUpperCase();if(!mapKey)return;this.customAuth.set(mapKey,this.options.customAuth[key])}),this.version=packageInfo.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder="",this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=(chunk)=>this._onData(chunk),this._onSocketError=(error3)=>this._onError(error3,"ESOCKET",!1,"CONN"),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(connectCallback){if(typeof connectCallback==="function"){this.once("connect",()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished"),connectCallback()});let isDestroyedMessage=this._isDestroyedMessage("connect");if(isDestroyedMessage)return connectCallback(this._formatError(isDestroyedMessage,"ECONNECTION",!1,"CONN"))}let opts={port:this.port,host:this.host,allowInternalNetworkInterfaces:this.allowInternalNetworkInterfaces,timeout:this.options.dnsTimeout||30000};if(this.options.localAddress)opts.localAddress=this.options.localAddress;let setupConnectionHandlers=()=>{this._connectionTimeout=setTimeout(()=>{this._onError("Connection timeout","ETIMEDOUT",!1,"CONN")},this.options.connectionTimeout||120000),this._socket.on("error",this._onSocketError)};if(this.options.connection){if(this._socket=this.options.connection,setupConnectionHandlers(),this.secureConnection&&!this.alreadySecured)setImmediate(()=>this._upgradeConnection((err)=>{if(err){this._onError(new Error("Error initiating TLS - "+(err.message||err)),"ETLS",!1,"CONN");return}this._onConnect()}));else setImmediate(()=>this._onConnect());return}else if(this.options.socket)return this._socket=this.options.socket,shared.resolveHostname(opts,(err,resolved)=>{if(err)return setImmediate(()=>this._onError(err,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:opts.host,resolved:resolved.host,cached:!!resolved.cached},"Resolved %s as %s [cache %s]",opts.host,resolved.host,resolved.cached?"hit":"miss"),Object.keys(resolved).forEach((key)=>{if(key.charAt(0)!=="_"&&resolved[key])opts[key]=resolved[key]});try{this._socket.connect(this.port,this.host,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),setupConnectionHandlers()}catch(E){return setImmediate(()=>this._onError(E,"ECONNECTION",!1,"CONN"))}});else if(this.secureConnection){if(this.options.tls)Object.keys(this.options.tls).forEach((key)=>{opts[key]=this.options.tls[key]});if(this.servername&&!opts.servername)opts.servername=this.servername;return shared.resolveHostname(opts,(err,resolved)=>{if(err)return setImmediate(()=>this._onError(err,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:opts.host,resolved:resolved.host,cached:!!resolved.cached},"Resolved %s as %s [cache %s]",opts.host,resolved.host,resolved.cached?"hit":"miss"),Object.keys(resolved).forEach((key)=>{if(key.charAt(0)!=="_"&&resolved[key])opts[key]=resolved[key]});try{this._socket=tls2.connect(opts,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),setupConnectionHandlers()}catch(E){return setImmediate(()=>this._onError(E,"ECONNECTION",!1,"CONN"))}})}else return shared.resolveHostname(opts,(err,resolved)=>{if(err)return setImmediate(()=>this._onError(err,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:opts.host,resolved:resolved.host,cached:!!resolved.cached},"Resolved %s as %s [cache %s]",opts.host,resolved.host,resolved.cached?"hit":"miss"),Object.keys(resolved).forEach((key)=>{if(key.charAt(0)!=="_"&&resolved[key])opts[key]=resolved[key]});try{this._socket=net2.connect(opts,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),setupConnectionHandlers()}catch(E){return setImmediate(()=>this._onError(E,"ECONNECTION",!1,"CONN"))}})}quit(){this._sendCommand("QUIT"),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let closeMethod="end";if(this.stage==="init")closeMethod="destroy";this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',closeMethod);let socket=this._socket&&this._socket.socket||this._socket;if(socket&&!socket.destroyed)try{socket[closeMethod]()}catch(E){}this._destroy()}login(authData,callback){let isDestroyedMessage=this._isDestroyedMessage("login");if(isDestroyedMessage)return callback(this._formatError(isDestroyedMessage,"ECONNECTION",!1,"API"));if(this._auth=authData||{},this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||!1,!this._authMethod&&this._auth.oauth2&&!this._auth.credentials)this._authMethod="XOAUTH2";else if(!this._authMethod||this._authMethod==="XOAUTH2"&&!this._auth.oauth2)this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim();if(this._authMethod!=="XOAUTH2"&&(!this._auth.credentials||!this._auth.credentials.user||!this._auth.credentials.pass))if(this._auth.user&&this._auth.pass||this.customAuth.has(this._authMethod))this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options};else return callback(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",!1,"API"));if(this.customAuth.has(this._authMethod)){let handler=this.customAuth.get(this._authMethod),lastResponse,returned=!1,resolve=()=>{if(returned)return;returned=!0,this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,callback(null,!0)},reject=(err)=>{if(returned)return;returned=!0,callback(this._formatError(err,"EAUTH",lastResponse,"AUTH "+this._authMethod))},handlerResponse=handler({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(cmd,done)=>{let promise;if(!done)promise=new Promise((resolve2,reject2)=>{done=shared.callbackPromise(resolve2,reject2)});return this._responseActions.push((str)=>{lastResponse=str;let codes=str.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),data={command:cmd,response:str};if(codes){if(data.status=Number(codes[1])||0,codes[2])data.code=codes[2];data.text=str.substr(codes[0].length)}else data.text=str,data.status=0;done(null,data)}),setImmediate(()=>this._sendCommand(cmd)),promise},resolve,reject});if(handlerResponse&&typeof handlerResponse.catch==="function")handlerResponse.then(resolve).catch(reject);return}switch(this._authMethod){case"XOAUTH2":this._handleXOauth2Token(!1,callback);return;case"LOGIN":this._responseActions.push((str)=>{this._actionAUTH_LOGIN_USER(str,callback)}),this._sendCommand("AUTH LOGIN");return;case"PLAIN":this._responseActions.push((str)=>{this._actionAUTHComplete(str,callback)}),this._sendCommand("AUTH PLAIN "+Buffer.from("\x00"+this._auth.credentials.user+"\x00"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\x00"+this._auth.credentials.user+"\x00/* secret */","utf-8").toString("base64"));return;case"CRAM-MD5":this._responseActions.push((str)=>{this._actionAUTH_CRAM_MD5(str,callback)}),this._sendCommand("AUTH CRAM-MD5");return}return callback(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",!1,"API"))}send(envelope,message2,done){if(!message2)return done(this._formatError("Empty message","EMESSAGE",!1,"API"));let isDestroyedMessage=this._isDestroyedMessage("send message");if(isDestroyedMessage)return done(this._formatError(isDestroyedMessage,"ECONNECTION",!1,"API"));if(this._maxAllowedSize&&envelope.size>this._maxAllowedSize)return setImmediate(()=>{done(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",!1,"MAIL FROM"))});let returned=!1,callback=function(){if(returned)return;returned=!0,done(...arguments)};if(typeof message2.on==="function")message2.on("error",(err)=>callback(this._formatError(err,"ESTREAM",!1,"API")));let startTime=Date.now();this._setEnvelope(envelope,(err,info)=>{if(err){let stream3=new PassThrough;if(typeof message2.pipe==="function")message2.pipe(stream3);else stream3.write(message2),stream3.end();return callback(err)}let envelopeTime=Date.now(),stream2=this._createSendStream((err2,str)=>{if(err2)return callback(err2);return info.envelopeTime=envelopeTime-startTime,info.messageTime=Date.now()-envelopeTime,info.messageSize=stream2.outByteCount,info.response=str,callback(null,info)});if(typeof message2.pipe==="function")message2.pipe(stream2);else stream2.write(message2),stream2.end()})}reset(callback){this._sendCommand("RSET"),this._responseActions.push((str)=>{if(str.charAt(0)!=="2")return callback(this._formatError("Could not reset session state. response="+str,"EPROTOCOL",str,"RSET"));return this._envelope=!1,callback(null,!0)})}_onConnect(){if(clearTimeout(this._connectionTimeout),this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort),this._destroyed){this.close();return}this.stage="connected",this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout),this._socket.removeListener("close",this._onSocketClose),this._socket.removeListener("end",this._onSocketEnd),this._socket.on("data",this._onSocketData),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||600000),this._socket.on("timeout",this._onSocketTimeout),this._greetingTimeout=setTimeout(()=>{if(this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting)this._onError("Greeting never received","ETIMEDOUT",!1,"CONN")},this.options.greetingTimeout||30000),this._responseActions.push(this._actionGreeting),this._socket.resume()}_onData(chunk){if(this._destroyed||!chunk||!chunk.length)return;let data=(chunk||"").toString("binary"),lines=(this._remainder+data).split(/\r?\n/),lastline;this._remainder=lines.pop();for(let i3=0,len3=lines.length;i3<len3;i3++){if(this._responseQueue.length){if(lastline=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(lastline.split(`
`).pop())){this._responseQueue[this._responseQueue.length-1]+=`
`+lines[i3];continue}}this._responseQueue.push(lines[i3])}if(this._responseQueue.length){if(lastline=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(lastline.split(`
`).pop()))return}this._processResponse()}_onError(err,type2,data,command){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._destroyed)return;err=this._formatError(err,type2,data,command),this.logger.error(data,err.message),this.emit("error",err),this.close()}_formatError(message2,type2,response,command){let err;if(/Error\]$/i.test(Object.prototype.toString.call(message2)))err=message2;else err=new Error(message2);if(type2&&type2!=="Error")err.code=type2;if(response)err.response=response,err.message+=": "+response;let responseCode=typeof response==="string"&&Number((response.match(/^\d+/)||[])[0])||!1;if(responseCode)err.responseCode=responseCode;if(command)err.command=command;return err}_onClose(){let serverResponse=!1;if(this._remainder&&this._remainder.trim()){if(this.options.debug||this.options.transactionLog)this.logger.debug({tnx:"server"},this._remainder.replace(/\r?\n$/,""));this.lastServerResponse=serverResponse=this._remainder.trim()}if(this.logger.info({tnx:"network"},"Connection closed"),this.upgrading&&!this._destroyed)return this._onError(new Error("Connection closed unexpectedly"),"ETLS",serverResponse,"CONN");else if(![this._actionGreeting,this.close].includes(this._responseActions[0])&&!this._destroyed)return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",serverResponse,"CONN");else if(/^[45]\d{2}\b/.test(serverResponse))return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",serverResponse,"CONN");this._destroy()}_onEnd(){if(this._socket&&!this._socket.destroyed)this._socket.destroy()}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",!1,"CONN")}_destroy(){if(this._destroyed)return;this._destroyed=!0,this.emit("end")}_upgradeConnection(callback){this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout);let socketPlain=this._socket,opts={socket:this._socket,host:this.host};if(Object.keys(this.options.tls||{}).forEach((key)=>{opts[key]=this.options.tls[key]}),this.servername&&!opts.servername)opts.servername=this.servername;this.upgrading=!0;try{this._socket=tls2.connect(opts,()=>{return this.secure=!0,this.upgrading=!1,this._socket.on("data",this._onSocketData),socketPlain.removeListener("close",this._onSocketClose),socketPlain.removeListener("end",this._onSocketEnd),callback(null,!0)})}catch(err){return callback(err)}this._socket.on("error",this._onSocketError),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||600000),this._socket.on("timeout",this._onSocketTimeout),socketPlain.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let str=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(str.split(`
`).pop()))return;if(this.options.debug||this.options.transactionLog)this.logger.debug({tnx:"server"},str.replace(/\r?\n$/,""));if(!str.trim())setImmediate(()=>this._processResponse());let action=this._responseActions.shift();if(typeof action==="function")action.call(this,str),setImmediate(()=>this._processResponse());else return this._onError(new Error("Unexpected Response"),"EPROTOCOL",str,"CONN")}_sendCommand(str,logStr){if(this._destroyed)return;if(this._socket.destroyed)return this.close();if(this.options.debug||this.options.transactionLog)this.logger.debug({tnx:"client"},(logStr||str||"").toString().replace(/\r?\n$/,""));this._socket.write(Buffer.from(str+`\r
`,"utf-8"))}_setEnvelope(envelope,callback){let args=[],useSmtpUtf8=!1;if(this._envelope=envelope||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map((to)=>(to&&to.address||to||"").toString().trim()),!this._envelope.to.length)return callback(this._formatError("No recipients defined","EENVELOPE",!1,"API"));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return callback(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",!1,"API"));if(/[\x80-\uFFFF]/.test(this._envelope.from))useSmtpUtf8=!0;for(let i3=0,len3=this._envelope.to.length;i3<len3;i3++){if(!this._envelope.to[i3]||/[\r\n<>]/.test(this._envelope.to[i3]))return callback(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[i3]),"EENVELOPE",!1,"API"));if(/[\x80-\uFFFF]/.test(this._envelope.to[i3]))useSmtpUtf8=!0}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(err){return callback(this._formatError("Invalid DSN "+err.message,"EENVELOPE",!1,"API"))}if(this._responseActions.push((str)=>{this._actionMAIL(str,callback)}),useSmtpUtf8&&this._supportedExtensions.includes("SMTPUTF8"))args.push("SMTPUTF8"),this._usingSmtpUtf8=!0;if(this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME"))args.push("BODY=8BITMIME"),this._using8BitMime=!0;if(this._envelope.size&&this._supportedExtensions.includes("SIZE"))args.push("SIZE="+this._envelope.size);if(this._envelope.dsn&&this._supportedExtensions.includes("DSN")){if(this._envelope.dsn.ret)args.push("RET="+shared.encodeXText(this._envelope.dsn.ret));if(this._envelope.dsn.envid)args.push("ENVID="+shared.encodeXText(this._envelope.dsn.envid))}this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(args.length?" "+args.join(" "):""))}_setDsnEnvelope(params){let ret=(params.ret||params.return||"").toString().toUpperCase()||null;if(ret)switch(ret){case"HDRS":case"HEADERS":ret="HDRS";break;case"FULL":case"BODY":ret="FULL";break}if(ret&&!["FULL","HDRS"].includes(ret))throw new Error("ret: "+JSON.stringify(ret));let envid=(params.envid||params.id||"").toString()||null,notify=params.notify||null;if(notify){if(typeof notify==="string")notify=notify.split(",");notify=notify.map((n)=>n.trim().toUpperCase());let validNotify=["NEVER","SUCCESS","FAILURE","DELAY"];if(notify.filter((n)=>!validNotify.includes(n)).length||notify.length>1&&notify.includes("NEVER"))throw new Error("notify: "+JSON.stringify(notify.join(",")));notify=notify.join(",")}let orcpt=(params.recipient||params.orcpt||"").toString()||null;if(orcpt&&orcpt.indexOf(";")<0)orcpt="rfc822;"+orcpt;return{ret,envid,notify,orcpt}}_getDsnRcptToArgs(){let args=[];if(this._envelope.dsn&&this._supportedExtensions.includes("DSN")){if(this._envelope.dsn.notify)args.push("NOTIFY="+shared.encodeXText(this._envelope.dsn.notify));if(this._envelope.dsn.orcpt)args.push("ORCPT="+shared.encodeXText(this._envelope.dsn.orcpt))}return args.length?" "+args.join(" "):""}_createSendStream(callback){let dataStream=new DataStream,logStream;if(this.options.lmtp)this._envelope.accepted.forEach((recipient,i3)=>{let final=i3===this._envelope.accepted.length-1;this._responseActions.push((str)=>{this._actionLMTPStream(recipient,final,str,callback)})});else this._responseActions.push((str)=>{this._actionSMTPStream(str,callback)});if(dataStream.pipe(this._socket,{end:!1}),this.options.debug)logStream=new PassThrough,logStream.on("readable",()=>{let chunk;while(chunk=logStream.read())this.logger.debug({tnx:"message"},chunk.toString("binary").replace(/\r?\n$/,""))}),dataStream.pipe(logStream);return dataStream.once("end",()=>{this.logger.info({tnx:"message",inByteCount:dataStream.inByteCount,outByteCount:dataStream.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",dataStream.outByteCount,dataStream.inByteCount)}),dataStream}_actionGreeting(str){if(clearTimeout(this._greetingTimeout),str.substr(0,3)!=="220"){this._onError(new Error("Invalid greeting. response="+str),"EPROTOCOL",str,"CONN");return}if(this.options.lmtp)this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name);else this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)}_actionLHLO(str){if(str.charAt(0)!=="2"){this._onError(new Error("Invalid LHLO. response="+str),"EPROTOCOL",str,"LHLO");return}this._actionEHLO(str)}_actionEHLO(str){let match;if(str.substr(0,3)==="421"){this._onError(new Error("Server terminates connection. response="+str),"ECONNECTION",str,"EHLO");return}if(str.charAt(0)!=="2"){if(this.options.requireTLS){this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+str),"ECONNECTION",str,"EHLO");return}this._responseActions.push(this._actionHELO),this._sendCommand("HELO "+this.name);return}if(this._ehloLines=str.split(/\r?\n/).map((line2)=>line2.replace(/^\d+[ -]/,"").trim()).filter((line2)=>line2).slice(1),!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(str)||this.options.requireTLS)){this._sendCommand("STARTTLS"),this._responseActions.push(this._actionSTARTTLS);return}if(/[ -]SMTPUTF8\b/im.test(str))this._supportedExtensions.push("SMTPUTF8");if(/[ -]DSN\b/im.test(str))this._supportedExtensions.push("DSN");if(/[ -]8BITMIME\b/im.test(str))this._supportedExtensions.push("8BITMIME");if(/[ -]PIPELINING\b/im.test(str))this._supportedExtensions.push("PIPELINING");if(/[ -]AUTH\b/i.test(str))this.allowsAuth=!0;if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(str))this._supportedAuth.push("PLAIN");if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(str))this._supportedAuth.push("LOGIN");if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(str))this._supportedAuth.push("CRAM-MD5");if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(str))this._supportedAuth.push("XOAUTH2");if(match=str.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))this._supportedExtensions.push("SIZE"),this._maxAllowedSize=Number(match[1])||0;this.emit("connect")}_actionHELO(str){if(str.charAt(0)!=="2"){this._onError(new Error("Invalid HELO. response="+str),"EPROTOCOL",str,"HELO");return}this.allowsAuth=!0,this.emit("connect")}_actionSTARTTLS(str){if(str.charAt(0)!=="2"){if(this.options.opportunisticTLS)return this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted"),this.emit("connect");this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",str,"STARTTLS");return}this._upgradeConnection((err,secured)=>{if(err){this._onError(new Error("Error initiating TLS - "+(err.message||err)),"ETLS",!1,"STARTTLS");return}if(this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS"),secured)if(this.options.lmtp)this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name);else this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name);else this.emit("connect")})}_actionAUTH_LOGIN_USER(str,callback){if(!/^334[ -]/.test(str)){callback(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",str,"AUTH LOGIN"));return}this._responseActions.push((str2)=>{this._actionAUTH_LOGIN_PASS(str2,callback)}),this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))}_actionAUTH_CRAM_MD5(str,callback){let challengeMatch=str.match(/^334\s+(.+)$/),challengeString="";if(!challengeMatch)return callback(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",str,"AUTH CRAM-MD5"));else challengeString=challengeMatch[1];let base64decoded=Buffer.from(challengeString,"base64").toString("ascii"),hmacMD5=crypto3.createHmac("md5",this._auth.credentials.pass);hmacMD5.update(base64decoded);let prepended=this._auth.credentials.user+" "+hmacMD5.digest("hex");this._responseActions.push((str2)=>{this._actionAUTH_CRAM_MD5_PASS(str2,callback)}),this._sendCommand(Buffer.from(prepended).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(str,callback){if(!str.match(/^235\s+/))return callback(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",str,"AUTH CRAM-MD5"));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,callback(null,!0)}_actionAUTH_LOGIN_PASS(str,callback){if(!/^334[ -]/.test(str))return callback(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",str,"AUTH LOGIN"));this._responseActions.push((str2)=>{this._actionAUTHComplete(str2,callback)}),this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(str,isRetry,callback){if(!callback&&typeof isRetry==="function")callback=isRetry,isRetry=!1;if(str.substr(0,3)==="334"){this._responseActions.push((str2)=>{if(isRetry||this._authMethod!=="XOAUTH2")this._actionAUTHComplete(str2,!0,callback);else setImmediate(()=>this._handleXOauth2Token(!0,callback))}),this._sendCommand("");return}if(str.charAt(0)!=="2")return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),callback(this._formatError("Invalid login","EAUTH",str,"AUTH "+this._authMethod));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,callback(null,!0)}_actionMAIL(str,callback){let message2,curRecipient;if(Number(str.charAt(0))!==2){if(this._usingSmtpUtf8&&/^550 /.test(str)&&/[\x80-\uFFFF]/.test(this._envelope.from))message2="Internationalized mailbox name not allowed";else message2="Mail command failed";return callback(this._formatError(message2,"EENVELOPE",str,"MAIL FROM"))}if(!this._envelope.rcptQueue.length)return callback(this._formatError("Can't send mail - no recipients defined","EENVELOPE",!1,"API"));else if(this._recipientQueue=[],this._supportedExtensions.includes("PIPELINING"))while(this._envelope.rcptQueue.length)curRecipient=this._envelope.rcptQueue.shift(),this._recipientQueue.push(curRecipient),this._responseActions.push((str2)=>{this._actionRCPT(str2,callback)}),this._sendCommand("RCPT TO:<"+curRecipient+">"+this._getDsnRcptToArgs());else curRecipient=this._envelope.rcptQueue.shift(),this._recipientQueue.push(curRecipient),this._responseActions.push((str2)=>{this._actionRCPT(str2,callback)}),this._sendCommand("RCPT TO:<"+curRecipient+">"+this._getDsnRcptToArgs())}_actionRCPT(str,callback){let message2,err,curRecipient=this._recipientQueue.shift();if(Number(str.charAt(0))!==2){if(this._usingSmtpUtf8&&/^553 /.test(str)&&/[\x80-\uFFFF]/.test(curRecipient))message2="Internationalized mailbox name not allowed";else message2="Recipient command failed";this._envelope.rejected.push(curRecipient),err=this._formatError(message2,"EENVELOPE",str,"RCPT TO"),err.recipient=curRecipient,this._envelope.rejectedErrors.push(err)}else this._envelope.accepted.push(curRecipient);if(!this._envelope.rcptQueue.length&&!this._recipientQueue.length)if(this._envelope.rejected.length<this._envelope.to.length)this._responseActions.push((str2)=>{this._actionDATA(str2,callback)}),this._sendCommand("DATA");else return err=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",str,"RCPT TO"),err.rejected=this._envelope.rejected,err.rejectedErrors=this._envelope.rejectedErrors,callback(err);else if(this._envelope.rcptQueue.length)curRecipient=this._envelope.rcptQueue.shift(),this._recipientQueue.push(curRecipient),this._responseActions.push((str2)=>{this._actionRCPT(str2,callback)}),this._sendCommand("RCPT TO:<"+curRecipient+">"+this._getDsnRcptToArgs())}_actionDATA(str,callback){if(!/^[23]/.test(str))return callback(this._formatError("Data command failed","EENVELOPE",str,"DATA"));let response={accepted:this._envelope.accepted,rejected:this._envelope.rejected};if(this._ehloLines&&this._ehloLines.length)response.ehlo=this._ehloLines;if(this._envelope.rejectedErrors.length)response.rejectedErrors=this._envelope.rejectedErrors;callback(null,response)}_actionSMTPStream(str,callback){if(Number(str.charAt(0))!==2)return callback(this._formatError("Message failed","EMESSAGE",str,"DATA"));else return callback(null,str)}_actionLMTPStream(recipient,final,str,callback){let err;if(Number(str.charAt(0))!==2){err=this._formatError("Message failed for recipient "+recipient,"EMESSAGE",str,"DATA"),err.recipient=recipient,this._envelope.rejected.push(recipient),this._envelope.rejectedErrors.push(err);for(let i3=0,len3=this._envelope.accepted.length;i3<len3;i3++)if(this._envelope.accepted[i3]===recipient)this._envelope.accepted.splice(i3,1)}if(final)return callback(null,str)}_handleXOauth2Token(isRetry,callback){this._auth.oauth2.getToken(isRetry,(err,accessToken)=>{if(err)return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),callback(this._formatError(err,"EAUTH",!1,"AUTH XOAUTH2"));this._responseActions.push((str)=>{this._actionAUTHComplete(str,isRetry,callback)}),this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(accessToken),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))})}_isDestroyedMessage(command){if(this._destroyed)return"Cannot "+command+" - smtp connection is already destroyed.";if(this._socket){if(this._socket.destroyed)return"Cannot "+command+" - smtp connection socket is already destroyed.";if(!this._socket.writable)return"Cannot "+command+" - smtp connection socket is already half-closed."}}_getHostname(){let defaultHostname;try{defaultHostname=os2.hostname()||""}catch(err){defaultHostname="localhost"}if(!defaultHostname||defaultHostname.indexOf(".")<0)defaultHostname="[127.0.0.1]";if(defaultHostname.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/))defaultHostname="["+defaultHostname+"]";return defaultHostname}}module.exports=SMTPConnection});var require_xoauth2=__commonJS((exports,module)=>{var Stream4=__require("stream").Stream,nmfetch=require_fetch(),crypto3=__require("crypto"),shared=require_shared();class XOAuth2 extends Stream4{constructor(options,logger){super();if(this.options=options||{},options&&options.serviceClient){if(!options.privateKey||!options.user){setImmediate(()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!')));return}let serviceRequestTimeout=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=serviceRequestTimeout||300}if(this.logger=shared.getLogger({logger},{component:this.options.component||"OAuth2"}),this.provisionCallback=typeof this.options.provisionCallback==="function"?this.options.provisionCallback:!1,this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token",this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let timeout=Math.max(Number(this.options.timeout)||0,0);this.expires=timeout&&Date.now()+timeout*1000||0}}getToken(renew,callback){if(!renew&&this.accessToken&&(!this.expires||this.expires>Date.now()))return callback(null,this.accessToken);let generateCallback=(...args)=>{if(args[0])this.logger.error({err:args[0],tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user);else this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user);callback(...args)};if(this.provisionCallback)this.provisionCallback(this.options.user,!!renew,(err,accessToken,expires)=>{if(!err&&accessToken)this.accessToken=accessToken,this.expires=expires||0;generateCallback(err,accessToken)});else this.generateToken(generateCallback)}updateToken(accessToken,timeout){this.accessToken=accessToken,timeout=Math.max(Number(timeout)||0,0),this.expires=timeout&&Date.now()+timeout*1000||0,this.emit("token",{user:this.options.user,accessToken:accessToken||"",expires:this.expires})}generateToken(callback){let urlOptions,loggedUrlOptions;if(this.options.serviceClient){let iat=Math.floor(Date.now()/1000),tokenData={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat,exp:iat+this.options.serviceRequestTimeout},token;try{token=this.jwtSignRS256(tokenData)}catch(err){return callback(new Error("Can't generate token. Check your auth options"))}urlOptions={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:token},loggedUrlOptions={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:tokenData}}else{if(!this.options.refreshToken)return callback(new Error("Can't create new access token for user"));urlOptions={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"},loggedUrlOptions={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach((key)=>{urlOptions[key]=this.options.customParams[key],loggedUrlOptions[key]=this.options.customParams[key]}),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(loggedUrlOptions)),this.postRequest(this.options.accessUrl,urlOptions,this.options,(error3,body)=>{let data;if(error3)return callback(error3);try{data=JSON.parse(body.toString())}catch(E){return callback(E)}if(!data||typeof data!=="object")return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(body||"").toString()),callback(new Error("Invalid authentication response"));let logData={};if(Object.keys(data).forEach((key)=>{if(key!=="access_token")logData[key]=data[key];else logData[key]=(data[key]||"").toString().substr(0,6)+"..."}),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(logData)),data.error){let errorMessage=data.error;if(data.error_description)errorMessage+=": "+data.error_description;if(data.error_uri)errorMessage+=" ("+data.error_uri+")";return callback(new Error(errorMessage))}if(data.access_token)return this.updateToken(data.access_token,data.expires_in),callback(null,this.accessToken);return callback(new Error("No access token"))})}buildXOAuth2Token(accessToken){let authData=["user="+(this.options.user||""),"auth=Bearer "+(accessToken||this.accessToken),"",""];return Buffer.from(authData.join("\x01"),"utf-8").toString("base64")}postRequest(url,payload,params,callback){let returned=!1,chunks=[],chunklen=0,req=nmfetch(url,{method:"post",headers:params.customHeaders,body:payload,allowErrorResponse:!0});req.on("readable",()=>{let chunk;while((chunk=req.read())!==null)chunks.push(chunk),chunklen+=chunk.length}),req.once("error",(err)=>{if(returned)return;return returned=!0,callback(err)}),req.once("end",()=>{if(returned)return;return returned=!0,callback(null,Buffer.concat(chunks,chunklen))})}toBase64URL(data){if(typeof data==="string")data=Buffer.from(data);return data.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(payload){payload=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(payload)].map((val)=>this.toBase64URL(val)).join(".");let signature=crypto3.createSign("RSA-SHA256").update(payload).sign(this.options.privateKey);return payload+"."+this.toBase64URL(signature)}}module.exports=XOAuth2});var require_pool_resource=__commonJS((exports,module)=>{var SMTPConnection=require_smtp_connection(),assign=require_shared().assign,XOAuth2=require_xoauth2(),EventEmitter=__require("events");class PoolResource extends EventEmitter{constructor(pool3){super();if(this.pool=pool3,this.options=pool3.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let oauth2=new XOAuth2(this.options.auth,this.logger);oauth2.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||oauth2.provisionCallback,this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2,method:"XOAUTH2"},oauth2.on("token",(token)=>this.pool.mailer.emit("token",token)),oauth2.on("error",(err)=>this.emit("error",err));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(callback){this.pool.getSocket(this.options,(err,socketOptions)=>{if(err)return callback(err);let returned=!1,options=this.options;if(socketOptions&&socketOptions.connection)this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||""),options=assign(!1,options),Object.keys(socketOptions).forEach((key)=>{options[key]=socketOptions[key]});this.connection=new SMTPConnection(options),this.connection.once("error",(err2)=>{if(this.emit("error",err2),returned)return;return returned=!0,callback(err2)}),this.connection.once("end",()=>{if(this.close(),returned)return;returned=!0;let timer2=setTimeout(()=>{if(returned)return;let err2=new Error("Unexpected socket close");if(this.connection&&this.connection._socket&&this.connection._socket.upgrading)err2.code="ETLS";callback(err2)},1000);try{timer2.unref()}catch(E){}}),this.connection.connect(()=>{if(returned)return;if(this.auth&&(this.connection.allowsAuth||options.forceAuth))this.connection.login(this.auth,(err2)=>{if(returned)return;if(returned=!0,err2)return this.connection.close(),this.emit("error",err2),callback(err2);this._connected=!0,callback(null,!0)});else return returned=!0,this._connected=!0,callback(null,!0)})})}send(mail,callback){if(!this._connected)return this.connect((err)=>{if(err)return callback(err);return this.send(mail,callback)});let envelope=mail.message.getEnvelope(),messageId=mail.message.messageId(),recipients=[].concat(envelope.to||[]);if(recipients.length>3)recipients.push("...and "+recipients.splice(2).length+" more");if(this.logger.info({tnx:"send",messageId,cid:this.id},"Sending message %s using #%s to <%s>",messageId,this.id,recipients.join(", ")),mail.data.dsn)envelope.dsn=mail.data.dsn;this.connection.send(envelope,mail.message.createReadStream(),(err,info)=>{if(this.messages++,err)return this.connection.close(),this.emit("error",err),callback(err);info.envelope={from:envelope.from,to:envelope.to},info.messageId=messageId,setImmediate(()=>{let err2;if(this.messages>=this.options.maxMessages)err2=new Error("Resource exhausted"),err2.code="EMAXLIMIT",this.connection.close(),this.emit("error",err2);else this.pool._checkRateLimit(()=>{this.available=!0,this.emit("available")})}),callback(null,info)})}close(){if(this._connected=!1,this.auth&&this.auth.oauth2)this.auth.oauth2.removeAllListeners();if(this.connection)this.connection.close();this.emit("close")}}module.exports=PoolResource});var require_services=__commonJS((exports,module)=>{module.exports={"1und1":{host:"smtp.1und1.de",port:465,secure:!0,authMethod:"LOGIN"},Aliyun:{domains:["aliyun.com"],host:"smtp.aliyun.com",port:465,secure:!0},AOL:{domains:["aol.com"],host:"smtp.aol.com",port:587},Bluewin:{host:"smtpauths.bluewin.ch",domains:["bluewin.ch"],port:465},DebugMail:{host:"debugmail.io",port:25},DynectEmail:{aliases:["Dynect"],host:"smtp.dynect.net",port:25},Ethereal:{aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},FastMail:{domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:!0},"Forward Email":{aliases:["FE","ForwardEmail"],domains:["forwardemail.net"],host:"smtp.forwardemail.net",port:465,secure:!0},"Feishu Mail":{aliases:["Feishu","FeishuMail"],domains:["www.feishu.cn"],host:"smtp.feishu.cn",port:465,secure:!0},GandiMail:{aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},Gmail:{aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:!0},Godaddy:{host:"smtpout.secureserver.net",port:25},GodaddyAsia:{host:"smtp.asia.secureserver.net",port:25},GodaddyEurope:{host:"smtp.europe.secureserver.net",port:25},"hot.ee":{host:"mail.hot.ee"},Hotmail:{aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},iCloud:{aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},Infomaniak:{host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},Loopia:{host:"mailcluster.loopia.se",port:465},"mail.ee":{host:"smtp.mail.ee"},"Mail.ru":{host:"smtp.mail.ru",port:465,secure:!0},"Mailcatch.app":{host:"sandbox-smtp.mailcatch.app",port:2525},Maildev:{port:1025,ignoreTLS:!0},Mailgun:{host:"smtp.mailgun.org",port:465,secure:!0},Mailjet:{host:"in.mailjet.com",port:587},Mailosaur:{host:"mailosaur.io",port:25},Mailtrap:{host:"live.smtp.mailtrap.io",port:587},Mandrill:{host:"smtp.mandrillapp.com",port:587},Naver:{host:"smtp.naver.com",port:587},One:{host:"send.one.com",port:465,secure:!0},OpenMailBox:{aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:!0},Outlook365:{host:"smtp.office365.com",port:587,secure:!1},OhMySMTP:{host:"smtp.ohmysmtp.com",port:587,secure:!1},Postmark:{aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},Proton:{aliases:["ProtonMail","Proton.me","Protonmail.com","Protonmail.ch"],domains:["proton.me","protonmail.com","pm.me","protonmail.ch"],host:"smtp.protonmail.ch",port:587,requireTLS:!0},"qiye.aliyun":{host:"smtp.mxhichina.com",port:"465",secure:!0},QQ:{domains:["qq.com"],host:"smtp.qq.com",port:465,secure:!0},QQex:{aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:!0},SendCloud:{host:"smtp.sendcloud.net",port:2525},SendGrid:{host:"smtp.sendgrid.net",port:587},SendinBlue:{aliases:["Brevo"],host:"smtp-relay.brevo.com",port:587},SendPulse:{host:"smtp-pulse.com",port:465,secure:!0},SES:{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-1":{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-2":{host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-1":{host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTH-1":{host:"email-smtp.ap-south-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-1":{host:"email-smtp.ap-northeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-2":{host:"email-smtp.ap-northeast-2.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-3":{host:"email-smtp.ap-northeast-3.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-1":{host:"email-smtp.ap-southeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-2":{host:"email-smtp.ap-southeast-2.amazonaws.com",port:465,secure:!0},Seznam:{aliases:["Seznam Email"],domains:["seznam.cz","email.cz","post.cz","spoluzaci.cz"],host:"smtp.seznam.cz",port:465,secure:!0},Sparkpost:{aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:!1},Tipimail:{host:"smtp.tipimail.com",port:587},Yahoo:{domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:!0},Yandex:{domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:!0},Zoho:{host:"smtp.zoho.com",port:465,secure:!0,authMethod:"LOGIN"},"126":{host:"smtp.126.com",port:465,secure:!0},"163":{host:"smtp.163.com",port:465,secure:!0}}});var require_well_known=__commonJS((exports,module)=>{var services=require_services(),normalized={};Object.keys(services).forEach((key)=>{let service=services[key];normalized[normalizeKey(key)]=normalizeService(service),[].concat(service.aliases||[]).forEach((alias)=>{normalized[normalizeKey(alias)]=normalizeService(service)}),[].concat(service.domains||[]).forEach((domain)=>{normalized[normalizeKey(domain)]=normalizeService(service)})});function normalizeKey(key){return key.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function normalizeService(service){let filter=["domains","aliases"],response={};return Object.keys(service).forEach((key)=>{if(filter.indexOf(key)<0)response[key]=service[key]}),response}module.exports=function(key){return key=normalizeKey(key.split("@").pop()),normalized[key]||!1}});var require_smtp_pool=__commonJS((exports,module)=>{var EventEmitter=__require("events"),PoolResource=require_pool_resource(),SMTPConnection=require_smtp_connection(),wellKnown=require_well_known(),shared=require_shared(),packageData=require_package3();class SMTPPool extends EventEmitter{constructor(options){super();if(options=options||{},typeof options==="string")options={url:options};let urlData,service=options.service;if(typeof options.getSocket==="function")this.getSocket=options.getSocket;if(options.url)urlData=shared.parseConnectionUrl(options.url),service=service||urlData.service;this.options=shared.assign(!1,options,urlData,service&&wellKnown(service)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=shared.getLogger(this.options,{component:this.options.component||"smtp-pool"});let connection2=new SMTPConnection(this.options);this.name="SMTP (pool)",this.version=packageData.version+"[client:"+connection2.version+"]",this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1000,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate(()=>{if(this.idling)this.emit("idle")})}getSocket(options,callback){return setImmediate(()=>callback(null,!1))}send(mail,callback){if(this._closed)return!1;if(this._queue.push({mail,requeueAttempts:0,callback}),this.idling&&this._queue.length>=this.options.maxConnections)this.idling=!1;return setImmediate(()=>this._processMessages()),!0}close(){let connection2,len3=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!len3&&!this._queue.length)return;for(let i3=len3-1;i3>=0;i3--)if(this._connections[i3]&&this._connections[i3].available)connection2=this._connections[i3],connection2.close(),this.logger.info({tnx:"connection",cid:connection2.id,action:"removed"},"Connection #%s removed",connection2.id);if(len3&&!this._connections.length)this.logger.debug({tnx:"connection"},"All connections removed");if(!this._queue.length)return;let invokeCallbacks=()=>{if(!this._queue.length){this.logger.debug({tnx:"connection"},"Pending queue entries cleared");return}let entry=this._queue.shift();if(entry&&typeof entry.callback==="function")try{entry.callback(new Error("Connection pool was closed"))}catch(E){this.logger.error({err:E,tnx:"callback",cid:connection2.id},"Callback error for #%s: %s",connection2.id,E.message)}setImmediate(invokeCallbacks)};setImmediate(invokeCallbacks)}_processMessages(){let connection2,i3,len3;if(this._closed)return;if(!this._queue.length){if(!this.idling)this.idling=!0,this.emit("idle");return}for(i3=0,len3=this._connections.length;i3<len3;i3++)if(this._connections[i3].available){connection2=this._connections[i3];break}if(!connection2&&this._connections.length<this.options.maxConnections)connection2=this._createConnection();if(!connection2){this.idling=!1;return}if(!this.idling&&this._queue.length<this.options.maxConnections)this.idling=!0,this.emit("idle");let entry=connection2.queueEntry=this._queue.shift();if(entry.messageId=(connection2.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),connection2.available=!1,this.logger.debug({tnx:"pool",cid:connection2.id,messageId:entry.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",entry.messageId,connection2.id,connection2.messages+1),this._rateLimit.limit){if(this._rateLimit.counter++,!this._rateLimit.checkpoint)this._rateLimit.checkpoint=Date.now()}connection2.send(entry.mail,(err,info)=>{if(entry===connection2.queueEntry){try{entry.callback(err,info)}catch(E){this.logger.error({err:E,tnx:"callback",cid:connection2.id},"Callback error for #%s: %s",connection2.id,E.message)}connection2.queueEntry=!1}})}_createConnection(){let connection2=new PoolResource(this);return connection2.id=++this._connectionCounter,this.logger.info({tnx:"pool",cid:connection2.id,action:"conection"},"Created new pool resource #%s",connection2.id),connection2.on("available",()=>{if(this.logger.debug({tnx:"connection",cid:connection2.id,action:"available"},"Connection #%s became available",connection2.id),this._closed)this.close();else this._processMessages()}),connection2.once("error",(err)=>{if(err.code!=="EMAXLIMIT")this.logger.error({err,tnx:"pool",cid:connection2.id},"Pool Error for #%s: %s",connection2.id,err.message);else this.logger.debug({tnx:"pool",cid:connection2.id,action:"maxlimit"},"Max messages limit exchausted for #%s",connection2.id);if(connection2.queueEntry){try{connection2.queueEntry.callback(err)}catch(E){this.logger.error({err:E,tnx:"callback",cid:connection2.id},"Callback error for #%s: %s",connection2.id,E.message)}connection2.queueEntry=!1}this._removeConnection(connection2),this._continueProcessing()}),connection2.once("close",()=>{if(this.logger.info({tnx:"connection",cid:connection2.id,action:"closed"},"Connection #%s was closed",connection2.id),this._removeConnection(connection2),connection2.queueEntry)setTimeout(()=>{if(connection2.queueEntry)if(this._shouldRequeuOnConnectionClose(connection2.queueEntry))this._requeueEntryOnConnectionClose(connection2);else this._failDeliveryOnConnectionClose(connection2);this._continueProcessing()},50);else this._continueProcessing()}),this._connections.push(connection2),connection2}_shouldRequeuOnConnectionClose(queueEntry){if(this.options.maxRequeues===void 0||this.options.maxRequeues<0)return!0;return queueEntry.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(connection2){if(connection2.queueEntry&&connection2.queueEntry.callback){try{connection2.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(E){this.logger.error({err:E,tnx:"callback",messageId:connection2.queueEntry.messageId,cid:connection2.id},"Callback error for #%s: %s",connection2.id,E.message)}connection2.queueEntry=!1}}_requeueEntryOnConnectionClose(connection2){connection2.queueEntry.requeueAttempts=connection2.queueEntry.requeueAttempts+1,this.logger.debug({tnx:"pool",cid:connection2.id,messageId:connection2.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",connection2.queueEntry.messageId,connection2.id,connection2.queueEntry.requeueAttempts),this._queue.unshift(connection2.queueEntry),connection2.queueEntry=!1}_continueProcessing(){if(this._closed)this.close();else setTimeout(()=>this._processMessages(),100)}_removeConnection(connection2){let index2=this._connections.indexOf(connection2);if(index2!==-1)this._connections.splice(index2,1)}_checkRateLimit(callback){if(!this._rateLimit.limit)return callback();let now=Date.now();if(this._rateLimit.counter<this._rateLimit.limit)return callback();if(this._rateLimit.waiting.push(callback),this._rateLimit.checkpoint<=now-this._rateLimit.delta)return this._clearRateLimit();else if(!this._rateLimit.timeout)this._rateLimit.timeout=setTimeout(()=>this._clearRateLimit(),this._rateLimit.delta-(now-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=now}_clearRateLimit(){clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;while(this._rateLimit.waiting.length){let cb=this._rateLimit.waiting.shift();setImmediate(cb)}}isIdle(){return this.idling}verify(callback){let promise;if(!callback)promise=new Promise((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)});let auth=new PoolResource(this).auth;return this.getSocket(this.options,(err,socketOptions)=>{if(err)return callback(err);let options=this.options;if(socketOptions&&socketOptions.connection)this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||""),options=shared.assign(!1,options),Object.keys(socketOptions).forEach((key)=>{options[key]=socketOptions[key]});let connection2=new SMTPConnection(options),returned=!1;connection2.once("error",(err2)=>{if(returned)return;return returned=!0,connection2.close(),callback(err2)}),connection2.once("end",()=>{if(returned)return;return returned=!0,callback(new Error("Connection closed"))});let finalize=()=>{if(returned)return;return returned=!0,connection2.quit(),callback(null,!0)};connection2.connect(()=>{if(returned)return;if(auth&&(connection2.allowsAuth||options.forceAuth))connection2.login(auth,(err2)=>{if(returned)return;if(err2)return returned=!0,connection2.close(),callback(err2);finalize()});else if(!auth&&connection2.allowsAuth&&options.forceAuth){let err2=new Error("Authentication info was not provided");return err2.code="NoAuth",returned=!0,connection2.close(),callback(err2)}else finalize()})}),promise}}module.exports=SMTPPool});var require_smtp_transport=__commonJS((exports,module)=>{var EventEmitter=__require("events"),SMTPConnection=require_smtp_connection(),wellKnown=require_well_known(),shared=require_shared(),XOAuth2=require_xoauth2(),packageData=require_package3();class SMTPTransport extends EventEmitter{constructor(options){super();if(options=options||{},typeof options==="string")options={url:options};let urlData,service=options.service;if(typeof options.getSocket==="function")this.getSocket=options.getSocket;if(options.url)urlData=shared.parseConnectionUrl(options.url),service=service||urlData.service;this.options=shared.assign(!1,options,urlData,service&&wellKnown(service)),this.logger=shared.getLogger(this.options,{component:this.options.component||"smtp-transport"});let connection2=new SMTPConnection(this.options);if(this.name="SMTP",this.version=packageData.version+"[client:"+connection2.version+"]",this.options.auth)this.auth=this.getAuth({})}getSocket(options,callback){return setImmediate(()=>callback(null,!1))}getAuth(authOpts){if(!authOpts)return this.auth;let hasAuth=!1,authData={};if(this.options.auth&&typeof this.options.auth==="object")Object.keys(this.options.auth).forEach((key)=>{hasAuth=!0,authData[key]=this.options.auth[key]});if(authOpts&&typeof authOpts==="object")Object.keys(authOpts).forEach((key)=>{hasAuth=!0,authData[key]=authOpts[key]});if(!hasAuth)return!1;switch((authData.type||"").toString().toUpperCase()){case"OAUTH2":{if(!authData.service&&!authData.user)return!1;let oauth2=new XOAuth2(authData,this.logger);return oauth2.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||oauth2.provisionCallback,oauth2.on("token",(token)=>this.mailer.emit("token",token)),oauth2.on("error",(err)=>this.emit("error",err)),{type:"OAUTH2",user:authData.user,oauth2,method:"XOAUTH2"}}default:return{type:(authData.type||"").toString().toUpperCase()||"LOGIN",user:authData.user,credentials:{user:authData.user||"",pass:authData.pass,options:authData.options},method:(authData.method||"").trim().toUpperCase()||this.options.authMethod||!1}}}send(mail,callback){this.getSocket(this.options,(err,socketOptions)=>{if(err)return callback(err);let returned=!1,options=this.options;if(socketOptions&&socketOptions.connection)this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||""),options=shared.assign(!1,options),Object.keys(socketOptions).forEach((key)=>{options[key]=socketOptions[key]});let connection2=new SMTPConnection(options);connection2.once("error",(err2)=>{if(returned)return;return returned=!0,connection2.close(),callback(err2)}),connection2.once("end",()=>{if(returned)return;let timer2=setTimeout(()=>{if(returned)return;returned=!0;let err2=new Error("Unexpected socket close");if(connection2&&connection2._socket&&connection2._socket.upgrading)err2.code="ETLS";callback(err2)},1000);try{timer2.unref()}catch(E){}});let sendMessage=()=>{let envelope=mail.message.getEnvelope(),messageId=mail.message.messageId(),recipients=[].concat(envelope.to||[]);if(recipients.length>3)recipients.push("...and "+recipients.splice(2).length+" more");if(mail.data.dsn)envelope.dsn=mail.data.dsn;this.logger.info({tnx:"send",messageId},"Sending message %s to <%s>",messageId,recipients.join(", ")),connection2.send(envelope,mail.message.createReadStream(),(err2,info)=>{if(returned=!0,connection2.close(),err2)return this.logger.error({err:err2,tnx:"send"},"Send error for %s: %s",messageId,err2.message),callback(err2);info.envelope={from:envelope.from,to:envelope.to},info.messageId=messageId;try{return callback(null,info)}catch(E){this.logger.error({err:E,tnx:"callback"},"Callback error for %s: %s",messageId,E.message)}})};connection2.connect(()=>{if(returned)return;let auth=this.getAuth(mail.data.auth);if(auth&&(connection2.allowsAuth||options.forceAuth))connection2.login(auth,(err2)=>{if(auth&&auth!==this.auth&&auth.oauth2)auth.oauth2.removeAllListeners();if(returned)return;if(err2)return returned=!0,connection2.close(),callback(err2);sendMessage()});else sendMessage()})})}verify(callback){let promise;if(!callback)promise=new Promise((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)});return this.getSocket(this.options,(err,socketOptions)=>{if(err)return callback(err);let options=this.options;if(socketOptions&&socketOptions.connection)this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||""),options=shared.assign(!1,options),Object.keys(socketOptions).forEach((key)=>{options[key]=socketOptions[key]});let connection2=new SMTPConnection(options),returned=!1;connection2.once("error",(err2)=>{if(returned)return;return returned=!0,connection2.close(),callback(err2)}),connection2.once("end",()=>{if(returned)return;return returned=!0,callback(new Error("Connection closed"))});let finalize=()=>{if(returned)return;return returned=!0,connection2.quit(),callback(null,!0)};connection2.connect(()=>{if(returned)return;let authData=this.getAuth({});if(authData&&(connection2.allowsAuth||options.forceAuth))connection2.login(authData,(err2)=>{if(returned)return;if(err2)return returned=!0,connection2.close(),callback(err2);finalize()});else if(!authData&&connection2.allowsAuth&&options.forceAuth){let err2=new Error("Authentication info was not provided");return err2.code="NoAuth",returned=!0,connection2.close(),callback(err2)}else finalize()})}),promise}close(){if(this.auth&&this.auth.oauth2)this.auth.oauth2.removeAllListeners();this.emit("close")}}module.exports=SMTPTransport});var require_sendmail_transport=__commonJS((exports,module)=>{var spawn=__require("child_process").spawn,packageData=require_package3(),shared=require_shared();class SendmailTransport{constructor(options){if(options=options||{},this._spawn=spawn,this.options=options||{},this.name="Sendmail",this.version=packageData.version,this.path="sendmail",this.args=!1,this.winbreak=!1,this.logger=shared.getLogger(this.options,{component:this.options.component||"sendmail"}),options){if(typeof options==="string")this.path=options;else if(typeof options==="object"){if(options.path)this.path=options.path;if(Array.isArray(options.args))this.args=options.args;this.winbreak=["win","windows","dos",`\r
`].includes((options.newline||"").toString().toLowerCase())}}}send(mail,done){mail.message.keepBcc=!0;let envelope=mail.data.envelope||mail.message.getEnvelope(),messageId=mail.message.messageId(),args,sendmail,returned;if([].concat(envelope.from||[]).concat(envelope.to||[]).some((addr)=>/^-/.test(addr)))return done(new Error("Can not send mail. Invalid envelope addresses."));if(this.args)args=["-i"].concat(this.args).concat(envelope.to);else args=["-i"].concat(envelope.from?["-f",envelope.from]:[]).concat(envelope.to);let callback=(err)=>{if(returned)return;if(returned=!0,typeof done==="function")if(err)return done(err);else return done(null,{envelope:mail.data.envelope||mail.message.getEnvelope(),messageId,response:"Messages queued for delivery"})};try{sendmail=this._spawn(this.path,args)}catch(E){return this.logger.error({err:E,tnx:"spawn",messageId},"Error occurred while spawning sendmail. %s",E.message),callback(E)}if(sendmail){sendmail.on("error",(err)=>{this.logger.error({err,tnx:"spawn",messageId},"Error occurred when sending message %s. %s",messageId,err.message),callback(err)}),sendmail.once("exit",(code)=>{if(!code)return callback();let err;if(code===127)err=new Error("Sendmail command not found, process exited with code "+code);else err=new Error("Sendmail exited with code "+code);this.logger.error({err,tnx:"stdin",messageId},"Error sending message %s to sendmail. %s",messageId,err.message),callback(err)}),sendmail.once("close",callback),sendmail.stdin.on("error",(err)=>{this.logger.error({err,tnx:"stdin",messageId},"Error occurred when piping message %s to sendmail. %s",messageId,err.message),callback(err)});let recipients=[].concat(envelope.to||[]);if(recipients.length>3)recipients.push("...and "+recipients.splice(2).length+" more");this.logger.info({tnx:"send",messageId},"Sending message %s to <%s>",messageId,recipients.join(", "));let sourceStream=mail.message.createReadStream();sourceStream.once("error",(err)=>{this.logger.error({err,tnx:"stdin",messageId},"Error occurred when generating message %s. %s",messageId,err.message),sendmail.kill("SIGINT"),callback(err)}),sourceStream.pipe(sendmail.stdin)}else return callback(new Error("sendmail was not found"))}}module.exports=SendmailTransport});var require_stream_transport=__commonJS((exports,module)=>{var packageData=require_package3(),shared=require_shared();class StreamTransport{constructor(options){options=options||{},this.options=options||{},this.name="StreamTransport",this.version=packageData.version,this.logger=shared.getLogger(this.options,{component:this.options.component||"stream-transport"}),this.winbreak=["win","windows","dos",`\r
`].includes((options.newline||"").toString().toLowerCase())}send(mail,done){mail.message.keepBcc=!0;let envelope=mail.data.envelope||mail.message.getEnvelope(),messageId=mail.message.messageId(),recipients=[].concat(envelope.to||[]);if(recipients.length>3)recipients.push("...and "+recipients.splice(2).length+" more");this.logger.info({tnx:"send",messageId},"Sending message %s to <%s> using %s line breaks",messageId,recipients.join(", "),this.winbreak?"<CR><LF>":"<LF>"),setImmediate(()=>{let stream2;try{stream2=mail.message.createReadStream()}catch(E){return this.logger.error({err:E,tnx:"send",messageId},"Creating send stream failed for %s. %s",messageId,E.message),done(E)}if(!this.options.buffer)return stream2.once("error",(err)=>{this.logger.error({err,tnx:"send",messageId},"Failed creating message for %s. %s",messageId,err.message)}),done(null,{envelope:mail.data.envelope||mail.message.getEnvelope(),messageId,message:stream2});let chunks=[],chunklen=0;stream2.on("readable",()=>{let chunk;while((chunk=stream2.read())!==null)chunks.push(chunk),chunklen+=chunk.length}),stream2.once("error",(err)=>{return this.logger.error({err,tnx:"send",messageId},"Failed creating message for %s. %s",messageId,err.message),done(err)}),stream2.on("end",()=>done(null,{envelope:mail.data.envelope||mail.message.getEnvelope(),messageId,message:Buffer.concat(chunks,chunklen)}))})}}module.exports=StreamTransport});var require_json_transport=__commonJS((exports,module)=>{var packageData=require_package3(),shared=require_shared();class JSONTransport{constructor(options){options=options||{},this.options=options||{},this.name="JSONTransport",this.version=packageData.version,this.logger=shared.getLogger(this.options,{component:this.options.component||"json-transport"})}send(mail,done){mail.message.keepBcc=!0;let envelope=mail.data.envelope||mail.message.getEnvelope(),messageId=mail.message.messageId(),recipients=[].concat(envelope.to||[]);if(recipients.length>3)recipients.push("...and "+recipients.splice(2).length+" more");this.logger.info({tnx:"send",messageId},"Composing JSON structure of %s to <%s>",messageId,recipients.join(", ")),setImmediate(()=>{mail.normalize((err,data)=>{if(err)return this.logger.error({err,tnx:"send",messageId},"Failed building JSON structure for %s. %s",messageId,err.message),done(err);return delete data.envelope,delete data.normalizedHeaders,done(null,{envelope,messageId,message:this.options.skipEncoding?data:JSON.stringify(data)})})})}}module.exports=JSONTransport});var require_ses_transport=__commonJS((exports,module)=>{var EventEmitter=__require("events"),packageData=require_package3(),shared=require_shared(),LeWindows=require_le_windows();class SESTransport extends EventEmitter{constructor(options){super();options=options||{},this.options=options||{},this.ses=this.options.SES,this.name="SESTransport",this.version=packageData.version,this.logger=shared.getLogger(this.options,{component:this.options.component||"ses-transport"}),this.maxConnections=Number(this.options.maxConnections)||1/0,this.connections=0,this.sendingRate=Number(this.options.sendingRate)||1/0,this.sendingRateTTL=null,this.rateInterval=1000,this.rateMessages=[],this.pending=[],this.idling=!0,setImmediate(()=>{if(this.idling)this.emit("idle")})}send(mail,callback){if(this.connections>=this.maxConnections)return this.idling=!1,this.pending.push({mail,callback});if(!this._checkSendingRate())return this.idling=!1,this.pending.push({mail,callback});this._send(mail,(...args)=>{setImmediate(()=>callback(...args)),this._sent()})}_checkRatedQueue(){if(this.connections>=this.maxConnections||!this._checkSendingRate())return;if(!this.pending.length){if(!this.idling)this.idling=!0,this.emit("idle");return}let next2=this.pending.shift();this._send(next2.mail,(...args)=>{setImmediate(()=>next2.callback(...args)),this._sent()})}_checkSendingRate(){clearTimeout(this.sendingRateTTL);let now=Date.now(),oldest=!1;for(let i3=this.rateMessages.length-1;i3>=0;i3--){if(this.rateMessages[i3].ts>=now-this.rateInterval&&(!oldest||this.rateMessages[i3].ts<oldest))oldest=this.rateMessages[i3].ts;if(this.rateMessages[i3].ts<now-this.rateInterval&&!this.rateMessages[i3].pending)this.rateMessages.splice(i3,1)}if(this.rateMessages.length<this.sendingRate)return!0;let delay=Math.max(oldest+1001,now+20);this.sendingRateTTL=setTimeout(()=>this._checkRatedQueue(),now-delay);try{this.sendingRateTTL.unref()}catch(E){}return!1}_sent(){this.connections--,this._checkRatedQueue()}isIdle(){return this.idling}_send(mail,callback){let statObject={ts:Date.now(),pending:!0};this.connections++,this.rateMessages.push(statObject);let envelope=mail.data.envelope||mail.message.getEnvelope(),messageId=mail.message.messageId(),recipients=[].concat(envelope.to||[]);if(recipients.length>3)recipients.push("...and "+recipients.splice(2).length+" more");this.logger.info({tnx:"send",messageId},"Sending message %s to <%s>",messageId,recipients.join(", "));let getRawMessage=(next2)=>{if(!mail.data._dkim)mail.data._dkim={};if(mail.data._dkim.skipFields&&typeof mail.data._dkim.skipFields==="string")mail.data._dkim.skipFields+=":date:message-id";else mail.data._dkim.skipFields="date:message-id";let sourceStream=mail.message.createReadStream(),stream2=sourceStream.pipe(new LeWindows),chunks=[],chunklen=0;stream2.on("readable",()=>{let chunk;while((chunk=stream2.read())!==null)chunks.push(chunk),chunklen+=chunk.length}),sourceStream.once("error",(err)=>stream2.emit("error",err)),stream2.once("error",(err)=>{next2(err)}),stream2.once("end",()=>next2(null,Buffer.concat(chunks,chunklen)))};setImmediate(()=>getRawMessage((err,raw)=>{if(err)return this.logger.error({err,tnx:"send",messageId},"Failed creating message for %s. %s",messageId,err.message),statObject.pending=!1,callback(err);let sesMessage={RawMessage:{Data:raw},Source:envelope.from,Destinations:envelope.to};Object.keys(mail.data.ses||{}).forEach((key)=>{sesMessage[key]=mail.data.ses[key]});let ses=(this.ses.aws?this.ses.ses:this.ses)||{},aws=this.ses.aws||{};((cb)=>{if(ses.config&&typeof ses.config.region==="function")return ses.config.region().then((region)=>cb(null,region)).catch((err2)=>cb(err2));return cb(null,ses.config&&ses.config.region||"us-east-1")})((err2,region)=>{if(err2||!region)region="us-east-1";let sendPromise;if(typeof ses.send==="function"&&aws.SendRawEmailCommand)sendPromise=ses.send(new aws.SendRawEmailCommand(sesMessage));else sendPromise=ses.sendRawEmail(sesMessage).promise();sendPromise.then((data)=>{if(region==="us-east-1")region="email";statObject.pending=!1,callback(null,{envelope:{from:envelope.from,to:envelope.to},messageId:"<"+data.MessageId+(!/@/.test(data.MessageId)?"@"+region+".amazonses.com":"")+">",response:data.MessageId,raw})}).catch((err3)=>{this.logger.error({err:err3,tnx:"send"},"Send error for %s: %s",messageId,err3.message),statObject.pending=!1,callback(err3)})})}))}verify(callback){let promise,ses=(this.ses.aws?this.ses.ses:this.ses)||{},aws=this.ses.aws||{},sesMessage={RawMessage:{Data:`From: invalid@invalid\r
To: invalid@invalid\r
 Subject: Invalid\r
\r
Invalid`},Source:"invalid@invalid",Destinations:["invalid@invalid"]};if(!callback)promise=new Promise((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)});let cb=(err)=>{if(err&&(err.code||err.Code)!=="InvalidParameterValue")return callback(err);return callback(null,!0)};if(typeof ses.send==="function"&&aws.SendRawEmailCommand)sesMessage.RawMessage.Data=Buffer.from(sesMessage.RawMessage.Data),ses.send(new aws.SendRawEmailCommand(sesMessage),cb);else ses.sendRawEmail(sesMessage,cb);return promise}}module.exports=SESTransport});var require_nodemailer=__commonJS((exports,module)=>{var Mailer=require_mailer(),shared=require_shared(),SMTPPool=require_smtp_pool(),SMTPTransport=require_smtp_transport(),SendmailTransport=require_sendmail_transport(),StreamTransport=require_stream_transport(),JSONTransport=require_json_transport(),SESTransport=require_ses_transport(),nmfetch=require_fetch(),packageData=require_package3(),ETHEREAL_API=(process.env.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,""),ETHEREAL_WEB=(process.env.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,""),ETHEREAL_API_KEY=(process.env.ETHEREAL_API_KEY||"").replace(/\s*/g,"")||null,ETHEREAL_CACHE=["true","yes","y","1"].includes((process.env.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase()),testAccount=!1;exports.createTransport=function(transporter,defaults){let urlConfig,options,mailer;if(typeof transporter==="object"&&typeof transporter.send!=="function"||typeof transporter==="string"&&/^(smtps?|direct):/i.test(transporter)){if(urlConfig=typeof transporter==="string"?transporter:transporter.url)options=shared.parseConnectionUrl(urlConfig);else options=transporter;if(options.pool)transporter=new SMTPPool(options);else if(options.sendmail)transporter=new SendmailTransport(options);else if(options.streamTransport)transporter=new StreamTransport(options);else if(options.jsonTransport)transporter=new JSONTransport(options);else if(options.SES)transporter=new SESTransport(options);else transporter=new SMTPTransport(options)}return mailer=new Mailer(transporter,options,defaults),mailer};exports.createTestAccount=function(apiUrl,callback){let promise;if(!callback&&typeof apiUrl==="function")callback=apiUrl,apiUrl=!1;if(!callback)promise=new Promise((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)});if(ETHEREAL_CACHE&&testAccount)return setImmediate(()=>callback(null,testAccount)),promise;apiUrl=apiUrl||ETHEREAL_API;let chunks=[],chunklen=0,requestHeaders={},requestBody={requestor:packageData.name,version:packageData.version};if(ETHEREAL_API_KEY)requestHeaders.Authorization="Bearer "+ETHEREAL_API_KEY;let req=nmfetch(apiUrl+"/user",{contentType:"application/json",method:"POST",headers:requestHeaders,body:Buffer.from(JSON.stringify(requestBody))});return req.on("readable",()=>{let chunk;while((chunk=req.read())!==null)chunks.push(chunk),chunklen+=chunk.length}),req.once("error",(err)=>callback(err)),req.once("end",()=>{let res=Buffer.concat(chunks,chunklen),data,err;try{data=JSON.parse(res.toString())}catch(E){err=E}if(err)return callback(err);if(data.status!=="success"||data.error)return callback(new Error(data.error||"Request failed"));delete data.status,testAccount=data,callback(null,testAccount)}),promise};exports.getTestMessageUrl=function(info){if(!info||!info.response)return!1;let infoProps=new Map;if(info.response.replace(/\[([^\]]+)\]$/,(m,props)=>{props.replace(/\b([A-Z0-9]+)=([^\s]+)/g,(m2,key,value)=>{infoProps.set(key,value)})}),infoProps.has("STATUS")&&infoProps.has("MSGID"))return(testAccount.web||ETHEREAL_WEB)+"/message/"+infoProps.get("MSGID");return!1}});var Y=(A,b)=>{let v=b?.length?{}:null;if(v)for(let K of b)v[K.part.charCodeAt(0)]=K;return{part:A,store:null,inert:v,params:null,wildcardStore:null}},k=(A,b)=>({...A,part:b}),T=(A)=>({name:A,store:null,inert:null});class _{config;root={};history=[];deferred=[];constructor(A={}){if(this.config=A,A.lazy)this.find=this.lazyFind}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/:.+?\?(?=\/|$)/g};lazyFind=(A,b)=>{if(!this.config.lazy)return this.find;return this.build(),this.find(A,b)};build(){if(!this.config.lazy)return;for(let[A,b,v]of this.deferred)this.add(A,b,v,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=(A,b)=>{let v=this.root[A];if(!v)return null;return $(b,b.length,v,0)}}add(A,b,v,{ignoreError:K=!1,ignoreHistory:V=!1,lazy:U=this.config.lazy}={}){if(U)return this.find=this.lazyFind,this.deferred.push([A,b,v]),v;if(typeof b!=="string")throw new TypeError("Route path must be a string");if(b==="")b="/";else if(b[0]!=="/")b=`/${b}`;let J=b[b.length-1]==="*",F=b.match(_.regex.optionalParams);if(F){let S=b.replaceAll("?","");this.add(A,S,v,{ignoreError:K,ignoreHistory:V,lazy:U});for(let D=0;D<F.length;D++){let B=b.replace("/"+F[D],"");this.add(A,B,v,{ignoreError:!0,ignoreHistory:V,lazy:U})}return v}if(F)b=b.replaceAll("?","");if(this.history.find(([S,D,B])=>S===A&&D===b))return v;if(J||F&&b.charCodeAt(b.length-1)===63)b=b.slice(0,-1);if(!V)this.history.push([A,b,v]);let G=b.split(_.regex.static),X=b.match(_.regex.params)||[];if(G[G.length-1]==="")G.pop();let q;if(!this.root[A])q=this.root[A]=Y("/");else q=this.root[A];let O=0;for(let S=0;S<G.length;++S){let D=G[S];if(S>0){let B=X[O++].slice(1);if(q.params===null)q.params=T(B);else if(q.params.name!==B)if(K)return v;else throw new Error(`Cannot create route "${b}" with parameter "${B}" because a route already exists with a different parameter name ("${q.params.name}") in the same location`);let Q=q.params;if(Q.inert===null){q=Q.inert=Y(D);continue}q=Q.inert}for(let B=0;;){if(B===D.length){if(B<q.part.length){let Q=k(q,q.part.slice(B));Object.assign(q,Y(D,[Q]))}break}if(B===q.part.length){if(q.inert===null)q.inert={};let Q=q.inert[D.charCodeAt(B)];if(Q){q=Q,D=D.slice(B),B=0;continue}let Z=Y(D.slice(B));q.inert[D.charCodeAt(B)]=Z,q=Z;break}if(D[B]!==q.part[B]){let Q=k(q,q.part.slice(B)),Z=Y(D.slice(B));Object.assign(q,Y(q.part.slice(0,B),[Q,Z])),q=Z;break}++B}}if(O<X.length){let D=X[O].slice(1);if(q.params===null)q.params=T(D);else if(q.params.name!==D)if(K)return v;else throw new Error(`Cannot create route "${b}" with parameter "${D}" because a route already exists with a different parameter name ("${q.params.name}") in the same location`);if(q.params.store===null)q.params.store=v;return q.params.store}if(J){if(q.wildcardStore===null)q.wildcardStore=v;return q.wildcardStore}if(q.store===null)q.store=v;return q.store}find(A,b){let v=this.root[A];if(!v)return null;return $(b,b.length,v,0)}}var $=(A,b,v,K)=>{let V=v.part,U=V.length,J=K+U;if(U>1){if(J>b)return null;if(U<15){for(let F=1,G=K+1;F<U;++F,++G)if(V.charCodeAt(F)!==A.charCodeAt(G))return null}else if(A.slice(K,J)!==V)return null}if(J===b){if(v.store!==null)return{store:v.store,params:{}};if(v.wildcardStore!==null)return{store:v.wildcardStore,params:{"*":""}};return null}if(v.inert!==null){let F=v.inert[A.charCodeAt(J)];if(F!==void 0){let G=$(A,b,F,J);if(G!==null)return G}}if(v.params!==null){let{store:F,name:G,inert:X}=v.params,q=A.indexOf("/",J);if(q!==J){if(q===-1||q>=b){if(F!==null){let O={};return O[G]=A.substring(J,b),{store:F,params:O}}}else if(X!==null){let O=$(A,b,X,q);if(O!==null)return O.params[G]=A.substring(J,q),O}}}if(v.wildcardStore!==null)return{store:v.wildcardStore,params:{"*":A.substring(J,b)}};return null};var exports_value={};__export(exports_value,{IsUndefined:()=>IsUndefined,IsUint8Array:()=>IsUint8Array,IsSymbol:()=>IsSymbol,IsString:()=>IsString,IsRegExp:()=>IsRegExp,IsObject:()=>IsObject,IsNumber:()=>IsNumber,IsNull:()=>IsNull,IsIterator:()=>IsIterator,IsFunction:()=>IsFunction,IsDate:()=>IsDate,IsBoolean:()=>IsBoolean,IsBigInt:()=>IsBigInt,IsAsyncIterator:()=>IsAsyncIterator,IsArray:()=>IsArray,HasPropertyKey:()=>HasPropertyKey});function HasPropertyKey(value,key){return key in value}function IsAsyncIterator(value){return IsObject(value)&&!IsArray(value)&&!IsUint8Array(value)&&Symbol.asyncIterator in value}function IsArray(value){return Array.isArray(value)}function IsBigInt(value){return typeof value==="bigint"}function IsBoolean(value){return typeof value==="boolean"}function IsDate(value){return value instanceof globalThis.Date}function IsFunction(value){return typeof value==="function"}function IsIterator(value){return IsObject(value)&&!IsArray(value)&&!IsUint8Array(value)&&Symbol.iterator in value}function IsNull(value){return value===null}function IsNumber(value){return typeof value==="number"}function IsObject(value){return typeof value==="object"&&value!==null}function IsRegExp(value){return value instanceof globalThis.RegExp}function IsString(value){return typeof value==="string"}function IsSymbol(value){return typeof value==="symbol"}function IsUint8Array(value){return value instanceof globalThis.Uint8Array}function IsUndefined(value){return value===void 0}function ArrayType(value){return value.map((value2)=>Visit(value2))}function DateType(value){return new Date(value.getTime())}function Uint8ArrayType(value){return new Uint8Array(value)}function RegExpType(value){return new RegExp(value.source,value.flags)}function ObjectType(value){let result={};for(let key of Object.getOwnPropertyNames(value))result[key]=Visit(value[key]);for(let key of Object.getOwnPropertySymbols(value))result[key]=Visit(value[key]);return result}function Visit(value){return IsArray(value)?ArrayType(value):IsDate(value)?DateType(value):IsUint8Array(value)?Uint8ArrayType(value):IsRegExp(value)?RegExpType(value):IsObject(value)?ObjectType(value):value}function Clone(value){return Visit(value)}function CloneType(schema,options){return options===void 0?Clone(schema):Clone({...options,...schema})}function IsAsyncIterator2(value){return IsObject2(value)&&globalThis.Symbol.asyncIterator in value}function IsIterator2(value){return IsObject2(value)&&globalThis.Symbol.iterator in value}function IsStandardObject(value){return IsObject2(value)&&(globalThis.Object.getPrototypeOf(value)===Object.prototype||globalThis.Object.getPrototypeOf(value)===null)}function IsPromise(value){return value instanceof globalThis.Promise}function IsDate2(value){return value instanceof Date&&globalThis.Number.isFinite(value.getTime())}function IsMap(value){return value instanceof globalThis.Map}function IsSet(value){return value instanceof globalThis.Set}function IsTypedArray(value){return globalThis.ArrayBuffer.isView(value)}function IsUint8Array2(value){return value instanceof globalThis.Uint8Array}function HasPropertyKey2(value,key){return key in value}function IsObject2(value){return value!==null&&typeof value==="object"}function IsArray2(value){return globalThis.Array.isArray(value)&&!globalThis.ArrayBuffer.isView(value)}function IsUndefined2(value){return value===void 0}function IsNull2(value){return value===null}function IsBoolean2(value){return typeof value==="boolean"}function IsNumber2(value){return typeof value==="number"}function IsInteger(value){return globalThis.Number.isInteger(value)}function IsBigInt2(value){return typeof value==="bigint"}function IsString2(value){return typeof value==="string"}function IsFunction2(value){return typeof value==="function"}function IsSymbol2(value){return typeof value==="symbol"}function IsValueType(value){return IsBigInt2(value)||IsBoolean2(value)||IsNull2(value)||IsNumber2(value)||IsString2(value)||IsSymbol2(value)||IsUndefined2(value)}var TypeSystemPolicy;(function(TypeSystemPolicy2){TypeSystemPolicy2.InstanceMode="default",TypeSystemPolicy2.ExactOptionalPropertyTypes=!1,TypeSystemPolicy2.AllowArrayObject=!1,TypeSystemPolicy2.AllowNaN=!1,TypeSystemPolicy2.AllowNullVoid=!1;function IsExactOptionalProperty(value,key){return TypeSystemPolicy2.ExactOptionalPropertyTypes?key in value:value[key]!==void 0}TypeSystemPolicy2.IsExactOptionalProperty=IsExactOptionalProperty;function IsObjectLike(value){let isObject=IsObject2(value);return TypeSystemPolicy2.AllowArrayObject?isObject:isObject&&!IsArray2(value)}TypeSystemPolicy2.IsObjectLike=IsObjectLike;function IsRecordLike(value){return IsObjectLike(value)&&!(value instanceof Date)&&!(value instanceof Uint8Array)}TypeSystemPolicy2.IsRecordLike=IsRecordLike;function IsNumberLike(value){return TypeSystemPolicy2.AllowNaN?IsNumber2(value):Number.isFinite(value)}TypeSystemPolicy2.IsNumberLike=IsNumberLike;function IsVoidLike(value){let isUndefined=IsUndefined2(value);return TypeSystemPolicy2.AllowNullVoid?isUndefined||value===null:isUndefined}TypeSystemPolicy2.IsVoidLike=IsVoidLike})(TypeSystemPolicy||(TypeSystemPolicy={}));function ImmutableArray(value){return globalThis.Object.freeze(value).map((value2)=>Immutable(value2))}function ImmutableDate(value){return value}function ImmutableUint8Array(value){return value}function ImmutableRegExp(value){return value}function ImmutableObject(value){let result={};for(let key of Object.getOwnPropertyNames(value))result[key]=Immutable(value[key]);for(let key of Object.getOwnPropertySymbols(value))result[key]=Immutable(value[key]);return globalThis.Object.freeze(result)}function Immutable(value){return IsArray(value)?ImmutableArray(value):IsDate(value)?ImmutableDate(value):IsUint8Array(value)?ImmutableUint8Array(value):IsRegExp(value)?ImmutableRegExp(value):IsObject(value)?ImmutableObject(value):value}function CreateType(schema,options){let result=options!==void 0?{...options,...schema}:schema;switch(TypeSystemPolicy.InstanceMode){case"freeze":return Immutable(result);case"clone":return Clone(result);default:return result}}class TypeBoxError extends Error{constructor(message){super(message)}}var TransformKind=Symbol.for("TypeBox.Transform"),ReadonlyKind=Symbol.for("TypeBox.Readonly"),OptionalKind=Symbol.for("TypeBox.Optional"),Hint=Symbol.for("TypeBox.Hint"),Kind=Symbol.for("TypeBox.Kind");function IsReadonly(value){return IsObject(value)&&value[ReadonlyKind]==="Readonly"}function IsOptional(value){return IsObject(value)&&value[OptionalKind]==="Optional"}function IsAny(value){return IsKindOf(value,"Any")}function IsArgument(value){return IsKindOf(value,"Argument")}function IsArray3(value){return IsKindOf(value,"Array")}function IsAsyncIterator3(value){return IsKindOf(value,"AsyncIterator")}function IsBigInt3(value){return IsKindOf(value,"BigInt")}function IsBoolean3(value){return IsKindOf(value,"Boolean")}function IsComputed(value){return IsKindOf(value,"Computed")}function IsConstructor(value){return IsKindOf(value,"Constructor")}function IsDate3(value){return IsKindOf(value,"Date")}function IsFunction3(value){return IsKindOf(value,"Function")}function IsInteger2(value){return IsKindOf(value,"Integer")}function IsIntersect(value){return IsKindOf(value,"Intersect")}function IsIterator3(value){return IsKindOf(value,"Iterator")}function IsKindOf(value,kind){return IsObject(value)&&Kind in value&&value[Kind]===kind}function IsLiteralValue(value){return IsBoolean(value)||IsNumber(value)||IsString(value)}function IsLiteral(value){return IsKindOf(value,"Literal")}function IsMappedKey(value){return IsKindOf(value,"MappedKey")}function IsMappedResult(value){return IsKindOf(value,"MappedResult")}function IsNever(value){return IsKindOf(value,"Never")}function IsNot(value){return IsKindOf(value,"Not")}function IsNull3(value){return IsKindOf(value,"Null")}function IsNumber3(value){return IsKindOf(value,"Number")}function IsObject3(value){return IsKindOf(value,"Object")}function IsPromise2(value){return IsKindOf(value,"Promise")}function IsRecord(value){return IsKindOf(value,"Record")}function IsRef(value){return IsKindOf(value,"Ref")}function IsRegExp2(value){return IsKindOf(value,"RegExp")}function IsString3(value){return IsKindOf(value,"String")}function IsSymbol3(value){return IsKindOf(value,"Symbol")}function IsTemplateLiteral(value){return IsKindOf(value,"TemplateLiteral")}function IsThis(value){return IsKindOf(value,"This")}function IsTransform(value){return IsObject(value)&&TransformKind in value}function IsTuple(value){return IsKindOf(value,"Tuple")}function IsUndefined3(value){return IsKindOf(value,"Undefined")}function IsUnion(value){return IsKindOf(value,"Union")}function IsUint8Array3(value){return IsKindOf(value,"Uint8Array")}function IsUnknown(value){return IsKindOf(value,"Unknown")}function IsUnsafe(value){return IsKindOf(value,"Unsafe")}function IsVoid(value){return IsKindOf(value,"Void")}function IsKind(value){return IsObject(value)&&Kind in value&&IsString(value[Kind])}function IsSchema(value){return IsAny(value)||IsArgument(value)||IsArray3(value)||IsBoolean3(value)||IsBigInt3(value)||IsAsyncIterator3(value)||IsComputed(value)||IsConstructor(value)||IsDate3(value)||IsFunction3(value)||IsInteger2(value)||IsIntersect(value)||IsIterator3(value)||IsLiteral(value)||IsMappedKey(value)||IsMappedResult(value)||IsNever(value)||IsNot(value)||IsNull3(value)||IsNumber3(value)||IsObject3(value)||IsPromise2(value)||IsRecord(value)||IsRef(value)||IsRegExp2(value)||IsString3(value)||IsSymbol3(value)||IsTemplateLiteral(value)||IsThis(value)||IsTuple(value)||IsUndefined3(value)||IsUnion(value)||IsUint8Array3(value)||IsUnknown(value)||IsUnsafe(value)||IsVoid(value)||IsKind(value)}var exports_type={};__export(exports_type,{TypeGuardUnknownTypeError:()=>TypeGuardUnknownTypeError,IsVoid:()=>IsVoid2,IsUnsafe:()=>IsUnsafe2,IsUnknown:()=>IsUnknown2,IsUnionLiteral:()=>IsUnionLiteral,IsUnion:()=>IsUnion2,IsUndefined:()=>IsUndefined4,IsUint8Array:()=>IsUint8Array4,IsTuple:()=>IsTuple2,IsTransform:()=>IsTransform2,IsThis:()=>IsThis2,IsTemplateLiteral:()=>IsTemplateLiteral2,IsSymbol:()=>IsSymbol4,IsString:()=>IsString4,IsSchema:()=>IsSchema2,IsRegExp:()=>IsRegExp3,IsRef:()=>IsRef2,IsRecursive:()=>IsRecursive,IsRecord:()=>IsRecord2,IsReadonly:()=>IsReadonly2,IsProperties:()=>IsProperties,IsPromise:()=>IsPromise3,IsOptional:()=>IsOptional2,IsObject:()=>IsObject4,IsNumber:()=>IsNumber4,IsNull:()=>IsNull4,IsNot:()=>IsNot2,IsNever:()=>IsNever2,IsMappedResult:()=>IsMappedResult2,IsMappedKey:()=>IsMappedKey2,IsLiteralValue:()=>IsLiteralValue2,IsLiteralString:()=>IsLiteralString,IsLiteralNumber:()=>IsLiteralNumber,IsLiteralBoolean:()=>IsLiteralBoolean,IsLiteral:()=>IsLiteral2,IsKindOf:()=>IsKindOf2,IsKind:()=>IsKind2,IsIterator:()=>IsIterator4,IsIntersect:()=>IsIntersect2,IsInteger:()=>IsInteger3,IsImport:()=>IsImport,IsFunction:()=>IsFunction4,IsDate:()=>IsDate4,IsConstructor:()=>IsConstructor2,IsComputed:()=>IsComputed2,IsBoolean:()=>IsBoolean4,IsBigInt:()=>IsBigInt4,IsAsyncIterator:()=>IsAsyncIterator4,IsArray:()=>IsArray4,IsArgument:()=>IsArgument2,IsAny:()=>IsAny2});class TypeGuardUnknownTypeError extends TypeBoxError{}var KnownTypes=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function IsPattern(value){try{return new RegExp(value),!0}catch{return!1}}function IsControlCharacterFree(value){if(!IsString(value))return!1;for(let i=0;i<value.length;i++){let code=value.charCodeAt(i);if(code>=7&&code<=13||code===27||code===127)return!1}return!0}function IsAdditionalProperties(value){return IsOptionalBoolean(value)||IsSchema2(value)}function IsOptionalBigInt(value){return IsUndefined(value)||IsBigInt(value)}function IsOptionalNumber(value){return IsUndefined(value)||IsNumber(value)}function IsOptionalBoolean(value){return IsUndefined(value)||IsBoolean(value)}function IsOptionalString(value){return IsUndefined(value)||IsString(value)}function IsOptionalPattern(value){return IsUndefined(value)||IsString(value)&&IsControlCharacterFree(value)&&IsPattern(value)}function IsOptionalFormat(value){return IsUndefined(value)||IsString(value)&&IsControlCharacterFree(value)}function IsOptionalSchema(value){return IsUndefined(value)||IsSchema2(value)}function IsReadonly2(value){return IsObject(value)&&value[ReadonlyKind]==="Readonly"}function IsOptional2(value){return IsObject(value)&&value[OptionalKind]==="Optional"}function IsAny2(value){return IsKindOf2(value,"Any")&&IsOptionalString(value.$id)}function IsArgument2(value){return IsKindOf2(value,"Argument")&&IsNumber(value.index)}function IsArray4(value){return IsKindOf2(value,"Array")&&value.type==="array"&&IsOptionalString(value.$id)&&IsSchema2(value.items)&&IsOptionalNumber(value.minItems)&&IsOptionalNumber(value.maxItems)&&IsOptionalBoolean(value.uniqueItems)&&IsOptionalSchema(value.contains)&&IsOptionalNumber(value.minContains)&&IsOptionalNumber(value.maxContains)}function IsAsyncIterator4(value){return IsKindOf2(value,"AsyncIterator")&&value.type==="AsyncIterator"&&IsOptionalString(value.$id)&&IsSchema2(value.items)}function IsBigInt4(value){return IsKindOf2(value,"BigInt")&&value.type==="bigint"&&IsOptionalString(value.$id)&&IsOptionalBigInt(value.exclusiveMaximum)&&IsOptionalBigInt(value.exclusiveMinimum)&&IsOptionalBigInt(value.maximum)&&IsOptionalBigInt(value.minimum)&&IsOptionalBigInt(value.multipleOf)}function IsBoolean4(value){return IsKindOf2(value,"Boolean")&&value.type==="boolean"&&IsOptionalString(value.$id)}function IsComputed2(value){return IsKindOf2(value,"Computed")&&IsString(value.target)&&IsArray(value.parameters)&&value.parameters.every((schema)=>IsSchema2(schema))}function IsConstructor2(value){return IsKindOf2(value,"Constructor")&&value.type==="Constructor"&&IsOptionalString(value.$id)&&IsArray(value.parameters)&&value.parameters.every((schema)=>IsSchema2(schema))&&IsSchema2(value.returns)}function IsDate4(value){return IsKindOf2(value,"Date")&&value.type==="Date"&&IsOptionalString(value.$id)&&IsOptionalNumber(value.exclusiveMaximumTimestamp)&&IsOptionalNumber(value.exclusiveMinimumTimestamp)&&IsOptionalNumber(value.maximumTimestamp)&&IsOptionalNumber(value.minimumTimestamp)&&IsOptionalNumber(value.multipleOfTimestamp)}function IsFunction4(value){return IsKindOf2(value,"Function")&&value.type==="Function"&&IsOptionalString(value.$id)&&IsArray(value.parameters)&&value.parameters.every((schema)=>IsSchema2(schema))&&IsSchema2(value.returns)}function IsImport(value){return IsKindOf2(value,"Import")&&HasPropertyKey(value,"$defs")&&IsObject(value.$defs)&&IsProperties(value.$defs)&&HasPropertyKey(value,"$ref")&&IsString(value.$ref)&&value.$ref in value.$defs}function IsInteger3(value){return IsKindOf2(value,"Integer")&&value.type==="integer"&&IsOptionalString(value.$id)&&IsOptionalNumber(value.exclusiveMaximum)&&IsOptionalNumber(value.exclusiveMinimum)&&IsOptionalNumber(value.maximum)&&IsOptionalNumber(value.minimum)&&IsOptionalNumber(value.multipleOf)}function IsProperties(value){return IsObject(value)&&Object.entries(value).every(([key,schema])=>IsControlCharacterFree(key)&&IsSchema2(schema))}function IsIntersect2(value){return IsKindOf2(value,"Intersect")&&(IsString(value.type)&&value.type!=="object"?!1:!0)&&IsArray(value.allOf)&&value.allOf.every((schema)=>IsSchema2(schema)&&!IsTransform2(schema))&&IsOptionalString(value.type)&&(IsOptionalBoolean(value.unevaluatedProperties)||IsOptionalSchema(value.unevaluatedProperties))&&IsOptionalString(value.$id)}function IsIterator4(value){return IsKindOf2(value,"Iterator")&&value.type==="Iterator"&&IsOptionalString(value.$id)&&IsSchema2(value.items)}function IsKindOf2(value,kind){return IsObject(value)&&Kind in value&&value[Kind]===kind}function IsLiteralString(value){return IsLiteral2(value)&&IsString(value.const)}function IsLiteralNumber(value){return IsLiteral2(value)&&IsNumber(value.const)}function IsLiteralBoolean(value){return IsLiteral2(value)&&IsBoolean(value.const)}function IsLiteral2(value){return IsKindOf2(value,"Literal")&&IsOptionalString(value.$id)&&IsLiteralValue2(value.const)}function IsLiteralValue2(value){return IsBoolean(value)||IsNumber(value)||IsString(value)}function IsMappedKey2(value){return IsKindOf2(value,"MappedKey")&&IsArray(value.keys)&&value.keys.every((key)=>IsNumber(key)||IsString(key))}function IsMappedResult2(value){return IsKindOf2(value,"MappedResult")&&IsProperties(value.properties)}function IsNever2(value){return IsKindOf2(value,"Never")&&IsObject(value.not)&&Object.getOwnPropertyNames(value.not).length===0}function IsNot2(value){return IsKindOf2(value,"Not")&&IsSchema2(value.not)}function IsNull4(value){return IsKindOf2(value,"Null")&&value.type==="null"&&IsOptionalString(value.$id)}function IsNumber4(value){return IsKindOf2(value,"Number")&&value.type==="number"&&IsOptionalString(value.$id)&&IsOptionalNumber(value.exclusiveMaximum)&&IsOptionalNumber(value.exclusiveMinimum)&&IsOptionalNumber(value.maximum)&&IsOptionalNumber(value.minimum)&&IsOptionalNumber(value.multipleOf)}function IsObject4(value){return IsKindOf2(value,"Object")&&value.type==="object"&&IsOptionalString(value.$id)&&IsProperties(value.properties)&&IsAdditionalProperties(value.additionalProperties)&&IsOptionalNumber(value.minProperties)&&IsOptionalNumber(value.maxProperties)}function IsPromise3(value){return IsKindOf2(value,"Promise")&&value.type==="Promise"&&IsOptionalString(value.$id)&&IsSchema2(value.item)}function IsRecord2(value){return IsKindOf2(value,"Record")&&value.type==="object"&&IsOptionalString(value.$id)&&IsAdditionalProperties(value.additionalProperties)&&IsObject(value.patternProperties)&&((schema)=>{let keys=Object.getOwnPropertyNames(schema.patternProperties);return keys.length===1&&IsPattern(keys[0])&&IsObject(schema.patternProperties)&&IsSchema2(schema.patternProperties[keys[0]])})(value)}function IsRecursive(value){return IsObject(value)&&Hint in value&&value[Hint]==="Recursive"}function IsRef2(value){return IsKindOf2(value,"Ref")&&IsOptionalString(value.$id)&&IsString(value.$ref)}function IsRegExp3(value){return IsKindOf2(value,"RegExp")&&IsOptionalString(value.$id)&&IsString(value.source)&&IsString(value.flags)&&IsOptionalNumber(value.maxLength)&&IsOptionalNumber(value.minLength)}function IsString4(value){return IsKindOf2(value,"String")&&value.type==="string"&&IsOptionalString(value.$id)&&IsOptionalNumber(value.minLength)&&IsOptionalNumber(value.maxLength)&&IsOptionalPattern(value.pattern)&&IsOptionalFormat(value.format)}function IsSymbol4(value){return IsKindOf2(value,"Symbol")&&value.type==="symbol"&&IsOptionalString(value.$id)}function IsTemplateLiteral2(value){return IsKindOf2(value,"TemplateLiteral")&&value.type==="string"&&IsString(value.pattern)&&value.pattern[0]==="^"&&value.pattern[value.pattern.length-1]==="$"}function IsThis2(value){return IsKindOf2(value,"This")&&IsOptionalString(value.$id)&&IsString(value.$ref)}function IsTransform2(value){return IsObject(value)&&TransformKind in value}function IsTuple2(value){return IsKindOf2(value,"Tuple")&&value.type==="array"&&IsOptionalString(value.$id)&&IsNumber(value.minItems)&&IsNumber(value.maxItems)&&value.minItems===value.maxItems&&(IsUndefined(value.items)&&IsUndefined(value.additionalItems)&&value.minItems===0||IsArray(value.items)&&value.items.every((schema)=>IsSchema2(schema)))}function IsUndefined4(value){return IsKindOf2(value,"Undefined")&&value.type==="undefined"&&IsOptionalString(value.$id)}function IsUnionLiteral(value){return IsUnion2(value)&&value.anyOf.every((schema)=>IsLiteralString(schema)||IsLiteralNumber(schema))}function IsUnion2(value){return IsKindOf2(value,"Union")&&IsOptionalString(value.$id)&&IsObject(value)&&IsArray(value.anyOf)&&value.anyOf.every((schema)=>IsSchema2(schema))}function IsUint8Array4(value){return IsKindOf2(value,"Uint8Array")&&value.type==="Uint8Array"&&IsOptionalString(value.$id)&&IsOptionalNumber(value.minByteLength)&&IsOptionalNumber(value.maxByteLength)}function IsUnknown2(value){return IsKindOf2(value,"Unknown")&&IsOptionalString(value.$id)}function IsUnsafe2(value){return IsKindOf2(value,"Unsafe")}function IsVoid2(value){return IsKindOf2(value,"Void")&&value.type==="void"&&IsOptionalString(value.$id)}function IsKind2(value){return IsObject(value)&&Kind in value&&IsString(value[Kind])&&!KnownTypes.includes(value[Kind])}function IsSchema2(value){return IsObject(value)&&(IsAny2(value)||IsArgument2(value)||IsArray4(value)||IsBoolean4(value)||IsBigInt4(value)||IsAsyncIterator4(value)||IsComputed2(value)||IsConstructor2(value)||IsDate4(value)||IsFunction4(value)||IsInteger3(value)||IsIntersect2(value)||IsIterator4(value)||IsLiteral2(value)||IsMappedKey2(value)||IsMappedResult2(value)||IsNever2(value)||IsNot2(value)||IsNull4(value)||IsNumber4(value)||IsObject4(value)||IsPromise3(value)||IsRecord2(value)||IsRef2(value)||IsRegExp3(value)||IsString4(value)||IsSymbol4(value)||IsTemplateLiteral2(value)||IsThis2(value)||IsTuple2(value)||IsUndefined4(value)||IsUnion2(value)||IsUint8Array4(value)||IsUnknown2(value)||IsUnsafe2(value)||IsVoid2(value)||IsKind2(value))}var PatternBoolean="(true|false)",PatternNumber="(0|[1-9][0-9]*)",PatternString="(.*)";var PatternNumberExact="^(0|[1-9][0-9]*)$",PatternStringExact="^(.*)$",PatternNeverExact="^(?!.*)$";var exports_format={};__export(exports_format,{Set:()=>Set2,Has:()=>Has,Get:()=>Get,Entries:()=>Entries,Delete:()=>Delete,Clear:()=>Clear});var map=new Map;function Entries(){return new Map(map)}function Clear(){return map.clear()}function Delete(format){return map.delete(format)}function Has(format){return map.has(format)}function Set2(format,func){map.set(format,func)}function Get(format){return map.get(format)}var exports_type2={};__export(exports_type2,{Set:()=>Set3,Has:()=>Has2,Get:()=>Get2,Entries:()=>Entries2,Delete:()=>Delete2,Clear:()=>Clear2});var map2=new Map;function Entries2(){return new Map(map2)}function Clear2(){return map2.clear()}function Delete2(kind){return map2.delete(kind)}function Has2(kind){return map2.has(kind)}function Set3(kind,func){map2.set(kind,func)}function Get2(kind){return map2.get(kind)}function SetIncludes(T2,S){return T2.includes(S)}function SetDistinct(T2){return[...new Set(T2)]}function SetIntersect(T2,S){return T2.filter((L)=>S.includes(L))}function SetIntersectManyResolve(T2,Init){return T2.reduce((Acc,L)=>{return SetIntersect(Acc,L)},Init)}function SetIntersectMany(T2){return T2.length===1?T2[0]:T2.length>1?SetIntersectManyResolve(T2.slice(1),T2[0]):[]}function SetUnionMany(T2){let Acc=[];for(let L of T2)Acc.push(...L);return Acc}function Any(options){return CreateType({[Kind]:"Any"},options)}function Array2(items,options){return CreateType({[Kind]:"Array",type:"array",items},options)}function Argument(index){return CreateType({[Kind]:"Argument",index})}function AsyncIterator(items,options){return CreateType({[Kind]:"AsyncIterator",type:"AsyncIterator",items},options)}function Computed(target,parameters,options){return CreateType({[Kind]:"Computed",target,parameters},options)}function DiscardKey(value,key){let{[key]:_2,...rest}=value;return rest}function Discard(value,keys){return keys.reduce((acc,key)=>DiscardKey(acc,key),value)}function Never(options){return CreateType({[Kind]:"Never",not:{}},options)}function MappedResult(properties){return CreateType({[Kind]:"MappedResult",properties})}function Constructor(parameters,returns,options){return CreateType({[Kind]:"Constructor",type:"Constructor",parameters,returns},options)}function Function2(parameters,returns,options){return CreateType({[Kind]:"Function",type:"Function",parameters,returns},options)}function UnionCreate(T2,options){return CreateType({[Kind]:"Union",anyOf:T2},options)}function IsUnionOptional(types){return types.some((type)=>IsOptional(type))}function RemoveOptionalFromRest(types){return types.map((left)=>IsOptional(left)?RemoveOptionalFromType(left):left)}function RemoveOptionalFromType(T2){return Discard(T2,[OptionalKind])}function ResolveUnion(types,options){return IsUnionOptional(types)?Optional(UnionCreate(RemoveOptionalFromRest(types),options)):UnionCreate(RemoveOptionalFromRest(types),options)}function UnionEvaluated(T2,options){return T2.length===1?CreateType(T2[0],options):T2.length===0?Never(options):ResolveUnion(T2,options)}function Union(types,options){return types.length===0?Never(options):types.length===1?CreateType(types[0],options):UnionCreate(types,options)}class TemplateLiteralParserError extends TypeBoxError{}function Unescape(pattern){return pattern.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function IsNonEscaped(pattern,index,char){return pattern[index]===char&&pattern.charCodeAt(index-1)!==92}function IsOpenParen(pattern,index){return IsNonEscaped(pattern,index,"(")}function IsCloseParen(pattern,index){return IsNonEscaped(pattern,index,")")}function IsSeparator(pattern,index){return IsNonEscaped(pattern,index,"|")}function IsGroup(pattern){if(!(IsOpenParen(pattern,0)&&IsCloseParen(pattern,pattern.length-1)))return!1;let count=0;for(let index=0;index<pattern.length;index++){if(IsOpenParen(pattern,index))count+=1;if(IsCloseParen(pattern,index))count-=1;if(count===0&&index!==pattern.length-1)return!1}return!0}function InGroup(pattern){return pattern.slice(1,pattern.length-1)}function IsPrecedenceOr(pattern){let count=0;for(let index=0;index<pattern.length;index++){if(IsOpenParen(pattern,index))count+=1;if(IsCloseParen(pattern,index))count-=1;if(IsSeparator(pattern,index)&&count===0)return!0}return!1}function IsPrecedenceAnd(pattern){for(let index=0;index<pattern.length;index++)if(IsOpenParen(pattern,index))return!0;return!1}function Or(pattern){let[count,start]=[0,0],expressions=[];for(let index=0;index<pattern.length;index++){if(IsOpenParen(pattern,index))count+=1;if(IsCloseParen(pattern,index))count-=1;if(IsSeparator(pattern,index)&&count===0){let range2=pattern.slice(start,index);if(range2.length>0)expressions.push(TemplateLiteralParse(range2));start=index+1}}let range=pattern.slice(start);if(range.length>0)expressions.push(TemplateLiteralParse(range));if(expressions.length===0)return{type:"const",const:""};if(expressions.length===1)return expressions[0];return{type:"or",expr:expressions}}function And(pattern){function Group(value,index){if(!IsOpenParen(value,index))throw new TemplateLiteralParserError("TemplateLiteralParser: Index must point to open parens");let count=0;for(let scan=index;scan<value.length;scan++){if(IsOpenParen(value,scan))count+=1;if(IsCloseParen(value,scan))count-=1;if(count===0)return[index,scan]}throw new TemplateLiteralParserError("TemplateLiteralParser: Unclosed group parens in expression")}function Range(pattern2,index){for(let scan=index;scan<pattern2.length;scan++)if(IsOpenParen(pattern2,scan))return[index,scan];return[index,pattern2.length]}let expressions=[];for(let index=0;index<pattern.length;index++)if(IsOpenParen(pattern,index)){let[start,end]=Group(pattern,index),range=pattern.slice(start,end+1);expressions.push(TemplateLiteralParse(range)),index=end}else{let[start,end]=Range(pattern,index),range=pattern.slice(start,end);if(range.length>0)expressions.push(TemplateLiteralParse(range));index=end-1}return expressions.length===0?{type:"const",const:""}:expressions.length===1?expressions[0]:{type:"and",expr:expressions}}function TemplateLiteralParse(pattern){return IsGroup(pattern)?TemplateLiteralParse(InGroup(pattern)):IsPrecedenceOr(pattern)?Or(pattern):IsPrecedenceAnd(pattern)?And(pattern):{type:"const",const:Unescape(pattern)}}function TemplateLiteralParseExact(pattern){return TemplateLiteralParse(pattern.slice(1,pattern.length-1))}class TemplateLiteralFiniteError extends TypeBoxError{}function IsNumberExpression(expression){return expression.type==="or"&&expression.expr.length===2&&expression.expr[0].type==="const"&&expression.expr[0].const==="0"&&expression.expr[1].type==="const"&&expression.expr[1].const==="[1-9][0-9]*"}function IsBooleanExpression(expression){return expression.type==="or"&&expression.expr.length===2&&expression.expr[0].type==="const"&&expression.expr[0].const==="true"&&expression.expr[1].type==="const"&&expression.expr[1].const==="false"}function IsStringExpression(expression){return expression.type==="const"&&expression.const===".*"}function IsTemplateLiteralExpressionFinite(expression){return IsNumberExpression(expression)||IsStringExpression(expression)?!1:IsBooleanExpression(expression)?!0:expression.type==="and"?expression.expr.every((expr)=>IsTemplateLiteralExpressionFinite(expr)):expression.type==="or"?expression.expr.every((expr)=>IsTemplateLiteralExpressionFinite(expr)):expression.type==="const"?!0:(()=>{throw new TemplateLiteralFiniteError("Unknown expression type")})()}function IsTemplateLiteralFinite(schema){let expression=TemplateLiteralParseExact(schema.pattern);return IsTemplateLiteralExpressionFinite(expression)}class TemplateLiteralGenerateError extends TypeBoxError{}function*GenerateReduce(buffer){if(buffer.length===1)return yield*buffer[0];for(let left of buffer[0])for(let right of GenerateReduce(buffer.slice(1)))yield`${left}${right}`}function*GenerateAnd(expression){return yield*GenerateReduce(expression.expr.map((expr)=>[...TemplateLiteralExpressionGenerate(expr)]))}function*GenerateOr(expression){for(let expr of expression.expr)yield*TemplateLiteralExpressionGenerate(expr)}function*GenerateConst(expression){return yield expression.const}function*TemplateLiteralExpressionGenerate(expression){return expression.type==="and"?yield*GenerateAnd(expression):expression.type==="or"?yield*GenerateOr(expression):expression.type==="const"?yield*GenerateConst(expression):(()=>{throw new TemplateLiteralGenerateError("Unknown expression")})()}function TemplateLiteralGenerate(schema){let expression=TemplateLiteralParseExact(schema.pattern);return IsTemplateLiteralExpressionFinite(expression)?[...TemplateLiteralExpressionGenerate(expression)]:[]}function Literal(value,options){return CreateType({[Kind]:"Literal",const:value,type:typeof value},options)}function Boolean2(options){return CreateType({[Kind]:"Boolean",type:"boolean"},options)}function BigInt2(options){return CreateType({[Kind]:"BigInt",type:"bigint"},options)}function Number2(options){return CreateType({[Kind]:"Number",type:"number"},options)}function String2(options){return CreateType({[Kind]:"String",type:"string"},options)}function*FromUnion(syntax){let trim=syntax.trim().replace(/"|'/g,"");return trim==="boolean"?yield Boolean2():trim==="number"?yield Number2():trim==="bigint"?yield BigInt2():trim==="string"?yield String2():yield(()=>{let literals=trim.split("|").map((literal)=>Literal(literal.trim()));return literals.length===0?Never():literals.length===1?literals[0]:UnionEvaluated(literals)})()}function*FromTerminal(syntax){if(syntax[1]!=="{"){let L=Literal("$"),R=FromSyntax(syntax.slice(1));return yield*[L,...R]}for(let i=2;i<syntax.length;i++)if(syntax[i]==="}"){let L=FromUnion(syntax.slice(2,i)),R=FromSyntax(syntax.slice(i+1));return yield*[...L,...R]}yield Literal(syntax)}function*FromSyntax(syntax){for(let i=0;i<syntax.length;i++)if(syntax[i]==="$"){let L=Literal(syntax.slice(0,i)),R=FromTerminal(syntax.slice(i));return yield*[L,...R]}yield Literal(syntax)}function TemplateLiteralSyntax(syntax){return[...FromSyntax(syntax)]}class TemplateLiteralPatternError extends TypeBoxError{}function Escape(value){return value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Visit2(schema,acc){return IsTemplateLiteral(schema)?schema.pattern.slice(1,schema.pattern.length-1):IsUnion(schema)?`(${schema.anyOf.map((schema2)=>Visit2(schema2,acc)).join("|")})`:IsNumber3(schema)?`${acc}${PatternNumber}`:IsInteger2(schema)?`${acc}${PatternNumber}`:IsBigInt3(schema)?`${acc}${PatternNumber}`:IsString3(schema)?`${acc}${PatternString}`:IsLiteral(schema)?`${acc}${Escape(schema.const.toString())}`:IsBoolean3(schema)?`${acc}${PatternBoolean}`:(()=>{throw new TemplateLiteralPatternError(`Unexpected Kind '${schema[Kind]}'`)})()}function TemplateLiteralPattern(kinds){return`^${kinds.map((schema)=>Visit2(schema,"")).join("")}$`}function TemplateLiteralToUnion(schema){let L=TemplateLiteralGenerate(schema).map((S)=>Literal(S));return UnionEvaluated(L)}function TemplateLiteral(unresolved,options){let pattern=IsString(unresolved)?TemplateLiteralPattern(TemplateLiteralSyntax(unresolved)):TemplateLiteralPattern(unresolved);return CreateType({[Kind]:"TemplateLiteral",type:"string",pattern},options)}function FromTemplateLiteral(templateLiteral){return TemplateLiteralGenerate(templateLiteral).map((key)=>key.toString())}function FromUnion2(types){let result=[];for(let type of types)result.push(...IndexPropertyKeys(type));return result}function FromLiteral(literalValue){return[literalValue.toString()]}function IndexPropertyKeys(type){return[...new Set(IsTemplateLiteral(type)?FromTemplateLiteral(type):IsUnion(type)?FromUnion2(type.anyOf):IsLiteral(type)?FromLiteral(type.const):IsNumber3(type)?["[number]"]:IsInteger2(type)?["[number]"]:[])]}function FromProperties(type,properties,options){let result={};for(let K2 of Object.getOwnPropertyNames(properties))result[K2]=Index(type,IndexPropertyKeys(properties[K2]),options);return result}function FromMappedResult(type,mappedResult,options){return FromProperties(type,mappedResult.properties,options)}function IndexFromMappedResult(type,mappedResult,options){let properties=FromMappedResult(type,mappedResult,options);return MappedResult(properties)}function FromRest(types,key){return types.map((type)=>IndexFromPropertyKey(type,key))}function FromIntersectRest(types){return types.filter((type)=>!IsNever(type))}function FromIntersect(types,key){return IntersectEvaluated(FromIntersectRest(FromRest(types,key)))}function FromUnionRest(types){return types.some((L)=>IsNever(L))?[]:types}function FromUnion3(types,key){return UnionEvaluated(FromUnionRest(FromRest(types,key)))}function FromTuple(types,key){return key in types?types[key]:key==="[number]"?UnionEvaluated(types):Never()}function FromArray(type,key){return key==="[number]"?type:Never()}function FromProperty(properties,propertyKey){return propertyKey in properties?properties[propertyKey]:Never()}function IndexFromPropertyKey(type,propertyKey){return IsIntersect(type)?FromIntersect(type.allOf,propertyKey):IsUnion(type)?FromUnion3(type.anyOf,propertyKey):IsTuple(type)?FromTuple(type.items??[],propertyKey):IsArray3(type)?FromArray(type.items,propertyKey):IsObject3(type)?FromProperty(type.properties,propertyKey):Never()}function IndexFromPropertyKeys(type,propertyKeys){return propertyKeys.map((propertyKey)=>IndexFromPropertyKey(type,propertyKey))}function FromSchema(type,propertyKeys){return UnionEvaluated(IndexFromPropertyKeys(type,propertyKeys))}function Index(type,key,options){if(IsRef(type)||IsRef(key)){if(!IsSchema(type)||!IsSchema(key))throw new TypeBoxError("Index types using Ref parameters require both Type and Key to be of TSchema");return Computed("Index",[type,key])}if(IsMappedResult(key))return IndexFromMappedResult(type,key,options);if(IsMappedKey(key))return IndexFromMappedKey(type,key,options);return CreateType(IsSchema(key)?FromSchema(type,IndexPropertyKeys(key)):FromSchema(type,key),options)}function MappedIndexPropertyKey(type,key,options){return{[key]:Index(type,[key],Clone(options))}}function MappedIndexPropertyKeys(type,propertyKeys,options){return propertyKeys.reduce((result,left)=>{return{...result,...MappedIndexPropertyKey(type,left,options)}},{})}function MappedIndexProperties(type,mappedKey,options){return MappedIndexPropertyKeys(type,mappedKey.keys,options)}function IndexFromMappedKey(type,mappedKey,options){let properties=MappedIndexProperties(type,mappedKey,options);return MappedResult(properties)}function Iterator(items,options){return CreateType({[Kind]:"Iterator",type:"Iterator",items},options)}function RequiredKeys(properties){let keys=[];for(let key in properties)if(!IsOptional(properties[key]))keys.push(key);return keys}function _Object(properties,options){let required=RequiredKeys(properties),schematic=required.length>0?{[Kind]:"Object",type:"object",properties,required}:{[Kind]:"Object",type:"object",properties};return CreateType(schematic,options)}var Object2=_Object;function Promise2(item,options){return CreateType({[Kind]:"Promise",type:"Promise",item},options)}function RemoveReadonly(schema){return CreateType(Discard(schema,[ReadonlyKind]))}function AddReadonly(schema){return CreateType({...schema,[ReadonlyKind]:"Readonly"})}function ReadonlyWithFlag(schema,F){return F===!1?RemoveReadonly(schema):AddReadonly(schema)}function Readonly(schema,enable){let F=enable??!0;return IsMappedResult(schema)?ReadonlyFromMappedResult(schema,F):ReadonlyWithFlag(schema,F)}function FromProperties2(K,F){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(K))Acc[K2]=Readonly(K[K2],F);return Acc}function FromMappedResult2(R,F){return FromProperties2(R.properties,F)}function ReadonlyFromMappedResult(R,F){let P=FromMappedResult2(R,F);return MappedResult(P)}function Tuple(types,options){return CreateType(types.length>0?{[Kind]:"Tuple",type:"array",items:types,additionalItems:!1,minItems:types.length,maxItems:types.length}:{[Kind]:"Tuple",type:"array",minItems:types.length,maxItems:types.length},options)}function FromMappedResult3(K,P){return K in P?FromSchemaType(K,P[K]):MappedResult(P)}function MappedKeyToKnownMappedResultProperties(K){return{[K]:Literal(K)}}function MappedKeyToUnknownMappedResultProperties(P){let Acc={};for(let L of P)Acc[L]=Literal(L);return Acc}function MappedKeyToMappedResultProperties(K,P){return SetIncludes(P,K)?MappedKeyToKnownMappedResultProperties(K):MappedKeyToUnknownMappedResultProperties(P)}function FromMappedKey(K,P){let R=MappedKeyToMappedResultProperties(K,P);return FromMappedResult3(K,R)}function FromRest2(K,T2){return T2.map((L)=>FromSchemaType(K,L))}function FromProperties3(K,T2){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(T2))Acc[K2]=FromSchemaType(K,T2[K2]);return Acc}function FromSchemaType(K,T2){let options={...T2};return IsOptional(T2)?Optional(FromSchemaType(K,Discard(T2,[OptionalKind]))):IsReadonly(T2)?Readonly(FromSchemaType(K,Discard(T2,[ReadonlyKind]))):IsMappedResult(T2)?FromMappedResult3(K,T2.properties):IsMappedKey(T2)?FromMappedKey(K,T2.keys):IsConstructor(T2)?Constructor(FromRest2(K,T2.parameters),FromSchemaType(K,T2.returns),options):IsFunction3(T2)?Function2(FromRest2(K,T2.parameters),FromSchemaType(K,T2.returns),options):IsAsyncIterator3(T2)?AsyncIterator(FromSchemaType(K,T2.items),options):IsIterator3(T2)?Iterator(FromSchemaType(K,T2.items),options):IsIntersect(T2)?Intersect(FromRest2(K,T2.allOf),options):IsUnion(T2)?Union(FromRest2(K,T2.anyOf),options):IsTuple(T2)?Tuple(FromRest2(K,T2.items??[]),options):IsObject3(T2)?Object2(FromProperties3(K,T2.properties),options):IsArray3(T2)?Array2(FromSchemaType(K,T2.items),options):IsPromise2(T2)?Promise2(FromSchemaType(K,T2.item),options):T2}function MappedFunctionReturnType(K,T2){let Acc={};for(let L of K)Acc[L]=FromSchemaType(L,T2);return Acc}function Mapped(key,map3,options){let K=IsSchema(key)?IndexPropertyKeys(key):key,RT=map3({[Kind]:"MappedKey",keys:K}),R=MappedFunctionReturnType(K,RT);return Object2(R,options)}function RemoveOptional(schema){return CreateType(Discard(schema,[OptionalKind]))}function AddOptional(schema){return CreateType({...schema,[OptionalKind]:"Optional"})}function OptionalWithFlag(schema,F){return F===!1?RemoveOptional(schema):AddOptional(schema)}function Optional(schema,enable){let F=enable??!0;return IsMappedResult(schema)?OptionalFromMappedResult(schema,F):OptionalWithFlag(schema,F)}function FromProperties4(P,F){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Optional(P[K2],F);return Acc}function FromMappedResult4(R,F){return FromProperties4(R.properties,F)}function OptionalFromMappedResult(R,F){let P=FromMappedResult4(R,F);return MappedResult(P)}function IntersectCreate(T2,options={}){let allObjects=T2.every((schema)=>IsObject3(schema)),clonedUnevaluatedProperties=IsSchema(options.unevaluatedProperties)?{unevaluatedProperties:options.unevaluatedProperties}:{};return CreateType(options.unevaluatedProperties===!1||IsSchema(options.unevaluatedProperties)||allObjects?{...clonedUnevaluatedProperties,[Kind]:"Intersect",type:"object",allOf:T2}:{...clonedUnevaluatedProperties,[Kind]:"Intersect",allOf:T2},options)}function IsIntersectOptional(types){return types.every((left)=>IsOptional(left))}function RemoveOptionalFromType2(type){return Discard(type,[OptionalKind])}function RemoveOptionalFromRest2(types){return types.map((left)=>IsOptional(left)?RemoveOptionalFromType2(left):left)}function ResolveIntersect(types,options){return IsIntersectOptional(types)?Optional(IntersectCreate(RemoveOptionalFromRest2(types),options)):IntersectCreate(RemoveOptionalFromRest2(types),options)}function IntersectEvaluated(types,options={}){if(types.length===1)return CreateType(types[0],options);if(types.length===0)return Never(options);if(types.some((schema)=>IsTransform(schema)))throw new Error("Cannot intersect transform types");return ResolveIntersect(types,options)}function Intersect(types,options){if(types.length===1)return CreateType(types[0],options);if(types.length===0)return Never(options);if(types.some((schema)=>IsTransform(schema)))throw new Error("Cannot intersect transform types");return IntersectCreate(types,options)}function Ref(...args){let[$ref,options]=typeof args[0]==="string"?[args[0],args[1]]:[args[0].$id,args[1]];if(typeof $ref!=="string")throw new TypeBoxError("Ref: $ref must be a string");return CreateType({[Kind]:"Ref",$ref},options)}function FromComputed(target,parameters){return Computed("Awaited",[Computed(target,parameters)])}function FromRef($ref){return Computed("Awaited",[Ref($ref)])}function FromIntersect2(types){return Intersect(FromRest3(types))}function FromUnion4(types){return Union(FromRest3(types))}function FromPromise(type){return Awaited(type)}function FromRest3(types){return types.map((type)=>Awaited(type))}function Awaited(type,options){return CreateType(IsComputed(type)?FromComputed(type.target,type.parameters):IsIntersect(type)?FromIntersect2(type.allOf):IsUnion(type)?FromUnion4(type.anyOf):IsPromise2(type)?FromPromise(type.item):IsRef(type)?FromRef(type.$ref):type,options)}function FromRest4(types){let result=[];for(let L of types)result.push(KeyOfPropertyKeys(L));return result}function FromIntersect3(types){let propertyKeysArray=FromRest4(types);return SetUnionMany(propertyKeysArray)}function FromUnion5(types){let propertyKeysArray=FromRest4(types);return SetIntersectMany(propertyKeysArray)}function FromTuple2(types){return types.map((_2,indexer)=>indexer.toString())}function FromArray2(_2){return["[number]"]}function FromProperties5(T2){return globalThis.Object.getOwnPropertyNames(T2)}function FromPatternProperties(patternProperties){if(!includePatternProperties)return[];return globalThis.Object.getOwnPropertyNames(patternProperties).map((key)=>{return key[0]==="^"&&key[key.length-1]==="$"?key.slice(1,key.length-1):key})}function KeyOfPropertyKeys(type){return IsIntersect(type)?FromIntersect3(type.allOf):IsUnion(type)?FromUnion5(type.anyOf):IsTuple(type)?FromTuple2(type.items??[]):IsArray3(type)?FromArray2(type.items):IsObject3(type)?FromProperties5(type.properties):IsRecord(type)?FromPatternProperties(type.patternProperties):[]}var includePatternProperties=!1;function KeyOfPattern(schema){includePatternProperties=!0;let keys=KeyOfPropertyKeys(schema);return includePatternProperties=!1,`^(${keys.map((key)=>`(${key})`).join("|")})$`}function FromComputed2(target,parameters){return Computed("KeyOf",[Computed(target,parameters)])}function FromRef2($ref){return Computed("KeyOf",[Ref($ref)])}function KeyOfFromType(type,options){let propertyKeys=KeyOfPropertyKeys(type),propertyKeyTypes=KeyOfPropertyKeysToRest(propertyKeys),result=UnionEvaluated(propertyKeyTypes);return CreateType(result,options)}function KeyOfPropertyKeysToRest(propertyKeys){return propertyKeys.map((L)=>L==="[number]"?Number2():Literal(L))}function KeyOf(type,options){return IsComputed(type)?FromComputed2(type.target,type.parameters):IsRef(type)?FromRef2(type.$ref):IsMappedResult(type)?KeyOfFromMappedResult(type,options):KeyOfFromType(type,options)}function FromProperties6(properties,options){let result={};for(let K2 of globalThis.Object.getOwnPropertyNames(properties))result[K2]=KeyOf(properties[K2],Clone(options));return result}function FromMappedResult5(mappedResult,options){return FromProperties6(mappedResult.properties,options)}function KeyOfFromMappedResult(mappedResult,options){let properties=FromMappedResult5(mappedResult,options);return MappedResult(properties)}function KeyOfPropertyEntries(schema){let keys=KeyOfPropertyKeys(schema),schemas=IndexFromPropertyKeys(schema,keys);return keys.map((_2,index)=>[keys[index],schemas[index]])}function CompositeKeys(T2){let Acc=[];for(let L of T2)Acc.push(...KeyOfPropertyKeys(L));return SetDistinct(Acc)}function FilterNever(T2){return T2.filter((L)=>!IsNever(L))}function CompositeProperty(T2,K){let Acc=[];for(let L of T2)Acc.push(...IndexFromPropertyKeys(L,[K]));return FilterNever(Acc)}function CompositeProperties(T2,K){let Acc={};for(let L of K)Acc[L]=IntersectEvaluated(CompositeProperty(T2,L));return Acc}function Composite(T2,options){let K=CompositeKeys(T2),P=CompositeProperties(T2,K);return Object2(P,options)}function Date2(options){return CreateType({[Kind]:"Date",type:"Date"},options)}function Null(options){return CreateType({[Kind]:"Null",type:"null"},options)}function Symbol2(options){return CreateType({[Kind]:"Symbol",type:"symbol"},options)}function Undefined(options){return CreateType({[Kind]:"Undefined",type:"undefined"},options)}function Uint8Array2(options){return CreateType({[Kind]:"Uint8Array",type:"Uint8Array"},options)}function Unknown(options){return CreateType({[Kind]:"Unknown"},options)}function FromArray3(T2){return T2.map((L)=>FromValue(L,!1))}function FromProperties7(value){let Acc={};for(let K of globalThis.Object.getOwnPropertyNames(value))Acc[K]=Readonly(FromValue(value[K],!1));return Acc}function ConditionalReadonly(T2,root){return root===!0?T2:Readonly(T2)}function FromValue(value,root){return IsAsyncIterator(value)?ConditionalReadonly(Any(),root):IsIterator(value)?ConditionalReadonly(Any(),root):IsArray(value)?Readonly(Tuple(FromArray3(value))):IsUint8Array(value)?Uint8Array2():IsDate(value)?Date2():IsObject(value)?ConditionalReadonly(Object2(FromProperties7(value)),root):IsFunction(value)?ConditionalReadonly(Function2([],Unknown()),root):IsUndefined(value)?Undefined():IsNull(value)?Null():IsSymbol(value)?Symbol2():IsBigInt(value)?BigInt2():IsNumber(value)?Literal(value):IsBoolean(value)?Literal(value):IsString(value)?Literal(value):Object2({})}function Const(T2,options){return CreateType(FromValue(T2,!0),options)}function ConstructorParameters(schema,options){return IsConstructor(schema)?Tuple(schema.parameters,options):Never(options)}function Enum(item,options){if(IsUndefined(item))throw new Error("Enum undefined or empty");let values1=globalThis.Object.getOwnPropertyNames(item).filter((key)=>isNaN(key)).map((key)=>item[key]),anyOf=[...new Set(values1)].map((value)=>Literal(value));return Union(anyOf,{...options,[Hint]:"Enum"})}class ExtendsResolverError extends TypeBoxError{}var ExtendsResult;(function(ExtendsResult2){ExtendsResult2[ExtendsResult2.Union=0]="Union",ExtendsResult2[ExtendsResult2.True=1]="True",ExtendsResult2[ExtendsResult2.False=2]="False"})(ExtendsResult||(ExtendsResult={}));function IntoBooleanResult(result){return result===ExtendsResult.False?result:ExtendsResult.True}function Throw(message){throw new ExtendsResolverError(message)}function IsStructuralRight(right){return exports_type.IsNever(right)||exports_type.IsIntersect(right)||exports_type.IsUnion(right)||exports_type.IsUnknown(right)||exports_type.IsAny(right)}function StructuralRight(left,right){return exports_type.IsNever(right)?FromNeverRight(left,right):exports_type.IsIntersect(right)?FromIntersectRight(left,right):exports_type.IsUnion(right)?FromUnionRight(left,right):exports_type.IsUnknown(right)?FromUnknownRight(left,right):exports_type.IsAny(right)?FromAnyRight(left,right):Throw("StructuralRight")}function FromAnyRight(left,right){return ExtendsResult.True}function FromAny(left,right){return exports_type.IsIntersect(right)?FromIntersectRight(left,right):exports_type.IsUnion(right)&&right.anyOf.some((schema)=>exports_type.IsAny(schema)||exports_type.IsUnknown(schema))?ExtendsResult.True:exports_type.IsUnion(right)?ExtendsResult.Union:exports_type.IsUnknown(right)?ExtendsResult.True:exports_type.IsAny(right)?ExtendsResult.True:ExtendsResult.Union}function FromArrayRight(left,right){return exports_type.IsUnknown(left)?ExtendsResult.False:exports_type.IsAny(left)?ExtendsResult.Union:exports_type.IsNever(left)?ExtendsResult.True:ExtendsResult.False}function FromArray4(left,right){return exports_type.IsObject(right)&&IsObjectArrayLike(right)?ExtendsResult.True:IsStructuralRight(right)?StructuralRight(left,right):!exports_type.IsArray(right)?ExtendsResult.False:IntoBooleanResult(Visit3(left.items,right.items))}function FromAsyncIterator(left,right){return IsStructuralRight(right)?StructuralRight(left,right):!exports_type.IsAsyncIterator(right)?ExtendsResult.False:IntoBooleanResult(Visit3(left.items,right.items))}function FromBigInt(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsBigInt(right)?ExtendsResult.True:ExtendsResult.False}function FromBooleanRight(left,right){return exports_type.IsLiteralBoolean(left)?ExtendsResult.True:exports_type.IsBoolean(left)?ExtendsResult.True:ExtendsResult.False}function FromBoolean(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsBoolean(right)?ExtendsResult.True:ExtendsResult.False}function FromConstructor(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):!exports_type.IsConstructor(right)?ExtendsResult.False:left.parameters.length>right.parameters.length?ExtendsResult.False:!left.parameters.every((schema,index)=>IntoBooleanResult(Visit3(right.parameters[index],schema))===ExtendsResult.True)?ExtendsResult.False:IntoBooleanResult(Visit3(left.returns,right.returns))}function FromDate(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsDate(right)?ExtendsResult.True:ExtendsResult.False}function FromFunction(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):!exports_type.IsFunction(right)?ExtendsResult.False:left.parameters.length>right.parameters.length?ExtendsResult.False:!left.parameters.every((schema,index)=>IntoBooleanResult(Visit3(right.parameters[index],schema))===ExtendsResult.True)?ExtendsResult.False:IntoBooleanResult(Visit3(left.returns,right.returns))}function FromIntegerRight(left,right){return exports_type.IsLiteral(left)&&exports_value.IsNumber(left.const)?ExtendsResult.True:exports_type.IsNumber(left)||exports_type.IsInteger(left)?ExtendsResult.True:ExtendsResult.False}function FromInteger(left,right){return exports_type.IsInteger(right)||exports_type.IsNumber(right)?ExtendsResult.True:IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):ExtendsResult.False}function FromIntersectRight(left,right){return right.allOf.every((schema)=>Visit3(left,schema)===ExtendsResult.True)?ExtendsResult.True:ExtendsResult.False}function FromIntersect4(left,right){return left.allOf.some((schema)=>Visit3(schema,right)===ExtendsResult.True)?ExtendsResult.True:ExtendsResult.False}function FromIterator(left,right){return IsStructuralRight(right)?StructuralRight(left,right):!exports_type.IsIterator(right)?ExtendsResult.False:IntoBooleanResult(Visit3(left.items,right.items))}function FromLiteral2(left,right){return exports_type.IsLiteral(right)&&right.const===left.const?ExtendsResult.True:IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsString(right)?FromStringRight(left,right):exports_type.IsNumber(right)?FromNumberRight(left,right):exports_type.IsInteger(right)?FromIntegerRight(left,right):exports_type.IsBoolean(right)?FromBooleanRight(left,right):ExtendsResult.False}function FromNeverRight(left,right){return ExtendsResult.False}function FromNever(left,right){return ExtendsResult.True}function UnwrapTNot(schema){let[current,depth]=[schema,0];while(!0){if(!exports_type.IsNot(current))break;current=current.not,depth+=1}return depth%2===0?current:Unknown()}function FromNot(left,right){return exports_type.IsNot(left)?Visit3(UnwrapTNot(left),right):exports_type.IsNot(right)?Visit3(left,UnwrapTNot(right)):Throw("Invalid fallthrough for Not")}function FromNull(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsNull(right)?ExtendsResult.True:ExtendsResult.False}function FromNumberRight(left,right){return exports_type.IsLiteralNumber(left)?ExtendsResult.True:exports_type.IsNumber(left)||exports_type.IsInteger(left)?ExtendsResult.True:ExtendsResult.False}function FromNumber(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsInteger(right)||exports_type.IsNumber(right)?ExtendsResult.True:ExtendsResult.False}function IsObjectPropertyCount(schema,count){return Object.getOwnPropertyNames(schema.properties).length===count}function IsObjectStringLike(schema){return IsObjectArrayLike(schema)}function IsObjectSymbolLike(schema){return IsObjectPropertyCount(schema,0)||IsObjectPropertyCount(schema,1)&&"description"in schema.properties&&exports_type.IsUnion(schema.properties.description)&&schema.properties.description.anyOf.length===2&&(exports_type.IsString(schema.properties.description.anyOf[0])&&exports_type.IsUndefined(schema.properties.description.anyOf[1])||exports_type.IsString(schema.properties.description.anyOf[1])&&exports_type.IsUndefined(schema.properties.description.anyOf[0]))}function IsObjectNumberLike(schema){return IsObjectPropertyCount(schema,0)}function IsObjectBooleanLike(schema){return IsObjectPropertyCount(schema,0)}function IsObjectBigIntLike(schema){return IsObjectPropertyCount(schema,0)}function IsObjectDateLike(schema){return IsObjectPropertyCount(schema,0)}function IsObjectUint8ArrayLike(schema){return IsObjectArrayLike(schema)}function IsObjectFunctionLike(schema){let length=Number2();return IsObjectPropertyCount(schema,0)||IsObjectPropertyCount(schema,1)&&"length"in schema.properties&&IntoBooleanResult(Visit3(schema.properties.length,length))===ExtendsResult.True}function IsObjectConstructorLike(schema){return IsObjectPropertyCount(schema,0)}function IsObjectArrayLike(schema){let length=Number2();return IsObjectPropertyCount(schema,0)||IsObjectPropertyCount(schema,1)&&"length"in schema.properties&&IntoBooleanResult(Visit3(schema.properties.length,length))===ExtendsResult.True}function IsObjectPromiseLike(schema){let then=Function2([Any()],Any());return IsObjectPropertyCount(schema,0)||IsObjectPropertyCount(schema,1)&&"then"in schema.properties&&IntoBooleanResult(Visit3(schema.properties.then,then))===ExtendsResult.True}function Property(left,right){return Visit3(left,right)===ExtendsResult.False?ExtendsResult.False:exports_type.IsOptional(left)&&!exports_type.IsOptional(right)?ExtendsResult.False:ExtendsResult.True}function FromObjectRight(left,right){return exports_type.IsUnknown(left)?ExtendsResult.False:exports_type.IsAny(left)?ExtendsResult.Union:exports_type.IsNever(left)||exports_type.IsLiteralString(left)&&IsObjectStringLike(right)||exports_type.IsLiteralNumber(left)&&IsObjectNumberLike(right)||exports_type.IsLiteralBoolean(left)&&IsObjectBooleanLike(right)||exports_type.IsSymbol(left)&&IsObjectSymbolLike(right)||exports_type.IsBigInt(left)&&IsObjectBigIntLike(right)||exports_type.IsString(left)&&IsObjectStringLike(right)||exports_type.IsSymbol(left)&&IsObjectSymbolLike(right)||exports_type.IsNumber(left)&&IsObjectNumberLike(right)||exports_type.IsInteger(left)&&IsObjectNumberLike(right)||exports_type.IsBoolean(left)&&IsObjectBooleanLike(right)||exports_type.IsUint8Array(left)&&IsObjectUint8ArrayLike(right)||exports_type.IsDate(left)&&IsObjectDateLike(right)||exports_type.IsConstructor(left)&&IsObjectConstructorLike(right)||exports_type.IsFunction(left)&&IsObjectFunctionLike(right)?ExtendsResult.True:exports_type.IsRecord(left)&&exports_type.IsString(RecordKey(left))?(()=>{return right[Hint]==="Record"?ExtendsResult.True:ExtendsResult.False})():exports_type.IsRecord(left)&&exports_type.IsNumber(RecordKey(left))?(()=>{return IsObjectPropertyCount(right,0)?ExtendsResult.True:ExtendsResult.False})():ExtendsResult.False}function FromObject(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):!exports_type.IsObject(right)?ExtendsResult.False:(()=>{for(let key of Object.getOwnPropertyNames(right.properties)){if(!(key in left.properties)&&!exports_type.IsOptional(right.properties[key]))return ExtendsResult.False;if(exports_type.IsOptional(right.properties[key]))return ExtendsResult.True;if(Property(left.properties[key],right.properties[key])===ExtendsResult.False)return ExtendsResult.False}return ExtendsResult.True})()}function FromPromise2(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)&&IsObjectPromiseLike(right)?ExtendsResult.True:!exports_type.IsPromise(right)?ExtendsResult.False:IntoBooleanResult(Visit3(left.item,right.item))}function RecordKey(schema){return PatternNumberExact in schema.patternProperties?Number2():(PatternStringExact in schema.patternProperties)?String2():Throw("Unknown record key pattern")}function RecordValue(schema){return PatternNumberExact in schema.patternProperties?schema.patternProperties[PatternNumberExact]:(PatternStringExact in schema.patternProperties)?schema.patternProperties[PatternStringExact]:Throw("Unable to get record value schema")}function FromRecordRight(left,right){let[Key,Value]=[RecordKey(right),RecordValue(right)];return exports_type.IsLiteralString(left)&&exports_type.IsNumber(Key)&&IntoBooleanResult(Visit3(left,Value))===ExtendsResult.True?ExtendsResult.True:exports_type.IsUint8Array(left)&&exports_type.IsNumber(Key)?Visit3(left,Value):exports_type.IsString(left)&&exports_type.IsNumber(Key)?Visit3(left,Value):exports_type.IsArray(left)&&exports_type.IsNumber(Key)?Visit3(left,Value):exports_type.IsObject(left)?(()=>{for(let key of Object.getOwnPropertyNames(left.properties))if(Property(Value,left.properties[key])===ExtendsResult.False)return ExtendsResult.False;return ExtendsResult.True})():ExtendsResult.False}function FromRecord(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):!exports_type.IsRecord(right)?ExtendsResult.False:Visit3(RecordValue(left),RecordValue(right))}function FromRegExp(left,right){let L=exports_type.IsRegExp(left)?String2():left,R=exports_type.IsRegExp(right)?String2():right;return Visit3(L,R)}function FromStringRight(left,right){return exports_type.IsLiteral(left)&&exports_value.IsString(left.const)?ExtendsResult.True:exports_type.IsString(left)?ExtendsResult.True:ExtendsResult.False}function FromString(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsString(right)?ExtendsResult.True:ExtendsResult.False}function FromSymbol(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsSymbol(right)?ExtendsResult.True:ExtendsResult.False}function FromTemplateLiteral2(left,right){return exports_type.IsTemplateLiteral(left)?Visit3(TemplateLiteralToUnion(left),right):exports_type.IsTemplateLiteral(right)?Visit3(left,TemplateLiteralToUnion(right)):Throw("Invalid fallthrough for TemplateLiteral")}function IsArrayOfTuple(left,right){return exports_type.IsArray(right)&&left.items!==void 0&&left.items.every((schema)=>Visit3(schema,right.items)===ExtendsResult.True)}function FromTupleRight(left,right){return exports_type.IsNever(left)?ExtendsResult.True:exports_type.IsUnknown(left)?ExtendsResult.False:exports_type.IsAny(left)?ExtendsResult.Union:ExtendsResult.False}function FromTuple3(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)&&IsObjectArrayLike(right)?ExtendsResult.True:exports_type.IsArray(right)&&IsArrayOfTuple(left,right)?ExtendsResult.True:!exports_type.IsTuple(right)?ExtendsResult.False:exports_value.IsUndefined(left.items)&&!exports_value.IsUndefined(right.items)||!exports_value.IsUndefined(left.items)&&exports_value.IsUndefined(right.items)?ExtendsResult.False:exports_value.IsUndefined(left.items)&&!exports_value.IsUndefined(right.items)?ExtendsResult.True:left.items.every((schema,index)=>Visit3(schema,right.items[index])===ExtendsResult.True)?ExtendsResult.True:ExtendsResult.False}function FromUint8Array(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsUint8Array(right)?ExtendsResult.True:ExtendsResult.False}function FromUndefined(left,right){return IsStructuralRight(right)?StructuralRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsRecord(right)?FromRecordRight(left,right):exports_type.IsVoid(right)?FromVoidRight(left,right):exports_type.IsUndefined(right)?ExtendsResult.True:ExtendsResult.False}function FromUnionRight(left,right){return right.anyOf.some((schema)=>Visit3(left,schema)===ExtendsResult.True)?ExtendsResult.True:ExtendsResult.False}function FromUnion6(left,right){return left.anyOf.every((schema)=>Visit3(schema,right)===ExtendsResult.True)?ExtendsResult.True:ExtendsResult.False}function FromUnknownRight(left,right){return ExtendsResult.True}function FromUnknown(left,right){return exports_type.IsNever(right)?FromNeverRight(left,right):exports_type.IsIntersect(right)?FromIntersectRight(left,right):exports_type.IsUnion(right)?FromUnionRight(left,right):exports_type.IsAny(right)?FromAnyRight(left,right):exports_type.IsString(right)?FromStringRight(left,right):exports_type.IsNumber(right)?FromNumberRight(left,right):exports_type.IsInteger(right)?FromIntegerRight(left,right):exports_type.IsBoolean(right)?FromBooleanRight(left,right):exports_type.IsArray(right)?FromArrayRight(left,right):exports_type.IsTuple(right)?FromTupleRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsUnknown(right)?ExtendsResult.True:ExtendsResult.False}function FromVoidRight(left,right){return exports_type.IsUndefined(left)?ExtendsResult.True:exports_type.IsUndefined(left)?ExtendsResult.True:ExtendsResult.False}function FromVoid(left,right){return exports_type.IsIntersect(right)?FromIntersectRight(left,right):exports_type.IsUnion(right)?FromUnionRight(left,right):exports_type.IsUnknown(right)?FromUnknownRight(left,right):exports_type.IsAny(right)?FromAnyRight(left,right):exports_type.IsObject(right)?FromObjectRight(left,right):exports_type.IsVoid(right)?ExtendsResult.True:ExtendsResult.False}function Visit3(left,right){return exports_type.IsTemplateLiteral(left)||exports_type.IsTemplateLiteral(right)?FromTemplateLiteral2(left,right):exports_type.IsRegExp(left)||exports_type.IsRegExp(right)?FromRegExp(left,right):exports_type.IsNot(left)||exports_type.IsNot(right)?FromNot(left,right):exports_type.IsAny(left)?FromAny(left,right):exports_type.IsArray(left)?FromArray4(left,right):exports_type.IsBigInt(left)?FromBigInt(left,right):exports_type.IsBoolean(left)?FromBoolean(left,right):exports_type.IsAsyncIterator(left)?FromAsyncIterator(left,right):exports_type.IsConstructor(left)?FromConstructor(left,right):exports_type.IsDate(left)?FromDate(left,right):exports_type.IsFunction(left)?FromFunction(left,right):exports_type.IsInteger(left)?FromInteger(left,right):exports_type.IsIntersect(left)?FromIntersect4(left,right):exports_type.IsIterator(left)?FromIterator(left,right):exports_type.IsLiteral(left)?FromLiteral2(left,right):exports_type.IsNever(left)?FromNever(left,right):exports_type.IsNull(left)?FromNull(left,right):exports_type.IsNumber(left)?FromNumber(left,right):exports_type.IsObject(left)?FromObject(left,right):exports_type.IsRecord(left)?FromRecord(left,right):exports_type.IsString(left)?FromString(left,right):exports_type.IsSymbol(left)?FromSymbol(left,right):exports_type.IsTuple(left)?FromTuple3(left,right):exports_type.IsPromise(left)?FromPromise2(left,right):exports_type.IsUint8Array(left)?FromUint8Array(left,right):exports_type.IsUndefined(left)?FromUndefined(left,right):exports_type.IsUnion(left)?FromUnion6(left,right):exports_type.IsUnknown(left)?FromUnknown(left,right):exports_type.IsVoid(left)?FromVoid(left,right):Throw(`Unknown left type operand '${left[Kind]}'`)}function ExtendsCheck(left,right){return Visit3(left,right)}function FromProperties8(P,Right,True,False,options){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Extends(P[K2],Right,True,False,Clone(options));return Acc}function FromMappedResult6(Left,Right,True,False,options){return FromProperties8(Left.properties,Right,True,False,options)}function ExtendsFromMappedResult(Left,Right,True,False,options){let P=FromMappedResult6(Left,Right,True,False,options);return MappedResult(P)}function ExtendsResolve(left,right,trueType,falseType){let R=ExtendsCheck(left,right);return R===ExtendsResult.Union?Union([trueType,falseType]):R===ExtendsResult.True?trueType:falseType}function Extends(L,R,T2,F,options){return IsMappedResult(L)?ExtendsFromMappedResult(L,R,T2,F,options):IsMappedKey(L)?CreateType(ExtendsFromMappedKey(L,R,T2,F,options)):CreateType(ExtendsResolve(L,R,T2,F),options)}function FromPropertyKey(K,U,L,R,options){return{[K]:Extends(Literal(K),U,L,R,Clone(options))}}function FromPropertyKeys(K,U,L,R,options){return K.reduce((Acc,LK)=>{return{...Acc,...FromPropertyKey(LK,U,L,R,options)}},{})}function FromMappedKey2(K,U,L,R,options){return FromPropertyKeys(K.keys,U,L,R,options)}function ExtendsFromMappedKey(T2,U,L,R,options){let P=FromMappedKey2(T2,U,L,R,options);return MappedResult(P)}function Intersect2(schema){return schema.allOf.every((schema2)=>ExtendsUndefinedCheck(schema2))}function Union2(schema){return schema.anyOf.some((schema2)=>ExtendsUndefinedCheck(schema2))}function Not(schema){return!ExtendsUndefinedCheck(schema.not)}function ExtendsUndefinedCheck(schema){return schema[Kind]==="Intersect"?Intersect2(schema):schema[Kind]==="Union"?Union2(schema):schema[Kind]==="Not"?Not(schema):schema[Kind]==="Undefined"?!0:!1}function ExcludeFromTemplateLiteral(L,R){return Exclude(TemplateLiteralToUnion(L),R)}function ExcludeRest(L,R){let excluded=L.filter((inner)=>ExtendsCheck(inner,R)===ExtendsResult.False);return excluded.length===1?excluded[0]:Union(excluded)}function Exclude(L,R,options={}){if(IsTemplateLiteral(L))return CreateType(ExcludeFromTemplateLiteral(L,R),options);if(IsMappedResult(L))return CreateType(ExcludeFromMappedResult(L,R),options);return CreateType(IsUnion(L)?ExcludeRest(L.anyOf,R):ExtendsCheck(L,R)!==ExtendsResult.False?Never():L,options)}function FromProperties9(P,U){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Exclude(P[K2],U);return Acc}function FromMappedResult7(R,T2){return FromProperties9(R.properties,T2)}function ExcludeFromMappedResult(R,T2){let P=FromMappedResult7(R,T2);return MappedResult(P)}function ExtractFromTemplateLiteral(L,R){return Extract(TemplateLiteralToUnion(L),R)}function ExtractRest(L,R){let extracted=L.filter((inner)=>ExtendsCheck(inner,R)!==ExtendsResult.False);return extracted.length===1?extracted[0]:Union(extracted)}function Extract(L,R,options){if(IsTemplateLiteral(L))return CreateType(ExtractFromTemplateLiteral(L,R),options);if(IsMappedResult(L))return CreateType(ExtractFromMappedResult(L,R),options);return CreateType(IsUnion(L)?ExtractRest(L.anyOf,R):ExtendsCheck(L,R)!==ExtendsResult.False?L:Never(),options)}function FromProperties10(P,T2){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Extract(P[K2],T2);return Acc}function FromMappedResult8(R,T2){return FromProperties10(R.properties,T2)}function ExtractFromMappedResult(R,T2){let P=FromMappedResult8(R,T2);return MappedResult(P)}function InstanceType(schema,options){return IsConstructor(schema)?CreateType(schema.returns,options):Never(options)}function ReadonlyOptional(schema){return Readonly(Optional(schema))}function RecordCreateFromPattern(pattern,T2,options){return CreateType({[Kind]:"Record",type:"object",patternProperties:{[pattern]:T2}},options)}function RecordCreateFromKeys(K,T2,options){let result={};for(let K2 of K)result[K2]=T2;return Object2(result,{...options,[Hint]:"Record"})}function FromTemplateLiteralKey(K,T2,options){return IsTemplateLiteralFinite(K)?RecordCreateFromKeys(IndexPropertyKeys(K),T2,options):RecordCreateFromPattern(K.pattern,T2,options)}function FromUnionKey(key,type,options){return RecordCreateFromKeys(IndexPropertyKeys(Union(key)),type,options)}function FromLiteralKey(key,type,options){return RecordCreateFromKeys([key.toString()],type,options)}function FromRegExpKey(key,type,options){return RecordCreateFromPattern(key.source,type,options)}function FromStringKey(key,type,options){let pattern=IsUndefined(key.pattern)?PatternStringExact:key.pattern;return RecordCreateFromPattern(pattern,type,options)}function FromAnyKey(_2,type,options){return RecordCreateFromPattern(PatternStringExact,type,options)}function FromNeverKey(_key,type,options){return RecordCreateFromPattern(PatternNeverExact,type,options)}function FromBooleanKey(_key,type,options){return Object2({true:type,false:type},options)}function FromIntegerKey(_key,type,options){return RecordCreateFromPattern(PatternNumberExact,type,options)}function FromNumberKey(_2,type,options){return RecordCreateFromPattern(PatternNumberExact,type,options)}function Record(key,type,options={}){return IsUnion(key)?FromUnionKey(key.anyOf,type,options):IsTemplateLiteral(key)?FromTemplateLiteralKey(key,type,options):IsLiteral(key)?FromLiteralKey(key.const,type,options):IsBoolean3(key)?FromBooleanKey(key,type,options):IsInteger2(key)?FromIntegerKey(key,type,options):IsNumber3(key)?FromNumberKey(key,type,options):IsRegExp2(key)?FromRegExpKey(key,type,options):IsString3(key)?FromStringKey(key,type,options):IsAny(key)?FromAnyKey(key,type,options):IsNever(key)?FromNeverKey(key,type,options):Never(options)}function RecordPattern(record){return globalThis.Object.getOwnPropertyNames(record.patternProperties)[0]}function RecordKey2(type){let pattern=RecordPattern(type);return pattern===PatternStringExact?String2():pattern===PatternNumberExact?Number2():String2({pattern})}function RecordValue2(type){return type.patternProperties[RecordPattern(type)]}function FromConstructor2(args,type){return type.parameters=FromTypes(args,type.parameters),type.returns=FromType(args,type.returns),type}function FromFunction2(args,type){return type.parameters=FromTypes(args,type.parameters),type.returns=FromType(args,type.returns),type}function FromIntersect5(args,type){return type.allOf=FromTypes(args,type.allOf),type}function FromUnion7(args,type){return type.anyOf=FromTypes(args,type.anyOf),type}function FromTuple4(args,type){if(IsUndefined(type.items))return type;return type.items=FromTypes(args,type.items),type}function FromArray5(args,type){return type.items=FromType(args,type.items),type}function FromAsyncIterator2(args,type){return type.items=FromType(args,type.items),type}function FromIterator2(args,type){return type.items=FromType(args,type.items),type}function FromPromise3(args,type){return type.item=FromType(args,type.item),type}function FromObject2(args,type){let mappedProperties=FromProperties11(args,type.properties);return{...type,...Object2(mappedProperties)}}function FromRecord2(args,type){let mappedKey=FromType(args,RecordKey2(type)),mappedValue=FromType(args,RecordValue2(type)),result=Record(mappedKey,mappedValue);return{...type,...result}}function FromArgument(args,argument){return argument.index in args?args[argument.index]:Unknown()}function FromProperty2(args,type){let isReadonly=IsReadonly(type),isOptional=IsOptional(type),mapped=FromType(args,type);return isReadonly&&isOptional?ReadonlyOptional(mapped):isReadonly&&!isOptional?Readonly(mapped):!isReadonly&&isOptional?Optional(mapped):mapped}function FromProperties11(args,properties){return globalThis.Object.getOwnPropertyNames(properties).reduce((result,key)=>{return{...result,[key]:FromProperty2(args,properties[key])}},{})}function FromTypes(args,types){return types.map((type)=>FromType(args,type))}function FromType(args,type){return IsConstructor(type)?FromConstructor2(args,type):IsFunction3(type)?FromFunction2(args,type):IsIntersect(type)?FromIntersect5(args,type):IsUnion(type)?FromUnion7(args,type):IsTuple(type)?FromTuple4(args,type):IsArray3(type)?FromArray5(args,type):IsAsyncIterator3(type)?FromAsyncIterator2(args,type):IsIterator3(type)?FromIterator2(args,type):IsPromise2(type)?FromPromise3(args,type):IsObject3(type)?FromObject2(args,type):IsRecord(type)?FromRecord2(args,type):IsArgument(type)?FromArgument(args,type):type}function Instantiate(type,args){return FromType(args,CloneType(type))}function Integer(options){return CreateType({[Kind]:"Integer",type:"integer"},options)}function MappedIntrinsicPropertyKey(K,M,options){return{[K]:Intrinsic(Literal(K),M,Clone(options))}}function MappedIntrinsicPropertyKeys(K,M,options){return K.reduce((Acc,L)=>{return{...Acc,...MappedIntrinsicPropertyKey(L,M,options)}},{})}function MappedIntrinsicProperties(T2,M,options){return MappedIntrinsicPropertyKeys(T2.keys,M,options)}function IntrinsicFromMappedKey(T2,M,options){let P=MappedIntrinsicProperties(T2,M,options);return MappedResult(P)}function ApplyUncapitalize(value){let[first,rest]=[value.slice(0,1),value.slice(1)];return[first.toLowerCase(),rest].join("")}function ApplyCapitalize(value){let[first,rest]=[value.slice(0,1),value.slice(1)];return[first.toUpperCase(),rest].join("")}function ApplyUppercase(value){return value.toUpperCase()}function ApplyLowercase(value){return value.toLowerCase()}function FromTemplateLiteral3(schema,mode,options){let expression=TemplateLiteralParseExact(schema.pattern);if(!IsTemplateLiteralExpressionFinite(expression))return{...schema,pattern:FromLiteralValue(schema.pattern,mode)};let literals=[...TemplateLiteralExpressionGenerate(expression)].map((value)=>Literal(value)),mapped=FromRest5(literals,mode),union=Union(mapped);return TemplateLiteral([union],options)}function FromLiteralValue(value,mode){return typeof value==="string"?mode==="Uncapitalize"?ApplyUncapitalize(value):mode==="Capitalize"?ApplyCapitalize(value):mode==="Uppercase"?ApplyUppercase(value):mode==="Lowercase"?ApplyLowercase(value):value:value.toString()}function FromRest5(T2,M){return T2.map((L)=>Intrinsic(L,M))}function Intrinsic(schema,mode,options={}){return IsMappedKey(schema)?IntrinsicFromMappedKey(schema,mode,options):IsTemplateLiteral(schema)?FromTemplateLiteral3(schema,mode,options):IsUnion(schema)?Union(FromRest5(schema.anyOf,mode),options):IsLiteral(schema)?Literal(FromLiteralValue(schema.const,mode),options):CreateType(schema,options)}function Capitalize(T2,options={}){return Intrinsic(T2,"Capitalize",options)}function Lowercase(T2,options={}){return Intrinsic(T2,"Lowercase",options)}function Uncapitalize(T2,options={}){return Intrinsic(T2,"Uncapitalize",options)}function Uppercase(T2,options={}){return Intrinsic(T2,"Uppercase",options)}function FromProperties12(properties,propertyKeys,options){let result={};for(let K2 of globalThis.Object.getOwnPropertyNames(properties))result[K2]=Omit(properties[K2],propertyKeys,Clone(options));return result}function FromMappedResult9(mappedResult,propertyKeys,options){return FromProperties12(mappedResult.properties,propertyKeys,options)}function OmitFromMappedResult(mappedResult,propertyKeys,options){let properties=FromMappedResult9(mappedResult,propertyKeys,options);return MappedResult(properties)}function FromIntersect6(types,propertyKeys){return types.map((type)=>OmitResolve(type,propertyKeys))}function FromUnion8(types,propertyKeys){return types.map((type)=>OmitResolve(type,propertyKeys))}function FromProperty3(properties,key){let{[key]:_2,...R}=properties;return R}function FromProperties13(properties,propertyKeys){return propertyKeys.reduce((T2,K2)=>FromProperty3(T2,K2),properties)}function FromObject3(properties,propertyKeys){let options=Discard(properties,[TransformKind,"$id","required","properties"]),omittedProperties=FromProperties13(properties.properties,propertyKeys);return Object2(omittedProperties,options)}function UnionFromPropertyKeys(propertyKeys){let result=propertyKeys.reduce((result2,key)=>IsLiteralValue(key)?[...result2,Literal(key)]:result2,[]);return Union(result)}function OmitResolve(properties,propertyKeys){return IsIntersect(properties)?Intersect(FromIntersect6(properties.allOf,propertyKeys)):IsUnion(properties)?Union(FromUnion8(properties.anyOf,propertyKeys)):IsObject3(properties)?FromObject3(properties,propertyKeys):Object2({})}function Omit(type,key,options){let typeKey=IsArray(key)?UnionFromPropertyKeys(key):key,propertyKeys=IsSchema(key)?IndexPropertyKeys(key):key,isTypeRef=IsRef(type),isKeyRef=IsRef(key);return IsMappedResult(type)?OmitFromMappedResult(type,propertyKeys,options):IsMappedKey(key)?OmitFromMappedKey(type,key,options):isTypeRef&&isKeyRef?Computed("Omit",[type,typeKey],options):!isTypeRef&&isKeyRef?Computed("Omit",[type,typeKey],options):isTypeRef&&!isKeyRef?Computed("Omit",[type,typeKey],options):CreateType({...OmitResolve(type,propertyKeys),...options})}function FromPropertyKey2(type,key,options){return{[key]:Omit(type,[key],Clone(options))}}function FromPropertyKeys2(type,propertyKeys,options){return propertyKeys.reduce((Acc,LK)=>{return{...Acc,...FromPropertyKey2(type,LK,options)}},{})}function FromMappedKey3(type,mappedKey,options){return FromPropertyKeys2(type,mappedKey.keys,options)}function OmitFromMappedKey(type,mappedKey,options){let properties=FromMappedKey3(type,mappedKey,options);return MappedResult(properties)}function FromProperties14(properties,propertyKeys,options){let result={};for(let K2 of globalThis.Object.getOwnPropertyNames(properties))result[K2]=Pick(properties[K2],propertyKeys,Clone(options));return result}function FromMappedResult10(mappedResult,propertyKeys,options){return FromProperties14(mappedResult.properties,propertyKeys,options)}function PickFromMappedResult(mappedResult,propertyKeys,options){let properties=FromMappedResult10(mappedResult,propertyKeys,options);return MappedResult(properties)}function FromIntersect7(types,propertyKeys){return types.map((type)=>PickResolve(type,propertyKeys))}function FromUnion9(types,propertyKeys){return types.map((type)=>PickResolve(type,propertyKeys))}function FromProperties15(properties,propertyKeys){let result={};for(let K2 of propertyKeys)if(K2 in properties)result[K2]=properties[K2];return result}function FromObject4(T2,K){let options=Discard(T2,[TransformKind,"$id","required","properties"]),properties=FromProperties15(T2.properties,K);return Object2(properties,options)}function UnionFromPropertyKeys2(propertyKeys){let result=propertyKeys.reduce((result2,key)=>IsLiteralValue(key)?[...result2,Literal(key)]:result2,[]);return Union(result)}function PickResolve(properties,propertyKeys){return IsIntersect(properties)?Intersect(FromIntersect7(properties.allOf,propertyKeys)):IsUnion(properties)?Union(FromUnion9(properties.anyOf,propertyKeys)):IsObject3(properties)?FromObject4(properties,propertyKeys):Object2({})}function Pick(type,key,options){let typeKey=IsArray(key)?UnionFromPropertyKeys2(key):key,propertyKeys=IsSchema(key)?IndexPropertyKeys(key):key,isTypeRef=IsRef(type),isKeyRef=IsRef(key);return IsMappedResult(type)?PickFromMappedResult(type,propertyKeys,options):IsMappedKey(key)?PickFromMappedKey(type,key,options):isTypeRef&&isKeyRef?Computed("Pick",[type,typeKey],options):!isTypeRef&&isKeyRef?Computed("Pick",[type,typeKey],options):isTypeRef&&!isKeyRef?Computed("Pick",[type,typeKey],options):CreateType({...PickResolve(type,propertyKeys),...options})}function FromPropertyKey3(type,key,options){return{[key]:Pick(type,[key],Clone(options))}}function FromPropertyKeys3(type,propertyKeys,options){return propertyKeys.reduce((result,leftKey)=>{return{...result,...FromPropertyKey3(type,leftKey,options)}},{})}function FromMappedKey4(type,mappedKey,options){return FromPropertyKeys3(type,mappedKey.keys,options)}function PickFromMappedKey(type,mappedKey,options){let properties=FromMappedKey4(type,mappedKey,options);return MappedResult(properties)}function FromComputed3(target,parameters){return Computed("Partial",[Computed(target,parameters)])}function FromRef3($ref){return Computed("Partial",[Ref($ref)])}function FromProperties16(properties){let partialProperties={};for(let K of globalThis.Object.getOwnPropertyNames(properties))partialProperties[K]=Optional(properties[K]);return partialProperties}function FromObject5(type){let options=Discard(type,[TransformKind,"$id","required","properties"]),properties=FromProperties16(type.properties);return Object2(properties,options)}function FromRest6(types){return types.map((type)=>PartialResolve(type))}function PartialResolve(type){return IsComputed(type)?FromComputed3(type.target,type.parameters):IsRef(type)?FromRef3(type.$ref):IsIntersect(type)?Intersect(FromRest6(type.allOf)):IsUnion(type)?Union(FromRest6(type.anyOf)):IsObject3(type)?FromObject5(type):IsBigInt3(type)?type:IsBoolean3(type)?type:IsInteger2(type)?type:IsLiteral(type)?type:IsNull3(type)?type:IsNumber3(type)?type:IsString3(type)?type:IsSymbol3(type)?type:IsUndefined3(type)?type:Object2({})}function Partial(type,options){if(IsMappedResult(type))return PartialFromMappedResult(type,options);else return CreateType({...PartialResolve(type),...options})}function FromProperties17(K,options){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(K))Acc[K2]=Partial(K[K2],Clone(options));return Acc}function FromMappedResult11(R,options){return FromProperties17(R.properties,options)}function PartialFromMappedResult(R,options){let P=FromMappedResult11(R,options);return MappedResult(P)}function FromComputed4(target,parameters){return Computed("Required",[Computed(target,parameters)])}function FromRef4($ref){return Computed("Required",[Ref($ref)])}function FromProperties18(properties){let requiredProperties={};for(let K of globalThis.Object.getOwnPropertyNames(properties))requiredProperties[K]=Discard(properties[K],[OptionalKind]);return requiredProperties}function FromObject6(type){let options=Discard(type,[TransformKind,"$id","required","properties"]),properties=FromProperties18(type.properties);return Object2(properties,options)}function FromRest7(types){return types.map((type)=>RequiredResolve(type))}function RequiredResolve(type){return IsComputed(type)?FromComputed4(type.target,type.parameters):IsRef(type)?FromRef4(type.$ref):IsIntersect(type)?Intersect(FromRest7(type.allOf)):IsUnion(type)?Union(FromRest7(type.anyOf)):IsObject3(type)?FromObject6(type):IsBigInt3(type)?type:IsBoolean3(type)?type:IsInteger2(type)?type:IsLiteral(type)?type:IsNull3(type)?type:IsNumber3(type)?type:IsString3(type)?type:IsSymbol3(type)?type:IsUndefined3(type)?type:Object2({})}function Required(type,options){if(IsMappedResult(type))return RequiredFromMappedResult(type,options);else return CreateType({...RequiredResolve(type),...options})}function FromProperties19(P,options){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Required(P[K2],options);return Acc}function FromMappedResult12(R,options){return FromProperties19(R.properties,options)}function RequiredFromMappedResult(R,options){let P=FromMappedResult12(R,options);return MappedResult(P)}function DereferenceParameters(moduleProperties,types){return types.map((type)=>{return IsRef(type)?Dereference(moduleProperties,type.$ref):FromType2(moduleProperties,type)})}function Dereference(moduleProperties,ref){return ref in moduleProperties?IsRef(moduleProperties[ref])?Dereference(moduleProperties,moduleProperties[ref].$ref):FromType2(moduleProperties,moduleProperties[ref]):Never()}function FromAwaited(parameters){return Awaited(parameters[0])}function FromIndex(parameters){return Index(parameters[0],parameters[1])}function FromKeyOf(parameters){return KeyOf(parameters[0])}function FromPartial(parameters){return Partial(parameters[0])}function FromOmit(parameters){return Omit(parameters[0],parameters[1])}function FromPick(parameters){return Pick(parameters[0],parameters[1])}function FromRequired(parameters){return Required(parameters[0])}function FromComputed5(moduleProperties,target,parameters){let dereferenced=DereferenceParameters(moduleProperties,parameters);return target==="Awaited"?FromAwaited(dereferenced):target==="Index"?FromIndex(dereferenced):target==="KeyOf"?FromKeyOf(dereferenced):target==="Partial"?FromPartial(dereferenced):target==="Omit"?FromOmit(dereferenced):target==="Pick"?FromPick(dereferenced):target==="Required"?FromRequired(dereferenced):Never()}function FromArray6(moduleProperties,type){return Array2(FromType2(moduleProperties,type))}function FromAsyncIterator3(moduleProperties,type){return AsyncIterator(FromType2(moduleProperties,type))}function FromConstructor3(moduleProperties,parameters,instanceType){return Constructor(FromTypes2(moduleProperties,parameters),FromType2(moduleProperties,instanceType))}function FromFunction3(moduleProperties,parameters,returnType){return Function2(FromTypes2(moduleProperties,parameters),FromType2(moduleProperties,returnType))}function FromIntersect8(moduleProperties,types){return Intersect(FromTypes2(moduleProperties,types))}function FromIterator3(moduleProperties,type){return Iterator(FromType2(moduleProperties,type))}function FromObject7(moduleProperties,properties){return Object2(globalThis.Object.keys(properties).reduce((result,key)=>{return{...result,[key]:FromType2(moduleProperties,properties[key])}},{}))}function FromRecord3(moduleProperties,type){let[value,pattern]=[FromType2(moduleProperties,RecordValue2(type)),RecordPattern(type)],result=CloneType(type);return result.patternProperties[pattern]=value,result}function FromTransform(moduleProperties,transform){return IsRef(transform)?{...Dereference(moduleProperties,transform.$ref),[TransformKind]:transform[TransformKind]}:transform}function FromTuple5(moduleProperties,types){return Tuple(FromTypes2(moduleProperties,types))}function FromUnion10(moduleProperties,types){return Union(FromTypes2(moduleProperties,types))}function FromTypes2(moduleProperties,types){return types.map((type)=>FromType2(moduleProperties,type))}function FromType2(moduleProperties,type){return IsOptional(type)?CreateType(FromType2(moduleProperties,Discard(type,[OptionalKind])),type):IsReadonly(type)?CreateType(FromType2(moduleProperties,Discard(type,[ReadonlyKind])),type):IsTransform(type)?CreateType(FromTransform(moduleProperties,type),type):IsArray3(type)?CreateType(FromArray6(moduleProperties,type.items),type):IsAsyncIterator3(type)?CreateType(FromAsyncIterator3(moduleProperties,type.items),type):IsComputed(type)?CreateType(FromComputed5(moduleProperties,type.target,type.parameters)):IsConstructor(type)?CreateType(FromConstructor3(moduleProperties,type.parameters,type.returns),type):IsFunction3(type)?CreateType(FromFunction3(moduleProperties,type.parameters,type.returns),type):IsIntersect(type)?CreateType(FromIntersect8(moduleProperties,type.allOf),type):IsIterator3(type)?CreateType(FromIterator3(moduleProperties,type.items),type):IsObject3(type)?CreateType(FromObject7(moduleProperties,type.properties),type):IsRecord(type)?CreateType(FromRecord3(moduleProperties,type)):IsTuple(type)?CreateType(FromTuple5(moduleProperties,type.items||[]),type):IsUnion(type)?CreateType(FromUnion10(moduleProperties,type.anyOf),type):type}function ComputeType(moduleProperties,key){return key in moduleProperties?FromType2(moduleProperties,moduleProperties[key]):Never()}function ComputeModuleProperties(moduleProperties){return globalThis.Object.getOwnPropertyNames(moduleProperties).reduce((result,key)=>{return{...result,[key]:ComputeType(moduleProperties,key)}},{})}class TModule{constructor($defs){let computed=ComputeModuleProperties($defs),identified=this.WithIdentifiers(computed);this.$defs=identified}Import(key,options){let $defs={...this.$defs,[key]:CreateType(this.$defs[key],options)};return CreateType({[Kind]:"Import",$defs,$ref:key})}WithIdentifiers($defs){return globalThis.Object.getOwnPropertyNames($defs).reduce((result,key)=>{return{...result,[key]:{...$defs[key],$id:key}}},{})}}function Module(properties){return new TModule(properties)}function Not2(type,options){return CreateType({[Kind]:"Not",not:type},options)}function Parameters(schema,options){return IsFunction3(schema)?Tuple(schema.parameters,options):Never()}var Ordinal=0;function Recursive(callback,options={}){if(IsUndefined(options.$id))options.$id=`T${Ordinal++}`;let thisType=CloneType(callback({[Kind]:"This",$ref:`${options.$id}`}));return thisType.$id=options.$id,CreateType({[Hint]:"Recursive",...thisType},options)}function RegExp2(unresolved,options){let expr=IsString(unresolved)?new globalThis.RegExp(unresolved):unresolved;return CreateType({[Kind]:"RegExp",type:"RegExp",source:expr.source,flags:expr.flags},options)}function RestResolve(T2){return IsIntersect(T2)?T2.allOf:IsUnion(T2)?T2.anyOf:IsTuple(T2)?T2.items??[]:[]}function Rest(T2){return RestResolve(T2)}function ReturnType(schema,options){return IsFunction3(schema)?CreateType(schema.returns,options):Never(options)}class TransformDecodeBuilder{constructor(schema){this.schema=schema}Decode(decode){return new TransformEncodeBuilder(this.schema,decode)}}class TransformEncodeBuilder{constructor(schema,decode){this.schema=schema,this.decode=decode}EncodeTransform(encode,schema){let Codec={Encode:(value)=>schema[TransformKind].Encode(encode(value)),Decode:(value)=>this.decode(schema[TransformKind].Decode(value))};return{...schema,[TransformKind]:Codec}}EncodeSchema(encode,schema){let Codec={Decode:this.decode,Encode:encode};return{...schema,[TransformKind]:Codec}}Encode(encode){return IsTransform(this.schema)?this.EncodeTransform(encode,this.schema):this.EncodeSchema(encode,this.schema)}}function Transform(schema){return new TransformDecodeBuilder(schema)}function Unsafe(options={}){return CreateType({[Kind]:options[Kind]??"Unsafe"},options)}function Void(options){return CreateType({[Kind]:"Void",type:"void"},options)}var exports_type3={};__export(exports_type3,{Void:()=>Void,Uppercase:()=>Uppercase,Unsafe:()=>Unsafe,Unknown:()=>Unknown,Union:()=>Union,Undefined:()=>Undefined,Uncapitalize:()=>Uncapitalize,Uint8Array:()=>Uint8Array2,Tuple:()=>Tuple,Transform:()=>Transform,TemplateLiteral:()=>TemplateLiteral,Symbol:()=>Symbol2,String:()=>String2,ReturnType:()=>ReturnType,Rest:()=>Rest,Required:()=>Required,RegExp:()=>RegExp2,Ref:()=>Ref,Recursive:()=>Recursive,Record:()=>Record,ReadonlyOptional:()=>ReadonlyOptional,Readonly:()=>Readonly,Promise:()=>Promise2,Pick:()=>Pick,Partial:()=>Partial,Parameters:()=>Parameters,Optional:()=>Optional,Omit:()=>Omit,Object:()=>Object2,Number:()=>Number2,Null:()=>Null,Not:()=>Not2,Never:()=>Never,Module:()=>Module,Mapped:()=>Mapped,Lowercase:()=>Lowercase,Literal:()=>Literal,KeyOf:()=>KeyOf,Iterator:()=>Iterator,Intersect:()=>Intersect,Integer:()=>Integer,Instantiate:()=>Instantiate,InstanceType:()=>InstanceType,Index:()=>Index,Function:()=>Function2,Extract:()=>Extract,Extends:()=>Extends,Exclude:()=>Exclude,Enum:()=>Enum,Date:()=>Date2,ConstructorParameters:()=>ConstructorParameters,Constructor:()=>Constructor,Const:()=>Const,Composite:()=>Composite,Capitalize:()=>Capitalize,Boolean:()=>Boolean2,BigInt:()=>BigInt2,Awaited:()=>Awaited,AsyncIterator:()=>AsyncIterator,Array:()=>Array2,Argument:()=>Argument,Any:()=>Any});var Type=exports_type3;function DefaultErrorFunction(error){switch(error.errorType){case ValueErrorType.ArrayContains:return"Expected array to contain at least one matching value";case ValueErrorType.ArrayMaxContains:return`Expected array to contain no more than ${error.schema.maxContains} matching values`;case ValueErrorType.ArrayMinContains:return`Expected array to contain at least ${error.schema.minContains} matching values`;case ValueErrorType.ArrayMaxItems:return`Expected array length to be less or equal to ${error.schema.maxItems}`;case ValueErrorType.ArrayMinItems:return`Expected array length to be greater or equal to ${error.schema.minItems}`;case ValueErrorType.ArrayUniqueItems:return"Expected array elements to be unique";case ValueErrorType.Array:return"Expected array";case ValueErrorType.AsyncIterator:return"Expected AsyncIterator";case ValueErrorType.BigIntExclusiveMaximum:return`Expected bigint to be less than ${error.schema.exclusiveMaximum}`;case ValueErrorType.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${error.schema.exclusiveMinimum}`;case ValueErrorType.BigIntMaximum:return`Expected bigint to be less or equal to ${error.schema.maximum}`;case ValueErrorType.BigIntMinimum:return`Expected bigint to be greater or equal to ${error.schema.minimum}`;case ValueErrorType.BigIntMultipleOf:return`Expected bigint to be a multiple of ${error.schema.multipleOf}`;case ValueErrorType.BigInt:return"Expected bigint";case ValueErrorType.Boolean:return"Expected boolean";case ValueErrorType.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${error.schema.exclusiveMinimumTimestamp}`;case ValueErrorType.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${error.schema.exclusiveMaximumTimestamp}`;case ValueErrorType.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${error.schema.minimumTimestamp}`;case ValueErrorType.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${error.schema.maximumTimestamp}`;case ValueErrorType.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${error.schema.multipleOfTimestamp}`;case ValueErrorType.Date:return"Expected Date";case ValueErrorType.Function:return"Expected function";case ValueErrorType.IntegerExclusiveMaximum:return`Expected integer to be less than ${error.schema.exclusiveMaximum}`;case ValueErrorType.IntegerExclusiveMinimum:return`Expected integer to be greater than ${error.schema.exclusiveMinimum}`;case ValueErrorType.IntegerMaximum:return`Expected integer to be less or equal to ${error.schema.maximum}`;case ValueErrorType.IntegerMinimum:return`Expected integer to be greater or equal to ${error.schema.minimum}`;case ValueErrorType.IntegerMultipleOf:return`Expected integer to be a multiple of ${error.schema.multipleOf}`;case ValueErrorType.Integer:return"Expected integer";case ValueErrorType.IntersectUnevaluatedProperties:return"Unexpected property";case ValueErrorType.Intersect:return"Expected all values to match";case ValueErrorType.Iterator:return"Expected Iterator";case ValueErrorType.Literal:return`Expected ${typeof error.schema.const==="string"?`'${error.schema.const}'`:error.schema.const}`;case ValueErrorType.Never:return"Never";case ValueErrorType.Not:return"Value should not match";case ValueErrorType.Null:return"Expected null";case ValueErrorType.NumberExclusiveMaximum:return`Expected number to be less than ${error.schema.exclusiveMaximum}`;case ValueErrorType.NumberExclusiveMinimum:return`Expected number to be greater than ${error.schema.exclusiveMinimum}`;case ValueErrorType.NumberMaximum:return`Expected number to be less or equal to ${error.schema.maximum}`;case ValueErrorType.NumberMinimum:return`Expected number to be greater or equal to ${error.schema.minimum}`;case ValueErrorType.NumberMultipleOf:return`Expected number to be a multiple of ${error.schema.multipleOf}`;case ValueErrorType.Number:return"Expected number";case ValueErrorType.Object:return"Expected object";case ValueErrorType.ObjectAdditionalProperties:return"Unexpected property";case ValueErrorType.ObjectMaxProperties:return`Expected object to have no more than ${error.schema.maxProperties} properties`;case ValueErrorType.ObjectMinProperties:return`Expected object to have at least ${error.schema.minProperties} properties`;case ValueErrorType.ObjectRequiredProperty:return"Expected required property";case ValueErrorType.Promise:return"Expected Promise";case ValueErrorType.RegExp:return"Expected string to match regular expression";case ValueErrorType.StringFormatUnknown:return`Unknown format '${error.schema.format}'`;case ValueErrorType.StringFormat:return`Expected string to match '${error.schema.format}' format`;case ValueErrorType.StringMaxLength:return`Expected string length less or equal to ${error.schema.maxLength}`;case ValueErrorType.StringMinLength:return`Expected string length greater or equal to ${error.schema.minLength}`;case ValueErrorType.StringPattern:return`Expected string to match '${error.schema.pattern}'`;case ValueErrorType.String:return"Expected string";case ValueErrorType.Symbol:return"Expected symbol";case ValueErrorType.TupleLength:return`Expected tuple to have ${error.schema.maxItems||0} elements`;case ValueErrorType.Tuple:return"Expected tuple";case ValueErrorType.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${error.schema.maxByteLength}`;case ValueErrorType.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${error.schema.minByteLength}`;case ValueErrorType.Uint8Array:return"Expected Uint8Array";case ValueErrorType.Undefined:return"Expected undefined";case ValueErrorType.Union:return"Expected union value";case ValueErrorType.Void:return"Expected void";case ValueErrorType.Kind:return`Expected kind '${error.schema[Kind]}'`;default:return"Unknown error type"}}var errorFunction=DefaultErrorFunction;function GetErrorFunction(){return errorFunction}class TypeDereferenceError extends TypeBoxError{constructor(schema){super(`Unable to dereference schema with $id '${schema.$ref}'`);this.schema=schema}}function Resolve(schema,references){let target=references.find((target2)=>target2.$id===schema.$ref);if(target===void 0)throw new TypeDereferenceError(schema);return Deref(target,references)}function Pushref(schema,references){if(!IsString2(schema.$id)||references.some((target)=>target.$id===schema.$id))return references;return references.push(schema),references}function Deref(schema,references){return schema[Kind]==="This"||schema[Kind]==="Ref"?Resolve(schema,references):schema}class ValueHashError extends TypeBoxError{constructor(value){super("Unable to hash value");this.value=value}}var ByteMarker;(function(ByteMarker2){ByteMarker2[ByteMarker2.Undefined=0]="Undefined",ByteMarker2[ByteMarker2.Null=1]="Null",ByteMarker2[ByteMarker2.Boolean=2]="Boolean",ByteMarker2[ByteMarker2.Number=3]="Number",ByteMarker2[ByteMarker2.String=4]="String",ByteMarker2[ByteMarker2.Object=5]="Object",ByteMarker2[ByteMarker2.Array=6]="Array",ByteMarker2[ByteMarker2.Date=7]="Date",ByteMarker2[ByteMarker2.Uint8Array=8]="Uint8Array",ByteMarker2[ByteMarker2.Symbol=9]="Symbol",ByteMarker2[ByteMarker2.BigInt=10]="BigInt"})(ByteMarker||(ByteMarker={}));var Accumulator=BigInt("14695981039346656037"),[Prime,Size]=[BigInt("1099511628211"),BigInt("18446744073709551616")],Bytes=Array.from({length:256}).map((_2,i)=>BigInt(i)),F64=new Float64Array(1),F64In=new DataView(F64.buffer),F64Out=new Uint8Array(F64.buffer);function*NumberToBytes(value){let byteCount=value===0?1:Math.ceil(Math.floor(Math.log2(value)+1)/8);for(let i=0;i<byteCount;i++)yield value>>8*(byteCount-1-i)&255}function ArrayType2(value){FNV1A64(ByteMarker.Array);for(let item of value)Visit4(item)}function BooleanType(value){FNV1A64(ByteMarker.Boolean),FNV1A64(value?1:0)}function BigIntType(value){FNV1A64(ByteMarker.BigInt),F64In.setBigInt64(0,value);for(let byte of F64Out)FNV1A64(byte)}function DateType2(value){FNV1A64(ByteMarker.Date),Visit4(value.getTime())}function NullType(value){FNV1A64(ByteMarker.Null)}function NumberType(value){FNV1A64(ByteMarker.Number),F64In.setFloat64(0,value);for(let byte of F64Out)FNV1A64(byte)}function ObjectType2(value){FNV1A64(ByteMarker.Object);for(let key of globalThis.Object.getOwnPropertyNames(value).sort())Visit4(key),Visit4(value[key])}function StringType(value){FNV1A64(ByteMarker.String);for(let i=0;i<value.length;i++)for(let byte of NumberToBytes(value.charCodeAt(i)))FNV1A64(byte)}function SymbolType(value){FNV1A64(ByteMarker.Symbol),Visit4(value.description)}function Uint8ArrayType2(value){FNV1A64(ByteMarker.Uint8Array);for(let i=0;i<value.length;i++)FNV1A64(value[i])}function UndefinedType(value){return FNV1A64(ByteMarker.Undefined)}function Visit4(value){if(IsArray2(value))return ArrayType2(value);if(IsBoolean2(value))return BooleanType(value);if(IsBigInt2(value))return BigIntType(value);if(IsDate2(value))return DateType2(value);if(IsNull2(value))return NullType(value);if(IsNumber2(value))return NumberType(value);if(IsObject2(value))return ObjectType2(value);if(IsString2(value))return StringType(value);if(IsSymbol2(value))return SymbolType(value);if(IsUint8Array2(value))return Uint8ArrayType2(value);if(IsUndefined2(value))return UndefinedType(value);throw new ValueHashError(value)}function FNV1A64(byte){Accumulator=Accumulator^Bytes[byte],Accumulator=Accumulator*Prime%Size}function Hash(value){return Accumulator=BigInt("14695981039346656037"),Visit4(value),Accumulator}class ValueCheckUnknownTypeError extends TypeBoxError{constructor(schema){super("Unknown type");this.schema=schema}}function IsAnyOrUnknown(schema){return schema[Kind]==="Any"||schema[Kind]==="Unknown"}function IsDefined(value){return value!==void 0}function FromAny2(schema,references,value){return!0}function FromArgument2(schema,references,value){return!0}function FromArray7(schema,references,value){if(!IsArray2(value))return!1;if(IsDefined(schema.minItems)&&!(value.length>=schema.minItems))return!1;if(IsDefined(schema.maxItems)&&!(value.length<=schema.maxItems))return!1;if(!value.every((value2)=>Visit5(schema.items,references,value2)))return!1;if(schema.uniqueItems===!0&&!function(){let set2=new Set;for(let element of value){let hashed=Hash(element);if(set2.has(hashed))return!1;else set2.add(hashed)}return!0}())return!1;if(!(IsDefined(schema.contains)||IsNumber2(schema.minContains)||IsNumber2(schema.maxContains)))return!0;let containsSchema=IsDefined(schema.contains)?schema.contains:Never(),containsCount=value.reduce((acc,value2)=>Visit5(containsSchema,references,value2)?acc+1:acc,0);if(containsCount===0)return!1;if(IsNumber2(schema.minContains)&&containsCount<schema.minContains)return!1;if(IsNumber2(schema.maxContains)&&containsCount>schema.maxContains)return!1;return!0}function FromAsyncIterator4(schema,references,value){return IsAsyncIterator2(value)}function FromBigInt2(schema,references,value){if(!IsBigInt2(value))return!1;if(IsDefined(schema.exclusiveMaximum)&&!(value<schema.exclusiveMaximum))return!1;if(IsDefined(schema.exclusiveMinimum)&&!(value>schema.exclusiveMinimum))return!1;if(IsDefined(schema.maximum)&&!(value<=schema.maximum))return!1;if(IsDefined(schema.minimum)&&!(value>=schema.minimum))return!1;if(IsDefined(schema.multipleOf)&&value%schema.multipleOf!==BigInt(0))return!1;return!0}function FromBoolean2(schema,references,value){return IsBoolean2(value)}function FromConstructor4(schema,references,value){return Visit5(schema.returns,references,value.prototype)}function FromDate2(schema,references,value){if(!IsDate2(value))return!1;if(IsDefined(schema.exclusiveMaximumTimestamp)&&!(value.getTime()<schema.exclusiveMaximumTimestamp))return!1;if(IsDefined(schema.exclusiveMinimumTimestamp)&&!(value.getTime()>schema.exclusiveMinimumTimestamp))return!1;if(IsDefined(schema.maximumTimestamp)&&!(value.getTime()<=schema.maximumTimestamp))return!1;if(IsDefined(schema.minimumTimestamp)&&!(value.getTime()>=schema.minimumTimestamp))return!1;if(IsDefined(schema.multipleOfTimestamp)&&value.getTime()%schema.multipleOfTimestamp!==0)return!1;return!0}function FromFunction4(schema,references,value){return IsFunction2(value)}function FromImport(schema,references,value){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];return Visit5(target,[...references,...definitions],value)}function FromInteger2(schema,references,value){if(!IsInteger(value))return!1;if(IsDefined(schema.exclusiveMaximum)&&!(value<schema.exclusiveMaximum))return!1;if(IsDefined(schema.exclusiveMinimum)&&!(value>schema.exclusiveMinimum))return!1;if(IsDefined(schema.maximum)&&!(value<=schema.maximum))return!1;if(IsDefined(schema.minimum)&&!(value>=schema.minimum))return!1;if(IsDefined(schema.multipleOf)&&value%schema.multipleOf!==0)return!1;return!0}function FromIntersect9(schema,references,value){let check1=schema.allOf.every((schema2)=>Visit5(schema2,references,value));if(schema.unevaluatedProperties===!1){let keyPattern=new RegExp(KeyOfPattern(schema)),check2=Object.getOwnPropertyNames(value).every((key)=>keyPattern.test(key));return check1&&check2}else if(IsSchema(schema.unevaluatedProperties)){let keyCheck=new RegExp(KeyOfPattern(schema)),check2=Object.getOwnPropertyNames(value).every((key)=>keyCheck.test(key)||Visit5(schema.unevaluatedProperties,references,value[key]));return check1&&check2}else return check1}function FromIterator4(schema,references,value){return IsIterator2(value)}function FromLiteral3(schema,references,value){return value===schema.const}function FromNever2(schema,references,value){return!1}function FromNot2(schema,references,value){return!Visit5(schema.not,references,value)}function FromNull2(schema,references,value){return IsNull2(value)}function FromNumber2(schema,references,value){if(!TypeSystemPolicy.IsNumberLike(value))return!1;if(IsDefined(schema.exclusiveMaximum)&&!(value<schema.exclusiveMaximum))return!1;if(IsDefined(schema.exclusiveMinimum)&&!(value>schema.exclusiveMinimum))return!1;if(IsDefined(schema.minimum)&&!(value>=schema.minimum))return!1;if(IsDefined(schema.maximum)&&!(value<=schema.maximum))return!1;if(IsDefined(schema.multipleOf)&&value%schema.multipleOf!==0)return!1;return!0}function FromObject8(schema,references,value){if(!TypeSystemPolicy.IsObjectLike(value))return!1;if(IsDefined(schema.minProperties)&&!(Object.getOwnPropertyNames(value).length>=schema.minProperties))return!1;if(IsDefined(schema.maxProperties)&&!(Object.getOwnPropertyNames(value).length<=schema.maxProperties))return!1;let knownKeys=Object.getOwnPropertyNames(schema.properties);for(let knownKey of knownKeys){let property=schema.properties[knownKey];if(schema.required&&schema.required.includes(knownKey)){if(!Visit5(property,references,value[knownKey]))return!1;if((ExtendsUndefinedCheck(property)||IsAnyOrUnknown(property))&&!(knownKey in value))return!1}else if(TypeSystemPolicy.IsExactOptionalProperty(value,knownKey)&&!Visit5(property,references,value[knownKey]))return!1}if(schema.additionalProperties===!1){let valueKeys=Object.getOwnPropertyNames(value);if(schema.required&&schema.required.length===knownKeys.length&&valueKeys.length===knownKeys.length)return!0;else return valueKeys.every((valueKey)=>knownKeys.includes(valueKey))}else if(typeof schema.additionalProperties==="object")return Object.getOwnPropertyNames(value).every((key)=>knownKeys.includes(key)||Visit5(schema.additionalProperties,references,value[key]));else return!0}function FromPromise4(schema,references,value){return IsPromise(value)}function FromRecord4(schema,references,value){if(!TypeSystemPolicy.IsRecordLike(value))return!1;if(IsDefined(schema.minProperties)&&!(Object.getOwnPropertyNames(value).length>=schema.minProperties))return!1;if(IsDefined(schema.maxProperties)&&!(Object.getOwnPropertyNames(value).length<=schema.maxProperties))return!1;let[patternKey,patternSchema]=Object.entries(schema.patternProperties)[0],regex=new RegExp(patternKey),check1=Object.entries(value).every(([key,value2])=>{return regex.test(key)?Visit5(patternSchema,references,value2):!0}),check2=typeof schema.additionalProperties==="object"?Object.entries(value).every(([key,value2])=>{return!regex.test(key)?Visit5(schema.additionalProperties,references,value2):!0}):!0,check3=schema.additionalProperties===!1?Object.getOwnPropertyNames(value).every((key)=>{return regex.test(key)}):!0;return check1&&check2&&check3}function FromRef5(schema,references,value){return Visit5(Deref(schema,references),references,value)}function FromRegExp2(schema,references,value){let regex=new RegExp(schema.source,schema.flags);if(IsDefined(schema.minLength)){if(!(value.length>=schema.minLength))return!1}if(IsDefined(schema.maxLength)){if(!(value.length<=schema.maxLength))return!1}return regex.test(value)}function FromString2(schema,references,value){if(!IsString2(value))return!1;if(IsDefined(schema.minLength)){if(!(value.length>=schema.minLength))return!1}if(IsDefined(schema.maxLength)){if(!(value.length<=schema.maxLength))return!1}if(IsDefined(schema.pattern)){if(!new RegExp(schema.pattern).test(value))return!1}if(IsDefined(schema.format)){if(!exports_format.Has(schema.format))return!1;return exports_format.Get(schema.format)(value)}return!0}function FromSymbol2(schema,references,value){return IsSymbol2(value)}function FromTemplateLiteral4(schema,references,value){return IsString2(value)&&new RegExp(schema.pattern).test(value)}function FromThis(schema,references,value){return Visit5(Deref(schema,references),references,value)}function FromTuple6(schema,references,value){if(!IsArray2(value))return!1;if(schema.items===void 0&&value.length!==0)return!1;if(value.length!==schema.maxItems)return!1;if(!schema.items)return!0;for(let i=0;i<schema.items.length;i++)if(!Visit5(schema.items[i],references,value[i]))return!1;return!0}function FromUndefined2(schema,references,value){return IsUndefined2(value)}function FromUnion11(schema,references,value){return schema.anyOf.some((inner)=>Visit5(inner,references,value))}function FromUint8Array2(schema,references,value){if(!IsUint8Array2(value))return!1;if(IsDefined(schema.maxByteLength)&&!(value.length<=schema.maxByteLength))return!1;if(IsDefined(schema.minByteLength)&&!(value.length>=schema.minByteLength))return!1;return!0}function FromUnknown2(schema,references,value){return!0}function FromVoid2(schema,references,value){return TypeSystemPolicy.IsVoidLike(value)}function FromKind(schema,references,value){if(!exports_type2.Has(schema[Kind]))return!1;return exports_type2.Get(schema[Kind])(schema,value)}function Visit5(schema,references,value){let references_=IsDefined(schema.$id)?Pushref(schema,references):references,schema_=schema;switch(schema_[Kind]){case"Any":return FromAny2(schema_,references_,value);case"Argument":return FromArgument2(schema_,references_,value);case"Array":return FromArray7(schema_,references_,value);case"AsyncIterator":return FromAsyncIterator4(schema_,references_,value);case"BigInt":return FromBigInt2(schema_,references_,value);case"Boolean":return FromBoolean2(schema_,references_,value);case"Constructor":return FromConstructor4(schema_,references_,value);case"Date":return FromDate2(schema_,references_,value);case"Function":return FromFunction4(schema_,references_,value);case"Import":return FromImport(schema_,references_,value);case"Integer":return FromInteger2(schema_,references_,value);case"Intersect":return FromIntersect9(schema_,references_,value);case"Iterator":return FromIterator4(schema_,references_,value);case"Literal":return FromLiteral3(schema_,references_,value);case"Never":return FromNever2(schema_,references_,value);case"Not":return FromNot2(schema_,references_,value);case"Null":return FromNull2(schema_,references_,value);case"Number":return FromNumber2(schema_,references_,value);case"Object":return FromObject8(schema_,references_,value);case"Promise":return FromPromise4(schema_,references_,value);case"Record":return FromRecord4(schema_,references_,value);case"Ref":return FromRef5(schema_,references_,value);case"RegExp":return FromRegExp2(schema_,references_,value);case"String":return FromString2(schema_,references_,value);case"Symbol":return FromSymbol2(schema_,references_,value);case"TemplateLiteral":return FromTemplateLiteral4(schema_,references_,value);case"This":return FromThis(schema_,references_,value);case"Tuple":return FromTuple6(schema_,references_,value);case"Undefined":return FromUndefined2(schema_,references_,value);case"Union":return FromUnion11(schema_,references_,value);case"Uint8Array":return FromUint8Array2(schema_,references_,value);case"Unknown":return FromUnknown2(schema_,references_,value);case"Void":return FromVoid2(schema_,references_,value);default:if(!exports_type2.Has(schema_[Kind]))throw new ValueCheckUnknownTypeError(schema_);return FromKind(schema_,references_,value)}}function Check(...args){return args.length===3?Visit5(args[0],args[1],args[2]):Visit5(args[0],[],args[1])}var ValueErrorType;(function(ValueErrorType2){ValueErrorType2[ValueErrorType2.ArrayContains=0]="ArrayContains",ValueErrorType2[ValueErrorType2.ArrayMaxContains=1]="ArrayMaxContains",ValueErrorType2[ValueErrorType2.ArrayMaxItems=2]="ArrayMaxItems",ValueErrorType2[ValueErrorType2.ArrayMinContains=3]="ArrayMinContains",ValueErrorType2[ValueErrorType2.ArrayMinItems=4]="ArrayMinItems",ValueErrorType2[ValueErrorType2.ArrayUniqueItems=5]="ArrayUniqueItems",ValueErrorType2[ValueErrorType2.Array=6]="Array",ValueErrorType2[ValueErrorType2.AsyncIterator=7]="AsyncIterator",ValueErrorType2[ValueErrorType2.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",ValueErrorType2[ValueErrorType2.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",ValueErrorType2[ValueErrorType2.BigIntMaximum=10]="BigIntMaximum",ValueErrorType2[ValueErrorType2.BigIntMinimum=11]="BigIntMinimum",ValueErrorType2[ValueErrorType2.BigIntMultipleOf=12]="BigIntMultipleOf",ValueErrorType2[ValueErrorType2.BigInt=13]="BigInt",ValueErrorType2[ValueErrorType2.Boolean=14]="Boolean",ValueErrorType2[ValueErrorType2.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",ValueErrorType2[ValueErrorType2.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",ValueErrorType2[ValueErrorType2.DateMaximumTimestamp=17]="DateMaximumTimestamp",ValueErrorType2[ValueErrorType2.DateMinimumTimestamp=18]="DateMinimumTimestamp",ValueErrorType2[ValueErrorType2.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",ValueErrorType2[ValueErrorType2.Date=20]="Date",ValueErrorType2[ValueErrorType2.Function=21]="Function",ValueErrorType2[ValueErrorType2.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",ValueErrorType2[ValueErrorType2.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",ValueErrorType2[ValueErrorType2.IntegerMaximum=24]="IntegerMaximum",ValueErrorType2[ValueErrorType2.IntegerMinimum=25]="IntegerMinimum",ValueErrorType2[ValueErrorType2.IntegerMultipleOf=26]="IntegerMultipleOf",ValueErrorType2[ValueErrorType2.Integer=27]="Integer",ValueErrorType2[ValueErrorType2.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",ValueErrorType2[ValueErrorType2.Intersect=29]="Intersect",ValueErrorType2[ValueErrorType2.Iterator=30]="Iterator",ValueErrorType2[ValueErrorType2.Kind=31]="Kind",ValueErrorType2[ValueErrorType2.Literal=32]="Literal",ValueErrorType2[ValueErrorType2.Never=33]="Never",ValueErrorType2[ValueErrorType2.Not=34]="Not",ValueErrorType2[ValueErrorType2.Null=35]="Null",ValueErrorType2[ValueErrorType2.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",ValueErrorType2[ValueErrorType2.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",ValueErrorType2[ValueErrorType2.NumberMaximum=38]="NumberMaximum",ValueErrorType2[ValueErrorType2.NumberMinimum=39]="NumberMinimum",ValueErrorType2[ValueErrorType2.NumberMultipleOf=40]="NumberMultipleOf",ValueErrorType2[ValueErrorType2.Number=41]="Number",ValueErrorType2[ValueErrorType2.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",ValueErrorType2[ValueErrorType2.ObjectMaxProperties=43]="ObjectMaxProperties",ValueErrorType2[ValueErrorType2.ObjectMinProperties=44]="ObjectMinProperties",ValueErrorType2[ValueErrorType2.ObjectRequiredProperty=45]="ObjectRequiredProperty",ValueErrorType2[ValueErrorType2.Object=46]="Object",ValueErrorType2[ValueErrorType2.Promise=47]="Promise",ValueErrorType2[ValueErrorType2.RegExp=48]="RegExp",ValueErrorType2[ValueErrorType2.StringFormatUnknown=49]="StringFormatUnknown",ValueErrorType2[ValueErrorType2.StringFormat=50]="StringFormat",ValueErrorType2[ValueErrorType2.StringMaxLength=51]="StringMaxLength",ValueErrorType2[ValueErrorType2.StringMinLength=52]="StringMinLength",ValueErrorType2[ValueErrorType2.StringPattern=53]="StringPattern",ValueErrorType2[ValueErrorType2.String=54]="String",ValueErrorType2[ValueErrorType2.Symbol=55]="Symbol",ValueErrorType2[ValueErrorType2.TupleLength=56]="TupleLength",ValueErrorType2[ValueErrorType2.Tuple=57]="Tuple",ValueErrorType2[ValueErrorType2.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",ValueErrorType2[ValueErrorType2.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",ValueErrorType2[ValueErrorType2.Uint8Array=60]="Uint8Array",ValueErrorType2[ValueErrorType2.Undefined=61]="Undefined",ValueErrorType2[ValueErrorType2.Union=62]="Union",ValueErrorType2[ValueErrorType2.Void=63]="Void"})(ValueErrorType||(ValueErrorType={}));class ValueErrorsUnknownTypeError extends TypeBoxError{constructor(schema){super("Unknown type");this.schema=schema}}function EscapeKey(key){return key.replace(/~/g,"~0").replace(/\//g,"~1")}function IsDefined2(value){return value!==void 0}class ValueErrorIterator{constructor(iterator){this.iterator=iterator}[Symbol.iterator](){return this.iterator}First(){let next=this.iterator.next();return next.done?void 0:next.value}}function Create(errorType,schema,path,value,errors=[]){return{type:errorType,schema,path,value,message:GetErrorFunction()({errorType,path,schema,value,errors}),errors}}function*FromAny3(schema,references,path,value){}function*FromArgument3(schema,references,path,value){}function*FromArray8(schema,references,path,value){if(!IsArray2(value))return yield Create(ValueErrorType.Array,schema,path,value);if(IsDefined2(schema.minItems)&&!(value.length>=schema.minItems))yield Create(ValueErrorType.ArrayMinItems,schema,path,value);if(IsDefined2(schema.maxItems)&&!(value.length<=schema.maxItems))yield Create(ValueErrorType.ArrayMaxItems,schema,path,value);for(let i=0;i<value.length;i++)yield*Visit6(schema.items,references,`${path}/${i}`,value[i]);if(schema.uniqueItems===!0&&!function(){let set2=new Set;for(let element of value){let hashed=Hash(element);if(set2.has(hashed))return!1;else set2.add(hashed)}return!0}())yield Create(ValueErrorType.ArrayUniqueItems,schema,path,value);if(!(IsDefined2(schema.contains)||IsDefined2(schema.minContains)||IsDefined2(schema.maxContains)))return;let containsSchema=IsDefined2(schema.contains)?schema.contains:Never(),containsCount=value.reduce((acc,value2,index)=>Visit6(containsSchema,references,`${path}${index}`,value2).next().done===!0?acc+1:acc,0);if(containsCount===0)yield Create(ValueErrorType.ArrayContains,schema,path,value);if(IsNumber2(schema.minContains)&&containsCount<schema.minContains)yield Create(ValueErrorType.ArrayMinContains,schema,path,value);if(IsNumber2(schema.maxContains)&&containsCount>schema.maxContains)yield Create(ValueErrorType.ArrayMaxContains,schema,path,value)}function*FromAsyncIterator5(schema,references,path,value){if(!IsAsyncIterator2(value))yield Create(ValueErrorType.AsyncIterator,schema,path,value)}function*FromBigInt3(schema,references,path,value){if(!IsBigInt2(value))return yield Create(ValueErrorType.BigInt,schema,path,value);if(IsDefined2(schema.exclusiveMaximum)&&!(value<schema.exclusiveMaximum))yield Create(ValueErrorType.BigIntExclusiveMaximum,schema,path,value);if(IsDefined2(schema.exclusiveMinimum)&&!(value>schema.exclusiveMinimum))yield Create(ValueErrorType.BigIntExclusiveMinimum,schema,path,value);if(IsDefined2(schema.maximum)&&!(value<=schema.maximum))yield Create(ValueErrorType.BigIntMaximum,schema,path,value);if(IsDefined2(schema.minimum)&&!(value>=schema.minimum))yield Create(ValueErrorType.BigIntMinimum,schema,path,value);if(IsDefined2(schema.multipleOf)&&value%schema.multipleOf!==BigInt(0))yield Create(ValueErrorType.BigIntMultipleOf,schema,path,value)}function*FromBoolean3(schema,references,path,value){if(!IsBoolean2(value))yield Create(ValueErrorType.Boolean,schema,path,value)}function*FromConstructor5(schema,references,path,value){yield*Visit6(schema.returns,references,path,value.prototype)}function*FromDate3(schema,references,path,value){if(!IsDate2(value))return yield Create(ValueErrorType.Date,schema,path,value);if(IsDefined2(schema.exclusiveMaximumTimestamp)&&!(value.getTime()<schema.exclusiveMaximumTimestamp))yield Create(ValueErrorType.DateExclusiveMaximumTimestamp,schema,path,value);if(IsDefined2(schema.exclusiveMinimumTimestamp)&&!(value.getTime()>schema.exclusiveMinimumTimestamp))yield Create(ValueErrorType.DateExclusiveMinimumTimestamp,schema,path,value);if(IsDefined2(schema.maximumTimestamp)&&!(value.getTime()<=schema.maximumTimestamp))yield Create(ValueErrorType.DateMaximumTimestamp,schema,path,value);if(IsDefined2(schema.minimumTimestamp)&&!(value.getTime()>=schema.minimumTimestamp))yield Create(ValueErrorType.DateMinimumTimestamp,schema,path,value);if(IsDefined2(schema.multipleOfTimestamp)&&value.getTime()%schema.multipleOfTimestamp!==0)yield Create(ValueErrorType.DateMultipleOfTimestamp,schema,path,value)}function*FromFunction5(schema,references,path,value){if(!IsFunction2(value))yield Create(ValueErrorType.Function,schema,path,value)}function*FromImport2(schema,references,path,value){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];yield*Visit6(target,[...references,...definitions],path,value)}function*FromInteger3(schema,references,path,value){if(!IsInteger(value))return yield Create(ValueErrorType.Integer,schema,path,value);if(IsDefined2(schema.exclusiveMaximum)&&!(value<schema.exclusiveMaximum))yield Create(ValueErrorType.IntegerExclusiveMaximum,schema,path,value);if(IsDefined2(schema.exclusiveMinimum)&&!(value>schema.exclusiveMinimum))yield Create(ValueErrorType.IntegerExclusiveMinimum,schema,path,value);if(IsDefined2(schema.maximum)&&!(value<=schema.maximum))yield Create(ValueErrorType.IntegerMaximum,schema,path,value);if(IsDefined2(schema.minimum)&&!(value>=schema.minimum))yield Create(ValueErrorType.IntegerMinimum,schema,path,value);if(IsDefined2(schema.multipleOf)&&value%schema.multipleOf!==0)yield Create(ValueErrorType.IntegerMultipleOf,schema,path,value)}function*FromIntersect10(schema,references,path,value){let hasError=!1;for(let inner of schema.allOf)for(let error of Visit6(inner,references,path,value))hasError=!0,yield error;if(hasError)return yield Create(ValueErrorType.Intersect,schema,path,value);if(schema.unevaluatedProperties===!1){let keyCheck=new RegExp(KeyOfPattern(schema));for(let valueKey of Object.getOwnPropertyNames(value))if(!keyCheck.test(valueKey))yield Create(ValueErrorType.IntersectUnevaluatedProperties,schema,`${path}/${valueKey}`,value)}if(typeof schema.unevaluatedProperties==="object"){let keyCheck=new RegExp(KeyOfPattern(schema));for(let valueKey of Object.getOwnPropertyNames(value))if(!keyCheck.test(valueKey)){let next=Visit6(schema.unevaluatedProperties,references,`${path}/${valueKey}`,value[valueKey]).next();if(!next.done)yield next.value}}}function*FromIterator5(schema,references,path,value){if(!IsIterator2(value))yield Create(ValueErrorType.Iterator,schema,path,value)}function*FromLiteral4(schema,references,path,value){if(value!==schema.const)yield Create(ValueErrorType.Literal,schema,path,value)}function*FromNever3(schema,references,path,value){yield Create(ValueErrorType.Never,schema,path,value)}function*FromNot3(schema,references,path,value){if(Visit6(schema.not,references,path,value).next().done===!0)yield Create(ValueErrorType.Not,schema,path,value)}function*FromNull3(schema,references,path,value){if(!IsNull2(value))yield Create(ValueErrorType.Null,schema,path,value)}function*FromNumber3(schema,references,path,value){if(!TypeSystemPolicy.IsNumberLike(value))return yield Create(ValueErrorType.Number,schema,path,value);if(IsDefined2(schema.exclusiveMaximum)&&!(value<schema.exclusiveMaximum))yield Create(ValueErrorType.NumberExclusiveMaximum,schema,path,value);if(IsDefined2(schema.exclusiveMinimum)&&!(value>schema.exclusiveMinimum))yield Create(ValueErrorType.NumberExclusiveMinimum,schema,path,value);if(IsDefined2(schema.maximum)&&!(value<=schema.maximum))yield Create(ValueErrorType.NumberMaximum,schema,path,value);if(IsDefined2(schema.minimum)&&!(value>=schema.minimum))yield Create(ValueErrorType.NumberMinimum,schema,path,value);if(IsDefined2(schema.multipleOf)&&value%schema.multipleOf!==0)yield Create(ValueErrorType.NumberMultipleOf,schema,path,value)}function*FromObject9(schema,references,path,value){if(!TypeSystemPolicy.IsObjectLike(value))return yield Create(ValueErrorType.Object,schema,path,value);if(IsDefined2(schema.minProperties)&&!(Object.getOwnPropertyNames(value).length>=schema.minProperties))yield Create(ValueErrorType.ObjectMinProperties,schema,path,value);if(IsDefined2(schema.maxProperties)&&!(Object.getOwnPropertyNames(value).length<=schema.maxProperties))yield Create(ValueErrorType.ObjectMaxProperties,schema,path,value);let requiredKeys=Array.isArray(schema.required)?schema.required:[],knownKeys=Object.getOwnPropertyNames(schema.properties),unknownKeys=Object.getOwnPropertyNames(value);for(let requiredKey of requiredKeys){if(unknownKeys.includes(requiredKey))continue;yield Create(ValueErrorType.ObjectRequiredProperty,schema.properties[requiredKey],`${path}/${EscapeKey(requiredKey)}`,void 0)}if(schema.additionalProperties===!1){for(let valueKey of unknownKeys)if(!knownKeys.includes(valueKey))yield Create(ValueErrorType.ObjectAdditionalProperties,schema,`${path}/${EscapeKey(valueKey)}`,value[valueKey])}if(typeof schema.additionalProperties==="object")for(let valueKey of unknownKeys){if(knownKeys.includes(valueKey))continue;yield*Visit6(schema.additionalProperties,references,`${path}/${EscapeKey(valueKey)}`,value[valueKey])}for(let knownKey of knownKeys){let property=schema.properties[knownKey];if(schema.required&&schema.required.includes(knownKey)){if(yield*Visit6(property,references,`${path}/${EscapeKey(knownKey)}`,value[knownKey]),ExtendsUndefinedCheck(schema)&&!(knownKey in value))yield Create(ValueErrorType.ObjectRequiredProperty,property,`${path}/${EscapeKey(knownKey)}`,void 0)}else if(TypeSystemPolicy.IsExactOptionalProperty(value,knownKey))yield*Visit6(property,references,`${path}/${EscapeKey(knownKey)}`,value[knownKey])}}function*FromPromise5(schema,references,path,value){if(!IsPromise(value))yield Create(ValueErrorType.Promise,schema,path,value)}function*FromRecord5(schema,references,path,value){if(!TypeSystemPolicy.IsRecordLike(value))return yield Create(ValueErrorType.Object,schema,path,value);if(IsDefined2(schema.minProperties)&&!(Object.getOwnPropertyNames(value).length>=schema.minProperties))yield Create(ValueErrorType.ObjectMinProperties,schema,path,value);if(IsDefined2(schema.maxProperties)&&!(Object.getOwnPropertyNames(value).length<=schema.maxProperties))yield Create(ValueErrorType.ObjectMaxProperties,schema,path,value);let[patternKey,patternSchema]=Object.entries(schema.patternProperties)[0],regex=new RegExp(patternKey);for(let[propertyKey,propertyValue]of Object.entries(value))if(regex.test(propertyKey))yield*Visit6(patternSchema,references,`${path}/${EscapeKey(propertyKey)}`,propertyValue);if(typeof schema.additionalProperties==="object"){for(let[propertyKey,propertyValue]of Object.entries(value))if(!regex.test(propertyKey))yield*Visit6(schema.additionalProperties,references,`${path}/${EscapeKey(propertyKey)}`,propertyValue)}if(schema.additionalProperties===!1)for(let[propertyKey,propertyValue]of Object.entries(value)){if(regex.test(propertyKey))continue;return yield Create(ValueErrorType.ObjectAdditionalProperties,schema,`${path}/${EscapeKey(propertyKey)}`,propertyValue)}}function*FromRef6(schema,references,path,value){yield*Visit6(Deref(schema,references),references,path,value)}function*FromRegExp3(schema,references,path,value){if(!IsString2(value))return yield Create(ValueErrorType.String,schema,path,value);if(IsDefined2(schema.minLength)&&!(value.length>=schema.minLength))yield Create(ValueErrorType.StringMinLength,schema,path,value);if(IsDefined2(schema.maxLength)&&!(value.length<=schema.maxLength))yield Create(ValueErrorType.StringMaxLength,schema,path,value);if(!new RegExp(schema.source,schema.flags).test(value))return yield Create(ValueErrorType.RegExp,schema,path,value)}function*FromString3(schema,references,path,value){if(!IsString2(value))return yield Create(ValueErrorType.String,schema,path,value);if(IsDefined2(schema.minLength)&&!(value.length>=schema.minLength))yield Create(ValueErrorType.StringMinLength,schema,path,value);if(IsDefined2(schema.maxLength)&&!(value.length<=schema.maxLength))yield Create(ValueErrorType.StringMaxLength,schema,path,value);if(IsString2(schema.pattern)){if(!new RegExp(schema.pattern).test(value))yield Create(ValueErrorType.StringPattern,schema,path,value)}if(IsString2(schema.format)){if(!exports_format.Has(schema.format))yield Create(ValueErrorType.StringFormatUnknown,schema,path,value);else if(!exports_format.Get(schema.format)(value))yield Create(ValueErrorType.StringFormat,schema,path,value)}}function*FromSymbol3(schema,references,path,value){if(!IsSymbol2(value))yield Create(ValueErrorType.Symbol,schema,path,value)}function*FromTemplateLiteral5(schema,references,path,value){if(!IsString2(value))return yield Create(ValueErrorType.String,schema,path,value);if(!new RegExp(schema.pattern).test(value))yield Create(ValueErrorType.StringPattern,schema,path,value)}function*FromThis2(schema,references,path,value){yield*Visit6(Deref(schema,references),references,path,value)}function*FromTuple7(schema,references,path,value){if(!IsArray2(value))return yield Create(ValueErrorType.Tuple,schema,path,value);if(schema.items===void 0&&value.length!==0)return yield Create(ValueErrorType.TupleLength,schema,path,value);if(value.length!==schema.maxItems)return yield Create(ValueErrorType.TupleLength,schema,path,value);if(!schema.items)return;for(let i=0;i<schema.items.length;i++)yield*Visit6(schema.items[i],references,`${path}/${i}`,value[i])}function*FromUndefined3(schema,references,path,value){if(!IsUndefined2(value))yield Create(ValueErrorType.Undefined,schema,path,value)}function*FromUnion12(schema,references,path,value){if(Check(schema,references,value))return;let errors=schema.anyOf.map((variant)=>new ValueErrorIterator(Visit6(variant,references,path,value)));yield Create(ValueErrorType.Union,schema,path,value,errors)}function*FromUint8Array3(schema,references,path,value){if(!IsUint8Array2(value))return yield Create(ValueErrorType.Uint8Array,schema,path,value);if(IsDefined2(schema.maxByteLength)&&!(value.length<=schema.maxByteLength))yield Create(ValueErrorType.Uint8ArrayMaxByteLength,schema,path,value);if(IsDefined2(schema.minByteLength)&&!(value.length>=schema.minByteLength))yield Create(ValueErrorType.Uint8ArrayMinByteLength,schema,path,value)}function*FromUnknown3(schema,references,path,value){}function*FromVoid3(schema,references,path,value){if(!TypeSystemPolicy.IsVoidLike(value))yield Create(ValueErrorType.Void,schema,path,value)}function*FromKind2(schema,references,path,value){if(!exports_type2.Get(schema[Kind])(schema,value))yield Create(ValueErrorType.Kind,schema,path,value)}function*Visit6(schema,references,path,value){let references_=IsDefined2(schema.$id)?[...references,schema]:references,schema_=schema;switch(schema_[Kind]){case"Any":return yield*FromAny3(schema_,references_,path,value);case"Argument":return yield*FromArgument3(schema_,references_,path,value);case"Array":return yield*FromArray8(schema_,references_,path,value);case"AsyncIterator":return yield*FromAsyncIterator5(schema_,references_,path,value);case"BigInt":return yield*FromBigInt3(schema_,references_,path,value);case"Boolean":return yield*FromBoolean3(schema_,references_,path,value);case"Constructor":return yield*FromConstructor5(schema_,references_,path,value);case"Date":return yield*FromDate3(schema_,references_,path,value);case"Function":return yield*FromFunction5(schema_,references_,path,value);case"Import":return yield*FromImport2(schema_,references_,path,value);case"Integer":return yield*FromInteger3(schema_,references_,path,value);case"Intersect":return yield*FromIntersect10(schema_,references_,path,value);case"Iterator":return yield*FromIterator5(schema_,references_,path,value);case"Literal":return yield*FromLiteral4(schema_,references_,path,value);case"Never":return yield*FromNever3(schema_,references_,path,value);case"Not":return yield*FromNot3(schema_,references_,path,value);case"Null":return yield*FromNull3(schema_,references_,path,value);case"Number":return yield*FromNumber3(schema_,references_,path,value);case"Object":return yield*FromObject9(schema_,references_,path,value);case"Promise":return yield*FromPromise5(schema_,references_,path,value);case"Record":return yield*FromRecord5(schema_,references_,path,value);case"Ref":return yield*FromRef6(schema_,references_,path,value);case"RegExp":return yield*FromRegExp3(schema_,references_,path,value);case"String":return yield*FromString3(schema_,references_,path,value);case"Symbol":return yield*FromSymbol3(schema_,references_,path,value);case"TemplateLiteral":return yield*FromTemplateLiteral5(schema_,references_,path,value);case"This":return yield*FromThis2(schema_,references_,path,value);case"Tuple":return yield*FromTuple7(schema_,references_,path,value);case"Undefined":return yield*FromUndefined3(schema_,references_,path,value);case"Union":return yield*FromUnion12(schema_,references_,path,value);case"Uint8Array":return yield*FromUint8Array3(schema_,references_,path,value);case"Unknown":return yield*FromUnknown3(schema_,references_,path,value);case"Void":return yield*FromVoid3(schema_,references_,path,value);default:if(!exports_type2.Has(schema_[Kind]))throw new ValueErrorsUnknownTypeError(schema);return yield*FromKind2(schema_,references_,path,value)}}function Errors(...args){let iterator=args.length===3?Visit6(args[0],args[1],"",args[2]):Visit6(args[0],[],"",args[1]);return new ValueErrorIterator(iterator)}class TransformDecodeCheckError extends TypeBoxError{constructor(schema,value,error){super("Unable to decode value as it does not match the expected schema");this.schema=schema,this.value=value,this.error=error}}class TransformDecodeError extends TypeBoxError{constructor(schema,path,value,error){super(error instanceof Error?error.message:"Unknown error");this.schema=schema,this.path=path,this.value=value,this.error=error}}function Default(schema,path,value){try{return IsTransform(schema)?schema[TransformKind].Decode(value):value}catch(error){throw new TransformDecodeError(schema,path,value,error)}}function FromArray9(schema,references,path,value){return IsArray2(value)?Default(schema,path,value.map((value2,index)=>Visit7(schema.items,references,`${path}/${index}`,value2))):Default(schema,path,value)}function FromIntersect11(schema,references,path,value){if(!IsObject2(value)||IsValueType(value))return Default(schema,path,value);let knownEntries=KeyOfPropertyEntries(schema),knownKeys=knownEntries.map((entry)=>entry[0]),knownProperties={...value};for(let[knownKey,knownSchema]of knownEntries)if(knownKey in knownProperties)knownProperties[knownKey]=Visit7(knownSchema,references,`${path}/${knownKey}`,knownProperties[knownKey]);if(!IsTransform(schema.unevaluatedProperties))return Default(schema,path,knownProperties);let unknownKeys=Object.getOwnPropertyNames(knownProperties),unevaluatedProperties=schema.unevaluatedProperties,unknownProperties={...knownProperties};for(let key of unknownKeys)if(!knownKeys.includes(key))unknownProperties[key]=Default(unevaluatedProperties,`${path}/${key}`,unknownProperties[key]);return Default(schema,path,unknownProperties)}function FromImport3(schema,references,path,value){let additional=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref],result=Visit7(target,[...references,...additional],path,value);return Default(schema,path,result)}function FromNot4(schema,references,path,value){return Default(schema,path,Visit7(schema.not,references,path,value))}function FromObject10(schema,references,path,value){if(!IsObject2(value))return Default(schema,path,value);let knownKeys=KeyOfPropertyKeys(schema),knownProperties={...value};for(let key of knownKeys){if(!HasPropertyKey2(knownProperties,key))continue;if(IsUndefined2(knownProperties[key])&&(!IsUndefined3(schema.properties[key])||TypeSystemPolicy.IsExactOptionalProperty(knownProperties,key)))continue;knownProperties[key]=Visit7(schema.properties[key],references,`${path}/${key}`,knownProperties[key])}if(!IsSchema(schema.additionalProperties))return Default(schema,path,knownProperties);let unknownKeys=Object.getOwnPropertyNames(knownProperties),additionalProperties=schema.additionalProperties,unknownProperties={...knownProperties};for(let key of unknownKeys)if(!knownKeys.includes(key))unknownProperties[key]=Default(additionalProperties,`${path}/${key}`,unknownProperties[key]);return Default(schema,path,unknownProperties)}function FromRecord6(schema,references,path,value){if(!IsObject2(value))return Default(schema,path,value);let pattern=Object.getOwnPropertyNames(schema.patternProperties)[0],knownKeys=new RegExp(pattern),knownProperties={...value};for(let key of Object.getOwnPropertyNames(value))if(knownKeys.test(key))knownProperties[key]=Visit7(schema.patternProperties[pattern],references,`${path}/${key}`,knownProperties[key]);if(!IsSchema(schema.additionalProperties))return Default(schema,path,knownProperties);let unknownKeys=Object.getOwnPropertyNames(knownProperties),additionalProperties=schema.additionalProperties,unknownProperties={...knownProperties};for(let key of unknownKeys)if(!knownKeys.test(key))unknownProperties[key]=Default(additionalProperties,`${path}/${key}`,unknownProperties[key]);return Default(schema,path,unknownProperties)}function FromRef7(schema,references,path,value){let target=Deref(schema,references);return Default(schema,path,Visit7(target,references,path,value))}function FromThis3(schema,references,path,value){let target=Deref(schema,references);return Default(schema,path,Visit7(target,references,path,value))}function FromTuple8(schema,references,path,value){return IsArray2(value)&&IsArray2(schema.items)?Default(schema,path,schema.items.map((schema2,index)=>Visit7(schema2,references,`${path}/${index}`,value[index]))):Default(schema,path,value)}function FromUnion13(schema,references,path,value){for(let subschema of schema.anyOf){if(!Check(subschema,references,value))continue;let decoded=Visit7(subschema,references,path,value);return Default(schema,path,decoded)}return Default(schema,path,value)}function Visit7(schema,references,path,value){let references_=Pushref(schema,references),schema_=schema;switch(schema[Kind]){case"Array":return FromArray9(schema_,references_,path,value);case"Import":return FromImport3(schema_,references_,path,value);case"Intersect":return FromIntersect11(schema_,references_,path,value);case"Not":return FromNot4(schema_,references_,path,value);case"Object":return FromObject10(schema_,references_,path,value);case"Record":return FromRecord6(schema_,references_,path,value);case"Ref":return FromRef7(schema_,references_,path,value);case"Symbol":return Default(schema_,path,value);case"This":return FromThis3(schema_,references_,path,value);case"Tuple":return FromTuple8(schema_,references_,path,value);case"Union":return FromUnion13(schema_,references_,path,value);default:return Default(schema_,path,value)}}function TransformDecode(schema,references,value){return Visit7(schema,references,"",value)}class TransformEncodeCheckError extends TypeBoxError{constructor(schema,value,error){super("The encoded value does not match the expected schema");this.schema=schema,this.value=value,this.error=error}}class TransformEncodeError extends TypeBoxError{constructor(schema,path,value,error){super(`${error instanceof Error?error.message:"Unknown error"}`);this.schema=schema,this.path=path,this.value=value,this.error=error}}function Default2(schema,path,value){try{return IsTransform(schema)?schema[TransformKind].Encode(value):value}catch(error){throw new TransformEncodeError(schema,path,value,error)}}function FromArray10(schema,references,path,value){let defaulted=Default2(schema,path,value);return IsArray2(defaulted)?defaulted.map((value2,index)=>Visit8(schema.items,references,`${path}/${index}`,value2)):defaulted}function FromImport4(schema,references,path,value){let additional=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref],result=Default2(schema,path,value);return Visit8(target,[...references,...additional],path,result)}function FromIntersect12(schema,references,path,value){let defaulted=Default2(schema,path,value);if(!IsObject2(value)||IsValueType(value))return defaulted;let knownEntries=KeyOfPropertyEntries(schema),knownKeys=knownEntries.map((entry)=>entry[0]),knownProperties={...defaulted};for(let[knownKey,knownSchema]of knownEntries)if(knownKey in knownProperties)knownProperties[knownKey]=Visit8(knownSchema,references,`${path}/${knownKey}`,knownProperties[knownKey]);if(!IsTransform(schema.unevaluatedProperties))return knownProperties;let unknownKeys=Object.getOwnPropertyNames(knownProperties),unevaluatedProperties=schema.unevaluatedProperties,properties={...knownProperties};for(let key of unknownKeys)if(!knownKeys.includes(key))properties[key]=Default2(unevaluatedProperties,`${path}/${key}`,properties[key]);return properties}function FromNot5(schema,references,path,value){return Default2(schema.not,path,Default2(schema,path,value))}function FromObject11(schema,references,path,value){let defaulted=Default2(schema,path,value);if(!IsObject2(defaulted))return defaulted;let knownKeys=KeyOfPropertyKeys(schema),knownProperties={...defaulted};for(let key of knownKeys){if(!HasPropertyKey2(knownProperties,key))continue;if(IsUndefined2(knownProperties[key])&&(!IsUndefined3(schema.properties[key])||TypeSystemPolicy.IsExactOptionalProperty(knownProperties,key)))continue;knownProperties[key]=Visit8(schema.properties[key],references,`${path}/${key}`,knownProperties[key])}if(!IsSchema(schema.additionalProperties))return knownProperties;let unknownKeys=Object.getOwnPropertyNames(knownProperties),additionalProperties=schema.additionalProperties,properties={...knownProperties};for(let key of unknownKeys)if(!knownKeys.includes(key))properties[key]=Default2(additionalProperties,`${path}/${key}`,properties[key]);return properties}function FromRecord7(schema,references,path,value){let defaulted=Default2(schema,path,value);if(!IsObject2(value))return defaulted;let pattern=Object.getOwnPropertyNames(schema.patternProperties)[0],knownKeys=new RegExp(pattern),knownProperties={...defaulted};for(let key of Object.getOwnPropertyNames(value))if(knownKeys.test(key))knownProperties[key]=Visit8(schema.patternProperties[pattern],references,`${path}/${key}`,knownProperties[key]);if(!IsSchema(schema.additionalProperties))return knownProperties;let unknownKeys=Object.getOwnPropertyNames(knownProperties),additionalProperties=schema.additionalProperties,properties={...knownProperties};for(let key of unknownKeys)if(!knownKeys.test(key))properties[key]=Default2(additionalProperties,`${path}/${key}`,properties[key]);return properties}function FromRef8(schema,references,path,value){let target=Deref(schema,references),resolved=Visit8(target,references,path,value);return Default2(schema,path,resolved)}function FromThis4(schema,references,path,value){let target=Deref(schema,references),resolved=Visit8(target,references,path,value);return Default2(schema,path,resolved)}function FromTuple9(schema,references,path,value){let value1=Default2(schema,path,value);return IsArray2(schema.items)?schema.items.map((schema2,index)=>Visit8(schema2,references,`${path}/${index}`,value1[index])):[]}function FromUnion14(schema,references,path,value){for(let subschema of schema.anyOf){if(!Check(subschema,references,value))continue;let value1=Visit8(subschema,references,path,value);return Default2(schema,path,value1)}for(let subschema of schema.anyOf){let value1=Visit8(subschema,references,path,value);if(!Check(schema,references,value1))continue;return Default2(schema,path,value1)}return Default2(schema,path,value)}function Visit8(schema,references,path,value){let references_=Pushref(schema,references),schema_=schema;switch(schema[Kind]){case"Array":return FromArray10(schema_,references_,path,value);case"Import":return FromImport4(schema_,references_,path,value);case"Intersect":return FromIntersect12(schema_,references_,path,value);case"Not":return FromNot5(schema_,references_,path,value);case"Object":return FromObject11(schema_,references_,path,value);case"Record":return FromRecord7(schema_,references_,path,value);case"Ref":return FromRef8(schema_,references_,path,value);case"This":return FromThis4(schema_,references_,path,value);case"Tuple":return FromTuple9(schema_,references_,path,value);case"Union":return FromUnion14(schema_,references_,path,value);default:return Default2(schema_,path,value)}}function TransformEncode(schema,references,value){return Visit8(schema,references,"",value)}function FromArray11(schema,references){return IsTransform(schema)||Visit9(schema.items,references)}function FromAsyncIterator6(schema,references){return IsTransform(schema)||Visit9(schema.items,references)}function FromConstructor6(schema,references){return IsTransform(schema)||Visit9(schema.returns,references)||schema.parameters.some((schema2)=>Visit9(schema2,references))}function FromFunction6(schema,references){return IsTransform(schema)||Visit9(schema.returns,references)||schema.parameters.some((schema2)=>Visit9(schema2,references))}function FromIntersect13(schema,references){return IsTransform(schema)||IsTransform(schema.unevaluatedProperties)||schema.allOf.some((schema2)=>Visit9(schema2,references))}function FromImport5(schema,references){let additional=globalThis.Object.getOwnPropertyNames(schema.$defs).reduce((result,key)=>[...result,schema.$defs[key]],[]),target=schema.$defs[schema.$ref];return IsTransform(schema)||Visit9(target,[...additional,...references])}function FromIterator6(schema,references){return IsTransform(schema)||Visit9(schema.items,references)}function FromNot6(schema,references){return IsTransform(schema)||Visit9(schema.not,references)}function FromObject12(schema,references){return IsTransform(schema)||Object.values(schema.properties).some((schema2)=>Visit9(schema2,references))||IsSchema(schema.additionalProperties)&&Visit9(schema.additionalProperties,references)}function FromPromise6(schema,references){return IsTransform(schema)||Visit9(schema.item,references)}function FromRecord8(schema,references){let pattern=Object.getOwnPropertyNames(schema.patternProperties)[0],property=schema.patternProperties[pattern];return IsTransform(schema)||Visit9(property,references)||IsSchema(schema.additionalProperties)&&IsTransform(schema.additionalProperties)}function FromRef9(schema,references){if(IsTransform(schema))return!0;return Visit9(Deref(schema,references),references)}function FromThis5(schema,references){if(IsTransform(schema))return!0;return Visit9(Deref(schema,references),references)}function FromTuple10(schema,references){return IsTransform(schema)||!IsUndefined2(schema.items)&&schema.items.some((schema2)=>Visit9(schema2,references))}function FromUnion15(schema,references){return IsTransform(schema)||schema.anyOf.some((schema2)=>Visit9(schema2,references))}function Visit9(schema,references){let references_=Pushref(schema,references),schema_=schema;if(schema.$id&&visited.has(schema.$id))return!1;if(schema.$id)visited.add(schema.$id);switch(schema[Kind]){case"Array":return FromArray11(schema_,references_);case"AsyncIterator":return FromAsyncIterator6(schema_,references_);case"Constructor":return FromConstructor6(schema_,references_);case"Function":return FromFunction6(schema_,references_);case"Import":return FromImport5(schema_,references_);case"Intersect":return FromIntersect13(schema_,references_);case"Iterator":return FromIterator6(schema_,references_);case"Not":return FromNot6(schema_,references_);case"Object":return FromObject12(schema_,references_);case"Promise":return FromPromise6(schema_,references_);case"Record":return FromRecord8(schema_,references_);case"Ref":return FromRef9(schema_,references_);case"This":return FromThis5(schema_,references_);case"Tuple":return FromTuple10(schema_,references_);case"Union":return FromUnion15(schema_,references_);default:return IsTransform(schema)}}var visited=new Set;function HasTransform(schema,references){return visited.clear(),Visit9(schema,references)}class TypeCheck{constructor(schema,references,checkFunc,code){this.schema=schema,this.references=references,this.checkFunc=checkFunc,this.code=code,this.hasTransform=HasTransform(schema,references)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(value){return Errors(this.schema,this.references,value)}Check(value){return this.checkFunc(value)}Decode(value){if(!this.checkFunc(value))throw new TransformDecodeCheckError(this.schema,value,this.Errors(value).First());return this.hasTransform?TransformDecode(this.schema,this.references,value):value}Encode(value){let encoded=this.hasTransform?TransformEncode(this.schema,this.references,value):value;if(!this.checkFunc(encoded))throw new TransformEncodeCheckError(this.schema,value,this.Errors(value).First());return encoded}}var Character;(function(Character2){function DollarSign(code){return code===36}Character2.DollarSign=DollarSign;function IsUnderscore(code){return code===95}Character2.IsUnderscore=IsUnderscore;function IsAlpha(code){return code>=65&&code<=90||code>=97&&code<=122}Character2.IsAlpha=IsAlpha;function IsNumeric(code){return code>=48&&code<=57}Character2.IsNumeric=IsNumeric})(Character||(Character={}));var MemberExpression;(function(MemberExpression2){function IsFirstCharacterNumeric(value){if(value.length===0)return!1;return Character.IsNumeric(value.charCodeAt(0))}function IsAccessor(value){if(IsFirstCharacterNumeric(value))return!1;for(let i=0;i<value.length;i++){let code=value.charCodeAt(i);if(!(Character.IsAlpha(code)||Character.IsNumeric(code)||Character.DollarSign(code)||Character.IsUnderscore(code)))return!1}return!0}function EscapeHyphen(key){return key.replace(/'/g,"\\'")}function Encode(object,key){return IsAccessor(key)?`${object}.${key}`:`${object}['${EscapeHyphen(key)}']`}MemberExpression2.Encode=Encode})(MemberExpression||(MemberExpression={}));var Identifier;(function(Identifier2){function Encode($id){let buffer=[];for(let i=0;i<$id.length;i++){let code=$id.charCodeAt(i);if(Character.IsNumeric(code)||Character.IsAlpha(code))buffer.push($id.charAt(i));else buffer.push(`_${code}_`)}return buffer.join("").replace(/__/g,"_")}Identifier2.Encode=Encode})(Identifier||(Identifier={}));var LiteralString;(function(LiteralString2){function Escape2(content){return content.replace(/'/g,"\\'")}LiteralString2.Escape=Escape2})(LiteralString||(LiteralString={}));class TypeCompilerUnknownTypeError extends TypeBoxError{constructor(schema){super("Unknown type");this.schema=schema}}class TypeCompilerTypeGuardError extends TypeBoxError{constructor(schema){super("Preflight validation check failed to guard for the given schema");this.schema=schema}}var Policy;(function(Policy2){function IsExactOptionalProperty(value,key,expression){return TypeSystemPolicy.ExactOptionalPropertyTypes?`('${key}' in ${value} ? ${expression} : true)`:`(${MemberExpression.Encode(value,key)} !== undefined ? ${expression} : true)`}Policy2.IsExactOptionalProperty=IsExactOptionalProperty;function IsObjectLike(value){return!TypeSystemPolicy.AllowArrayObject?`(typeof ${value} === 'object' && ${value} !== null && !Array.isArray(${value}))`:`(typeof ${value} === 'object' && ${value} !== null)`}Policy2.IsObjectLike=IsObjectLike;function IsRecordLike(value){return!TypeSystemPolicy.AllowArrayObject?`(typeof ${value} === 'object' && ${value} !== null && !Array.isArray(${value}) && !(${value} instanceof Date) && !(${value} instanceof Uint8Array))`:`(typeof ${value} === 'object' && ${value} !== null && !(${value} instanceof Date) && !(${value} instanceof Uint8Array))`}Policy2.IsRecordLike=IsRecordLike;function IsNumberLike(value){return TypeSystemPolicy.AllowNaN?`typeof ${value} === 'number'`:`Number.isFinite(${value})`}Policy2.IsNumberLike=IsNumberLike;function IsVoidLike(value){return TypeSystemPolicy.AllowNullVoid?`(${value} === undefined || ${value} === null)`:`${value} === undefined`}Policy2.IsVoidLike=IsVoidLike})(Policy||(Policy={}));var TypeCompiler;(function(TypeCompiler2){function IsAnyOrUnknown2(schema){return schema[Kind]==="Any"||schema[Kind]==="Unknown"}function*FromAny4(schema,references,value){yield"true"}function*FromArgument4(schema,references,value){yield"true"}function*FromArray12(schema,references,value){yield`Array.isArray(${value})`;let[parameter,accumulator]=[CreateParameter("value","any"),CreateParameter("acc","number")];if(IsNumber2(schema.maxItems))yield`${value}.length <= ${schema.maxItems}`;if(IsNumber2(schema.minItems))yield`${value}.length >= ${schema.minItems}`;let elementExpression=CreateExpression(schema.items,references,"value");if(yield`${value}.every((${parameter}) => ${elementExpression})`,IsSchema2(schema.contains)||IsNumber2(schema.minContains)||IsNumber2(schema.maxContains)){let containsSchema=IsSchema2(schema.contains)?schema.contains:Never(),checkExpression=CreateExpression(containsSchema,references,"value"),checkMinContains=IsNumber2(schema.minContains)?[`(count >= ${schema.minContains})`]:[],checkMaxContains=IsNumber2(schema.maxContains)?[`(count <= ${schema.maxContains})`]:[],checkCount=`const count = value.reduce((${accumulator}, ${parameter}) => ${checkExpression} ? acc + 1 : acc, 0)`,check=["(count > 0)",...checkMinContains,...checkMaxContains].join(" && ");yield`((${parameter}) => { ${checkCount}; return ${check}})(${value})`}if(schema.uniqueItems===!0)yield`((${parameter}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${value})`}function*FromAsyncIterator7(schema,references,value){yield`(typeof value === 'object' && Symbol.asyncIterator in ${value})`}function*FromBigInt4(schema,references,value){if(yield`(typeof ${value} === 'bigint')`,IsBigInt2(schema.exclusiveMaximum))yield`${value} < BigInt(${schema.exclusiveMaximum})`;if(IsBigInt2(schema.exclusiveMinimum))yield`${value} > BigInt(${schema.exclusiveMinimum})`;if(IsBigInt2(schema.maximum))yield`${value} <= BigInt(${schema.maximum})`;if(IsBigInt2(schema.minimum))yield`${value} >= BigInt(${schema.minimum})`;if(IsBigInt2(schema.multipleOf))yield`(${value} % BigInt(${schema.multipleOf})) === 0`}function*FromBoolean4(schema,references,value){yield`(typeof ${value} === 'boolean')`}function*FromConstructor7(schema,references,value){yield*Visit10(schema.returns,references,`${value}.prototype`)}function*FromDate4(schema,references,value){if(yield`(${value} instanceof Date) && Number.isFinite(${value}.getTime())`,IsNumber2(schema.exclusiveMaximumTimestamp))yield`${value}.getTime() < ${schema.exclusiveMaximumTimestamp}`;if(IsNumber2(schema.exclusiveMinimumTimestamp))yield`${value}.getTime() > ${schema.exclusiveMinimumTimestamp}`;if(IsNumber2(schema.maximumTimestamp))yield`${value}.getTime() <= ${schema.maximumTimestamp}`;if(IsNumber2(schema.minimumTimestamp))yield`${value}.getTime() >= ${schema.minimumTimestamp}`;if(IsNumber2(schema.multipleOfTimestamp))yield`(${value}.getTime() % ${schema.multipleOfTimestamp}) === 0`}function*FromFunction7(schema,references,value){yield`(typeof ${value} === 'function')`}function*FromImport6(schema,references,value){let members=globalThis.Object.getOwnPropertyNames(schema.$defs).reduce((result,key)=>{return[...result,schema.$defs[key]]},[]);yield*Visit10(Ref(schema.$ref),[...references,...members],value)}function*FromInteger4(schema,references,value){if(yield`Number.isInteger(${value})`,IsNumber2(schema.exclusiveMaximum))yield`${value} < ${schema.exclusiveMaximum}`;if(IsNumber2(schema.exclusiveMinimum))yield`${value} > ${schema.exclusiveMinimum}`;if(IsNumber2(schema.maximum))yield`${value} <= ${schema.maximum}`;if(IsNumber2(schema.minimum))yield`${value} >= ${schema.minimum}`;if(IsNumber2(schema.multipleOf))yield`(${value} % ${schema.multipleOf}) === 0`}function*FromIntersect14(schema,references,value){let check1=schema.allOf.map((schema2)=>CreateExpression(schema2,references,value)).join(" && ");if(schema.unevaluatedProperties===!1){let keyCheck=CreateVariable(`${new RegExp(KeyOfPattern(schema))};`),check2=`Object.getOwnPropertyNames(${value}).every(key => ${keyCheck}.test(key))`;yield`(${check1} && ${check2})`}else if(IsSchema2(schema.unevaluatedProperties)){let keyCheck=CreateVariable(`${new RegExp(KeyOfPattern(schema))};`),check2=`Object.getOwnPropertyNames(${value}).every(key => ${keyCheck}.test(key) || ${CreateExpression(schema.unevaluatedProperties,references,`${value}[key]`)})`;yield`(${check1} && ${check2})`}else yield`(${check1})`}function*FromIterator7(schema,references,value){yield`(typeof value === 'object' && Symbol.iterator in ${value})`}function*FromLiteral5(schema,references,value){if(typeof schema.const==="number"||typeof schema.const==="boolean")yield`(${value} === ${schema.const})`;else yield`(${value} === '${LiteralString.Escape(schema.const)}')`}function*FromNever4(schema,references,value){yield"false"}function*FromNot7(schema,references,value){yield`(!${CreateExpression(schema.not,references,value)})`}function*FromNull4(schema,references,value){yield`(${value} === null)`}function*FromNumber4(schema,references,value){if(yield Policy.IsNumberLike(value),IsNumber2(schema.exclusiveMaximum))yield`${value} < ${schema.exclusiveMaximum}`;if(IsNumber2(schema.exclusiveMinimum))yield`${value} > ${schema.exclusiveMinimum}`;if(IsNumber2(schema.maximum))yield`${value} <= ${schema.maximum}`;if(IsNumber2(schema.minimum))yield`${value} >= ${schema.minimum}`;if(IsNumber2(schema.multipleOf))yield`(${value} % ${schema.multipleOf}) === 0`}function*FromObject13(schema,references,value){if(yield Policy.IsObjectLike(value),IsNumber2(schema.minProperties))yield`Object.getOwnPropertyNames(${value}).length >= ${schema.minProperties}`;if(IsNumber2(schema.maxProperties))yield`Object.getOwnPropertyNames(${value}).length <= ${schema.maxProperties}`;let knownKeys=Object.getOwnPropertyNames(schema.properties);for(let knownKey of knownKeys){let memberExpression=MemberExpression.Encode(value,knownKey),property=schema.properties[knownKey];if(schema.required&&schema.required.includes(knownKey)){if(yield*Visit10(property,references,memberExpression),ExtendsUndefinedCheck(property)||IsAnyOrUnknown2(property))yield`('${knownKey}' in ${value})`}else{let expression=CreateExpression(property,references,memberExpression);yield Policy.IsExactOptionalProperty(value,knownKey,expression)}}if(schema.additionalProperties===!1)if(schema.required&&schema.required.length===knownKeys.length)yield`Object.getOwnPropertyNames(${value}).length === ${knownKeys.length}`;else{let keys=`[${knownKeys.map((key)=>`'${key}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${value}).every(key => ${keys}.includes(key))`}if(typeof schema.additionalProperties==="object"){let expression=CreateExpression(schema.additionalProperties,references,`${value}[key]`),keys=`[${knownKeys.map((key)=>`'${key}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${value}).every(key => ${keys}.includes(key) || ${expression}))`}}function*FromPromise7(schema,references,value){yield`${value} instanceof Promise`}function*FromRecord9(schema,references,value){if(yield Policy.IsRecordLike(value),IsNumber2(schema.minProperties))yield`Object.getOwnPropertyNames(${value}).length >= ${schema.minProperties}`;if(IsNumber2(schema.maxProperties))yield`Object.getOwnPropertyNames(${value}).length <= ${schema.maxProperties}`;let[patternKey,patternSchema]=Object.entries(schema.patternProperties)[0],variable=CreateVariable(`${new RegExp(patternKey)}`),check1=CreateExpression(patternSchema,references,"value"),check2=IsSchema2(schema.additionalProperties)?CreateExpression(schema.additionalProperties,references,value):schema.additionalProperties===!1?"false":"true",expression=`(${variable}.test(key) ? ${check1} : ${check2})`;yield`(Object.entries(${value}).every(([key, value]) => ${expression}))`}function*FromRef10(schema,references,value){let target=Deref(schema,references);if(state.functions.has(schema.$ref))return yield`${CreateFunctionName(schema.$ref)}(${value})`;yield*Visit10(target,references,value)}function*FromRegExp4(schema,references,value){let variable=CreateVariable(`${new RegExp(schema.source,schema.flags)};`);if(yield`(typeof ${value} === 'string')`,IsNumber2(schema.maxLength))yield`${value}.length <= ${schema.maxLength}`;if(IsNumber2(schema.minLength))yield`${value}.length >= ${schema.minLength}`;yield`${variable}.test(${value})`}function*FromString4(schema,references,value){if(yield`(typeof ${value} === 'string')`,IsNumber2(schema.maxLength))yield`${value}.length <= ${schema.maxLength}`;if(IsNumber2(schema.minLength))yield`${value}.length >= ${schema.minLength}`;if(schema.pattern!==void 0)yield`${CreateVariable(`${new RegExp(schema.pattern)};`)}.test(${value})`;if(schema.format!==void 0)yield`format('${schema.format}', ${value})`}function*FromSymbol4(schema,references,value){yield`(typeof ${value} === 'symbol')`}function*FromTemplateLiteral6(schema,references,value){yield`(typeof ${value} === 'string')`,yield`${CreateVariable(`${new RegExp(schema.pattern)};`)}.test(${value})`}function*FromThis6(schema,references,value){yield`${CreateFunctionName(schema.$ref)}(${value})`}function*FromTuple11(schema,references,value){if(yield`Array.isArray(${value})`,schema.items===void 0)return yield`${value}.length === 0`;yield`(${value}.length === ${schema.maxItems})`;for(let i=0;i<schema.items.length;i++)yield`${CreateExpression(schema.items[i],references,`${value}[${i}]`)}`}function*FromUndefined4(schema,references,value){yield`${value} === undefined`}function*FromUnion16(schema,references,value){yield`(${schema.anyOf.map((schema2)=>CreateExpression(schema2,references,value)).join(" || ")})`}function*FromUint8Array4(schema,references,value){if(yield`${value} instanceof Uint8Array`,IsNumber2(schema.maxByteLength))yield`(${value}.length <= ${schema.maxByteLength})`;if(IsNumber2(schema.minByteLength))yield`(${value}.length >= ${schema.minByteLength})`}function*FromUnknown4(schema,references,value){yield"true"}function*FromVoid4(schema,references,value){yield Policy.IsVoidLike(value)}function*FromKind3(schema,references,value){let instance=state.instances.size;state.instances.set(instance,schema),yield`kind('${schema[Kind]}', ${instance}, ${value})`}function*Visit10(schema,references,value,useHoisting=!0){let references_=IsString2(schema.$id)?[...references,schema]:references,schema_=schema;if(useHoisting&&IsString2(schema.$id)){let functionName=CreateFunctionName(schema.$id);if(state.functions.has(functionName))return yield`${functionName}(${value})`;else{state.functions.set(functionName,"<deferred>");let functionCode=CreateFunction(functionName,schema,references,"value",!1);return state.functions.set(functionName,functionCode),yield`${functionName}(${value})`}}switch(schema_[Kind]){case"Any":return yield*FromAny4(schema_,references_,value);case"Argument":return yield*FromArgument4(schema_,references_,value);case"Array":return yield*FromArray12(schema_,references_,value);case"AsyncIterator":return yield*FromAsyncIterator7(schema_,references_,value);case"BigInt":return yield*FromBigInt4(schema_,references_,value);case"Boolean":return yield*FromBoolean4(schema_,references_,value);case"Constructor":return yield*FromConstructor7(schema_,references_,value);case"Date":return yield*FromDate4(schema_,references_,value);case"Function":return yield*FromFunction7(schema_,references_,value);case"Import":return yield*FromImport6(schema_,references_,value);case"Integer":return yield*FromInteger4(schema_,references_,value);case"Intersect":return yield*FromIntersect14(schema_,references_,value);case"Iterator":return yield*FromIterator7(schema_,references_,value);case"Literal":return yield*FromLiteral5(schema_,references_,value);case"Never":return yield*FromNever4(schema_,references_,value);case"Not":return yield*FromNot7(schema_,references_,value);case"Null":return yield*FromNull4(schema_,references_,value);case"Number":return yield*FromNumber4(schema_,references_,value);case"Object":return yield*FromObject13(schema_,references_,value);case"Promise":return yield*FromPromise7(schema_,references_,value);case"Record":return yield*FromRecord9(schema_,references_,value);case"Ref":return yield*FromRef10(schema_,references_,value);case"RegExp":return yield*FromRegExp4(schema_,references_,value);case"String":return yield*FromString4(schema_,references_,value);case"Symbol":return yield*FromSymbol4(schema_,references_,value);case"TemplateLiteral":return yield*FromTemplateLiteral6(schema_,references_,value);case"This":return yield*FromThis6(schema_,references_,value);case"Tuple":return yield*FromTuple11(schema_,references_,value);case"Undefined":return yield*FromUndefined4(schema_,references_,value);case"Union":return yield*FromUnion16(schema_,references_,value);case"Uint8Array":return yield*FromUint8Array4(schema_,references_,value);case"Unknown":return yield*FromUnknown4(schema_,references_,value);case"Void":return yield*FromVoid4(schema_,references_,value);default:if(!exports_type2.Has(schema_[Kind]))throw new TypeCompilerUnknownTypeError(schema);return yield*FromKind3(schema_,references_,value)}}let state={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function CreateExpression(schema,references,value,useHoisting=!0){return`(${[...Visit10(schema,references,value,useHoisting)].join(" && ")})`}function CreateFunctionName($id){return`check_${Identifier.Encode($id)}`}function CreateVariable(expression){let variableName=`local_${state.variables.size}`;return state.variables.set(variableName,`const ${variableName} = ${expression}`),variableName}function CreateFunction(name,schema,references,value,useHoisting=!0){let[newline,pad]=[`
`,(length)=>"".padStart(length," ")],parameter=CreateParameter("value","any"),returns=CreateReturns("boolean"),expression=[...Visit10(schema,references,value,useHoisting)].map((expression2)=>`${pad(4)}${expression2}`).join(` &&${newline}`);return`function ${name}(${parameter})${returns} {${newline}${pad(2)}return (${newline}${expression}${newline}${pad(2)})
}`}function CreateParameter(name,type){let annotation=state.language==="typescript"?`: ${type}`:"";return`${name}${annotation}`}function CreateReturns(type){return state.language==="typescript"?`: ${type}`:""}function Build(schema,references,options){let functionCode=CreateFunction("check",schema,references,"value"),parameter=CreateParameter("value","any"),returns=CreateReturns("boolean"),functions=[...state.functions.values()],variables=[...state.variables.values()],checkFunction=IsString2(schema.$id)?`return function check(${parameter})${returns} {
  return ${CreateFunctionName(schema.$id)}(value)
}`:`return ${functionCode}`;return[...variables,...functions,checkFunction].join(`
`)}function Code(...args){let defaults={language:"javascript"},[schema,references,options]=args.length===2&&IsArray2(args[1])?[args[0],args[1],defaults]:args.length===2&&!IsArray2(args[1])?[args[0],[],args[1]]:args.length===3?[args[0],args[1],args[2]]:args.length===1?[args[0],[],defaults]:[null,[],defaults];if(state.language=options.language,state.variables.clear(),state.functions.clear(),state.instances.clear(),!IsSchema2(schema))throw new TypeCompilerTypeGuardError(schema);for(let schema2 of references)if(!IsSchema2(schema2))throw new TypeCompilerTypeGuardError(schema2);return Build(schema,references,options)}TypeCompiler2.Code=Code;function Compile(schema,references=[]){let generatedCode=Code(schema,references,{language:"javascript"}),compiledFunction=globalThis.Function("kind","format","hash",generatedCode),instances=new Map(state.instances);function typeRegistryFunction(kind,instance,value){if(!exports_type2.Has(kind)||!instances.has(instance))return!1;let checkFunc=exports_type2.Get(kind),schema2=instances.get(instance);return checkFunc(schema2,value)}function formatRegistryFunction(format,value){if(!exports_format.Has(format))return!1;return exports_format.Get(format)(value)}function hashFunction(value){return Hash(value)}let checkFunction=compiledFunction(typeRegistryFunction,formatRegistryFunction,hashFunction);return new TypeCheck(schema,references,checkFunction,generatedCode)}TypeCompiler2.Compile=Compile})(TypeCompiler||(TypeCompiler={}));var __classPrivateFieldSet=function(receiver,state,value,kind,f){if(kind==="m")throw new TypeError("Private method is not writable");if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");return kind==="a"?f.call(receiver,value):f?f.value=value:state.set(receiver,value),value},__classPrivateFieldGet=function(receiver,state,kind,f){if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a getter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return kind==="m"?f:kind==="a"?f.call(receiver):f?f.value:state.get(receiver)},_AssertError_instances,_AssertError_iterator,_AssertError_Iterator;class AssertError extends TypeBoxError{constructor(iterator){let error=iterator.First();super(error===void 0?"Invalid Value":error.message);_AssertError_instances.add(this),_AssertError_iterator.set(this,void 0),__classPrivateFieldSet(this,_AssertError_iterator,iterator,"f"),this.error=error}Errors(){return new ValueErrorIterator(__classPrivateFieldGet(this,_AssertError_instances,"m",_AssertError_Iterator).call(this))}}_AssertError_iterator=new WeakMap,_AssertError_instances=new WeakSet,_AssertError_Iterator=function*_AssertError_Iterator2(){if(this.error)yield this.error;yield*__classPrivateFieldGet(this,_AssertError_iterator,"f")};function AssertValue(schema,references,value){if(Check(schema,references,value))return;throw new AssertError(Errors(schema,references,value))}function Assert(...args){return args.length===3?AssertValue(args[0],args[1],args[2]):AssertValue(args[0],[],args[1])}function FromObject13(value){let Acc={};for(let key of Object.getOwnPropertyNames(value))Acc[key]=Clone2(value[key]);for(let key of Object.getOwnPropertySymbols(value))Acc[key]=Clone2(value[key]);return Acc}function FromArray12(value){return value.map((element)=>Clone2(element))}function FromTypedArray(value){return value.slice()}function FromMap(value){return new Map(Clone2([...value.entries()]))}function FromSet(value){return new Set(Clone2([...value.entries()]))}function FromDate4(value){return new Date(value.toISOString())}function FromValue2(value){return value}function Clone2(value){if(IsArray2(value))return FromArray12(value);if(IsDate2(value))return FromDate4(value);if(IsTypedArray(value))return FromTypedArray(value);if(IsMap(value))return FromMap(value);if(IsSet(value))return FromSet(value);if(IsObject2(value))return FromObject13(value);if(IsValueType(value))return FromValue2(value);throw new Error("ValueClone: Unable to clone value")}class ValueCreateError extends TypeBoxError{constructor(schema,message){super(message);this.schema=schema}}function FromDefault(value){return IsFunction2(value)?value():Clone2(value)}function FromAny4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return{}}function FromArgument4(schema,references){return{}}function FromArray13(schema,references){if(schema.uniqueItems===!0&&!HasPropertyKey2(schema,"default"))throw new ValueCreateError(schema,"Array with the uniqueItems constraint requires a default value");else if("contains"in schema&&!HasPropertyKey2(schema,"default"))throw new ValueCreateError(schema,"Array with the contains constraint requires a default value");else if("default"in schema)return FromDefault(schema.default);else if(schema.minItems!==void 0)return Array.from({length:schema.minItems}).map((item)=>{return Visit10(schema.items,references)});else return[]}function FromAsyncIterator7(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return async function*(){}()}function FromBigInt4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return BigInt(0)}function FromBoolean4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return!1}function FromConstructor7(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else{let value=Visit10(schema.returns,references);if(typeof value==="object"&&!Array.isArray(value))return class{constructor(){for(let[key,val]of Object.entries(value)){let self2=this;self2[key]=val}}};else return class{}}}function FromDate5(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(schema.minimumTimestamp!==void 0)return new Date(schema.minimumTimestamp);else return new Date}function FromFunction7(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return()=>Visit10(schema.returns,references)}function FromImport6(schema,references){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];return Visit10(target,[...references,...definitions])}function FromInteger4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(schema.minimum!==void 0)return schema.minimum;else return 0}function FromIntersect14(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else{let value=schema.allOf.reduce((acc,schema2)=>{let next=Visit10(schema2,references);return typeof next==="object"?{...acc,...next}:next},{});if(!Check(schema,references,value))throw new ValueCreateError(schema,"Intersect produced invalid value. Consider using a default value.");return value}}function FromIterator7(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return function*(){}()}function FromLiteral5(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return schema.const}function FromNever4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else throw new ValueCreateError(schema,"Never types cannot be created. Consider using a default value.")}function FromNot7(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else throw new ValueCreateError(schema,"Not types must have a default value")}function FromNull4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return null}function FromNumber4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(schema.minimum!==void 0)return schema.minimum;else return 0}function FromObject14(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else{let required=new Set(schema.required),Acc={};for(let[key,subschema]of Object.entries(schema.properties)){if(!required.has(key))continue;Acc[key]=Visit10(subschema,references)}return Acc}}function FromPromise7(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return Promise.resolve(Visit10(schema.item,references))}function FromRecord9(schema,references){let[keyPattern,valueSchema]=Object.entries(schema.patternProperties)[0];if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(!(keyPattern===PatternStringExact||keyPattern===PatternNumberExact)){let propertyKeys=keyPattern.slice(1,keyPattern.length-1).split("|"),Acc={};for(let key of propertyKeys)Acc[key]=Visit10(valueSchema,references);return Acc}else return{}}function FromRef10(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return Visit10(Deref(schema,references),references)}function FromRegExp4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else throw new ValueCreateError(schema,"RegExp types cannot be created. Consider using a default value.")}function FromString4(schema,references){if(schema.pattern!==void 0)if(!HasPropertyKey2(schema,"default"))throw new ValueCreateError(schema,"String types with patterns must specify a default value");else return FromDefault(schema.default);else if(schema.format!==void 0)if(!HasPropertyKey2(schema,"default"))throw new ValueCreateError(schema,"String types with formats must specify a default value");else return FromDefault(schema.default);else if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(schema.minLength!==void 0)return Array.from({length:schema.minLength}).map(()=>" ").join("");else return""}function FromSymbol4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if("value"in schema)return Symbol.for(schema.value);else return Symbol()}function FromTemplateLiteral6(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);if(!IsTemplateLiteralFinite(schema))throw new ValueCreateError(schema,"Can only create template literals that produce a finite variants. Consider using a default value.");return TemplateLiteralGenerate(schema)[0]}function FromThis6(schema,references){if(recursiveDepth++>recursiveMaxDepth)throw new ValueCreateError(schema,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return Visit10(Deref(schema,references),references)}function FromTuple11(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);if(schema.items===void 0)return[];else return Array.from({length:schema.minItems}).map((_2,index)=>Visit10(schema.items[index],references))}function FromUndefined4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return}function FromUnion16(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(schema.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return Visit10(schema.anyOf[0],references)}function FromUint8Array4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else if(schema.minByteLength!==void 0)return new Uint8Array(schema.minByteLength);else return new Uint8Array(0)}function FromUnknown4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return{}}function FromVoid4(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else return}function FromKind3(schema,references){if(HasPropertyKey2(schema,"default"))return FromDefault(schema.default);else throw new Error("User defined types must specify a default value")}function Visit10(schema,references){let references_=Pushref(schema,references),schema_=schema;switch(schema_[Kind]){case"Any":return FromAny4(schema_,references_);case"Argument":return FromArgument4(schema_,references_);case"Array":return FromArray13(schema_,references_);case"AsyncIterator":return FromAsyncIterator7(schema_,references_);case"BigInt":return FromBigInt4(schema_,references_);case"Boolean":return FromBoolean4(schema_,references_);case"Constructor":return FromConstructor7(schema_,references_);case"Date":return FromDate5(schema_,references_);case"Function":return FromFunction7(schema_,references_);case"Import":return FromImport6(schema_,references_);case"Integer":return FromInteger4(schema_,references_);case"Intersect":return FromIntersect14(schema_,references_);case"Iterator":return FromIterator7(schema_,references_);case"Literal":return FromLiteral5(schema_,references_);case"Never":return FromNever4(schema_,references_);case"Not":return FromNot7(schema_,references_);case"Null":return FromNull4(schema_,references_);case"Number":return FromNumber4(schema_,references_);case"Object":return FromObject14(schema_,references_);case"Promise":return FromPromise7(schema_,references_);case"Record":return FromRecord9(schema_,references_);case"Ref":return FromRef10(schema_,references_);case"RegExp":return FromRegExp4(schema_,references_);case"String":return FromString4(schema_,references_);case"Symbol":return FromSymbol4(schema_,references_);case"TemplateLiteral":return FromTemplateLiteral6(schema_,references_);case"This":return FromThis6(schema_,references_);case"Tuple":return FromTuple11(schema_,references_);case"Undefined":return FromUndefined4(schema_,references_);case"Union":return FromUnion16(schema_,references_);case"Uint8Array":return FromUint8Array4(schema_,references_);case"Unknown":return FromUnknown4(schema_,references_);case"Void":return FromVoid4(schema_,references_);default:if(!exports_type2.Has(schema_[Kind]))throw new ValueCreateError(schema_,"Unknown type");return FromKind3(schema_,references_)}}var recursiveMaxDepth=512,recursiveDepth=0;function Create2(...args){return recursiveDepth=0,args.length===2?Visit10(args[0],args[1]):Visit10(args[0],[])}class ValueCastError extends TypeBoxError{constructor(schema,message){super(message);this.schema=schema}}function ScoreUnion(schema,references,value){if(schema[Kind]==="Object"&&typeof value==="object"&&!IsNull2(value)){let object=schema,keys=Object.getOwnPropertyNames(value),entries=Object.entries(object.properties),[point,max]=[1/entries.length,entries.length];return entries.reduce((acc,[key,schema2])=>{let literal=schema2[Kind]==="Literal"&&schema2.const===value[key]?max:0,checks=Check(schema2,references,value[key])?point:0,exists=keys.includes(key)?point:0;return acc+(literal+checks+exists)},0)}else return Check(schema,references,value)?1:0}function SelectUnion(union,references,value){let schemas=union.anyOf.map((schema)=>Deref(schema,references)),[select,best]=[schemas[0],0];for(let schema of schemas){let score=ScoreUnion(schema,references,value);if(score>best)select=schema,best=score}return select}function CastUnion(union,references,value){if("default"in union)return typeof value==="function"?union.default:Clone2(union.default);else{let schema=SelectUnion(union,references,value);return Cast(schema,references,value)}}function DefaultClone(schema,references,value){return Check(schema,references,value)?Clone2(value):Create2(schema,references)}function Default3(schema,references,value){return Check(schema,references,value)?value:Create2(schema,references)}function FromArray14(schema,references,value){if(Check(schema,references,value))return Clone2(value);let created=IsArray2(value)?Clone2(value):Create2(schema,references),minimum=IsNumber2(schema.minItems)&&created.length<schema.minItems?[...created,...Array.from({length:schema.minItems-created.length},()=>null)]:created,casted=(IsNumber2(schema.maxItems)&&minimum.length>schema.maxItems?minimum.slice(0,schema.maxItems):minimum).map((value2)=>Visit11(schema.items,references,value2));if(schema.uniqueItems!==!0)return casted;let unique=[...new Set(casted)];if(!Check(schema,references,unique))throw new ValueCastError(schema,"Array cast produced invalid data due to uniqueItems constraint");return unique}function FromConstructor8(schema,references,value){if(Check(schema,references,value))return Create2(schema,references);let required=new Set(schema.returns.required||[]),result=function(){};for(let[key,property]of Object.entries(schema.returns.properties)){if(!required.has(key)&&value.prototype[key]===void 0)continue;result.prototype[key]=Visit11(property,references,value.prototype[key])}return result}function FromImport7(schema,references,value){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];return Visit11(target,[...references,...definitions],value)}function FromIntersect15(schema,references,value){let created=Create2(schema,references),mapped=IsObject2(created)&&IsObject2(value)?{...created,...value}:value;return Check(schema,references,mapped)?mapped:Create2(schema,references)}function FromNever5(schema,references,value){throw new ValueCastError(schema,"Never types cannot be cast")}function FromObject15(schema,references,value){if(Check(schema,references,value))return value;if(value===null||typeof value!=="object")return Create2(schema,references);let required=new Set(schema.required||[]),result={};for(let[key,property]of Object.entries(schema.properties)){if(!required.has(key)&&value[key]===void 0)continue;result[key]=Visit11(property,references,value[key])}if(typeof schema.additionalProperties==="object"){let propertyNames=Object.getOwnPropertyNames(schema.properties);for(let propertyName of Object.getOwnPropertyNames(value)){if(propertyNames.includes(propertyName))continue;result[propertyName]=Visit11(schema.additionalProperties,references,value[propertyName])}}return result}function FromRecord10(schema,references,value){if(Check(schema,references,value))return Clone2(value);if(value===null||typeof value!=="object"||Array.isArray(value)||value instanceof Date)return Create2(schema,references);let subschemaPropertyName=Object.getOwnPropertyNames(schema.patternProperties)[0],subschema=schema.patternProperties[subschemaPropertyName],result={};for(let[propKey,propValue]of Object.entries(value))result[propKey]=Visit11(subschema,references,propValue);return result}function FromRef11(schema,references,value){return Visit11(Deref(schema,references),references,value)}function FromThis7(schema,references,value){return Visit11(Deref(schema,references),references,value)}function FromTuple12(schema,references,value){if(Check(schema,references,value))return Clone2(value);if(!IsArray2(value))return Create2(schema,references);if(schema.items===void 0)return[];return schema.items.map((schema2,index)=>Visit11(schema2,references,value[index]))}function FromUnion17(schema,references,value){return Check(schema,references,value)?Clone2(value):CastUnion(schema,references,value)}function Visit11(schema,references,value){let references_=IsString2(schema.$id)?Pushref(schema,references):references,schema_=schema;switch(schema[Kind]){case"Array":return FromArray14(schema_,references_,value);case"Constructor":return FromConstructor8(schema_,references_,value);case"Import":return FromImport7(schema_,references_,value);case"Intersect":return FromIntersect15(schema_,references_,value);case"Never":return FromNever5(schema_,references_,value);case"Object":return FromObject15(schema_,references_,value);case"Record":return FromRecord10(schema_,references_,value);case"Ref":return FromRef11(schema_,references_,value);case"This":return FromThis7(schema_,references_,value);case"Tuple":return FromTuple12(schema_,references_,value);case"Union":return FromUnion17(schema_,references_,value);case"Date":case"Symbol":case"Uint8Array":return DefaultClone(schema,references,value);default:return Default3(schema_,references_,value)}}function Cast(...args){return args.length===3?Visit11(args[0],args[1],args[2]):Visit11(args[0],[],args[1])}function IsCheckable(schema){return IsKind(schema)&&schema[Kind]!=="Unsafe"}function FromArray15(schema,references,value){if(!IsArray2(value))return value;return value.map((value2)=>Visit12(schema.items,references,value2))}function FromImport8(schema,references,value){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];return Visit12(target,[...references,...definitions],value)}function FromIntersect16(schema,references,value){let unevaluatedProperties=schema.unevaluatedProperties,composite=schema.allOf.map((schema2)=>Visit12(schema2,references,Clone2(value))).reduce((acc,value2)=>IsObject2(value2)?{...acc,...value2}:value2,{});if(!IsObject2(value)||!IsObject2(composite)||!IsKind(unevaluatedProperties))return composite;let knownkeys=KeyOfPropertyKeys(schema);for(let key of Object.getOwnPropertyNames(value)){if(knownkeys.includes(key))continue;if(Check(unevaluatedProperties,references,value[key]))composite[key]=Visit12(unevaluatedProperties,references,value[key])}return composite}function FromObject16(schema,references,value){if(!IsObject2(value)||IsArray2(value))return value;let additionalProperties=schema.additionalProperties;for(let key of Object.getOwnPropertyNames(value)){if(HasPropertyKey2(schema.properties,key)){value[key]=Visit12(schema.properties[key],references,value[key]);continue}if(IsKind(additionalProperties)&&Check(additionalProperties,references,value[key])){value[key]=Visit12(additionalProperties,references,value[key]);continue}delete value[key]}return value}function FromRecord11(schema,references,value){if(!IsObject2(value))return value;let additionalProperties=schema.additionalProperties,propertyKeys=Object.getOwnPropertyNames(value),[propertyKey,propertySchema]=Object.entries(schema.patternProperties)[0],propertyKeyTest=new RegExp(propertyKey);for(let key of propertyKeys){if(propertyKeyTest.test(key)){value[key]=Visit12(propertySchema,references,value[key]);continue}if(IsKind(additionalProperties)&&Check(additionalProperties,references,value[key])){value[key]=Visit12(additionalProperties,references,value[key]);continue}delete value[key]}return value}function FromRef12(schema,references,value){return Visit12(Deref(schema,references),references,value)}function FromThis8(schema,references,value){return Visit12(Deref(schema,references),references,value)}function FromTuple13(schema,references,value){if(!IsArray2(value))return value;if(IsUndefined2(schema.items))return[];let length=Math.min(value.length,schema.items.length);for(let i=0;i<length;i++)value[i]=Visit12(schema.items[i],references,value[i]);return value.length>length?value.slice(0,length):value}function FromUnion18(schema,references,value){for(let inner of schema.anyOf)if(IsCheckable(inner)&&Check(inner,references,value))return Visit12(inner,references,value);return value}function Visit12(schema,references,value){let references_=IsString2(schema.$id)?Pushref(schema,references):references,schema_=schema;switch(schema_[Kind]){case"Array":return FromArray15(schema_,references_,value);case"Import":return FromImport8(schema_,references_,value);case"Intersect":return FromIntersect16(schema_,references_,value);case"Object":return FromObject16(schema_,references_,value);case"Record":return FromRecord11(schema_,references_,value);case"Ref":return FromRef12(schema_,references_,value);case"This":return FromThis8(schema_,references_,value);case"Tuple":return FromTuple13(schema_,references_,value);case"Union":return FromUnion18(schema_,references_,value);default:return value}}function Clean(...args){return args.length===3?Visit12(args[0],args[1],args[2]):Visit12(args[0],[],args[1])}function IsStringNumeric(value){return IsString2(value)&&!isNaN(value)&&!isNaN(parseFloat(value))}function IsValueToString(value){return IsBigInt2(value)||IsBoolean2(value)||IsNumber2(value)}function IsValueTrue(value){return value===!0||IsNumber2(value)&&value===1||IsBigInt2(value)&&value===BigInt("1")||IsString2(value)&&(value.toLowerCase()==="true"||value==="1")}function IsValueFalse(value){return value===!1||IsNumber2(value)&&(value===0||Object.is(value,-0))||IsBigInt2(value)&&value===BigInt("0")||IsString2(value)&&(value.toLowerCase()==="false"||value==="0"||value==="-0")}function IsTimeStringWithTimeZone(value){return IsString2(value)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(value)}function IsTimeStringWithoutTimeZone(value){return IsString2(value)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(value)}function IsDateTimeStringWithTimeZone(value){return IsString2(value)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(value)}function IsDateTimeStringWithoutTimeZone(value){return IsString2(value)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(value)}function IsDateString(value){return IsString2(value)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(value)}function TryConvertLiteralString(value,target){let conversion=TryConvertString(value);return conversion===target?conversion:value}function TryConvertLiteralNumber(value,target){let conversion=TryConvertNumber(value);return conversion===target?conversion:value}function TryConvertLiteralBoolean(value,target){let conversion=TryConvertBoolean(value);return conversion===target?conversion:value}function TryConvertLiteral(schema,value){return IsString2(schema.const)?TryConvertLiteralString(value,schema.const):IsNumber2(schema.const)?TryConvertLiteralNumber(value,schema.const):IsBoolean2(schema.const)?TryConvertLiteralBoolean(value,schema.const):value}function TryConvertBoolean(value){return IsValueTrue(value)?!0:IsValueFalse(value)?!1:value}function TryConvertBigInt(value){let truncateInteger=(value2)=>value2.split(".")[0];return IsStringNumeric(value)?BigInt(truncateInteger(value)):IsNumber2(value)?BigInt(Math.trunc(value)):IsValueFalse(value)?BigInt(0):IsValueTrue(value)?BigInt(1):value}function TryConvertString(value){return IsSymbol2(value)&&value.description!==void 0?value.description.toString():IsValueToString(value)?value.toString():value}function TryConvertNumber(value){return IsStringNumeric(value)?parseFloat(value):IsValueTrue(value)?1:IsValueFalse(value)?0:value}function TryConvertInteger(value){return IsStringNumeric(value)?parseInt(value):IsNumber2(value)?Math.trunc(value):IsValueTrue(value)?1:IsValueFalse(value)?0:value}function TryConvertNull(value){return IsString2(value)&&value.toLowerCase()==="null"?null:value}function TryConvertUndefined(value){return IsString2(value)&&value==="undefined"?void 0:value}function TryConvertDate(value){return IsDate2(value)?value:IsNumber2(value)?new Date(value):IsValueTrue(value)?new Date(1):IsValueFalse(value)?new Date(0):IsStringNumeric(value)?new Date(parseInt(value)):IsTimeStringWithoutTimeZone(value)?new Date(`1970-01-01T${value}.000Z`):IsTimeStringWithTimeZone(value)?new Date(`1970-01-01T${value}`):IsDateTimeStringWithoutTimeZone(value)?new Date(`${value}.000Z`):IsDateTimeStringWithTimeZone(value)?new Date(value):IsDateString(value)?new Date(`${value}T00:00:00.000Z`):value}function Default4(value){return value}function FromArray16(schema,references,value){return(IsArray2(value)?value:[value]).map((element)=>Visit13(schema.items,references,element))}function FromBigInt5(schema,references,value){return TryConvertBigInt(value)}function FromBoolean5(schema,references,value){return TryConvertBoolean(value)}function FromDate6(schema,references,value){return TryConvertDate(value)}function FromImport9(schema,references,value){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];return Visit13(target,[...references,...definitions],value)}function FromInteger5(schema,references,value){return TryConvertInteger(value)}function FromIntersect17(schema,references,value){return schema.allOf.reduce((value2,schema2)=>Visit13(schema2,references,value2),value)}function FromLiteral6(schema,references,value){return TryConvertLiteral(schema,value)}function FromNull5(schema,references,value){return TryConvertNull(value)}function FromNumber5(schema,references,value){return TryConvertNumber(value)}function FromObject17(schema,references,value){if(!IsObject2(value))return value;for(let propertyKey of Object.getOwnPropertyNames(schema.properties)){if(!HasPropertyKey2(value,propertyKey))continue;value[propertyKey]=Visit13(schema.properties[propertyKey],references,value[propertyKey])}return value}function FromRecord12(schema,references,value){if(!IsObject2(value))return value;let propertyKey=Object.getOwnPropertyNames(schema.patternProperties)[0],property=schema.patternProperties[propertyKey];for(let[propKey,propValue]of Object.entries(value))value[propKey]=Visit13(property,references,propValue);return value}function FromRef13(schema,references,value){return Visit13(Deref(schema,references),references,value)}function FromString5(schema,references,value){return TryConvertString(value)}function FromSymbol5(schema,references,value){return IsString2(value)||IsNumber2(value)?Symbol(value):value}function FromThis9(schema,references,value){return Visit13(Deref(schema,references),references,value)}function FromTuple14(schema,references,value){if(!(IsArray2(value)&&!IsUndefined2(schema.items)))return value;return value.map((value2,index)=>{return index<schema.items.length?Visit13(schema.items[index],references,value2):value2})}function FromUndefined5(schema,references,value){return TryConvertUndefined(value)}function FromUnion19(schema,references,value){for(let subschema of schema.anyOf){let converted=Visit13(subschema,references,Clone2(value));if(!Check(subschema,references,converted))continue;return converted}return value}function Visit13(schema,references,value){let references_=Pushref(schema,references),schema_=schema;switch(schema[Kind]){case"Array":return FromArray16(schema_,references_,value);case"BigInt":return FromBigInt5(schema_,references_,value);case"Boolean":return FromBoolean5(schema_,references_,value);case"Date":return FromDate6(schema_,references_,value);case"Import":return FromImport9(schema_,references_,value);case"Integer":return FromInteger5(schema_,references_,value);case"Intersect":return FromIntersect17(schema_,references_,value);case"Literal":return FromLiteral6(schema_,references_,value);case"Null":return FromNull5(schema_,references_,value);case"Number":return FromNumber5(schema_,references_,value);case"Object":return FromObject17(schema_,references_,value);case"Record":return FromRecord12(schema_,references_,value);case"Ref":return FromRef13(schema_,references_,value);case"String":return FromString5(schema_,references_,value);case"Symbol":return FromSymbol5(schema_,references_,value);case"This":return FromThis9(schema_,references_,value);case"Tuple":return FromTuple14(schema_,references_,value);case"Undefined":return FromUndefined5(schema_,references_,value);case"Union":return FromUnion19(schema_,references_,value);default:return Default4(value)}}function Convert(...args){return args.length===3?Visit13(args[0],args[1],args[2]):Visit13(args[0],[],args[1])}function Decode(...args){let[schema,references,value]=args.length===3?[args[0],args[1],args[2]]:[args[0],[],args[1]];if(!Check(schema,references,value))throw new TransformDecodeCheckError(schema,value,Errors(schema,references,value).First());return HasTransform(schema,references)?TransformDecode(schema,references,value):value}function ValueOrDefault(schema,value){let defaultValue=HasPropertyKey2(schema,"default")?schema.default:void 0,clone=IsFunction2(defaultValue)?defaultValue():Clone2(defaultValue);return IsUndefined2(value)?clone:IsObject2(value)&&IsObject2(clone)?Object.assign(clone,value):value}function HasDefaultProperty(schema){return IsKind(schema)&&"default"in schema}function FromArray17(schema,references,value){if(IsArray2(value)){for(let i=0;i<value.length;i++)value[i]=Visit14(schema.items,references,value[i]);return value}let defaulted=ValueOrDefault(schema,value);if(!IsArray2(defaulted))return defaulted;for(let i=0;i<defaulted.length;i++)defaulted[i]=Visit14(schema.items,references,defaulted[i]);return defaulted}function FromDate7(schema,references,value){return IsDate2(value)?value:ValueOrDefault(schema,value)}function FromImport10(schema,references,value){let definitions=globalThis.Object.values(schema.$defs),target=schema.$defs[schema.$ref];return Visit14(target,[...references,...definitions],value)}function FromIntersect18(schema,references,value){let defaulted=ValueOrDefault(schema,value);return schema.allOf.reduce((acc,schema2)=>{let next=Visit14(schema2,references,defaulted);return IsObject2(next)?{...acc,...next}:next},{})}function FromObject18(schema,references,value){let defaulted=ValueOrDefault(schema,value);if(!IsObject2(defaulted))return defaulted;let knownPropertyKeys=Object.getOwnPropertyNames(schema.properties);for(let key of knownPropertyKeys){let propertyValue=Visit14(schema.properties[key],references,defaulted[key]);if(IsUndefined2(propertyValue))continue;defaulted[key]=Visit14(schema.properties[key],references,defaulted[key])}if(!HasDefaultProperty(schema.additionalProperties))return defaulted;for(let key of Object.getOwnPropertyNames(defaulted)){if(knownPropertyKeys.includes(key))continue;defaulted[key]=Visit14(schema.additionalProperties,references,defaulted[key])}return defaulted}function FromRecord13(schema,references,value){let defaulted=ValueOrDefault(schema,value);if(!IsObject2(defaulted))return defaulted;let additionalPropertiesSchema=schema.additionalProperties,[propertyKeyPattern,propertySchema]=Object.entries(schema.patternProperties)[0],knownPropertyKey=new RegExp(propertyKeyPattern);for(let key of Object.getOwnPropertyNames(defaulted)){if(!(knownPropertyKey.test(key)&&HasDefaultProperty(propertySchema)))continue;defaulted[key]=Visit14(propertySchema,references,defaulted[key])}if(!HasDefaultProperty(additionalPropertiesSchema))return defaulted;for(let key of Object.getOwnPropertyNames(defaulted)){if(knownPropertyKey.test(key))continue;defaulted[key]=Visit14(additionalPropertiesSchema,references,defaulted[key])}return defaulted}function FromRef14(schema,references,value){return Visit14(Deref(schema,references),references,ValueOrDefault(schema,value))}function FromThis10(schema,references,value){return Visit14(Deref(schema,references),references,value)}function FromTuple15(schema,references,value){let defaulted=ValueOrDefault(schema,value);if(!IsArray2(defaulted)||IsUndefined2(schema.items))return defaulted;let[items,max]=[schema.items,Math.max(schema.items.length,defaulted.length)];for(let i=0;i<max;i++)if(i<items.length)defaulted[i]=Visit14(items[i],references,defaulted[i]);return defaulted}function FromUnion20(schema,references,value){let defaulted=ValueOrDefault(schema,value);for(let inner of schema.anyOf){let result=Visit14(inner,references,Clone2(defaulted));if(Check(inner,references,result))return result}return defaulted}function Visit14(schema,references,value){let references_=Pushref(schema,references),schema_=schema;switch(schema_[Kind]){case"Array":return FromArray17(schema_,references_,value);case"Date":return FromDate7(schema_,references_,value);case"Import":return FromImport10(schema_,references_,value);case"Intersect":return FromIntersect18(schema_,references_,value);case"Object":return FromObject18(schema_,references_,value);case"Record":return FromRecord13(schema_,references_,value);case"Ref":return FromRef14(schema_,references_,value);case"This":return FromThis10(schema_,references_,value);case"Tuple":return FromTuple15(schema_,references_,value);case"Union":return FromUnion20(schema_,references_,value);default:return ValueOrDefault(schema_,value)}}function Default5(...args){return args.length===3?Visit14(args[0],args[1],args[2]):Visit14(args[0],[],args[1])}var exports_pointer={};__export(exports_pointer,{ValuePointerRootSetError:()=>ValuePointerRootSetError,ValuePointerRootDeleteError:()=>ValuePointerRootDeleteError,Set:()=>Set4,Has:()=>Has3,Get:()=>Get3,Format:()=>Format,Delete:()=>Delete3});class ValuePointerRootSetError extends TypeBoxError{constructor(value,path,update){super("Cannot set root value");this.value=value,this.path=path,this.update=update}}class ValuePointerRootDeleteError extends TypeBoxError{constructor(value,path){super("Cannot delete root value");this.value=value,this.path=path}}function Escape2(component){return component.indexOf("~")===-1?component:component.replace(/~1/g,"/").replace(/~0/g,"~")}function*Format(pointer){if(pointer==="")return;let[start,end]=[0,0];for(let i=0;i<pointer.length;i++)if(pointer.charAt(i)==="/")if(i===0)start=i+1;else end=i,yield Escape2(pointer.slice(start,end)),start=i+1;else end=i;yield Escape2(pointer.slice(start))}function Set4(value,pointer,update){if(pointer==="")throw new ValuePointerRootSetError(value,pointer,update);let[owner,next,key]=[null,value,""];for(let component of Format(pointer)){if(next[component]===void 0)next[component]={};owner=next,next=next[component],key=component}owner[key]=update}function Delete3(value,pointer){if(pointer==="")throw new ValuePointerRootDeleteError(value,pointer);let[owner,next,key]=[null,value,""];for(let component of Format(pointer)){if(next[component]===void 0||next[component]===null)return;owner=next,next=next[component],key=component}if(Array.isArray(owner)){let index=parseInt(key);owner.splice(index,1)}else delete owner[key]}function Has3(value,pointer){if(pointer==="")return!0;let[owner,next,key]=[null,value,""];for(let component of Format(pointer)){if(next[component]===void 0)return!1;owner=next,next=next[component],key=component}return Object.getOwnPropertyNames(owner).includes(key)}function Get3(value,pointer){if(pointer==="")return value;let current=value;for(let component of Format(pointer)){if(current[component]===void 0)return;current=current[component]}return current}function ObjectType3(left,right){if(!IsObject2(right))return!1;let leftKeys=[...Object.keys(left),...Object.getOwnPropertySymbols(left)],rightKeys=[...Object.keys(right),...Object.getOwnPropertySymbols(right)];if(leftKeys.length!==rightKeys.length)return!1;return leftKeys.every((key)=>Equal(left[key],right[key]))}function DateType3(left,right){return IsDate2(right)&&left.getTime()===right.getTime()}function ArrayType3(left,right){if(!IsArray2(right)||left.length!==right.length)return!1;return left.every((value,index)=>Equal(value,right[index]))}function TypedArrayType(left,right){if(!IsTypedArray(right)||left.length!==right.length||Object.getPrototypeOf(left).constructor.name!==Object.getPrototypeOf(right).constructor.name)return!1;return left.every((value,index)=>Equal(value,right[index]))}function ValueType(left,right){return left===right}function Equal(left,right){if(IsDate2(left))return DateType3(left,right);if(IsTypedArray(left))return TypedArrayType(left,right);if(IsArray2(left))return ArrayType3(left,right);if(IsObject2(left))return ObjectType3(left,right);if(IsValueType(left))return ValueType(left,right);throw new Error("ValueEquals: Unable to compare value")}var Insert=Object2({type:Literal("insert"),path:String2(),value:Unknown()}),Update=Object2({type:Literal("update"),path:String2(),value:Unknown()}),Delete4=Object2({type:Literal("delete"),path:String2()}),Edit=Union([Insert,Update,Delete4]);class ValueDiffError extends TypeBoxError{constructor(value,message){super(message);this.value=value}}function CreateUpdate(path,value){return{type:"update",path,value}}function CreateInsert(path,value){return{type:"insert",path,value}}function CreateDelete(path){return{type:"delete",path}}function AssertDiffable(value){if(globalThis.Object.getOwnPropertySymbols(value).length>0)throw new ValueDiffError(value,"Cannot diff objects with symbols")}function*ObjectType4(path,current,next){if(AssertDiffable(current),AssertDiffable(next),!IsStandardObject(next))return yield CreateUpdate(path,next);let currentKeys=globalThis.Object.getOwnPropertyNames(current),nextKeys=globalThis.Object.getOwnPropertyNames(next);for(let key of nextKeys){if(HasPropertyKey2(current,key))continue;yield CreateInsert(`${path}/${key}`,next[key])}for(let key of currentKeys){if(!HasPropertyKey2(next,key))continue;if(Equal(current,next))continue;yield*Visit15(`${path}/${key}`,current[key],next[key])}for(let key of currentKeys){if(HasPropertyKey2(next,key))continue;yield CreateDelete(`${path}/${key}`)}}function*ArrayType4(path,current,next){if(!IsArray2(next))return yield CreateUpdate(path,next);for(let i=0;i<Math.min(current.length,next.length);i++)yield*Visit15(`${path}/${i}`,current[i],next[i]);for(let i=0;i<next.length;i++){if(i<current.length)continue;yield CreateInsert(`${path}/${i}`,next[i])}for(let i=current.length-1;i>=0;i--){if(i<next.length)continue;yield CreateDelete(`${path}/${i}`)}}function*TypedArrayType2(path,current,next){if(!IsTypedArray(next)||current.length!==next.length||globalThis.Object.getPrototypeOf(current).constructor.name!==globalThis.Object.getPrototypeOf(next).constructor.name)return yield CreateUpdate(path,next);for(let i=0;i<Math.min(current.length,next.length);i++)yield*Visit15(`${path}/${i}`,current[i],next[i])}function*ValueType2(path,current,next){if(current===next)return;yield CreateUpdate(path,next)}function*Visit15(path,current,next){if(IsStandardObject(current))return yield*ObjectType4(path,current,next);if(IsArray2(current))return yield*ArrayType4(path,current,next);if(IsTypedArray(current))return yield*TypedArrayType2(path,current,next);if(IsValueType(current))return yield*ValueType2(path,current,next);throw new ValueDiffError(current,"Unable to diff value")}function Diff(current,next){return[...Visit15("",current,next)]}function IsRootUpdate(edits){return edits.length>0&&edits[0].path===""&&edits[0].type==="update"}function IsIdentity(edits){return edits.length===0}function Patch(current,edits){if(IsRootUpdate(edits))return Clone2(edits[0].value);if(IsIdentity(edits))return Clone2(current);let clone=Clone2(current);for(let edit of edits)switch(edit.type){case"insert":{exports_pointer.Set(clone,edit.path,edit.value);break}case"update":{exports_pointer.Set(clone,edit.path,edit.value);break}case"delete":{exports_pointer.Delete(clone,edit.path);break}}return clone}function Encode(...args){let[schema,references,value]=args.length===3?[args[0],args[1],args[2]]:[args[0],[],args[1]],encoded=HasTransform(schema,references)?TransformEncode(schema,references,value):value;if(!Check(schema,references,encoded))throw new TransformEncodeCheckError(schema,encoded,Errors(schema,references,encoded).First());return encoded}function IsStandardObject2(value){return IsObject2(value)&&!IsArray2(value)}class ValueMutateError extends TypeBoxError{constructor(message){super(message)}}function ObjectType5(root,path,current,next){if(!IsStandardObject2(current))exports_pointer.Set(root,path,Clone2(next));else{let currentKeys=Object.getOwnPropertyNames(current),nextKeys=Object.getOwnPropertyNames(next);for(let currentKey of currentKeys)if(!nextKeys.includes(currentKey))delete current[currentKey];for(let nextKey of nextKeys)if(!currentKeys.includes(nextKey))current[nextKey]=null;for(let nextKey of nextKeys)Visit16(root,`${path}/${nextKey}`,current[nextKey],next[nextKey])}}function ArrayType5(root,path,current,next){if(!IsArray2(current))exports_pointer.Set(root,path,Clone2(next));else{for(let index=0;index<next.length;index++)Visit16(root,`${path}/${index}`,current[index],next[index]);current.splice(next.length)}}function TypedArrayType3(root,path,current,next){if(IsTypedArray(current)&&current.length===next.length)for(let i=0;i<current.length;i++)current[i]=next[i];else exports_pointer.Set(root,path,Clone2(next))}function ValueType3(root,path,current,next){if(current===next)return;exports_pointer.Set(root,path,next)}function Visit16(root,path,current,next){if(IsArray2(next))return ArrayType5(root,path,current,next);if(IsTypedArray(next))return TypedArrayType3(root,path,current,next);if(IsStandardObject2(next))return ObjectType5(root,path,current,next);if(IsValueType(next))return ValueType3(root,path,current,next)}function IsNonMutableValue(value){return IsTypedArray(value)||IsValueType(value)}function IsMismatchedValue(current,next){return IsStandardObject2(current)&&IsArray2(next)||IsArray2(current)&&IsStandardObject2(next)}function Mutate(current,next){if(IsNonMutableValue(current)||IsNonMutableValue(next))throw new ValueMutateError("Only object and array types can be mutated at the root level");if(IsMismatchedValue(current,next))throw new ValueMutateError("Cannot assign due type mismatch of assignable values");Visit16(current,"",current,next)}class ParseError extends TypeBoxError{constructor(message){super(message)}}var ParseRegistry;(function(ParseRegistry2){let registry=new Map([["Assert",(type,references,value)=>{return Assert(type,references,value),value}],["Cast",(type,references,value)=>Cast(type,references,value)],["Clean",(type,references,value)=>Clean(type,references,value)],["Clone",(_type,_references,value)=>Clone2(value)],["Convert",(type,references,value)=>Convert(type,references,value)],["Decode",(type,references,value)=>HasTransform(type,references)?TransformDecode(type,references,value):value],["Default",(type,references,value)=>Default5(type,references,value)],["Encode",(type,references,value)=>HasTransform(type,references)?TransformEncode(type,references,value):value]]);function Delete5(key){registry.delete(key)}ParseRegistry2.Delete=Delete5;function Set5(key,callback){registry.set(key,callback)}ParseRegistry2.Set=Set5;function Get4(key){return registry.get(key)}ParseRegistry2.Get=Get4})(ParseRegistry||(ParseRegistry={}));var ParseDefault=["Clone","Clean","Default","Convert","Assert","Decode"];function ParseValue(operations,type,references,value){return operations.reduce((value2,operationKey)=>{let operation=ParseRegistry.Get(operationKey);if(IsUndefined2(operation))throw new ParseError(`Unable to find Parse operation '${operationKey}'`);return operation(type,references,value2)},value)}function Parse(...args){let[operations,schema,references,value]=args.length===4?[args[0],args[1],args[2],args[3]]:args.length===3?IsArray2(args[0])?[args[0],args[1],[],args[2]]:[ParseDefault,args[0],args[1],args[2]]:args.length===2?[ParseDefault,args[0],[],args[1]]:(()=>{throw new ParseError("Invalid Arguments")})();return ParseValue(operations,schema,references,value)}var exports_value2={};__export(exports_value2,{ValueErrorIterator:()=>ValueErrorIterator,Patch:()=>Patch,Parse:()=>Parse,Mutate:()=>Mutate,Hash:()=>Hash,Errors:()=>Errors,Equal:()=>Equal,Encode:()=>Encode,Edit:()=>Edit,Diff:()=>Diff,Default:()=>Default5,Decode:()=>Decode,Create:()=>Create2,Convert:()=>Convert,Clone:()=>Clone2,Clean:()=>Clean,Check:()=>Check,Cast:()=>Cast,Assert:()=>Assert});var import_cookie=__toESM(require_dist(),1);var fullFormats={date,time:getTime(!0),"date-time":getDateTime(!0),"iso-time":getTime(!1),"iso-date-time":getDateTime(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte,int32:{type:"number",validate:validateInt32},int64:{type:"number",validate:validateInt64},float:{type:"number",validate:validateNumber},double:{type:"number",validate:validateNumber},password:!0,binary:!0};function isLeapYear(year){return year%4===0&&(year%100!==0||year%400===0)}var DATE=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,DAYS=[0,31,28,31,30,31,30,31,31,30,31,30,31];function date(str){let matches=DATE.exec(str);if(!matches)return!1;let year=+matches[1],month=+matches[2],day=+matches[3];return month>=1&&month<=12&&day>=1&&day<=(month===2&&isLeapYear(year)?29:DAYS[month])}var TIME=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function getTime(strictTimeZone){return function time(str){let matches=TIME.exec(str);if(!matches)return!1;let hr=+matches[1],min=+matches[2],sec=+matches[3],tz=matches[4],tzSign=matches[5]==="-"?-1:1,tzH=+(matches[6]||0),tzM=+(matches[7]||0);if(tzH>23||tzM>59||strictTimeZone&&!tz)return!1;if(hr<=23&&min<=59&&sec<60)return!0;let utcMin=min-tzM*tzSign,utcHr=hr-tzH*tzSign-(utcMin<0?1:0);return(utcHr===23||utcHr===-1)&&(utcMin===59||utcMin===-1)&&sec<61}}var DATE_TIME_SEPARATOR=/t|\s/i;function getDateTime(strictTimeZone){let time=getTime(strictTimeZone);return function date_time(str){let dateTime=str.split(DATE_TIME_SEPARATOR);return dateTime.length===2&&date(dateTime[0])&&time(dateTime[1])}}var NOT_URI_FRAGMENT=/\/|:/,URI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function uri(str){return NOT_URI_FRAGMENT.test(str)&&URI.test(str)}var BYTE=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function byte(str){return BYTE.lastIndex=0,BYTE.test(str)}var MIN_INT32=-2147483648,MAX_INT32=2147483647;function validateInt32(value){return Number.isInteger(value)&&value<=MAX_INT32&&value>=MIN_INT32}function validateInt64(value){return Number.isInteger(value)}function validateNumber(){return!0}var Z_ANCHOR=/[^\\]\\Z/;function regex(str){if(Z_ANCHOR.test(str))return!1;try{return new RegExp(str),!0}catch(e){return!1}}var hasHeaderShorthand="toJSON"in new Headers,replaceUrlPath=(url,pathname)=>{let urlObject=new URL(url);return urlObject.pathname=pathname,urlObject.toString()},isClass=(v)=>typeof v==="function"&&/^\s*class\s+/.test(v.toString())||v.toString&&v.toString().startsWith("[object ")&&v.toString()!=="[object Object]"||isNotEmpty(Object.getPrototypeOf(v)),isObject=(item)=>item&&typeof item==="object"&&!Array.isArray(item),mergeDeep=(target,source,{skipKeys,override=!0}={})=>{if(!isObject(target)||!isObject(source))return target;for(let[key,value]of Object.entries(source)){if(skipKeys?.includes(key))continue;if(!isObject(value)||!(key in target)||isClass(value)){if(override||!(key in target))target[key]=value;continue}target[key]=mergeDeep(target[key],value,{skipKeys,override})}return target},mergeCookie=(a,b)=>{let v=mergeDeep(Object.assign({},a),b,{skipKeys:["properties"]});if("properties"in v)delete v.properties;return v},mergeObjectArray=(a=[],b=[])=>{if(!a)return;if(!b)return a;let array=[],checksums=[];if(!Array.isArray(a))a=[a];if(!Array.isArray(b))b=[b];for(let item of a)if(array.push(item),item.checksum)checksums.push(item.checksum);for(let item of b)if(!checksums.includes(item.checksum))array.push(item);return array},primitiveHooks=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],primitiveHookMap=primitiveHooks.reduce((acc,x)=>(acc[x]=!0,acc),{}),mergeResponse=(a,b)=>{let isRecordNumber=(x)=>typeof x==="object"&&Object.keys(x).every(isNumericString);if(isRecordNumber(a)&&isRecordNumber(b))return Object.assign(a,b);else if(a&&!isRecordNumber(a)&&isRecordNumber(b))return Object.assign({200:a},b);return b??a},mergeSchemaValidator=(a,b)=>{return{body:b?.body??a?.body,headers:b?.headers??a?.headers,params:b?.params??a?.params,query:b?.query??a?.query,cookie:b?.cookie??a?.cookie,response:mergeResponse(a?.response,b?.response)}},mergeHook=(a,b)=>{let{resolve:resolveA,...restA}=a??{},{resolve:resolveB,...restB}=b??{};return{...restA,...restB,body:b?.body??a?.body,headers:b?.headers??a?.headers,params:b?.params??a?.params,query:b?.query??a?.query,cookie:b?.cookie??a?.cookie,response:mergeResponse(a?.response,b?.response),type:a?.type||b?.type,detail:mergeDeep(b?.detail??{},a?.detail??{}),parse:mergeObjectArray(a?.parse,b?.parse),transform:mergeObjectArray(a?.transform,b?.transform),beforeHandle:mergeObjectArray(mergeObjectArray(fnToContainer(resolveA,"resolve"),a?.beforeHandle),mergeObjectArray(fnToContainer(resolveB,"resolve"),b?.beforeHandle)),afterHandle:mergeObjectArray(a?.afterHandle,b?.afterHandle),mapResponse:mergeObjectArray(a?.mapResponse,b?.mapResponse),afterResponse:mergeObjectArray(a?.afterResponse,b?.afterResponse),trace:mergeObjectArray(a?.trace,b?.trace),error:mergeObjectArray(a?.error,b?.error)}},replaceSchemaType=(schema,options,root=!0)=>{if(!Array.isArray(options))return options.original=schema,_replaceSchemaType(schema,options,root);for(let option of options)option.original=schema,schema=_replaceSchemaType(schema,option,root);return schema},_replaceSchemaType=(schema,options,root=!0)=>{if(!schema)return schema;if(options.untilObjectFound&&!root&&schema.type==="object")return schema;let fromSymbol=options.from[Kind];if(schema.oneOf){for(let i=0;i<schema.oneOf.length;i++)schema.oneOf[i]=_replaceSchemaType(schema.oneOf[i],options,root);return schema}if(schema.anyOf){for(let i=0;i<schema.anyOf.length;i++)schema.anyOf[i]=_replaceSchemaType(schema.anyOf[i],options,root);return schema}if(schema.allOf){for(let i=0;i<schema.allOf.length;i++)schema.allOf[i]=_replaceSchemaType(schema.allOf[i],options,root);return schema}if(schema.not)return _replaceSchemaType(schema.not,options,root);let isRoot=root&&!!options.excludeRoot;if(schema[Kind]===fromSymbol){let{anyOf,oneOf,allOf,not,properties:properties2,items,...rest}=schema,to=options.to(rest);if(!to)return schema;let transform2,composeProperties=(v)=>{if(properties2&&v.type==="object"){let newProperties={};for(let[key,value2]of Object.entries(properties2))newProperties[key]=_replaceSchemaType(value2,options,!1);return{...rest,...v,properties:newProperties}}if(items&&v.type==="array")return{...rest,...v,items:_replaceSchemaType(items,options,!1)};let value={...rest,...v};if(delete value.required,properties2&&v.type==="string"&&v.format==="ObjectString"&&v.default==="{}")transform2=t.ObjectString(properties2,rest),value.default=JSON.stringify(exports_value2.Create(t.Object(properties2))),value.properties=properties2;if(items&&v.type==="string"&&v.format==="ArrayString"&&v.default==="[]")transform2=t.ArrayString(items,rest),value.default=JSON.stringify(exports_value2.Create(t.Array(items))),value.items=items;return value};if(isRoot){if(properties2){let newProperties={};for(let[key,value]of Object.entries(properties2))newProperties[key]=_replaceSchemaType(value,options,!1);return{...rest,properties:newProperties}}else if(items?.map)return{...rest,items:items.map((v)=>_replaceSchemaType(v,options,!1))};return rest}if(to.anyOf)for(let i=0;i<to.anyOf.length;i++)to.anyOf[i]=composeProperties(to.anyOf[i]);else if(to.oneOf)for(let i=0;i<to.oneOf.length;i++)to.oneOf[i]=composeProperties(to.oneOf[i]);else if(to.allOf)for(let i=0;i<to.allOf.length;i++)to.allOf[i]=composeProperties(to.allOf[i]);else if(to.not)to.not=composeProperties(to.not);if(transform2)to[TransformKind]=transform2[TransformKind];if(to.anyOf||to.oneOf||to.allOf||to.not)return to;if(properties2){let newProperties={};for(let[key,value]of Object.entries(properties2))newProperties[key]=_replaceSchemaType(value,options,!1);return{...rest,...to,properties:newProperties}}else if(items?.map)return{...rest,...to,items:items.map((v)=>_replaceSchemaType(v,options,!1))};return{...rest,...to}}let properties=schema?.properties;if(properties&&root&&options.rootOnly!==!0)for(let[key,value]of Object.entries(properties))switch(value[Kind]){case fromSymbol:let{anyOf,oneOf,allOf,not,type,...rest}=value,to=options.to(rest);if(!to)return schema;if(to.anyOf)for(let i=0;i<to.anyOf.length;i++)to.anyOf[i]={...rest,...to.anyOf[i]};else if(to.oneOf)for(let i=0;i<to.oneOf.length;i++)to.oneOf[i]={...rest,...to.oneOf[i]};else if(to.allOf)for(let i=0;i<to.allOf.length;i++)to.allOf[i]={...rest,...to.allOf[i]};else if(to.not)to.not={...rest,...to.not};properties[key]={...rest,..._replaceSchemaType(rest,options,!1)};break;case"Object":case"Union":properties[key]=_replaceSchemaType(value,options,!1);break;default:if(Array.isArray(value.items))for(let i=0;i<value.items.length;i++)value.items[i]=_replaceSchemaType(value.items[i],options,!1);else if(value.anyOf||value.oneOf||value.allOf||value.not)properties[key]=_replaceSchemaType(value,options,!1);else if(value.type==="array")value.items=_replaceSchemaType(value.items,options,!1);break}return schema},createCleaner=(schema)=>(value)=>{if(typeof value==="object")try{return exports_value2.Clean(schema,structuredClone(value))}catch{try{return exports_value2.Clean(schema,value)}catch{return value}}return value},getSchemaValidator=(s,{models={},dynamic=!1,modules,normalize=!1,additionalProperties=!1,coerce=!1,additionalCoerce=[]}={modules:t.Module({})})=>{if(!s)return;let schema;if(typeof s!=="string")schema=s;else{let isArray=s.endsWith("[]"),key=isArray?s.substring(0,s.length-2):s;if(schema=modules.Import(key)??models[key],isArray)schema=t.Array(schema)}if(!schema)return;if(coerce||additionalCoerce)if(coerce)schema=replaceSchemaType(schema,[{from:t.Ref(""),to:(options)=>modules.Import(options.$ref)},{from:t.Number(),to:(options)=>t.Numeric(options),untilObjectFound:!0},{from:t.Boolean(),to:(options)=>t.BooleanString(options),untilObjectFound:!0},...Array.isArray(additionalCoerce)?additionalCoerce:[additionalCoerce]]);else schema=replaceSchemaType(schema,[{from:t.Ref(""),to:(options)=>modules.Import(options.$ref)},...Array.isArray(additionalCoerce)?additionalCoerce:[additionalCoerce]]);if(schema.type==="object"&&"additionalProperties"in schema===!1)schema.additionalProperties=additionalProperties;if(dynamic){let validator={schema,references:"",checkFunc:()=>{},code:"",Check:(value)=>exports_value2.Check(schema,value),Errors:(value)=>exports_value2.Errors(schema,value),Code:()=>"",Clean:createCleaner(schema),Decode:(value)=>exports_value2.Decode(schema,value),Encode:(value)=>exports_value2.Encode(schema,value)};if(normalize&&schema.additionalProperties===!1)validator.Clean=createCleaner(schema);if(schema.config){if(validator.config=schema.config,validator?.schema?.config)delete validator.schema.config}return validator.parse=(v)=>{try{return validator.Decode(v)}catch(error){throw[...validator.Errors(v)].map(mapValueError)}},validator.safeParse=(v)=>{try{return{success:!0,data:validator.Decode(v),error:null}}catch(error){let errors=[...compiled.Errors(v)].map(mapValueError);return{success:!1,data:null,error:errors[0]?.summary,errors}}},validator}let compiled=TypeCompiler.Compile(schema,Object.values(models));if(compiled.Clean=createCleaner(schema),schema.config){if(compiled.config=schema.config,compiled?.schema?.config)delete compiled.schema.config}return compiled.parse=(v)=>{try{return compiled.Decode(v)}catch(error){throw[...compiled.Errors(v)].map(mapValueError)}},compiled.safeParse=(v)=>{try{return{success:!0,data:compiled.Decode(v),error:null}}catch(error){let errors=[...compiled.Errors(v)].map(mapValueError);return{success:!1,data:null,error:errors[0]?.summary,errors}}},compiled},getResponseSchemaValidator=(s,{models={},modules,dynamic=!1,normalize=!1,additionalProperties=!1})=>{if(!s)return;let maybeSchemaOrRecord;if(typeof s!=="string")maybeSchemaOrRecord=s;else{let isArray=s.endsWith("[]"),key=isArray?s.substring(0,s.length-2):s;if(maybeSchemaOrRecord=modules.Import(key)??models[key],isArray)maybeSchemaOrRecord=t.Array(maybeSchemaOrRecord)}if(!maybeSchemaOrRecord)return;let compile=(schema,references)=>{if(dynamic)return{schema,references:"",checkFunc:()=>{},code:"",Check:(value)=>exports_value2.Check(schema,value),Errors:(value)=>exports_value2.Errors(schema,value),Code:()=>"",Clean:createCleaner(schema),Decode:(value)=>exports_value2.Decode(schema,value),Encode:(value)=>exports_value2.Encode(schema,value)};let compiledValidator=TypeCompiler.Compile(schema,references);if(normalize&&schema.additionalProperties===!1)compiledValidator.Clean=createCleaner(schema);return compiledValidator},modelValues=Object.values(models);if(Kind in maybeSchemaOrRecord){if("additionalProperties"in maybeSchemaOrRecord===!1)maybeSchemaOrRecord.additionalProperties=additionalProperties;return{200:compile(maybeSchemaOrRecord,modelValues)}}let record={};return Object.keys(maybeSchemaOrRecord).forEach((status)=>{let maybeNameOrSchema=maybeSchemaOrRecord[+status];if(typeof maybeNameOrSchema==="string"){if(maybeNameOrSchema in models){let schema=models[maybeNameOrSchema];schema.type==="object"&&"additionalProperties"in schema,record[+status]=Kind in schema?compile(schema,modelValues):schema}return}if(maybeNameOrSchema.type==="object"&&"additionalProperties"in maybeNameOrSchema===!1)maybeNameOrSchema.additionalProperties=additionalProperties;record[+status]=Kind in maybeNameOrSchema?compile(maybeNameOrSchema,modelValues):maybeNameOrSchema}),record},isBun=typeof Bun!=="undefined",hasHash=isBun&&typeof Bun.hash==="function",checksum=(s)=>{if(hasHash)return Bun.hash(s);let h=9;for(let i=0;i<s.length;)h=Math.imul(h^s.charCodeAt(i++),387420489);return h=h^h>>>9},_stringToStructureCoercions,stringToStructureCoercions=()=>{if(!_stringToStructureCoercions)_stringToStructureCoercions=[{from:t.Object({}),to:()=>t.ObjectString({}),excludeRoot:!0},{from:t.Array(t.Any()),to:()=>t.ArrayString(t.Any())}];return _stringToStructureCoercions},_coercePrimitiveRoot,coercePrimitiveRoot=()=>{if(!_coercePrimitiveRoot)_coercePrimitiveRoot=[{from:t.Number(),to:(options)=>t.Numeric(options),rootOnly:!0},{from:t.Boolean(),to:(options)=>t.BooleanString(options),rootOnly:!0}];return _coercePrimitiveRoot},getCookieValidator=({validator,modules,defaultConfig={},config,dynamic,models})=>{let cookieValidator=getSchemaValidator(validator,{modules,dynamic,models,additionalProperties:!0,coerce:!0,additionalCoerce:stringToStructureCoercions()});if(isNotEmpty(defaultConfig))if(cookieValidator)cookieValidator.config=mergeCookie(cookieValidator.config,config);else cookieValidator=getSchemaValidator(t.Cookie({}),{modules,dynamic,models,additionalProperties:!0}),cookieValidator.config=defaultConfig;return cookieValidator},injectChecksum=(checksum2,x)=>{if(!x)return;if(!Array.isArray(x)){let fn=x;if(checksum2&&!fn.checksum)fn.checksum=checksum2;if(fn.scope==="scoped")fn.scope="local";return fn}let fns=[...x];for(let fn of fns){if(checksum2&&!fn.checksum)fn.checksum=checksum2;if(fn.scope==="scoped")fn.scope="local"}return fns},mergeLifeCycle=(a,b,checksum2)=>{return{start:mergeObjectArray(a.start,injectChecksum(checksum2,b?.start)),request:mergeObjectArray(a.request,injectChecksum(checksum2,b?.request)),parse:mergeObjectArray(a.parse,injectChecksum(checksum2,b?.parse)),transform:mergeObjectArray(a.transform,injectChecksum(checksum2,b?.transform)),beforeHandle:mergeObjectArray(mergeObjectArray(fnToContainer(a.resolve,"resolve"),a.beforeHandle),injectChecksum(checksum2,mergeObjectArray(fnToContainer(b?.resolve,"resolve"),b?.beforeHandle))),afterHandle:mergeObjectArray(a.afterHandle,injectChecksum(checksum2,b?.afterHandle)),mapResponse:mergeObjectArray(a.mapResponse,injectChecksum(checksum2,b?.mapResponse)),afterResponse:mergeObjectArray(a.afterResponse,injectChecksum(checksum2,b?.afterResponse)),trace:mergeObjectArray(a.trace,injectChecksum(checksum2,b?.trace)),error:mergeObjectArray(a.error,injectChecksum(checksum2,b?.error)),stop:mergeObjectArray(a.stop,injectChecksum(checksum2,b?.stop))}},asHookType=(fn,inject,{skipIfHasType=!1}={})=>{if(!fn)return fn;if(!Array.isArray(fn)){if(skipIfHasType)fn.scope??=inject;else fn.scope=inject;return fn}for(let x of fn)if(skipIfHasType)x.scope??=inject;else x.scope=inject;return fn},filterGlobal=(fn)=>{if(!fn)return fn;if(!Array.isArray(fn))switch(fn.scope){case"global":case"scoped":return{...fn};default:return{fn}}let array=[];for(let x of fn)switch(x.scope){case"global":case"scoped":array.push({...x});break}return array},filterGlobalHook=(hook)=>{return{...hook,type:hook?.type,detail:hook?.detail,parse:filterGlobal(hook?.parse),transform:filterGlobal(hook?.transform),beforeHandle:filterGlobal(hook?.beforeHandle),afterHandle:filterGlobal(hook?.afterHandle),mapResponse:filterGlobal(hook?.mapResponse),afterResponse:filterGlobal(hook?.afterResponse),error:filterGlobal(hook?.error),trace:filterGlobal(hook?.trace)}},StatusMap={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},InvertedStatusMap=Object.fromEntries(Object.entries(StatusMap).map(([k2,v])=>[v,k2]));function removeTrailingEquals(digest){let trimmedDigest=digest;while(trimmedDigest.endsWith("="))trimmedDigest=trimmedDigest.slice(0,-1);return trimmedDigest}var encoder=new TextEncoder,signCookie=async(val,secret)=>{if(typeof val!=="string")throw new TypeError("Cookie value must be provided as a string.");if(secret===null)throw new TypeError("Secret key must be provided.");let secretKey=await crypto.subtle.importKey("raw",encoder.encode(secret),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),hmacBuffer=await crypto.subtle.sign("HMAC",secretKey,encoder.encode(val));return val+"."+removeTrailingEquals(Buffer.from(hmacBuffer).toString("base64"))},unsignCookie=async(input,secret)=>{if(typeof input!=="string")throw new TypeError("Signed cookie string must be provided.");if(secret===null)throw new TypeError("Secret key must be provided.");let tentativeValue=input.slice(0,input.lastIndexOf("."));return await signCookie(tentativeValue,secret)===input?tentativeValue:!1},traceBackMacro=(extension,property,manage)=>{if(!extension||typeof extension!=="object"||!property)return;for(let[key,value]of Object.entries(property)){if(key in primitiveHookMap||!(key in extension))continue;let v=extension[key];if(typeof v==="function"){let hook=v(value);if(typeof hook==="object")for(let[k2,v2]of Object.entries(hook))manage(k2)({fn:v2})}delete property[key]}},createMacroManager=({globalHook,localHook})=>(stackName)=>(type,fn)=>{if(typeof type==="function")type={fn:type};if(stackName==="resolve")type={...type,subType:"resolve"};if("fn"in type||Array.isArray(type)){if(!localHook[stackName])localHook[stackName]=[];if(typeof localHook[stackName]==="function")localHook[stackName]=[localHook[stackName]];if(Array.isArray(type))localHook[stackName]=localHook[stackName].concat(type);else localHook[stackName].push(type);return}let{insert="after",stack="local"}=type;if(typeof fn==="function")fn={fn};if(stack==="global")if(!Array.isArray(fn))if(insert==="before")globalHook[stackName].unshift(fn);else globalHook[stackName].push(fn);else if(insert==="before")globalHook[stackName]=fn.concat(globalHook[stackName]);else globalHook[stackName]=globalHook[stackName].concat(fn);else{if(!localHook[stackName])localHook[stackName]=[];if(typeof localHook[stackName]==="function")localHook[stackName]=[localHook[stackName]];if(!Array.isArray(fn))if(insert==="before")localHook[stackName].unshift(fn);else localHook[stackName].push(fn);else if(insert==="before")localHook[stackName]=fn.concat(localHook[stackName]);else localHook[stackName]=localHook[stackName].concat(fn)}},parseNumericString=(message)=>{if(typeof message==="number")return message;if(message.length<16){if(message.trim().length===0)return null;let length=Number(message);if(Number.isNaN(length))return null;return length}if(message.length===16){if(message.trim().length===0)return null;let number=Number(message);if(Number.isNaN(number)||number.toString()!==message)return null;return number}return null},isNumericString=(message)=>parseNumericString(message)!==null;class PromiseGroup{onError;root=null;promises=[];constructor(onError=console.error){this.onError=onError}get size(){return this.promises.length}add(promise){return this.promises.push(promise),this.root||=this.drain(),promise}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch(error){this.onError(error)}this.promises.shift()}this.root=null}then(onfulfilled,onrejected){return(this.root??Promise.resolve()).then(onfulfilled,onrejected)}}var fnToContainer=(fn,subType)=>{if(!fn)return fn;if(!Array.isArray(fn)){if(typeof fn==="function"||typeof fn==="string")return subType?{fn,subType}:{fn};else if("fn"in fn)return fn}let fns=[];for(let x of fn)if(typeof x==="function"||typeof x==="string")fns.push(subType?{fn:x,subType}:{fn:x});else if("fn"in x)fns.push(x);return fns},localHookToLifeCycleStore=(a)=>{return{...a,start:fnToContainer(a?.start),request:fnToContainer(a?.request),parse:fnToContainer(a?.parse),transform:fnToContainer(a?.transform),beforeHandle:fnToContainer(a?.beforeHandle),afterHandle:fnToContainer(a?.afterHandle),mapResponse:fnToContainer(a?.mapResponse),afterResponse:fnToContainer(a?.afterResponse),trace:fnToContainer(a?.trace),error:fnToContainer(a?.error),stop:fnToContainer(a?.stop)}},lifeCycleToFn=(a)=>{let hook={};if(a.start?.map)hook.start=a.start.map((x)=>x.fn);if(a.request?.map)hook.request=a.request.map((x)=>x.fn);if(a.parse?.map)hook.parse=a.parse.map((x)=>x.fn);if(a.transform?.map)hook.transform=a.transform.map((x)=>x.fn);if(a.beforeHandle?.map)hook.beforeHandle=a.beforeHandle.map((x)=>x.fn);if(a.afterHandle?.map)hook.afterHandle=a.afterHandle.map((x)=>x.fn);if(a.mapResponse?.map)hook.mapResponse=a.mapResponse.map((x)=>x.fn);if(a.afterResponse?.map)hook.afterResponse=a.afterResponse.map((x)=>x.fn);if(a.trace?.map)hook.trace=a.trace.map((x)=>x.fn);if(a.error?.map)hook.error=a.error.map((x)=>x.fn);if(a.stop?.map)hook.stop=a.stop.map((x)=>x.fn);return hook},cloneInference=(inference)=>({body:inference.body,cookie:inference.cookie,headers:inference.headers,query:inference.query,set:inference.set,server:inference.server,request:inference.request,route:inference.route}),redirect=(url,status=302)=>Response.redirect(url,status),ELYSIA_FORM_DATA=Symbol("ElysiaFormData"),ELYSIA_REQUEST_ID=Symbol("ElysiaRequestId");var randomId=()=>{let uuid=crypto.randomUUID();return uuid.slice(0,8)+uuid.slice(24,32)},deduplicateChecksum=(array)=>{let hashes=[];for(let i=0;i<array.length;i++){let item=array[i];if(item.checksum){if(hashes.includes(item.checksum))array.splice(i,1),i--;hashes.push(item.checksum)}}return array},promoteEvent=(events,as="scoped")=>{if(!events)return;if(as==="scoped"){for(let event of events)if("scope"in event&&event.scope==="local")event.scope="scoped";return}for(let event of events)if("scope"in event)event.scope="global"},getLoosePath=(path)=>{if(path.charCodeAt(path.length-1)===47)return path.slice(0,path.length-1);return path+"/"},isNotEmpty=(obj)=>{if(!obj)return!1;for(let x in obj)return!0;return!1},isEmptyHookProperty=(prop)=>{if(Array.isArray(prop))return prop.length===0;return!prop},compressHistoryHook=(hook)=>{let history={...hook};if(isEmptyHookProperty(hook.afterHandle))delete history.afterHandle;if(isEmptyHookProperty(hook.afterResponse))delete history.afterResponse;if(isEmptyHookProperty(hook.beforeHandle))delete history.beforeHandle;if(isEmptyHookProperty(hook.error))delete history.error;if(isEmptyHookProperty(hook.mapResponse))delete history.mapResponse;if(isEmptyHookProperty(hook.parse))delete history.parse;if(isEmptyHookProperty(hook.request))delete history.request;if(isEmptyHookProperty(hook.start))delete history.start;if(isEmptyHookProperty(hook.stop))delete history.stop;if(isEmptyHookProperty(hook.trace))delete history.trace;if(isEmptyHookProperty(hook.transform))delete history.transform;if(!history.type)delete history.type;if(history.detail&&!Object.keys(history.detail).length)delete history.detail;if(!history.body)delete history.body;if(!history.cookie)delete history.cookie;if(!history.headers)delete history.headers;if(!history.query)delete history.query;if(!history.params)delete history.params;if(!history.response)delete history.response;return history},encodePath=(path,{dynamic=!1}={})=>{let encoded=encodeURIComponent(path).replace(/%2F/g,"/");if(dynamic)encoded=encoded.replace(/%3A/g,":").replace(/%3F/g,"?");return encoded},env=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,ERROR_CODE=Symbol("ElysiaErrorCode"),isProduction=(env?.NODE_ENV??env?.ENV)==="production";class ElysiaCustomStatusResponse{code;response;constructor(code,response){let res=response??(code in InvertedStatusMap?InvertedStatusMap[code]:code);this.code=StatusMap[code]??code,this.response=res}}var error=(code,response)=>new ElysiaCustomStatusResponse(code,response);class InternalServerError extends Error{code="INTERNAL_SERVER_ERROR";status=500;constructor(message){super(message??"INTERNAL_SERVER_ERROR")}}class NotFoundError extends Error{code="NOT_FOUND";status=404;constructor(message){super(message??"NOT_FOUND")}}class ParseError2 extends Error{code="PARSE";status=400;constructor(){super("Bad Request")}}class InvalidCookieSignature extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor(key,message){super(message??`"${key}" has invalid cookie signature`);this.key=key}}var mapValueError=(error2)=>{if(!error2)return{summary:void 0};let{message,path,value,type}=error2,property=path.slice(1).replaceAll("/","."),isRoot=path==="";switch(type){case 42:return{...error2,summary:isRoot?"Value should not be provided":`Property '${property}' should not be provided`};case 45:return{...error2,summary:isRoot?"Value is missing":`Property '${property}' is missing`};case 50:let quoteIndex=message.indexOf("'"),format=message.slice(quoteIndex+1,message.indexOf("'",quoteIndex+1));return{...error2,summary:isRoot?"Value should be an email":`Property '${property}' should be ${format}`};case 54:return{...error2,summary:`${message.slice(0,9)} property '${property}' to be ${message.slice(8)} but found: ${value}`};case 62:let union=error2.schema.anyOf.map((x)=>`'${x?.format??x.type}'`).join(", ");return{...error2,summary:isRoot?`Value should be one of ${union}`:`Property '${property}' should be one of: ${union}`};default:return{summary:message,...error2}}};class ValidationError extends Error{type;validator;value;code="VALIDATION";status=422;constructor(type,validator,value){if(value&&typeof value==="object"&&value instanceof ElysiaCustomStatusResponse)value=value.response;let error2=isProduction?void 0:("Errors"in validator)?validator.Errors(value).First():exports_value2.Errors(validator,value).First(),customError=error2?.schema?.message||error2?.schema?.error!==void 0?typeof error2.schema.error==="function"?error2.schema.error({type,validator,value,get errors(){return[...validator.Errors(value)].map(mapValueError)}}):error2.schema.error:void 0,accessor=error2?.path||"root",message="";if(customError!==void 0)message=typeof customError==="object"?JSON.stringify(customError):customError+"";else if(isProduction)message=JSON.stringify({type:"validation",on:type,summary:mapValueError(error2).summary,message:error2?.message,found:value});else{let schema=validator?.schema??validator,errors="Errors"in validator?[...validator.Errors(value)].map(mapValueError):[...exports_value2.Errors(validator,value)].map(mapValueError),expected;try{expected=exports_value2.Create(schema)}catch(error3){expected={type:"Could not create expected value",message:error3?.message,error:error3}}message=JSON.stringify({type:"validation",on:type,summary:mapValueError(error2).summary,property:accessor,message:error2?.message,expected,found:value,errors},null,2)}super(message);this.type=type,this.validator=validator,this.value=value,Object.setPrototypeOf(this,ValidationError.prototype)}get all(){return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(mapValueError):[...exports_value2.Errors(this.validator,this.value)].map(mapValueError)}static simplifyModel(validator){let model="schema"in validator?validator.schema:validator;try{return exports_value2.Create(model)}catch{return model}}get model(){return ValidationError.simplifyModel(this.validator)}toResponse(headers){return new Response(this.message,{status:400,headers:{...headers,"content-type":"application/json"}})}}var isISO8601=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,isFormalDate=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,isShortenDate=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,_validateDate=fullFormats.date,_validateDateTime=fullFormats["date-time"];if(!exports_format.Has("date"))exports_format.Set("date",(value)=>{let temp=value.replace(/"/g,"");if(isISO8601.test(temp)||isFormalDate.test(temp)||isShortenDate.test(temp)||_validateDate(temp)){let date2=new Date(temp);if(!Number.isNaN(date2.getTime()))return!0}return!1});if(!exports_format.Has("date-time"))exports_format.Set("date-time",(value)=>{let temp=value.replace(/"/g,"");if(isISO8601.test(temp)||isFormalDate.test(temp)||isShortenDate.test(temp)||_validateDateTime(temp)){let date2=new Date(temp);if(!Number.isNaN(date2.getTime()))return!0}return!1});Object.entries(fullFormats).forEach((formatEntry)=>{let[formatName,formatValue]=formatEntry;if(!exports_format.Has(formatName)){if(formatValue instanceof RegExp)exports_format.Set(formatName,(value)=>formatValue.test(value));else if(typeof formatValue==="function")exports_format.Set(formatName,formatValue)}});var t=Object.assign({},Type),parseFileUnit=(size)=>{if(typeof size==="string")switch(size.slice(-1)){case"k":return+size.slice(0,size.length-1)*1024;case"m":return+size.slice(0,size.length-1)*1048576;default:return+size}return size},checkFileExtension=(type,extension)=>{if(type.startsWith(extension))return!0;return extension.charCodeAt(extension.length-1)===42&&extension.charCodeAt(extension.length-2)===47&&type.startsWith(extension.slice(0,-1))},validateFile=(options,value)=>{if(!(value instanceof Blob))return!1;if(options.minSize&&value.size<parseFileUnit(options.minSize))return!1;if(options.maxSize&&value.size>parseFileUnit(options.maxSize))return!1;if(options.extension){if(typeof options.extension==="string")return checkFileExtension(value.type,options.extension);for(let i=0;i<options.extension.length;i++)if(checkFileExtension(value.type,options.extension[i]))return!0;return!1}return!0},File2=getOrSetType("File",validateFile),Files=getOrSetType("Files",(options,value)=>{if(!Array.isArray(value))return validateFile(options,value);if(options.minItems&&value.length<options.minItems)return!1;if(options.maxItems&&value.length>options.maxItems)return!1;for(let i=0;i<value.length;i++)if(!validateFile(options,value[i]))return!1;return!0});if(!exports_format.Has("numeric"))exports_format.Set("numeric",(value)=>!!value&&!isNaN(+value));if(!exports_format.Has("integer"))exports_format.Set("integer",(value)=>!!value&&Number.isInteger(+value));if(!exports_format.Has("boolean"))exports_format.Set("boolean",(value)=>value==="true"||value==="false");if(!exports_format.Has("ObjectString"))exports_format.Set("ObjectString",(value)=>{let start=value.charCodeAt(0);if(start===9||start===10||start===32)start=value.trimStart().charCodeAt(0);if(start!==123&&start!==91)return!1;try{return JSON.parse(value),!0}catch{return!1}});if(!exports_format.Has("ArrayString"))exports_format.Set("ArrayString",(value)=>{let start=value.charCodeAt(0);if(start===9||start===10||start===32)start=value.trimStart().charCodeAt(0);if(start!==123&&start!==91)return!1;try{return JSON.parse(value),!0}catch{return!1}});if(!exports_type2.Has("UnionEnum"))exports_type2.Set("UnionEnum",(schema,value)=>{return(typeof value==="number"||typeof value==="string"||value===null)&&schema.enum.includes(value)});var ElysiaType={Numeric:(property)=>{let schema=Type.Number(property);return t.Transform(t.Union([t.String({format:"numeric",default:0}),t.Number(property)],property)).Decode((value)=>{let number=+value;if(isNaN(number))return value;if(property&&!exports_value2.Check(schema,number))throw new ValidationError("property",schema,number);return number}).Encode((value)=>value)},Integer:(property)=>{let schema=Type.Integer(property);return t.Transform(t.Union([t.String({format:"integer",default:0}),Type.Integer(property)],property)).Decode((value)=>{let number=+value;if(!exports_value2.Check(schema,number))throw new ValidationError("property",schema,number);return number}).Encode((value)=>value)},Date:(property)=>{let schema=Type.Date(property),_default=property?.default?new Date(property.default):void 0;return t.Transform(t.Union([Type.Date(property),t.String({format:"date",default:_default?.toISOString()}),t.String({format:"date-time",default:_default?.toISOString()}),t.Number({default:_default?.getTime()})],property)).Decode((value)=>{if(typeof value==="number"){let date3=new Date(value);if(!exports_value2.Check(schema,date3))throw new ValidationError("property",schema,date3);return date3}if(value instanceof Date)return value;let date2=new Date(value);if(!date2||isNaN(date2.getTime()))throw new ValidationError("property",schema,date2);if(!exports_value2.Check(schema,date2))throw new ValidationError("property",schema,date2);return date2}).Encode((value)=>value.toISOString())},BooleanString:(property)=>{let schema=Type.Boolean(property);return t.Transform(t.Union([t.Boolean(property),t.String({format:"boolean",default:!1})],property)).Decode((value)=>{if(typeof value==="string")return value==="true";if(value!==void 0&&!exports_value2.Check(schema,value))throw new ValidationError("property",schema,value);return value}).Encode((value)=>value)},ObjectString:(properties,options)=>{let schema=t.Object(properties,options),defaultValue=JSON.stringify(exports_value2.Create(schema)),compiler;try{compiler=TypeCompiler.Compile(schema)}catch{}return t.Transform(t.Union([t.String({format:"ObjectString",default:defaultValue}),schema])).Decode((value)=>{if(typeof value==="string"){if(value.charCodeAt(0)!==123)throw new ValidationError("property",schema,value);try{value=JSON.parse(value)}catch{throw new ValidationError("property",schema,value)}if(compiler){if(!compiler.Check(value))throw new ValidationError("property",schema,value);return compiler.Decode(value)}if(!exports_value2.Check(schema,value))throw new ValidationError("property",schema,value);return exports_value2.Decode(schema,value)}return value}).Encode((value)=>{if(typeof value==="string")try{value=JSON.parse(value)}catch{throw new ValidationError("property",schema,value)}if(!exports_value2.Check(schema,value))throw new ValidationError("property",schema,value);return JSON.stringify(value)})},ArrayString:(children=t.String(),options)=>{let schema=t.Array(children,options),compiler;try{compiler=TypeCompiler.Compile(schema)}catch{}let decode2=(value,isProperty=!1)=>{if(value.charCodeAt(0)===91){try{value=JSON.parse(value)}catch{throw new ValidationError("property",schema,value)}if(compiler){if(!compiler.Check(value))throw new ValidationError("property",schema,value);return compiler.Decode(value)}if(!exports_value2.Check(schema,value))throw new ValidationError("property",schema,value);return exports_value2.Decode(schema,value)}if(value.indexOf(",")!==-1){let newValue=value.split(",").map((v)=>v.trim());if(compiler){if(!compiler.Check(newValue))throw new ValidationError("property",schema,value);return compiler.Decode(newValue)}if(!exports_value2.Check(schema,newValue))throw new ValidationError("property",schema,newValue);return exports_value2.Decode(schema,newValue)}if(isProperty)return value;throw new ValidationError("property",schema,value)};return t.Transform(t.Union([t.String({format:"ArrayString",default:options?.default}),schema])).Decode((value)=>{if(Array.isArray(value)){let values=[];for(let i=0;i<value.length;i++){let v=value[i];if(typeof v==="string"){let t2=decode2(v,!0);if(Array.isArray(t2))values=values.concat(t2);else values.push(t2);continue}values.push(v)}return values}if(typeof value==="string")return decode2(value);return value}).Encode((value)=>{if(typeof value==="string")try{value=JSON.parse(value)}catch{throw new ValidationError("property",schema,value)}if(!exports_value2.Check(schema,value))throw new ValidationError("property",schema,value);return JSON.stringify(value)})},File:File2,Files:(options={})=>t.Transform(Files(options)).Decode((value)=>{if(Array.isArray(value))return value;return[value]}).Encode((value)=>value),Nullable:(schema,options)=>t.Union([schema,t.Null()],options),MaybeEmpty:(schema,options)=>t.Union([schema,t.Null(),t.Undefined()],options),Cookie:(properties,{domain,expires,httpOnly,maxAge,path,priority,sameSite,secure,secrets,sign,...options}={})=>{let v=t.Object(properties,options);return v.config={domain,expires,httpOnly,maxAge,path,priority,sameSite,secure,secrets,sign},v},UnionEnum:(values,options={})=>{let type=values.every((value)=>typeof value==="string")?{type:"string"}:values.every((value)=>typeof value==="number")?{type:"number"}:values.every((value)=>value===null)?{type:"null"}:{};if(values.some((x)=>typeof x==="object"&&x!==null))throw new Error("This type does not support objects or arrays");return{default:values[0],...options,[Kind]:"UnionEnum",...type,enum:values}}};t.BooleanString=ElysiaType.BooleanString;t.ObjectString=ElysiaType.ObjectString;t.ArrayString=ElysiaType.ArrayString;t.Numeric=ElysiaType.Numeric;t.Integer=ElysiaType.Integer;t.File=(arg={})=>ElysiaType.File({default:"File",...arg,extension:arg?.type,type:"string",format:"binary"});t.Files=(arg={})=>ElysiaType.Files({...arg,elysiaMeta:"Files",default:"Files",extension:arg?.type,type:"array",items:{...arg,default:"Files",type:"string",format:"binary"}});t.Nullable=(schema)=>ElysiaType.Nullable(schema);t.MaybeEmpty=ElysiaType.MaybeEmpty;t.Cookie=ElysiaType.Cookie;t.Date=ElysiaType.Date;t.UnionEnum=ElysiaType.UnionEnum;function getOrSetType(kind,func){if(!exports_type2.Has(kind))exports_type2.Set(kind,func);return(options={})=>Unsafe({...options,[Kind]:kind})}var hasReturn=(fn)=>{let fnLiteral=typeof fn==="object"?fn.fn.toString():typeof fn==="string"?fn.toString():fn,parenthesisEnd=fnLiteral.indexOf(")");if(fnLiteral.charCodeAt(parenthesisEnd+2)===61&&fnLiteral.charCodeAt(parenthesisEnd+5)!==123)return!0;return fnLiteral.includes("return")},separateFunction=(code)=>{if(code.startsWith("async"))code=code.slice(5);code=code.trimStart();let index=-1;if(code.charCodeAt(0)===40){if(index=code.indexOf("=>",code.indexOf(")")),index!==-1){let bracketEndIndex=index;while(bracketEndIndex>0)if(code.charCodeAt(--bracketEndIndex)===41)break;let body=code.slice(index+2);if(body.charCodeAt(0)===32)body=body.trimStart();return[code.slice(1,bracketEndIndex),body,{isArrowReturn:body.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test(code)){if(index=code.indexOf("=>"),index!==-1){let body=code.slice(index+2);if(body.charCodeAt(0)===32)body=body.trimStart();return[code.slice(0,index),body,{isArrowReturn:body.charCodeAt(0)!==123}]}}if(code.startsWith("function")){index=code.indexOf("(");let end=code.indexOf(")");return[code.slice(index+1,end),code.slice(end+2),{isArrowReturn:!1}]}let start=code.indexOf("(");if(start!==-1){let sep=code.indexOf(`
`,2),parameter=code.slice(0,sep),end=parameter.lastIndexOf(")")+1,body=code.slice(sep+1);return[parameter.slice(start,end),"{"+body,{isArrowReturn:!1}]}let x=code.split(`
`,2);return[x[0],x[1],{isArrowReturn:!1}]},bracketPairRange=(parameter)=>{let start=parameter.indexOf("{");if(start===-1)return[-1,0];let end=start+1,deep=1;for(;end<parameter.length;end++){let char=parameter.charCodeAt(end);if(char===123)deep++;else if(char===125)deep--;if(deep===0)break}if(deep!==0)return[0,parameter.length];return[start,end+1]},bracketPairRangeReverse=(parameter)=>{let end=parameter.lastIndexOf("}");if(end===-1)return[-1,0];let start=end-1,deep=1;for(;start>=0;start--){let char=parameter.charCodeAt(start);if(char===125)deep++;else if(char===123)deep--;if(deep===0)break}if(deep!==0)return[-1,0];return[start,end+1]},removeColonAlias=(parameter)=>{while(!0){let start=parameter.indexOf(":");if(start===-1)break;let end=parameter.indexOf(",",start);if(end===-1)end=parameter.indexOf("}",start)-1;if(end===-2)end=parameter.length;parameter=parameter.slice(0,start)+parameter.slice(end)}return parameter},retrieveRootParamters=(parameter)=>{let hasParenthesis=!1;if(parameter.charCodeAt(0)===40)parameter=parameter.slice(1,-1);if(parameter.charCodeAt(0)===123)hasParenthesis=!0,parameter=parameter.slice(1,-1);parameter=parameter.replace(/( |\t|\n)/g,"").trim();let parameters=[];while(!0){let[start,end]=bracketPairRange(parameter);if(start===-1)break;if(parameters.push(parameter.slice(0,start-1)),parameter.charCodeAt(end)===44)end++;parameter=parameter.slice(end)}if(parameter=removeColonAlias(parameter),parameter)parameters=parameters.concat(parameter.split(","));let newParameters=[];for(let p of parameters){if(p.indexOf(",")===-1){newParameters.push(p);continue}for(let q of p.split(","))newParameters.push(q.trim())}return parameters=newParameters,{hasParenthesis,parameters}},findParameterReference=(parameter,inference)=>{let{parameters,hasParenthesis}=retrieveRootParamters(parameter);if(!inference.query&&parameters.includes("query"))inference.query=!0;if(!inference.headers&&parameters.includes("headers"))inference.headers=!0;if(!inference.body&&parameters.includes("body"))inference.body=!0;if(!inference.cookie&&parameters.includes("cookie"))inference.cookie=!0;if(!inference.set&&parameters.includes("set"))inference.set=!0;if(!inference.server&&parameters.includes("server"))inference.server=!0;if(!inference.request&&parameters.includes("request"))inference.request=!0;if(!inference.route&&parameters.includes("route"))inference.route=!0;if(hasParenthesis)return`{ ${parameters.join(", ")} }`;return parameters.join(", ")},findEndIndex=(type,content,index)=>{let newLineIndex=content.indexOf(type+`
`,index),newTabIndex=content.indexOf(type+"\t",index),commaIndex=content.indexOf(type+",",index),semicolonIndex=content.indexOf(type+";",index),emptyIndex=content.indexOf(type+" ",index);return[newLineIndex,newTabIndex,commaIndex,semicolonIndex,emptyIndex].filter((i)=>i>0).sort((a,b)=>a-b)[0]||-1},findAlias=(type,body,depth=0)=>{if(depth>5)return[];let aliases=[],content=body;while(!0){let index=findEndIndex(" = "+type,content);if(index===-1)index=findEndIndex("="+type,content);if(index===-1){let lastIndex=content.indexOf(" = "+type);if(lastIndex===-1)lastIndex=content.indexOf("="+type);if(lastIndex+3+type.length!==content.length)break;index=lastIndex}let part=content.slice(0,index),lastPart=part.lastIndexOf(" "),variable=part.slice(lastPart!==-1?lastPart+1:-1);if(variable==="}"){let[start,end]=bracketPairRangeReverse(part);aliases.push(removeColonAlias(content.slice(start,end))),content=content.slice(index+3+type.length);continue}while(variable.charCodeAt(0)===44)variable=variable.slice(1);while(variable.charCodeAt(0)===9)variable=variable.slice(1);if(!variable.includes("("))aliases.push(variable);content=content.slice(index+3+type.length)}for(let alias of aliases){if(alias.charCodeAt(0)===123)continue;let deepAlias=findAlias(alias,body);if(deepAlias.length>0)aliases.push(...deepAlias)}return aliases},extractMainParameter=(parameter)=>{if(!parameter)return;if(parameter.charCodeAt(0)!==123)return parameter;if(parameter=parameter.slice(2,-2),!parameter.includes(",")){if(parameter.includes("..."))return parameter.slice(parameter.indexOf("...")+3);return}let spreadIndex=parameter.indexOf("...");if(spreadIndex===-1)return;return parameter.slice(spreadIndex+3).trimEnd()},inferBodyReference=(code,aliases,inference)=>{let access=(type,alias)=>code.includes(alias+"."+type)||code.includes(alias+'["'+type+'"]')||code.includes(alias+"['"+type+"']");for(let alias of aliases){if(!alias)continue;if(alias.charCodeAt(0)===123){let parameters=retrieveRootParamters(alias).parameters;if(!inference.query&&parameters.includes("query"))inference.query=!0;if(!inference.headers&&parameters.includes("headers"))inference.headers=!0;if(!inference.body&&parameters.includes("body"))inference.body=!0;if(!inference.cookie&&parameters.includes("cookie"))inference.cookie=!0;if(!inference.set&&parameters.includes("set"))inference.set=!0;if(!inference.query&&parameters.includes("server"))inference.server=!0;if(!inference.request&&parameters.includes("request"))inference.request=!0;if(!inference.route&&parameters.includes("route"))inference.route=!0;continue}if(!inference.query&&access("query",alias))inference.query=!0;if(code.includes("return "+alias)||code.includes("return "+alias+".query"))inference.query=!0;if(!inference.headers&&access("headers",alias))inference.headers=!0;if(!inference.body&&access("body",alias))inference.body=!0;if(!inference.cookie&&access("cookie",alias))inference.cookie=!0;if(!inference.set&&access("set",alias))inference.set=!0;if(!inference.server&&access("server",alias))inference.server=!0;if(inference.query&&inference.headers&&inference.body&&inference.cookie&&inference.set&&inference.server&&inference.server&&inference.route)break}return aliases},isContextPassToFunction=(context,body,inference)=>{try{let captureFunction=new RegExp(`(?:\\w)\\((?:.*)?${context}`,"gs");captureFunction.test(body);let nextChar=body.charCodeAt(captureFunction.lastIndex);if(nextChar===41||nextChar===44)return inference.query=!0,inference.headers=!0,inference.body=!0,inference.cookie=!0,inference.set=!0,inference.server=!0,inference.route=!0,inference.request=!0,!0;return!1}catch(error2){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log(body),console.log("--- context ---"),console.log(context),!0}},sucrose=(lifeCycle,inference={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,request:!1,route:!1})=>{let events=[];if(lifeCycle.handler&&typeof lifeCycle.handler==="function")events.push(lifeCycle.handler);if(lifeCycle.request?.length)events.push(...lifeCycle.request);if(lifeCycle.beforeHandle?.length)events.push(...lifeCycle.beforeHandle);if(lifeCycle.parse?.length)events.push(...lifeCycle.parse);if(lifeCycle.error?.length)events.push(...lifeCycle.error);if(lifeCycle.transform?.length)events.push(...lifeCycle.transform);if(lifeCycle.afterHandle?.length)events.push(...lifeCycle.afterHandle);if(lifeCycle.mapResponse?.length)events.push(...lifeCycle.mapResponse);if(lifeCycle.afterResponse?.length)events.push(...lifeCycle.afterResponse);for(let e of events){if(!e)continue;let event="fn"in e?e.fn:e;if(typeof event!=="function")continue;let[parameter,body,{isArrowReturn}]=separateFunction(event.toString()),rootParameters=findParameterReference(parameter,inference),mainParameter=extractMainParameter(rootParameters);if(mainParameter){let aliases=findAlias(mainParameter,body.slice(1,-1));aliases.splice(0,-1,mainParameter);let code=body;if(code.charCodeAt(0)===123&&code.charCodeAt(body.length-1)===125)code=code.slice(1,-1);if(!isContextPassToFunction(mainParameter,code,inference))inferBodyReference(code,aliases,inference);if(!inference.query&&code.includes("return "+mainParameter+".query"))inference.query=!0}if(inference.query&&inference.headers&&inference.body&&inference.cookie&&inference.set&&inference.server&&inference.request&&inference.route)break}return inference},hex=[];for(let i=48;i<58;i++)hex[i]=i-48;for(let i=0;i<6;i++)hex[i+65]=hex[i+97]=i+10;var calcHex=(a,b)=>{if(a in hex&&b in hex)return hex[a]<<4|hex[b];return 255},type=[...new Array(128).fill(0),...new Array(16).fill(1),...new Array(16).fill(2),...new Array(32).fill(3),4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4],next=[0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0],mask=type.map((val)=>[127,63,63,63,0,31,15,15,15,7,7,7][val]),decode2=(url)=>{let percentPosition=url.indexOf("%");if(percentPosition===-1)return url;let end=url.length-3;if(percentPosition>end)return null;let decoded="",start=0,codepoint=0,startOfOctets=percentPosition,state=12,byte2;for(;;){if(byte2=calcHex(url.charCodeAt(percentPosition+1),url.charCodeAt(percentPosition+2)),state=next[state+type[byte2]],state===0)return null;if(state===12){if(decoded+=url.substring(start,startOfOctets),codepoint=codepoint<<6|byte2&mask[byte2],codepoint>65535)decoded+=String.fromCharCode(55232+(codepoint>>10),56320+(codepoint&1023));else decoded+=String.fromCharCode(codepoint);if(start=percentPosition+3,percentPosition=url.indexOf("%",start),percentPosition===-1)return decoded+url.substring(start);if(percentPosition>end)return null;startOfOctets=percentPosition,codepoint=0}else{if(percentPosition+=3,percentPosition>end||url.charCodeAt(percentPosition)!==37)return null;codepoint=codepoint<<6|byte2&mask[byte2]}}};class Cookie{name;jar;initial;constructor(name,jar,initial={}){this.name=name,this.jar=jar,this.initial=initial}get cookie(){return this.jar[this.name]??this.initial}set cookie(jar){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=jar}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie(jar){this.cookie=jar}get value(){return this.cookie.value}set value(value){this.setCookie.value=value}get expires(){return this.cookie.expires}set expires(expires){this.setCookie.expires=expires}get maxAge(){return this.cookie.maxAge}set maxAge(maxAge){this.setCookie.maxAge=maxAge}get domain(){return this.cookie.domain}set domain(domain){this.setCookie.domain=domain}get path(){return this.cookie.path}set path(path){this.setCookie.path=path}get secure(){return this.cookie.secure}set secure(secure){this.setCookie.secure=secure}get httpOnly(){return this.cookie.httpOnly}set httpOnly(httpOnly){this.setCookie.httpOnly=httpOnly}get sameSite(){return this.cookie.sameSite}set sameSite(sameSite){this.setCookie.sameSite=sameSite}get priority(){return this.cookie.priority}set priority(priority){this.setCookie.priority=priority}get partitioned(){return this.cookie.partitioned}set partitioned(partitioned){this.setCookie.partitioned=partitioned}get secrets(){return this.cookie.secrets}set secrets(secrets){this.setCookie.secrets=secrets}update(config){return this.setCookie=Object.assign(this.cookie,typeof config==="function"?config(this.cookie):config),this}set(config){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof config==="function"?config(this.cookie):config),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var createCookieJar=(set2,store,initial)=>{if(!set2.cookie)set2.cookie={};return new Proxy(store,{get(_2,key){if(key in store)return new Cookie(key,set2.cookie,Object.assign({},initial??{},store[key]));return new Cookie(key,set2.cookie,Object.assign({},initial))}})},parseCookie=async(set2,cookieString,{secrets,sign,...initial}={})=>{if(!cookieString)return createCookieJar(set2,{},initial);let isStringKey=typeof secrets==="string";if(sign&&sign!==!0&&!Array.isArray(sign))sign=[sign];let jar={},cookies=import_cookie.parse(cookieString);for(let[name,v]of Object.entries(cookies)){if(v===void 0)continue;let value=decode2(v);if(sign===!0||sign?.includes(name)){if(!secrets)throw new Error("No secret is provided to cookie plugin");if(isStringKey){let temp=await unsignCookie(value,secrets);if(temp===!1)throw new InvalidCookieSignature(name);value=temp}else{let decoded=!0;for(let i=0;i<secrets.length;i++){let temp=await unsignCookie(value,secrets[i]);if(temp!==!1){decoded=!0,value=temp;break}}if(!decoded)throw new InvalidCookieSignature(name)}}jar[name]={value}}return createCookieJar(set2,jar,initial)},serializeCookie=(cookies)=>{if(!cookies||!isNotEmpty(cookies))return;let set2=[];for(let[key,property]of Object.entries(cookies)){if(!key||!property)continue;let value=property.value;if(value===void 0||value===null)continue;set2.push(import_cookie.serialize(key,typeof value==="object"?JSON.stringify(value):value+"",property))}if(set2.length===0)return;if(set2.length===1)return set2[0];return set2},handleFile=(response,set2)=>{let size=response.size;if(!set2&&size||size&&set2&&set2.status!==206&&set2.status!==304&&set2.status!==412&&set2.status!==416){if(set2){if(set2.headers instanceof Headers){let setHeaders={"accept-ranges":"bytes","content-range":`bytes 0-${size-1}/${size}`,"transfer-encoding":"chunked"};if(hasHeaderShorthand)setHeaders=set2.headers.toJSON();else{setHeaders={};for(let[key,value]of set2.headers.entries())if(key in set2.headers)setHeaders[key]=value}return new Response(response,{status:set2.status,headers:setHeaders})}if(isNotEmpty(set2.headers))return new Response(response,{status:set2.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${size-1}/${size}`,"transfer-encoding":"chunked"},set2.headers)})}return new Response(response,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${size-1}/${size}`,"transfer-encoding":"chunked"}})}return new Response(response)},parseSetCookies=(headers,setCookie)=>{if(!headers)return headers;headers.delete("set-cookie");for(let i=0;i<setCookie.length;i++){let index=setCookie[i].indexOf("=");headers.append("set-cookie",`${setCookie[i].slice(0,index)}=${setCookie[i].slice(index+1)||""}`)}return headers},responseToSetHeaders=(response,set2)=>{if(set2?.headers){if(response){if(hasHeaderShorthand)Object.assign(set2.headers,response.headers.toJSON());else for(let[key,value]of response.headers.entries())if(key in set2.headers)set2.headers[key]=value}if(set2.status===200)set2.status=response.status;if(set2.headers["content-encoding"])delete set2.headers["content-encoding"];return set2}if(!response)return{headers:{},status:set2?.status??200};if(hasHeaderShorthand){if(set2={headers:response.headers.toJSON(),status:set2?.status??200},set2.headers["content-encoding"])delete set2.headers["content-encoding"];return set2}set2={headers:{},status:set2?.status??200};for(let[key,value]of response.headers.entries()){if(key==="content-encoding")continue;if(key in set2.headers)set2.headers[key]=value}return set2},handleStream=async(generator,set2,request)=>{let init=generator.next();if(init instanceof Promise)init=await init;if(init.done){if(set2)return mapResponse(init.value,set2,request);return mapCompactResponse(init.value,request)}if(set2?.headers){if(!set2.headers["transfer-encoding"])set2.headers["transfer-encoding"]="chunked";if(!set2.headers["content-type"])set2.headers["content-type"]="text/event-stream; charset=utf-8"}else set2={status:200,headers:{"content-type":"text/event-stream; charset=utf-8","transfer-encoding":"chunked"}};return new Response(new ReadableStream({async start(controller){let end=!1;if(request?.signal?.addEventListener("abort",()=>{end=!0;try{controller.close()}catch{}}),init.value!==void 0&&init.value!==null)if(typeof init.value==="object")try{controller.enqueue(Buffer.from(JSON.stringify(init.value)))}catch{controller.enqueue(Buffer.from(init.value.toString()))}else controller.enqueue(Buffer.from(init.value.toString()));for await(let chunk of generator){if(end)break;if(chunk===void 0||chunk===null)continue;if(typeof chunk==="object")try{controller.enqueue(Buffer.from(JSON.stringify(chunk)))}catch{controller.enqueue(Buffer.from(chunk.toString()))}else controller.enqueue(Buffer.from(chunk.toString()));await new Promise((resolve)=>setTimeout(()=>resolve(),0))}try{controller.close()}catch{}}}),set2)};async function*streamResponse(response){let body=response.body;if(!body)return;let reader=body.getReader(),decoder=new TextDecoder;try{while(!0){let{done,value}=await reader.read();if(done)break;yield decoder.decode(value)}}finally{reader.releaseLock()}}var handleSet=(set2)=>{if(typeof set2.status==="string")set2.status=StatusMap[set2.status];if(set2.cookie&&isNotEmpty(set2.cookie)){let cookie=serializeCookie(set2.cookie);if(cookie)set2.headers["set-cookie"]=cookie}if(set2.headers["set-cookie"]&&Array.isArray(set2.headers["set-cookie"]))set2.headers=parseSetCookies(new Headers(set2.headers),set2.headers["set-cookie"])},mergeResponseWithSetHeaders=(response,set2)=>{if(response.status!==set2.status&&set2.status!==200&&(response.status<=300||response.status>400))response=new Response(response.body,{headers:response.headers,status:set2.status});let isCookieSet=!1;if(set2.headers instanceof Headers)for(let key of set2.headers.keys())if(key==="set-cookie"){if(isCookieSet)continue;isCookieSet=!0;for(let cookie of set2.headers.getSetCookie())response.headers.append("set-cookie",cookie)}else response.headers.append(key,set2.headers?.get(key)??"");else for(let key in set2.headers)response.headers.append(key,set2.headers[key]);return response},mapResponse=(response,set2,request)=>{if(isNotEmpty(set2.headers)||set2.status!==200||set2.cookie)switch(handleSet(set2),response?.constructor?.name){case"String":return new Response(response,set2);case"Array":case"Object":return Response.json(response,set2);case"ElysiaFile":return handleFile(response.value);case"Blob":return handleFile(response,set2);case"ElysiaCustomStatusResponse":return set2.status=response.code,mapResponse(response.response,set2,request);case"ReadableStream":if(!set2.headers["content-type"]?.startsWith("text/event-stream"))set2.headers["content-type"]="text/event-stream; charset=utf-8";return request?.signal?.addEventListener("abort",{handleEvent(){if(request?.signal&&!request?.signal?.aborted)response.cancel()}},{once:!0}),new Response(response,set2);case void 0:if(!response)return new Response("",set2);return Response.json(response,set2);case"Response":if(response=mergeResponseWithSetHeaders(response,set2),!response.headers.has("content-length")&&response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response,set2),request);return response;case"Error":return errorToResponse(response,set2);case"Promise":return response.then((x)=>mapResponse(x,set2,request));case"Function":return mapResponse(response(),set2,request);case"Number":case"Boolean":return new Response(response.toString(),set2);case"Cookie":if(response instanceof Cookie)return new Response(response.value,set2);return new Response(response?.toString(),set2);case"FormData":return new Response(response,set2);default:if(response instanceof Response){if(response=mergeResponseWithSetHeaders(response,set2),response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response,set2),request);return response}if(response instanceof Promise)return response.then((x)=>mapResponse(x,set2));if(response instanceof Error)return errorToResponse(response,set2);if(response instanceof ElysiaCustomStatusResponse)return set2.status=response.code,mapResponse(response.response,set2,request);if(typeof response?.next==="function")return handleStream(response,set2,request);if(typeof response?.then==="function")return response.then((x)=>mapResponse(x,set2));if(typeof response?.toResponse==="function")return mapResponse(response.toResponse(),set2);if("charCodeAt"in response){let code=response.charCodeAt(0);if(code===123||code===91){if(!set2.headers["Content-Type"])set2.headers["Content-Type"]="application/json";return new Response(JSON.stringify(response),set2)}}return new Response(response,set2)}if(response instanceof Response&&!response.headers.has("content-length")&&response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response,set2),request);if(typeof response?.next==="function"||response instanceof ReadableStream)return handleStream(response,set2,request);return mapCompactResponse(response,request)},mapEarlyResponse=(response,set2,request)=>{if(response===void 0||response===null)return;if(isNotEmpty(set2.headers)||set2.status!==200||set2.cookie)switch(handleSet(set2),response?.constructor?.name){case"String":return new Response(response,set2);case"Array":case"Object":return Response.json(response,set2);case"ElysiaFile":return handleFile(response.value);case"Blob":return handleFile(response,set2);case"ElysiaCustomStatusResponse":return set2.status=response.code,mapEarlyResponse(response.response,set2,request);case"ReadableStream":if(!set2.headers["content-type"]?.startsWith("text/event-stream"))set2.headers["content-type"]="text/event-stream; charset=utf-8";return request?.signal?.addEventListener("abort",{handleEvent(){if(request?.signal&&!request?.signal?.aborted)response.cancel()}},{once:!0}),new Response(response,set2);case void 0:if(!response)return;return Response.json(response,set2);case"Response":if(response=mergeResponseWithSetHeaders(response,set2),!response.headers.has("content-length")&&response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response,set2),request);return response;case"Promise":return response.then((x)=>mapEarlyResponse(x,set2));case"Error":return errorToResponse(response,set2);case"Function":return mapEarlyResponse(response(),set2);case"Number":case"Boolean":return new Response(response.toString(),set2);case"FormData":return new Response(response);case"Cookie":if(response instanceof Cookie)return new Response(response.value,set2);return new Response(response?.toString(),set2);default:if(response instanceof Response){if(response=mergeResponseWithSetHeaders(response,set2),response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response,set2),request);return response}if(response instanceof Promise)return response.then((x)=>mapEarlyResponse(x,set2));if(response instanceof Error)return errorToResponse(response,set2);if(response instanceof ElysiaCustomStatusResponse)return set2.status=response.code,mapEarlyResponse(response.response,set2,request);if(typeof response?.next==="function")return handleStream(response,set2,request);if(typeof response?.then==="function")return response.then((x)=>mapEarlyResponse(x,set2));if(typeof response?.toResponse==="function")return mapEarlyResponse(response.toResponse(),set2);if("charCodeAt"in response){let code=response.charCodeAt(0);if(code===123||code===91){if(!set2.headers["Content-Type"])set2.headers["Content-Type"]="application/json";return new Response(JSON.stringify(response),set2)}}return new Response(response,set2)}else switch(response?.constructor?.name){case"String":return new Response(response);case"Array":case"Object":return Response.json(response,set2);case"ElysiaFile":return handleFile(response.value);case"Blob":return handleFile(response,set2);case"ElysiaCustomStatusResponse":return set2.status=response.code,mapEarlyResponse(response.response,set2,request);case"ReadableStream":return request?.signal?.addEventListener("abort",{handleEvent(){if(request?.signal&&!request?.signal?.aborted)response.cancel()}},{once:!0}),new Response(response,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!response)return new Response("");return new Response(JSON.stringify(response),{headers:{"content-type":"application/json"}});case"Response":if(!response.headers.has("content-length")&&response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response),request);return response;case"Promise":return response.then((x)=>{let r=mapEarlyResponse(x,set2);if(r!==void 0)return r});case"Error":return errorToResponse(response,set2);case"Function":return mapCompactResponse(response(),request);case"Number":case"Boolean":return new Response(response.toString());case"Cookie":if(response instanceof Cookie)return new Response(response.value,set2);return new Response(response?.toString(),set2);case"FormData":return new Response(response);default:if(response instanceof Response)return response;if(response instanceof Promise)return response.then((x)=>mapEarlyResponse(x,set2));if(response instanceof Error)return errorToResponse(response,set2);if(response instanceof ElysiaCustomStatusResponse)return set2.status=response.code,mapEarlyResponse(response.response,set2,request);if(typeof response?.next==="function")return handleStream(response,set2,request);if(typeof response?.then==="function")return response.then((x)=>mapEarlyResponse(x,set2));if(typeof response?.toResponse==="function")return mapEarlyResponse(response.toResponse(),set2);if("charCodeAt"in response){let code=response.charCodeAt(0);if(code===123||code===91){if(!set2.headers["Content-Type"])set2.headers["Content-Type"]="application/json";return new Response(JSON.stringify(response),set2)}}return new Response(response)}},mapCompactResponse=(response,request)=>{switch(response?.constructor?.name){case"String":return new Response(response);case"Object":case"Array":return Response.json(response);case"ElysiaFile":return handleFile(response.value);case"Blob":return handleFile(response);case"ElysiaCustomStatusResponse":return mapResponse(response.response,{status:response.code,headers:{}});case"ReadableStream":return request?.signal?.addEventListener("abort",{handleEvent(){if(request?.signal&&!request?.signal?.aborted)response.cancel()}},{once:!0}),new Response(response,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!response)return new Response("");return new Response(JSON.stringify(response),{headers:{"content-type":"application/json"}});case"Response":if(response.headers.get("transfer-encoding")==="chunked")return handleStream(streamResponse(response),responseToSetHeaders(response),request);return response;case"Error":return errorToResponse(response);case"Promise":return response.then((x)=>mapCompactResponse(x,request));case"Function":return mapCompactResponse(response(),request);case"Number":case"Boolean":return new Response(response.toString());case"FormData":return new Response(response);default:if(response instanceof Response)return response;if(response instanceof Promise)return response.then((x)=>mapCompactResponse(x,request));if(response instanceof Error)return errorToResponse(response);if(response instanceof ElysiaCustomStatusResponse)return mapResponse(response.response,{status:response.code,headers:{}});if(typeof response?.next==="function")return handleStream(response,void 0,request);if(typeof response?.then==="function")return response.then((x)=>mapResponse(x,set));if(typeof response?.toResponse==="function")return mapCompactResponse(response.toResponse());if("charCodeAt"in response){let code=response.charCodeAt(0);if(code===123||code===91)return new Response(JSON.stringify(response),{headers:{"Content-Type":"application/json"}})}return new Response(response)}},errorToResponse=(error2,set2)=>new Response(JSON.stringify({name:error2?.name,message:error2?.message,cause:error2?.cause}),{status:set2?.status!==200?set2?.status??500:500,headers:set2?.headers}),createStaticHandler=(handle,hooks,setHeaders={})=>{if(typeof handle==="function")return;let response=mapResponse(handle,{headers:setHeaders});if(!hooks.parse?.length&&!hooks.transform?.length&&!hooks.beforeHandle?.length&&!hooks.afterHandle?.length)return response.clone.bind(response)},WebStandardAdapter={name:"web-standard",isWebStandard:!0,handler:{mapResponse,mapEarlyResponse,mapCompactResponse,createStaticHandler},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`,parser:{json(isOptional){if(isOptional)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData(isOptional){let fnLiteral=`
c.body={}
`;if(isOptional)fnLiteral+="let form;try{form=await c.request.formData()}catch{}";else fnLiteral+=`const form=await c.request.formData()
`;return fnLiteral+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},composeGeneralHandler:{parameters:"r",createContext(app){let decoratorsLiteral="",fnLiteral="",defaultHeaders=app.setHeaders;for(let key of Object.keys(app.singleton.decorator))decoratorsLiteral+=`,${key}: decorator['${key}']`;let standardHostname=app.config.handler?.standardHostname??!0,hasTrace=!!app.event.trace?.length;if(fnLiteral+=`const u=r.url,s=u.indexOf('/',${standardHostname?11:7}),qi=u.indexOf('?', s + 1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,hasTrace)fnLiteral+=`const id=randomId()
`;if(fnLiteral+="const c={request:r,store,qi,path:p,url:u,redirect,error,set:{headers:",fnLiteral+=Object.keys(defaultHeaders??{}).length?"Object.assign({}, app.setHeaders)":"{}",fnLiteral+=",status:200}",app.inference.server)fnLiteral+=",get server(){return app.getServer()}";if(hasTrace)fnLiteral+=",[ELYSIA_REQUEST_ID]:id";return fnLiteral+=decoratorsLiteral,fnLiteral+=`}
`,fnLiteral},websocket(app){let fnLiteral="",wsPaths=app.router.static.ws,router=app.router.http;if(router.build(),Object.keys(wsPaths).length||router.root.ws||router.history.find((x)=>x["0"]==="ws")){fnLiteral+="if(r.method==='GET'){switch(p){";for(let[path,index]of Object.entries(wsPaths))fnLiteral+=`case'${path}':`+(app.config.strictPath!==!0?`case'${getLoosePath(path)}':`:"")+`if(r.headers.get('upgrade')==='websocket')return ht[${index}].composed(c)
`;fnLiteral+=`default:if(r.headers.get('upgrade')==='websocket'){const route=router.find('ws',p)
if(route){c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)}}break}}`}return fnLiteral},error404(hasEventHook,hasErrorHook){let findDynamicRoute="if(route===null)return ";if(hasErrorHook)findDynamicRoute+=`app.handleError(c,notFound,false,${this.parameters})`;else findDynamicRoute+=hasEventHook?"new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"error404.clone()";return{declare:hasErrorHook?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:findDynamicRoute}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw new Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}},createNativeStaticHandler=(handle,hooks,setHeaders={})=>{if(typeof handle==="function"||handle instanceof Blob)return;if(typeof handle==="object"&&handle?.toString()==="[object HTMLBundle]")return()=>handle;let response=mapResponse(handle,{headers:setHeaders});if(!hooks.parse?.length&&!hooks.transform?.length&&!hooks.beforeHandle?.length&&!hooks.afterHandle?.length){if(!response.headers.has("content-type"))response.headers.append("content-type","text/plain;charset=utf-8");return response.clone.bind(response)}},websocket={open(ws){ws.data.open?.(ws)},message(ws,message){ws.data.message?.(ws,message)},drain(ws){ws.data.drain?.(ws)},close(ws,code,reason){ws.data.close?.(ws,code,reason)}};class ElysiaWS{raw;data;body;validator;["~types"];get id(){return this.data.id}constructor(raw,data,body=void 0){this.raw=raw,this.data=data,this.body=body,this.validator=raw.data?.validator,this.sendText=raw.sendText.bind(raw),this.sendBinary=raw.sendBinary.bind(raw),this.close=raw.close.bind(raw),this.terminate=raw.terminate.bind(raw),this.publishText=raw.publishText.bind(raw),this.publishBinary=raw.publishBinary.bind(raw),this.subscribe=raw.subscribe.bind(raw),this.unsubscribe=raw.unsubscribe.bind(raw),this.isSubscribed=raw.isSubscribed.bind(raw),this.cork=raw.cork.bind(raw),this.remoteAddress=raw.remoteAddress,this.binaryType=raw.binaryType,this.data=raw.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send(data,compress){if(Buffer.isBuffer(data))return this.raw.send(data,compress);if(this.validator?.Check(data)===!1)return this.raw.send(new ValidationError("message",this.validator,data).message);if(typeof data==="object")data=JSON.stringify(data);return this.raw.send(data,compress)}ping(data){if(Buffer.isBuffer(data))return this.raw.ping(data);if(this.validator?.Check(data)===!1)return this.raw.send(new ValidationError("message",this.validator,data).message);if(typeof data==="object")data=JSON.stringify(data);return this.raw.ping(data)}pong(data){if(Buffer.isBuffer(data))return this.raw.pong(data);if(this.validator?.Check(data)===!1)return this.raw.send(new ValidationError("message",this.validator,data).message);if(typeof data==="object")data=JSON.stringify(data);return this.raw.pong(data)}publish(topic,data,compress){if(Buffer.isBuffer(data))return this.raw.publish(topic,data,compress);if(this.validator?.Check(data)===!1)return this.raw.send(new ValidationError("message",this.validator,data).message);if(typeof data==="object")data=JSON.stringify(data);return this.raw.publish(topic,data,compress)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}}var createWSMessageParser=(parse22)=>{let parsers=typeof parse22==="function"?[parse22]:parse22;return async function parseMessage(ws,message){if(typeof message==="string"){let start=message?.charCodeAt(0);if(start===34||start===47||start===91||start===123)try{message=JSON.parse(message)}catch{}else if(isNumericString(message))message=+message;else if(message==="true")message=!0;else if(message==="false")message=!1;else if(message==="null")message=null}if(parsers)for(let i=0;i<parsers.length;i++){let temp=parsers[i](ws,message);if(temp instanceof Promise)temp=await temp;if(temp!==void 0)return temp}return message}},createHandleWSResponse=(validateResponse)=>{let handleWSResponse=(ws,data)=>{if(data instanceof Promise)return data.then((data2)=>handleWSResponse(ws,data2));if(Buffer.isBuffer(data))return ws.send(data.toString());if(data===void 0)return;let send=(datum)=>{if(validateResponse?.Check(datum)===!1)return ws.send(new ValidationError("message",validateResponse,datum).message);if(typeof datum==="object")return ws.send(JSON.stringify(datum));ws.send(datum)};if(typeof data?.next!=="function")return void send(data);let init=data.next();if(init instanceof Promise)return(async()=>{let first=await init;if(validateResponse?.Check(first)===!1)return ws.send(new ValidationError("message",validateResponse,first).message);if(send(first.value),!first.done)for await(let datum of data)send(datum)})();if(send(init.value),!init.done)for(let datum of data)send(datum)};return handleWSResponse},BunAdapter={...WebStandardAdapter,name:"bun",handler:{...WebStandardAdapter.handler,createNativeStaticHandler},composeHandler:{...WebStandardAdapter.composeHandler,headers:hasHeaderShorthand?`c.headers = c.request.headers.toJSON()
`:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`},listen(app){return(options,callback)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(app.compile(),typeof options==="string"){if(!isNumericString(options))throw new Error("Port must be a numeric value");options=parseInt(options)}let fetch2=app.fetch,serve=typeof options==="object"?{development:!isProduction,reusePort:!0,...app.config.serve||{},...options||{},static:{...app.router.static.http.static,...app.config.serve?.static},websocket:{...app.config.websocket||{},...websocket||{}},fetch:fetch2,error:app.outerErrorHandler}:{development:!isProduction,reusePort:!0,...app.config.serve||{},static:app.router.static.http.static,websocket:{...app.config.websocket||{},...websocket||{}},port:options,fetch:fetch2,error:app.outerErrorHandler};if(app.server=Bun?.serve(serve),app.event.start)for(let i=0;i<app.event.start.length;i++)app.event.start[i].fn(app);if(callback)callback(app.server);process.on("beforeExit",()=>{if(app.server){if(app.server.stop?.(),app.server=null,app.event.stop)for(let i=0;i<app.event.stop.length;i++)app.event.stop[i].fn(app)}}),app.promisedModules.then(()=>{Bun?.gc(!1)})}},ws(app,path,options){let{parse:parse22,body,response,...rest}=options,validateMessage=getSchemaValidator(body,{modules:app.definitions.typebox,models:app.definitions.type,normalize:app.config.normalize}),validateResponse=getSchemaValidator(response,{modules:app.definitions.typebox,models:app.definitions.type,normalize:app.config.normalize});app.route("$INTERNALWS",path,async(context)=>{let server=app.getServer(),{set:set2,path:path2,qi,headers,query,params}=context;if(context.validator=validateResponse,options.upgrade){if(typeof options.upgrade==="function"){let temp=options.upgrade(context);if(temp instanceof Promise)await temp}else if(options.upgrade)Object.assign(set2.headers,options.upgrade)}if(set2.cookie&&isNotEmpty(set2.cookie)){let cookie=serializeCookie(set2.cookie);if(cookie)set2.headers["set-cookie"]=cookie}if(set2.headers["set-cookie"]&&Array.isArray(set2.headers["set-cookie"]))set2.headers=parseSetCookies(new Headers(set2.headers),set2.headers["set-cookie"]);let handleResponse=createHandleWSResponse(validateResponse),parseMessage=createWSMessageParser(parse22),_id,errorHandlers=[...Array.isArray(options.error)?options.error:[options.error],...(app.event.error??[]).map((x)=>typeof x==="function"?x:x.fn)],handleErrors=!errorHandlers.length?()=>{}:async(ws,error2)=>{for(let handleError of errorHandlers){let response2=handleError(Object.assign(context,{error:error2}));if(response2 instanceof Promise)response2=await response2;if(await handleResponse(ws,response2),response2)break}};if(server?.upgrade(context.request,{headers:isNotEmpty(set2.headers)?set2.headers:void 0,data:{...context,get id(){if(_id)return _id;return _id=randomId()},validator:validateResponse,ping(data){options.ping?.(data)},pong(data){options.pong?.(data)},open(ws){try{handleResponse(ws,options.open?.(new ElysiaWS(ws,context)))}catch(error2){handleErrors(ws,error2)}},message:async(ws,_message)=>{let message=await parseMessage(ws,_message);if(validateMessage?.Check(message)===!1)return void ws.send(new ValidationError("message",validateMessage,message).message);try{handleResponse(ws,options.message?.(new ElysiaWS(ws,context,message),message))}catch(error2){handleErrors(ws,error2)}},drain(ws){try{handleResponse(ws,options.drain?.(new ElysiaWS(ws,context)))}catch(error2){handleErrors(ws,error2)}},close(ws,code,reason){try{handleResponse(ws,options.close?.(new ElysiaWS(ws,context),code,reason))}catch(error2){handleErrors(ws,error2)}}}}))return;return set2.status=400,"Expected a websocket connection"},{...rest,websocket:options})}},isBun2=typeof Bun!=="undefined",env2=isBun2?Bun.env:typeof process!=="undefined"&&process?.env?process.env:{},plusRegex=/\+/g;function parseQueryFromURL(input){let result={};if(typeof input!=="string")return result;let key="",value="",startingIndex=-1,equalityIndex=-1,flags=0,l=input.length;for(let i=0;i<l;i++)switch(input.charCodeAt(i)){case 38:let hasBothKeyValuePair=equalityIndex>startingIndex;if(!hasBothKeyValuePair)equalityIndex=i;if(key=input.slice(startingIndex+1,equalityIndex),hasBothKeyValuePair||key.length>0){if(flags&1)key=key.replace(plusRegex," ");if(flags&2)key=decode2(key)||key;if(!result[key]){if(hasBothKeyValuePair){if(value=input.slice(equalityIndex+1,i),flags&4)value=value.replace(plusRegex," ");if(flags&8)value=decode2(value)||value}result[key]=value}}key="",value="",startingIndex=i,equalityIndex=i,flags=0;break;case 61:if(equalityIndex<=startingIndex)equalityIndex=i;else flags|=8;break;case 43:if(equalityIndex>startingIndex)flags|=4;else flags|=1;break;case 37:if(equalityIndex>startingIndex)flags|=8;else flags|=2;break}if(startingIndex<l){let hasBothKeyValuePair=equalityIndex>startingIndex;if(key=input.slice(startingIndex+1,hasBothKeyValuePair?equalityIndex:l),hasBothKeyValuePair||key.length>0){if(flags&1)key=key.replace(plusRegex," ");if(flags&2)key=decode2(key)||key;if(!result[key]){if(hasBothKeyValuePair){if(value=input.slice(equalityIndex+1,l),flags&4)value=value.replace(plusRegex," ");if(flags&8)value=decode2(value)||value}result[key]=value}}}return result}var parseQuery=(input)=>{let result={};if(typeof input!=="string")return result;let inputLength=input.length,key="",value="",startingIndex=-1,equalityIndex=-1,shouldDecodeKey=!1,shouldDecodeValue=!1,keyHasPlus=!1,valueHasPlus=!1,hasBothKeyValuePair=!1,c=0;for(let i=0;i<inputLength+1;i++){if(i!==inputLength)c=input.charCodeAt(i);else c=38;switch(c){case 38:{if(hasBothKeyValuePair=equalityIndex>startingIndex,!hasBothKeyValuePair)equalityIndex=i;if(key=input.slice(startingIndex+1,equalityIndex),hasBothKeyValuePair||key.length>0){if(keyHasPlus)key=key.replace(plusRegex," ");if(shouldDecodeKey)key=decode2(key)||key;if(hasBothKeyValuePair){if(value=input.slice(equalityIndex+1,i),valueHasPlus)value=value.replace(plusRegex," ");if(shouldDecodeValue)value=decode2(value)||value}let currentValue=result[key];if(currentValue===void 0)result[key]=value;else if(currentValue.pop)currentValue.push(value);else result[key]=[currentValue,value]}value="",startingIndex=i,equalityIndex=i,shouldDecodeKey=!1,shouldDecodeValue=!1,keyHasPlus=!1,valueHasPlus=!1;break}case 61:if(equalityIndex<=startingIndex)equalityIndex=i;else shouldDecodeValue=!0;break;case 43:if(equalityIndex>startingIndex)valueHasPlus=!0;else keyHasPlus=!0;break;case 37:if(equalityIndex>startingIndex)shouldDecodeValue=!0;else shouldDecodeKey=!0;break}}return result},ELYSIA_TRACE=Symbol("ElysiaTrace"),createProcess=()=>{let{promise,resolve}=Promise.withResolvers(),{promise:end,resolve:resolveEnd}=Promise.withResolvers(),{promise:error2,resolve:resolveError}=Promise.withResolvers(),callbacks=[],callbacksEnd=[];return[(callback)=>{if(callback)callbacks.push(callback);return promise},(process2)=>{let processes=[],resolvers=[],groupError=null;for(let i=0;i<(process2.total??0);i++){let{promise:promise2,resolve:resolve2}=Promise.withResolvers(),{promise:end2,resolve:resolveEnd2}=Promise.withResolvers(),{promise:error3,resolve:resolveError2}=Promise.withResolvers(),callbacks2=[],callbacksEnd2=[];processes.push((callback)=>{if(callback)callbacks2.push(callback);return promise2}),resolvers.push((process3)=>{let result2={...process3,end:end2,error:error3,index:i,onStop(callback){if(callback)callbacksEnd2.push(callback);return end2}};resolve2(result2);for(let i2=0;i2<callbacks2.length;i2++)callbacks2[i2](result2);return(error4=null)=>{let end3=performance.now();if(error4)groupError=error4;let detail={end:end3,error:error4,get elapsed(){return end3-process3.begin}};for(let i2=0;i2<callbacksEnd2.length;i2++)callbacksEnd2[i2](detail);resolveEnd2(end3),resolveError2(error4)}})}let result={...process2,end,error:error2,onEvent(callback){for(let i=0;i<processes.length;i++)processes[i](callback)},onStop(callback){if(callback)callbacksEnd.push(callback);return end}};resolve(result);for(let i=0;i<callbacks.length;i++)callbacks[i](result);return{resolveChild:resolvers,resolve(error3=null){let end2=performance.now();if(!error3&&groupError)error3=groupError;let detail={end:end2,error:error3,get elapsed(){return end2-process2.begin}};for(let i=0;i<callbacksEnd.length;i++)callbacksEnd[i](detail);resolveEnd(end2),resolveError(error3)}}}]},createTracer=(traceListener)=>{return(context)=>{let[onRequest,resolveRequest]=createProcess(),[onParse,resolveParse]=createProcess(),[onTransform,resolveTransform]=createProcess(),[onBeforeHandle,resolveBeforeHandle]=createProcess(),[onHandle,resolveHandle]=createProcess(),[onAfterHandle,resolveAfterHandle]=createProcess(),[onError,resolveError]=createProcess(),[onMapResponse,resolveMapResponse]=createProcess(),[onAfterResponse,resolveAfterResponse]=createProcess();return traceListener({id:context[ELYSIA_REQUEST_ID],context,set:context.set,onRequest,onParse,onTransform,onBeforeHandle,onHandle,onAfterHandle,onMapResponse,onAfterResponse,onError}),{request:resolveRequest,parse:resolveParse,transform:resolveTransform,beforeHandle:resolveBeforeHandle,handle:resolveHandle,afterHandle:resolveAfterHandle,error:resolveError,mapResponse:resolveMapResponse,afterResponse:resolveAfterResponse}}},TypeBoxSymbol={optional:Symbol.for("TypeBox.Optional"),kind:Symbol.for("TypeBox.Kind")},isOptional=(validator)=>{if(!validator)return!1;let schema=validator?.schema;if(schema?.[TypeBoxSymbol.kind]==="Import")return validator.References().some(isOptional);return!!schema&&TypeBoxSymbol.optional in schema},allocateIf=(value,condition)=>condition?value:"",defaultParsers=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],hasAdditionalProperties=(_schema)=>{if(!_schema)return!1;let schema=_schema?.schema??_schema;if(schema[TypeBoxSymbol.kind]==="Import"&&_schema.References())return _schema.References().some(hasAdditionalProperties);if(schema.anyOf)return schema.anyOf.some(hasAdditionalProperties);if(schema.someOf)return schema.someOf.some(hasAdditionalProperties);if(schema.allOf)return schema.allOf.some(hasAdditionalProperties);if(schema.not)return schema.not.some(hasAdditionalProperties);if(schema.type==="object"){let properties=schema.properties;if("additionalProperties"in schema)return schema.additionalProperties;if("patternProperties"in schema)return!1;for(let key of Object.keys(properties)){let property=properties[key];if(property.type==="object"){if(hasAdditionalProperties(property))return!0}else if(property.anyOf){for(let i=0;i<property.anyOf.length;i++)if(hasAdditionalProperties(property.anyOf[i]))return!0}return property.additionalProperties}return!1}return!1},createReport=({context="c",trace=[],addFn})=>{if(!trace.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let i=0;i<trace.length;i++)addFn(`let report${i}, reportChild${i}, reportErr${i}, reportErrChild${i};let trace${i} = ${context}[ELYSIA_TRACE]?.[${i}] ?? trace[${i}](${context});
`);return(event,{name,total=0}={})=>{if(!name)name="anonymous";let reporter=event==="error"?"reportErr":"report";for(let i=0;i<trace.length;i++)addFn(`${reporter}${i} = trace${i}.${event}({id,event:'${event}',name:'${name}',begin:performance.now(),total:${total}})
`);return{resolve(){for(let i=0;i<trace.length;i++)addFn(`${reporter}${i}.resolve()
`)},resolveChild(name2){for(let i=0;i<trace.length;i++)addFn(`${reporter}Child${i}=${reporter}${i}.resolveChild?.shift()?.({id,event:'${event}',name:'${name2}',begin:performance.now()})
`);return(binding)=>{for(let i=0;i<trace.length;i++)if(binding)addFn(`if(${binding} instanceof Error){${reporter}Child${i}?.(${binding}) }else{${reporter}Child${i}?.()}`);else addFn(`${reporter}Child${i}?.()
`)}}}}},composeValidationFactory=({injectResponse="",normalize=!1,validator,encodeSchema=!1})=>({composeValidation:(type2,value=`c.${type2}`)=>`c.set.status=422;throw new ValidationError('${type2}',validator.${type2},${value})`,composeResponseValidation:(name="r")=>{let code=injectResponse+`
`;code+=`if(${name} instanceof ElysiaCustomStatusResponse){c.set.status=${name}.code
${name}=${name}.response}const isResponse=${name} instanceof Response
switch(c.set.status){`;for(let[status,value]of Object.entries(validator.response)){if(code+=`
case ${status}:if(!isResponse){`,normalize&&"Clean"in value&&!hasAdditionalProperties(value))code+=`${name}=validator.response['${status}'].Clean(${name})
`;if(encodeSchema&&(value.hasTransform||typeof value.Decode==="function"))code+=`${name}=validator.response['${status}'].Encode(${name})
`;code+=`if(validator.response['${status}'].Check(${name})===false){c.set.status=422
throw new ValidationError('response',validator.response['${status}'],${name})}c.set.status = ${status}}
`,code+=`break
`}return code+"}"}}),KindSymbol=Symbol.for("TypeBox.Kind"),hasProperty=(expectedProperty,_schema)=>{if(!_schema)return;let schema=_schema.schema??_schema;if(schema[TypeBoxSymbol.kind]==="Import")return _schema.References().some((schema2)=>hasProperty(expectedProperty,schema2));if(schema.type==="object"){let properties=schema.properties;if(!properties)return!1;for(let key of Object.keys(properties)){let property=properties[key];if(expectedProperty in property)return!0;if(property.type==="object"){if(hasProperty(expectedProperty,property))return!0}else if(property.anyOf){for(let i=0;i<property.anyOf.length;i++)if(hasProperty(expectedProperty,property.anyOf[i]))return!0}}return!1}return expectedProperty in schema},TransformSymbol=Symbol.for("TypeBox.Transform"),hasTransform=(schema)=>{if(!schema)return!1;if(schema.$ref&&schema.$defs&&schema.$ref in schema.$defs&&hasTransform(schema.$defs[schema.$ref]))return!0;if(schema.oneOf){for(let i=0;i<schema.oneOf.length;i++)if(hasTransform(schema.oneOf[i]))return!0}if(schema.anyOf){for(let i=0;i<schema.anyOf.length;i++)if(hasTransform(schema.anyOf[i]))return!0}if(schema.allOf){for(let i=0;i<schema.allOf.length;i++)if(hasTransform(schema.allOf[i]))return!0}if(schema.not&&hasTransform(schema.not))return!0;if(schema.type==="object"&&schema.properties){let properties=schema.properties;for(let key of Object.keys(properties)){let property=properties[key];if(hasTransform(property))return!0;if(property.type==="array"&&property.items&&hasTransform(property.items))return!0}}if(schema.type==="array"&&schema.items&&hasTransform(schema.items))return!0;return TransformSymbol in schema},matchFnReturn=/(?:return|=>) \S+\(/g,isAsyncName=(v)=>{return(v?.fn??v).constructor.name==="AsyncFunction"},isAsync=(v)=>{let fn=v?.fn??v;if(fn.constructor.name==="AsyncFunction")return!0;let literal=fn.toString();if(literal.includes("=> response.clone("))return!1;if(literal.includes("await"))return!0;if(literal.includes("async"))return!0;if(literal.includes("=>response.clone("))return!1;return!!literal.match(matchFnReturn)},isGenerator=(v)=>{let fn=v?.fn??v;return fn.constructor.name==="AsyncGeneratorFunction"||fn.constructor.name==="GeneratorFunction"},composeHandler=({app,path,method,hooks,validator,handler,allowMeta=!1,inference,asManifest=!1})=>{let adapter=app["~adapter"].composeHandler,adapterHandler=app["~adapter"].handler,isHandleFn=typeof handler==="function";if(!isHandleFn){if(handler=adapterHandler.mapResponse(handler,{headers:app.setHeaders??{}}),hooks.parse?.length&&hooks.transform?.length&&hooks.beforeHandle?.length&&hooks.afterHandle?.length){if(handler instanceof Response)return Function("a","return function(){return a.clone()}")(handler);return Function("a","return function(){return a}")(handler)}}let handle=isHandleFn?"handler(c)":"handler",hasAfterResponse=!!hooks.afterResponse?.length,hasTrace=!!hooks.trace?.length,fnLiteral="";if(inference=sucrose(Object.assign({},hooks,{handler}),inference),adapter.declare){let literal=adapter.declare(inference);if(literal)fnLiteral+=literal}if(inference.server)fnLiteral+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;validator.createBody?.(),validator.createQuery?.(),validator.createHeaders?.(),validator.createParams?.(),validator.createCookie?.(),validator.createResponse?.();let hasValidation=validator.body||validator.headers||validator.params||validator.query||validator.cookie||validator.response,hasQuery=inference.query||!!validator.query,requestNoBody=hooks.parse?.length===1&&hooks.parse[0].fn==="none",hasBody=method!=="$INTERNALWS"&&method!=="GET"&&method!=="HEAD"&&(inference.body||!!validator.body||!!hooks.parse?.length)&&!requestNoBody;if(hasBody)fnLiteral+=`let isParsing=false
`;let defaultHeaders=app.setHeaders,hasDefaultHeaders=defaultHeaders&&!!Object.keys(defaultHeaders).length,hasHeaders=inference.headers||validator.headers||adapter.preferWebstandardHeaders!==!0&&inference.body,hasCookie=inference.cookie||!!validator.cookie,cookieValidator=hasCookie?getCookieValidator({modules:app.definitions.typebox,validator:validator.cookie,defaultConfig:app.config.cookie,dynamic:!!app.config.aot,config:validator.cookie?.config??{},models:app.definitions.type}):void 0,cookieMeta=cookieValidator?.config,encodeCookie="";if(cookieMeta?.sign){if(!cookieMeta.secrets)throw new Error(`t.Cookie required secret which is not set in (${method}) ${path}.`);let secret=!cookieMeta.secrets?void 0:typeof cookieMeta.secrets==="string"?cookieMeta.secrets:cookieMeta.secrets[0];if(encodeCookie+=`const _setCookie = c.set.cookie
if(_setCookie){`,cookieMeta.sign===!0)encodeCookie+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${secret}')}`;else for(let name of cookieMeta.sign)encodeCookie+=`if(_setCookie['${name}']?.value){c.set.cookie['${name}'].value=await signCookie(_setCookie['${name}'].value,'${secret}')}`;encodeCookie+=`}
`}let normalize=app.config.normalize,encodeSchema=app.config.experimental?.encodeSchema,{composeValidation,composeResponseValidation}=composeValidationFactory({normalize,validator,encodeSchema});if(hasHeaders)fnLiteral+=adapter.headers;if(hasTrace)fnLiteral+=`const id=c[ELYSIA_REQUEST_ID]
`;let report=createReport({trace:hooks.trace,addFn:(word)=>{fnLiteral+=word}});if(fnLiteral+="try{",hasCookie){let get=(name,defaultValue)=>{let value=cookieMeta?.[name]??defaultValue;if(!value)return typeof defaultValue==="string"?`${name}:"${defaultValue}",`:`${name}:${defaultValue},`;if(typeof value==="string")return`${name}:'${value}',`;if(value instanceof Date)return`${name}: new Date(${value.getTime()}),`;return`${name}:${value},`},options=cookieMeta?`{secrets:${cookieMeta.secrets!==void 0?typeof cookieMeta.secrets==="string"?`'${cookieMeta.secrets}'`:"["+cookieMeta.secrets.reduce((a,b)=>a+`'${b}',`,"")+"]":"undefined"},sign:${cookieMeta.sign===!0?!0:cookieMeta.sign!==void 0?"["+cookieMeta.sign.reduce((a,b)=>a+`'${b}',`,"")+"]":"undefined"},`+get("domain")+get("expires")+get("httpOnly")+get("maxAge")+get("path","/")+get("priority")+get("sameSite")+get("secure")+"}":"undefined";if(hasHeaders)fnLiteral+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${options})
`;else fnLiteral+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${options})
`}if(hasQuery){let destructured=[];if(validator.query&&validator.query.schema.type==="object"){let properties=validator.query.schema.properties;if(!hasAdditionalProperties(validator.query))for(let[key,_value]of Object.entries(properties)){let value=_value,isArray=value.type==="array"||!!value.anyOf?.some((v)=>v.type==="string"&&v.format==="ArrayString");if(value&&TypeBoxSymbol.optional in value&&value.type==="array"&&value.items)value=value.items;let{type:type2,anyOf}=value;destructured.push({key,isArray,isNestedObjectArray:isArray&&value.items?.type==="object"||!!value.items?.anyOf?.some((x)=>x.type==="object"||x.type==="array"),isObject:type2==="object"||anyOf?.some((v)=>v.type==="string"&&v.format==="ArrayString"),anyOf:!!anyOf})}}if(!destructured.length)fnLiteral+="if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url.slice(c.qi + 1))}";else{fnLiteral+=`if(c.qi!==-1){let url='&'+c.url.slice(c.qi + 1)
`;let index=0;for(let{key,isArray,isObject:isObject2,isNestedObjectArray,anyOf}of destructured){let init2=(index===0?"let ":"")+`memory=url.indexOf('&${key}=')
let a${index}
`;if(isArray)if(fnLiteral+=init2,isNestedObjectArray)fnLiteral+=`while(memory!==-1){const start=memory+${key.length+2}
memory=url.indexOf('&',start)
if(a${index}===undefined)
a${index}=''
else
a${index}+=','
let temp
if(memory===-1)temp=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else temp=decodeURIComponent(url.slice(start, memory).replace(/\\+/g,' '))
const charCode=temp.charCodeAt(0)
if(charCode!==91&&charCode !== 123)
temp='"'+temp+'"'
a${index}+=temp
if(memory===-1)break
memory=url.indexOf('&${key}=',memory)
if(memory===-1)break}try{if(a${index}.charCodeAt(0)===91)a${index} = JSON.parse(a${index})
else
a${index}=JSON.parse('['+a${index}+']')}catch{}
`;else fnLiteral+=`while(memory!==-1){const start=memory+${key.length+2}
memory=url.indexOf('&',start)
if(a${index}===undefined)a${index}=[]
if(memory===-1){const temp=decodeURIComponent(url.slice(start)).replace(/\\+/g,' ')
if(temp.includes(',')){a${index}=a${index}.concat(temp.split(','))}else{a${index}.push(decodeURIComponent(url.slice(start)).replace(/\\+/g,' '))}
break}else{const temp=decodeURIComponent(url.slice(start, memory)).replace(/\\+/g,' ')
if(temp.includes(',')){a${index}=a${index}.concat(temp.split(','))}else{a${index}.push(temp)}
}memory=url.indexOf('&${key}=',memory)
if(memory===-1) break
}`;else if(isObject2)fnLiteral+=init2+`if(memory!==-1){const start=memory+${key.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${index}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))else a${index}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))if(a${index}!==undefined)try{a${index}=JSON.parse(a${index})}catch{}}`;else{if(fnLiteral+=init2+`if(memory!==-1){const start=memory+${key.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${index}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else{a${index}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))`,anyOf)fnLiteral+=`
let deepMemory=url.indexOf('&${key}=',memory)
if(deepMemory!==-1){a${index}=[a${index}]
let first=true
while(true){const start=deepMemory+${key.length+2}
if(first)first=false
else deepMemory = url.indexOf('&', start)
let value
if(deepMemory===-1)value=url.slice(start).replace(/\\+/g,' ')
else value=url.slice(start, deepMemory).replace(/\\+/g,' ')
value=decodeURIComponent(value)
if(value===null){if(deepMemory===-1){break}else{continue}}
const vStart=value.charCodeAt(0)
const vEnd=value.charCodeAt(value.length - 1)
if((vStart===91&&vEnd===93)||(vStart===123&&vEnd===125))
try{a${index}.push(JSON.parse(value))}catch{a${index}.push(value)}if(deepMemory===-1)break}}`;fnLiteral+="}}"}index++,fnLiteral+=`
`}fnLiteral+="c.query={"+destructured.map(({key},index2)=>`'${key}':a${index2}`).join(",")+"}",fnLiteral+=`} else c.query = {}
`}}let isAsyncHandler=typeof handler==="function"&&isAsync(handler),saveResponse=hasTrace||hooks.afterResponse?.length?"c.response= ":"",maybeAsync=hasCookie||hasBody||isAsyncHandler||!!hooks.parse?.length||!!hooks.afterHandle?.some(isAsync)||!!hooks.beforeHandle?.some(isAsync)||!!hooks.transform?.some(isAsync)||!!hooks.mapResponse?.some(isAsync),maybeStream=(typeof handler==="function"?isGenerator(handler):!1)||!!hooks.beforeHandle?.some(isGenerator)||!!hooks.afterHandle?.some(isGenerator)||!!hooks.transform?.some(isGenerator),hasSet=inference.cookie||inference.set||hasHeaders||hasTrace||validator.response||isHandleFn&&hasDefaultHeaders||maybeStream,mapResponseContext=adapter.mapResponseContext?`,${adapter.mapResponseContext}`:"";if(hasTrace||inference.route)fnLiteral+=`c.route=\`${path}\`
`;let parseReporter=report("parse",{total:hooks.parse?.length});if(hasBody){let isOptionalBody=isOptional(validator.body),hasBodyInference=!!hooks.parse?.length||inference.body||validator.body;if(adapter.parser.declare)fnLiteral+=adapter.parser.declare;fnLiteral+=`
isParsing=true
`;let parser=typeof hooks.parse==="string"?hooks.parse:Array.isArray(hooks.parse)&&hooks.parse.length===1?typeof hooks.parse[0]==="string"?hooks.parse[0]:typeof hooks.parse[0].fn==="string"?hooks.parse[0].fn:void 0:void 0;if(parser&&defaultParsers.includes(parser)){let reporter=report("parse",{total:hooks.parse?.length});switch(parser){case"json":case"application/json":fnLiteral+=adapter.parser.json(isOptionalBody);break;case"text":case"text/plain":fnLiteral+=adapter.parser.text(isOptionalBody);break;case"urlencoded":case"application/x-www-form-urlencoded":fnLiteral+=adapter.parser.urlencoded(isOptionalBody);break;case"arrayBuffer":case"application/octet-stream":fnLiteral+=adapter.parser.arrayBuffer(isOptionalBody);break;case"formdata":case"multipart/form-data":fnLiteral+=adapter.parser.formData(isOptionalBody);break;default:if(parser[0]in app["~parser"])fnLiteral+=hasHeaders?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",fnLiteral+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,fnLiteral+=`let result=parser['${parser}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}reporter.resolve()}else if(hasBodyInference){if(fnLiteral+=`
`,fnLiteral+=hasHeaders?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",fnLiteral+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,hooks.parse?.length)fnLiteral+=`let used=false
`;let reporter=report("parse",{total:hooks.parse?.length}),hasDefaultParser=!1;if(hooks.parse)for(let i=0;i<hooks.parse.length;i++){let name=`bo${i}`;if(i!==0)fnLiteral+=`
if(!used){`;if(typeof hooks.parse[i].fn==="string"){let endUnit=reporter.resolveChild(hooks.parse[i].fn);switch(hooks.parse[i].fn){case"json":case"application/json":hasDefaultParser=!0,fnLiteral+=adapter.parser.json(isOptionalBody);break;case"text":case"text/plain":hasDefaultParser=!0,fnLiteral+=adapter.parser.text(isOptionalBody);break;case"urlencoded":case"application/x-www-form-urlencoded":hasDefaultParser=!0,fnLiteral+=adapter.parser.urlencoded(isOptionalBody);break;case"arrayBuffer":case"application/octet-stream":hasDefaultParser=!0,fnLiteral+=adapter.parser.arrayBuffer(isOptionalBody);break;case"formdata":case"multipart/form-data":hasDefaultParser=!0,fnLiteral+=adapter.parser.formData(isOptionalBody);break;default:fnLiteral+=`${name}=parser['${hooks.parse[i].fn}'](c,contentType)
if(${name} instanceof Promise)${name}=await ${name}
if(${name}!==undefined){c.body=${name};used=true}
`}endUnit()}else{let endUnit=reporter.resolveChild(hooks.parse[i].fn.name);fnLiteral+=`let ${name}=e.parse[${i}]
${name}=${name}(c,contentType)
if(${name} instanceof Promise)${name}=await ${name}
if(${name}!==undefined){c.body=${name};used=true}`,endUnit()}if(i!==0)fnLiteral+="}";if(hasDefaultParser)break}if(reporter.resolve(),!hasDefaultParser){if(hooks.parse?.length)fnLiteral+=`
if(!used){
if(!contentType) throw new ParseError()
`;fnLiteral+="switch(contentType){",fnLiteral+=`case 'application/json':
`+adapter.parser.json(isOptionalBody)+`break
case 'text/plain':`+adapter.parser.text(isOptionalBody)+`break
case 'application/x-www-form-urlencoded':`+adapter.parser.urlencoded(isOptionalBody)+`break
case 'application/octet-stream':`+adapter.parser.arrayBuffer(isOptionalBody)+`break
case 'multipart/form-data':`+adapter.parser.formData(isOptionalBody)+`break
`;for(let key of Object.keys(app["~parser"]))fnLiteral+=`case '${key}':let bo${key}=parser['${key}'](c,contentType)
if(bo${key} instanceof Promise)bo${key}=await bo${key}
if(bo${key} instanceof ElysiaCustomStatusResponse)throw result
if(bo${key}!==undefined)c.body=bo${key}
break
`;if(hooks.parse?.length)fnLiteral+="}";fnLiteral+="}"}}fnLiteral+=`
delete c.contentType`,fnLiteral+=`
isParsing=false
`}if(parseReporter.resolve(),hooks?.transform){let reporter=report("transform",{total:hooks.transform.length});if(hooks.transform.length)fnLiteral+=`let transformed
`;for(let i=0;i<hooks.transform.length;i++){let transform2=hooks.transform[i],endUnit=reporter.resolveChild(transform2.fn.name);if(fnLiteral+=isAsync(transform2)?`transformed=await e.transform[${i}](c)
`:`transformed=e.transform[${i}](c)
`,transform2.subType==="mapDerive")fnLiteral+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else fnLiteral+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else Object.assign(c,transformed)
`;endUnit()}reporter.resolve()}if(validator){if(validator.headers){if(normalize&&"Clean"in validator.headers&&!hasAdditionalProperties(validator.headers))fnLiteral+=`c.headers=validator.headers.Clean(c.headers);
`;if(hasProperty("default",validator.headers))for(let[key,value]of Object.entries(exports_value2.Default(validator.headers.schema,{}))){let parsed=typeof value==="object"?JSON.stringify(value):typeof value==="string"?`'${value}'`:value;if(parsed!==void 0)fnLiteral+=`c.headers['${key}']??=${parsed}
`}if(isOptional(validator.headers))fnLiteral+="if(isNotEmpty(c.headers)){";if(fnLiteral+="if(validator.headers.Check(c.headers) === false){"+composeValidation("headers")+"}",hasTransform(validator.headers.schema))fnLiteral+=`c.headers=validator.headers.Decode(c.headers)
`;if(isOptional(validator.headers))fnLiteral+="}"}if(validator.params){if(hasProperty("default",validator.params))for(let[key,value]of Object.entries(exports_value2.Default(validator.params.schema,{}))){let parsed=typeof value==="object"?JSON.stringify(value):typeof value==="string"?`'${value}'`:value;if(parsed!==void 0)fnLiteral+=`c.params['${key}']??=${parsed}
`}if(fnLiteral+="if(validator.params.Check(c.params)===false){"+composeValidation("params")+"}",hasTransform(validator.params.schema))fnLiteral+=`c.params=validator.params.Decode(c.params)
`}if(validator.query){if(normalize&&"Clean"in validator.query&&!hasAdditionalProperties(validator.query))fnLiteral+=`c.query=validator.query.Clean(c.query)
`;if(hasProperty("default",validator.query))for(let[key,value]of Object.entries(exports_value2.Default(validator.query.schema,{}))){let parsed=typeof value==="object"?JSON.stringify(value):typeof value==="string"?`'${value}'`:value;if(parsed!==void 0)fnLiteral+=`if(c.query['${key}']===undefined)c.query['${key}']=${parsed}
`}if(isOptional(validator.query))fnLiteral+="if(isNotEmpty(c.query)){";if(fnLiteral+="if(validator.query.Check(c.query)===false){"+composeValidation("query")+"}",hasTransform(validator.query.schema))fnLiteral+=`c.query=validator.query.Decode(Object.assign({},c.query))
`;if(isOptional(validator.query))fnLiteral+="}"}if(validator.body){if(normalize&&"Clean"in validator.body&&!hasAdditionalProperties(validator.body))fnLiteral+=`c.body=validator.body.Clean(c.body)
`;let doesHaveTransform=hasTransform(validator.body.schema);if(doesHaveTransform||isOptional(validator.body))fnLiteral+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&isNotEmpty(c.body))
`;if(hasProperty("default",validator.body)){let schema=validator.body.schema,value=exports_value2.Default(schema,schema.type==="object"||schema[TypeBoxSymbol.kind]==="Import"&&schema.$defs[schema.$ref][TypeBoxSymbol.kind]==="Object"?{}:void 0),parsed=typeof value==="object"?JSON.stringify(value):typeof value==="string"?`'${value}'`:value;if(fnLiteral+="if(validator.body.Check(c.body)===false){",value!==void 0&&value!==null)fnLiteral+=`if(typeof c.body==='object')c.body=Object.assign(${parsed},c.body)
else c.body=${parsed}
`;if(isOptional(validator.body))fnLiteral+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+composeValidation("body")+"}";else fnLiteral+="if(validator.body.Check(c.body)===false){"+composeValidation("body")+"}";fnLiteral+="}"}else if(isOptional(validator.body))fnLiteral+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+composeValidation("body")+"}";else fnLiteral+="if(validator.body.Check(c.body)===false){"+composeValidation("body")+"}";if(doesHaveTransform)fnLiteral+=`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`}if(cookieValidator&&isNotEmpty(cookieValidator?.schema?.properties??cookieValidator?.schema?.schema??{})){if(fnLiteral+=`const cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,hasProperty("default",cookieValidator))for(let[key,value]of Object.entries(exports_value2.Default(cookieValidator.schema,{})))fnLiteral+=`cookieValue['${key}'] = ${typeof value==="object"?JSON.stringify(value):value}
`;if(isOptional(validator.cookie))fnLiteral+="if(isNotEmpty(c.cookie)){";if(fnLiteral+="if(validator.cookie.Check(cookieValue)===false){"+composeValidation("cookie","cookieValue")+"}",hasTransform(validator.cookie.schema))fnLiteral+=`for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue)))c.cookie[key].value=value
`;if(isOptional(validator.cookie))fnLiteral+="}"}}if(hooks?.beforeHandle){let reporter=report("beforeHandle",{total:hooks.beforeHandle.length}),hasResolve=!1;for(let i=0;i<hooks.beforeHandle.length;i++){let beforeHandle=hooks.beforeHandle[i],endUnit=reporter.resolveChild(beforeHandle.fn.name),returning=hasReturn(beforeHandle);if(beforeHandle.subType==="resolve"||beforeHandle.subType==="mapResolve"){if(!hasResolve)hasResolve=!0,fnLiteral+=`
let resolved
`;if(fnLiteral+=isAsync(beforeHandle)?`resolved=await e.beforeHandle[${i}](c);
`:`resolved=e.beforeHandle[${i}](c);
`,beforeHandle.subType==="mapResolve")fnLiteral+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else{resolved.request = c.request
resolved.store = c.store
resolved.qi = c.qi
resolved.path = c.path
resolved.url = c.url
resolved.redirect = c.redirect
resolved.set = c.set
resolved.error = c.error
c = resolved}`;else fnLiteral+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else Object.assign(c, resolved)
`}else if(!returning)fnLiteral+=isAsync(beforeHandle)?`await e.beforeHandle[${i}](c)
`:`e.beforeHandle[${i}](c)
`,endUnit();else{if(fnLiteral+=isAsync(beforeHandle)?`be=await e.beforeHandle[${i}](c)
`:`be=e.beforeHandle[${i}](c)
`,endUnit("be"),fnLiteral+="if(be!==undefined){",reporter.resolve(),hooks.afterHandle?.length){report("handle",{name:isHandleFn?handler.name:void 0}).resolve();let reporter2=report("afterHandle",{total:hooks.afterHandle.length});for(let i2=0;i2<hooks.afterHandle.length;i2++){let hook=hooks.afterHandle[i2],returning2=hasReturn(hook),endUnit2=reporter2.resolveChild(hook.fn.name);if(fnLiteral+=`c.response = be
`,!returning2)fnLiteral+=isAsync(hook.fn)?`await e.afterHandle[${i2}](c, be)
`:`e.afterHandle[${i2}](c, be)
`;else fnLiteral+=isAsync(hook.fn)?`af = await e.afterHandle[${i2}](c)
`:`af = e.afterHandle[${i2}](c)
`,fnLiteral+=`if(af!==undefined) c.response=be=af
`;endUnit2("af")}reporter2.resolve()}if(validator.response)fnLiteral+=composeResponseValidation("be");let mapResponseReporter=report("mapResponse",{total:hooks.mapResponse?.length});if(hooks.mapResponse?.length){fnLiteral+=`c.response=be
`;for(let i2=0;i2<hooks.mapResponse.length;i2++){let mapResponse2=hooks.mapResponse[i2],endUnit2=mapResponseReporter.resolveChild(mapResponse2.fn.name);fnLiteral+=`if(mr===undefined){mr=${isAsyncName(mapResponse2)?"await ":""}e.mapResponse[${i2}](c)
if(mr!==undefined)be=c.response=mr}`,endUnit2()}}mapResponseReporter.resolve(),fnLiteral+=encodeCookie,fnLiteral+=`return mapEarlyResponse(${saveResponse}be,c.set${mapResponseContext})}
`}}reporter.resolve()}if(hooks.afterHandle?.length){let handleReporter=report("handle",{name:isHandleFn?handler.name:void 0});if(hooks.afterHandle.length)fnLiteral+=isAsyncHandler?`let r=c.response=await ${handle}
`:`let r=c.response=${handle}
`;else fnLiteral+=isAsyncHandler?`let r=await ${handle}
`:`let r=${handle}
`;handleReporter.resolve();let reporter=report("afterHandle",{total:hooks.afterHandle.length});for(let i=0;i<hooks.afterHandle.length;i++){let hook=hooks.afterHandle[i],returning=hasReturn(hook),endUnit=reporter.resolveChild(hook.fn.name);if(!returning)fnLiteral+=isAsync(hook.fn)?`await e.afterHandle[${i}](c)
`:`e.afterHandle[${i}](c)
`,endUnit();else if(fnLiteral+=isAsync(hook.fn)?`af=await e.afterHandle[${i}](c)
`:`af=e.afterHandle[${i}](c)
`,endUnit("af"),validator.response)fnLiteral+="if(af!==undefined){",reporter.resolve(),fnLiteral+=composeResponseValidation("af"),fnLiteral+="c.response=af}";else fnLiteral+="if(af!==undefined){",reporter.resolve(),fnLiteral+="c.response=af}"}if(reporter.resolve(),fnLiteral+=`r=c.response
`,validator.response)fnLiteral+=composeResponseValidation();fnLiteral+=encodeCookie;let mapResponseReporter=report("mapResponse",{total:hooks.mapResponse?.length});if(hooks.mapResponse?.length)for(let i=0;i<hooks.mapResponse.length;i++){let mapResponse2=hooks.mapResponse[i],endUnit=mapResponseReporter.resolveChild(mapResponse2.fn.name);fnLiteral+=`mr=${isAsyncName(mapResponse2)?"await ":""}e.mapResponse[${i}](c)
if(mr!==undefined)r=c.response=mr
`,endUnit()}if(mapResponseReporter.resolve(),hasSet)fnLiteral+=`return mapResponse(${saveResponse}r,c.set${mapResponseContext})
`;else fnLiteral+=`return mapCompactResponse(${saveResponse}r${mapResponseContext})
`}else{let handleReporter=report("handle",{name:isHandleFn?handler.name:void 0});if(validator.response||hooks.mapResponse?.length){if(fnLiteral+=isAsyncHandler?`let r=await ${handle}
`:`let r=${handle}
`,handleReporter.resolve(),validator.response)fnLiteral+=composeResponseValidation();report("afterHandle").resolve();let mapResponseReporter=report("mapResponse",{total:hooks.mapResponse?.length});if(hooks.mapResponse?.length){fnLiteral+=`
c.response=r
`;for(let i=0;i<hooks.mapResponse.length;i++){let mapResponse2=hooks.mapResponse[i],endUnit=mapResponseReporter.resolveChild(mapResponse2.fn.name);fnLiteral+=`
if(mr===undefined){mr=${isAsyncName(mapResponse2)?"await ":""}e.mapResponse[${i}](c)
if(mr!==undefined)r=c.response=mr}
`,endUnit()}}if(mapResponseReporter.resolve(),fnLiteral+=encodeCookie,handler instanceof Response)fnLiteral+=inference.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${saveResponse}${handle}.clone(),c.set${mapResponseContext})else return ${handle}.clone()`:`return ${handle}.clone()`,fnLiteral+=`
`;else if(hasSet)fnLiteral+=`return mapResponse(${saveResponse}r,c.set${mapResponseContext})
`;else fnLiteral+=`return mapCompactResponse(${saveResponse}r${mapResponseContext})
`}else if(hasCookie||hasTrace){fnLiteral+=isAsyncHandler?`let r=await ${handle}
`:`let r=${handle}
`,handleReporter.resolve(),report("afterHandle").resolve();let mapResponseReporter=report("mapResponse",{total:hooks.mapResponse?.length});if(hooks.mapResponse?.length){fnLiteral+=`c.response= r
`;for(let i=0;i<hooks.mapResponse.length;i++){let mapResponse2=hooks.mapResponse[i],endUnit=mapResponseReporter.resolveChild(mapResponse2.fn.name);fnLiteral+=`if(mr===undefined){mr=${isAsyncName(mapResponse2)?"await ":""}e.mapResponse[${i}](c)
if(mr!==undefined)r=c.response=mr}`,endUnit()}}if(mapResponseReporter.resolve(),fnLiteral+=encodeCookie,hasSet)fnLiteral+=`return mapResponse(${saveResponse}r,c.set${mapResponseContext})
`;else fnLiteral+=`return mapCompactResponse(${saveResponse}r${mapResponseContext})
`}else{handleReporter.resolve();let handled=isAsyncHandler?`await ${handle}`:handle;if(report("afterHandle").resolve(),handler instanceof Response)fnLiteral+=inference.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${saveResponse}${handle}.clone(),c.set${mapResponseContext})
else return ${handle}.clone()
`:`return ${handle}.clone()
`;else if(hasSet)fnLiteral+=`return mapResponse(${saveResponse}${handled},c.set${mapResponseContext})
`;else fnLiteral+=`return mapCompactResponse(${saveResponse}${handled}${mapResponseContext})
`}}if(fnLiteral+=`
}catch(error){`,hasBody)fnLiteral+=`if(isParsing)error=new ParseError()
`;if(!maybeAsync)fnLiteral+="return(async()=>{";if(fnLiteral+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,hasTrace&&hooks.trace)for(let i=0;i<hooks.trace.length;i++)fnLiteral+=`report${i}?.resolve(error);reportChild${i}?.(error)
`;let errorReporter=report("error",{total:hooks.error?.length});if(hooks.error?.length){if(fnLiteral+=`c.error=error
`,hasValidation)fnLiteral+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else fnLiteral+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;fnLiteral+=`let er
`;for(let i=0;i<hooks.error.length;i++){let endUnit=errorReporter.resolveChild(hooks.error[i].fn.name);if(isAsync(hooks.error[i]))fnLiteral+=`er=await e.error[${i}](c)
`;else fnLiteral+=`er=e.error[${i}](c)
if(er instanceof Promise)er=await er
`;endUnit();let mapResponseReporter=report("mapResponse",{total:hooks.mapResponse?.length});if(hooks.mapResponse?.length)for(let i2=0;i2<hooks.mapResponse.length;i2++){let mapResponse2=hooks.mapResponse[i2],endUnit2=mapResponseReporter.resolveChild(mapResponse2.fn.name);fnLiteral+=`c.response=er
er=e.mapResponse[${i2}](c)
if(er instanceof Promise)er=await er
`,endUnit2()}if(mapResponseReporter.resolve(),fnLiteral+=`er=mapEarlyResponse(er,set${mapResponseContext})
`,fnLiteral+="if(er){",hasTrace&&hooks.trace){for(let i2=0;i2<hooks.trace.length;i2++)fnLiteral+=`report${i2}.resolve()
`;errorReporter.resolve()}fnLiteral+="return er}"}}if(errorReporter.resolve(),fnLiteral+="return handleError(c,error,true)",!maybeAsync)fnLiteral+="})()";if(fnLiteral+="}",hasAfterResponse||hasTrace){if(fnLiteral+="finally{ ",!maybeAsync)fnLiteral+=";(async()=>{";let reporter=report("afterResponse",{total:hooks.afterResponse?.length});if(hasAfterResponse&&hooks.afterResponse)for(let i=0;i<hooks.afterResponse.length;i++){let endUnit=reporter.resolveChild(hooks.afterResponse[i].fn.name);fnLiteral+=`
await e.afterResponse[${i}](c)
`,endUnit()}if(reporter.resolve(),!maybeAsync)fnLiteral+="})()";fnLiteral+="}"}let adapterVariables=adapter.inject?Object.keys(adapter.inject).join(",")+",":"",init="const {handler,handleError,hooks:e, "+allocateIf("validator,",hasValidation)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+allocateIf("parseQuery,",hasBody)+allocateIf("parseQueryFromURL,",hasQuery)+"},error:{"+allocateIf("ValidationError,",hasValidation)+"InternalServerError,"+allocateIf("ParseError",hasBody)+"},schema,definitions,ERROR_CODE,"+allocateIf("parseCookie,",hasCookie)+allocateIf("signCookie,",hasCookie)+allocateIf("decodeURIComponent,",hasQuery)+"ElysiaCustomStatusResponse,"+allocateIf("ELYSIA_TRACE,",hasTrace)+allocateIf("ELYSIA_REQUEST_ID,",hasTrace)+allocateIf("parser,",hooks.parse?.length)+allocateIf("getServer,",inference.server)+adapterVariables+allocateIf("TypeBoxError",hasValidation)+`}=hooks
const trace=e.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
return ${maybeAsync?"async ":""}function handle(c){`;if(hooks.beforeHandle?.length)init+=`let be
`;if(hooks.afterHandle?.length)init+=`let af
`;if(hooks.mapResponse?.length)init+=`let mr
`;if(allowMeta)init+=`c.schema = schema
c.defs = definitions
`;init+=fnLiteral+"}";try{if(asManifest)return Function("hooks",init);return Function("hooks",init)({handler,hooks:lifeCycleToFn(hooks),validator:hasValidation?validator:void 0,handleError:app.handleError,mapResponse:adapterHandler.mapResponse,mapCompactResponse:adapterHandler.mapCompactResponse,mapEarlyResponse:adapterHandler.mapEarlyResponse,isNotEmpty,utils:{parseQuery:hasBody?parseQuery:void 0,parseQueryFromURL:hasQuery?parseQueryFromURL:void 0},error:{ValidationError:hasValidation?ValidationError:void 0,InternalServerError,ParseError:hasBody?ParseError2:void 0},schema:app.router.history,definitions:app.definitions.type,ERROR_CODE,parseCookie:hasCookie?parseCookie:void 0,signCookie:hasCookie?signCookie:void 0,decodeURIComponent:hasQuery?decode2:void 0,ElysiaCustomStatusResponse,ELYSIA_TRACE:hasTrace?ELYSIA_TRACE:void 0,ELYSIA_REQUEST_ID:hasTrace?ELYSIA_REQUEST_ID:void 0,getServer:()=>app.getServer(),TypeBoxError:hasValidation?TypeBoxError:void 0,parser:app["~parser"],...adapter.inject})}catch(error2){let debugHooks=lifeCycleToFn(hooks);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof handler==="function"?handler.toString():handler,instruction:init,hooks:{...debugHooks,transform:debugHooks?.transform?.map?.((x)=>x.toString()),resolve:debugHooks?.resolve?.map?.((x)=>x.toString()),beforeHandle:debugHooks?.beforeHandle?.map?.((x)=>x.toString()),afterHandle:debugHooks?.afterHandle?.map?.((x)=>x.toString()),mapResponse:debugHooks?.mapResponse?.map?.((x)=>x.toString()),parse:debugHooks?.parse?.map?.((x)=>x.toString()),error:debugHooks?.error?.map?.((x)=>x.toString()),afterResponse:debugHooks?.afterResponse?.map?.((x)=>x.toString()),stop:debugHooks?.stop?.map?.((x)=>x.toString())},validator,definitions:app.definitions.type,error:error2,fnLiteral}),console.log("---"),process.exit(1)}},composeGeneralHandler=(app,{asManifest=!1}={})=>{let adapter=app["~adapter"].composeGeneralHandler;app.router.http.build();let error404=adapter.error404(!!app.event.request?.length,!!app.event.error?.length),hasTrace=app.event.trace?.length,fnLiteral="",router=app.router,findDynamicRoute="const route=router.find(r.method,p)";findDynamicRoute+=router.http.root.ALL?`??router.find("ALL",p)
`:`
`,findDynamicRoute+=error404.code,findDynamicRoute+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)
`;let switchMap="";for(let[path,v]of Object.entries(router.static.http.map)){if(switchMap+=`case'${path}':`,app.config.strictPath!==!0)switchMap+=`case'${getLoosePath(path)}':`;let encoded=encodePath(path);if(path!==encoded)switchMap+=`case'${encoded}':`;switchMap+=`switch(r.method){${v.code}
`+(v.all??"default: break map")+"}"}let maybeAsync=!!app.event.request?.some(isAsync),adapterVariables=adapter.inject?Object.keys(adapter.inject).join(",")+",":"";if(fnLiteral+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,error,redirect,`+allocateIf("ELYSIA_TRACE,",hasTrace)+allocateIf("ELYSIA_REQUEST_ID,",hasTrace)+adapterVariables+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,app.event.request?.length)fnLiteral+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(fnLiteral+=error404.declare,app.event.trace?.length)fnLiteral+="const "+app.event.trace.map((_2,i)=>`tr${i}=app.event.trace[${i}].fn`).join(",")+`
`;if(fnLiteral+=`${maybeAsync?"async ":""}function map(${adapter.parameters}){`,app.event.request?.length)fnLiteral+=`let re
`;if(fnLiteral+=adapter.createContext(app),app.event.trace?.length)fnLiteral+="c[ELYSIA_TRACE]=["+app.event.trace.map((_2,i)=>`tr${i}(c)`).join(",")+`]
`;let reporter=createReport({trace:app.event.trace,addFn(word){fnLiteral+=word}})("request",{total:app.event.request?.length});if(app.event.request?.length){fnLiteral+="try{";for(let i=0;i<app.event.request.length;i++){let hook=app.event.request[i],withReturn=hasReturn(hook),maybeAsync2=isAsync(hook),endUnit=reporter.resolveChild(app.event.request[i].fn.name);if(withReturn)fnLiteral+=`re=mapEarlyResponse(${maybeAsync2?"await ":""}onRequest[${i}](c),c.set)
`,endUnit("re"),fnLiteral+=`if(re!==undefined)return re
`;else fnLiteral+=`${maybeAsync2?"await ":""}onRequest[${i}](c)
`,endUnit()}fnLiteral+="}catch(error){return app.handleError(c,error,false)}"}if(reporter.resolve(),fnLiteral+=adapter.websocket(app),fnLiteral+=`
map:switch(p){
`+switchMap+"default:break}"+findDynamicRoute+`}
`,app.extender.higherOrderFunctions.length){let handler="map";for(let i=0;i<app.extender.higherOrderFunctions.length;i++)handler=`hoc[${i}](${handler},${adapter.parameters})`;fnLiteral+=`return function hocMap(${adapter.parameters}){return ${handler}(${adapter.parameters})}`}else fnLiteral+="return map";let handleError=composeErrorHandler(app);return app.handleError=handleError,Function("data",fnLiteral)({app,mapEarlyResponse:app["~adapter"].handler.mapEarlyResponse,NotFoundError,randomId,handleError,error,redirect,ELYSIA_TRACE:hasTrace?ELYSIA_TRACE:void 0,ELYSIA_REQUEST_ID:hasTrace?ELYSIA_REQUEST_ID:void 0,...adapter.inject})},composeErrorHandler=(app)=>{let hooks=app.event,fnLiteral="",adapter=app["~adapter"].composeError,adapterVariables=adapter.inject?Object.keys(adapter.inject).join(",")+",":"",hasTrace=!!app.event.trace?.length;if(fnLiteral+="const {app:{event:{error:onErrorContainer,afterResponse:resContainer,mapResponse:_onMapResponse,trace:_trace}},mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+allocateIf("ELYSIA_TRACE,",hasTrace)+allocateIf("ELYSIA_REQUEST_ID,",hasTrace)+adapterVariables+`}=inject
`,fnLiteral+=`const trace=_trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const onMapResponse=[]
if(_onMapResponse)for(let i=0;i<_onMapResponse.length;i++)onMapResponse.push(_onMapResponse[i].fn??_onMapResponse[i])
delete _onMapResponse
const onError=onErrorContainer?.map(x=>x.fn)??[]
const res=resContainer?.map(x=>x.fn)??[]
return ${app.event.error?.find(isAsync)||app.event.mapResponse?.find(isAsync)?"async ":""}function(context,error,skipGlobal){`,fnLiteral+="",hasTrace)fnLiteral+=`const id=context[ELYSIA_REQUEST_ID]
`;let report=createReport({context:"context",trace:hooks.trace,addFn:(word)=>{fnLiteral+=word}});if(fnLiteral+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,adapter.declare)fnLiteral+=adapter.declare;let saveResponse=hasTrace||!!hooks.afterResponse?.length||!!hooks.afterResponse?.length?"context.response = ":"";if(app.event.error)for(let i=0;i<app.event.error.length;i++){let handler=app.event.error[i],response=`${isAsync(handler)?"await ":""}onError[${i}](context)
`;if(fnLiteral+="if(skipGlobal!==true){",hasReturn(handler)){fnLiteral+=`_r=${response}
if(_r!==undefined){if(_r instanceof Response)return mapResponse(_r,set${adapter.mapResponseContext})
if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let mapResponseReporter2=report("mapResponse",{total:hooks.mapResponse?.length,name:"context"});if(hooks.mapResponse?.length)for(let i2=0;i2<hooks.mapResponse.length;i2++){let mapResponse2=hooks.mapResponse[i2],endUnit=mapResponseReporter2.resolveChild(mapResponse2.fn.name);fnLiteral+=`context.response=_r_r=${isAsyncName(mapResponse2)?"await ":""}onMapResponse[${i2}](context)
`,endUnit()}mapResponseReporter2.resolve(),fnLiteral+=`return mapResponse(${saveResponse}_r,set${adapter.mapResponseContext})}`}else fnLiteral+=response;fnLiteral+="}"}fnLiteral+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){if(error.error)error=error.error
set.status=error.status??422
`+adapter.validationError+"}",fnLiteral+="if(error instanceof Error){"+adapter.unknownError+"}";let mapResponseReporter=report("mapResponse",{total:hooks.mapResponse?.length,name:"context"});if(fnLiteral+=`
if(!context.response)context.response=error.message??error
`,hooks.mapResponse?.length){fnLiteral+=`let mr
`;for(let i=0;i<hooks.mapResponse.length;i++){let mapResponse2=hooks.mapResponse[i],endUnit=mapResponseReporter.resolveChild(mapResponse2.fn.name);fnLiteral+=`if(mr===undefined){mr=${isAsyncName(mapResponse2)?"await ":""}onMapResponse[${i}](context)
if(mr!==undefined)error=context.response=mr}`,endUnit()}}return mapResponseReporter.resolve(),fnLiteral+=`
return mapResponse(${saveResponse}error,set${adapter.mapResponseContext})}`,Function("inject",fnLiteral)({app,mapResponse:app["~adapter"].handler.mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,ELYSIA_TRACE:hasTrace?ELYSIA_TRACE:void 0,ELYSIA_REQUEST_ID:hasTrace?ELYSIA_REQUEST_ID:void 0,...adapter.inject})},injectDefaultValues=(typeChecker,obj)=>{for(let[key,keySchema]of Object.entries(typeChecker.schema.properties))obj[key]??=keySchema.default},createDynamicHandler=(app)=>{let{mapResponse:mapResponse2,mapEarlyResponse:mapEarlyResponse2}=app["~adapter"].handler;return async(request)=>{let url=request.url,s=url.indexOf("/",11),qi=url.indexOf("?",s+1),path=qi===-1?url.substring(s):url.substring(s,qi),set2={cookie:{},status:200,headers:{}},context=Object.assign({},app.singleton.decorator,{set:set2,store:app.singleton.store,request,path,qi,error,redirect});try{if(app.event.request)for(let i=0;i<app.event.request.length;i++){let onRequest=app.event.request[i].fn,response2=onRequest(context);if(response2 instanceof Promise)response2=await response2;if(response2=mapEarlyResponse2(response2,set2),response2)return context.response=response2}let handler=app.router.dynamic.find(request.method,path)??app.router.dynamic.find("ALL",path);if(!handler)throw new NotFoundError;let{handle,hooks,validator,content,route}=handler.store,body;if(request.method!=="GET"&&request.method!=="HEAD")if(content)switch(content){case"application/json":body=await request.json();break;case"text/plain":body=await request.text();break;case"application/x-www-form-urlencoded":body=parseQuery(await request.text());break;case"application/octet-stream":body=await request.arrayBuffer();break;case"multipart/form-data":body={};let form2=await request.formData();for(let key of form2.keys()){if(body[key])continue;let value=form2.getAll(key);if(value.length===1)body[key]=value[0];else body[key]=value}break}else{let contentType=request.headers.get("content-type");if(contentType){let index=contentType.indexOf(";");if(index!==-1)contentType=contentType.slice(0,index);if(context.contentType=contentType,hooks.parse)for(let i=0;i<hooks.parse.length;i++){let hook=hooks.parse[i].fn,temp=hook(context,contentType);if(temp instanceof Promise)temp=await temp;if(temp){body=temp;break}}if(delete context.contentType,body===void 0)switch(contentType){case"application/json":body=await request.json();break;case"text/plain":body=await request.text();break;case"application/x-www-form-urlencoded":body=parseQuery(await request.text());break;case"application/octet-stream":body=await request.arrayBuffer();break;case"multipart/form-data":body={};let form2=await request.formData();for(let key of form2.keys()){if(body[key])continue;let value=form2.getAll(key);if(value.length===1)body[key]=value[0];else body[key]=value}break}}}context.route=route,context.body=body,context.params=handler?.params||void 0,context.query=qi===-1?{}:parseQuery(url.substring(qi+1)),context.headers={};for(let[key,value]of request.headers.entries())context.headers[key]=value;let cookieMeta=Object.assign({},app.config?.cookie,validator?.cookie?.config),cookieHeaderValue=request.headers.get("cookie");context.cookie=await parseCookie(context.set,cookieHeaderValue,cookieMeta?{secrets:cookieMeta.secrets!==void 0?typeof cookieMeta.secrets==="string"?cookieMeta.secrets:cookieMeta.secrets.join(","):void 0,sign:cookieMeta.sign===!0?!0:cookieMeta.sign!==void 0?typeof cookieMeta.sign==="string"?cookieMeta.sign:cookieMeta.sign.join(","):void 0}:void 0);let headerValidator=validator?.createHeaders?.();if(headerValidator)injectDefaultValues(headerValidator,context.headers);let paramsValidator=validator?.createParams?.();if(paramsValidator)injectDefaultValues(paramsValidator,context.params);let queryValidator=validator?.createQuery?.();if(queryValidator)injectDefaultValues(queryValidator,context.query);if(hooks.transform)for(let i=0;i<hooks.transform.length;i++){let hook=hooks.transform[i],operation=hook.fn(context);if(hook.subType==="derive")if(operation instanceof Promise)Object.assign(context,await operation);else Object.assign(context,operation);else if(operation instanceof Promise)await operation}if(validator){if(headerValidator){let _header=structuredClone(context.headers);for(let[key,value]of request.headers)_header[key]=value;if(validator.headers.Check(_header)===!1)throw new ValidationError("header",validator.headers,_header)}else if(validator.headers?.Decode)context.headers=validator.headers.Decode(context.headers);if(paramsValidator?.Check(context.params)===!1)throw new ValidationError("params",validator.params,context.params);else if(validator.params?.Decode)context.params=validator.params.Decode(context.params);if(queryValidator?.Check(context.query)===!1)throw new ValidationError("query",validator.query,context.query);else if(validator.query?.Decode)context.query=validator.query.Decode(context.query);if(validator.createCookie?.()){let cookieValue={};for(let[key,value]of Object.entries(context.cookie))cookieValue[key]=value.value;if(validator.cookie.Check(cookieValue)===!1)throw new ValidationError("cookie",validator.cookie,cookieValue);else if(validator.cookie?.Decode)cookieValue=validator.cookie.Decode(cookieValue)}if(validator.createBody?.()?.Check(body)===!1)throw new ValidationError("body",validator.body,body);else if(validator.body?.Decode)context.body=validator.body.Decode(body)}if(hooks.beforeHandle)for(let i=0;i<hooks.beforeHandle.length;i++){let hook=hooks.beforeHandle[i],response2=hook.fn(context);if(hook.subType==="resolve"){if(response2 instanceof ElysiaCustomStatusResponse){let result=mapEarlyResponse2(response2,context.set);if(result)return context.response=result}if(response2 instanceof Promise)Object.assign(context,await response2);else Object.assign(context,response2);continue}else if(response2 instanceof Promise)response2=await response2;if(response2!==void 0){if(context.response=response2,hooks.afterHandle)for(let i2=0;i2<hooks.afterHandle.length;i2++){let newResponse=hooks.afterHandle[i2].fn(context);if(newResponse instanceof Promise)newResponse=await newResponse;if(newResponse)response2=newResponse}let result=mapEarlyResponse2(response2,context.set);if(result)return context.response=result}}let response=typeof handle==="function"?handle(context):handle;if(response instanceof Promise)response=await response;if(hooks.afterHandle)if(!hooks.afterHandle.length){let status=response instanceof ElysiaCustomStatusResponse?response.code:set2.status?typeof set2.status==="string"?StatusMap[set2.status]:set2.status:200,responseValidator=validator?.createResponse?.()?.[status];if(responseValidator?.Check(response)===!1)throw new ValidationError("response",responseValidator,response);else if(responseValidator?.Decode)response=responseValidator.Decode(response)}else{context.response=response;for(let i=0;i<hooks.afterHandle.length;i++){let newResponse=hooks.afterHandle[i].fn(context);if(newResponse instanceof Promise)newResponse=await newResponse;let result=mapEarlyResponse2(newResponse,context.set);if(result!==void 0){let responseValidator=validator?.response?.[result.status];if(responseValidator?.Check(result)===!1)throw new ValidationError("response",responseValidator,result);else if(responseValidator?.Decode)response=responseValidator.Decode(response);return context.response=result}}}if(context.set.cookie&&cookieMeta?.sign){let secret=!cookieMeta.secrets?void 0:typeof cookieMeta.secrets==="string"?cookieMeta.secrets:cookieMeta.secrets[0];if(cookieMeta.sign===!0)for(let[key,cookie]of Object.entries(context.set.cookie))context.set.cookie[key].value=await signCookie(cookie.value,"${secret}");else{let properties=validator?.cookie?.schema?.properties;for(let name of cookieMeta.sign){if(!(name in properties))continue;if(context.set.cookie[name]?.value)context.set.cookie[name].value=await signCookie(context.set.cookie[name].value,secret)}}}return mapResponse2(context.response=response,context.set)}catch(error2){let reportedError=error2 instanceof TransformDecodeError&&error2.error?error2.error:error2;return app.handleError(context,reportedError)}finally{if(app.event.afterResponse)for(let afterResponse of app.event.afterResponse)await afterResponse.fn(context)}}},createDynamicErrorHandler=(app)=>{let{mapResponse:mapResponse2}=app["~adapter"].handler;return async(context,error2)=>{let errorContext=Object.assign(context,{error:error2,code:error2.code});if(errorContext.set=context.set,app.event.error)for(let i=0;i<app.event.error.length;i++){let response=app.event.error[i].fn(errorContext);if(response instanceof Promise)response=await response;if(response!==void 0&&response!==null)return context.response=mapResponse2(response,context.set)}return new Response(typeof error2.cause==="string"?error2.cause:error2.message,{headers:context.set.headers,status:error2.status??500})}};class Elysia{config;server=null;dependencies={};_routes={};_types={Prefix:"",Singleton:{},Definitions:{},Metadata:{}};_ephemeral={};_volatile={};singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:t.Module({}),type:{},error:{}};extender={macros:[],higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){return mergeSchemaValidator(mergeSchemaValidator(this.global,this.scoped),this.local)}};event={};telemetry={stack:void 0};router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new _({lazy:!0});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new _;return this["~dynamic"]},static:{http:{static:{},map:{},all:""},ws:{}},history:[]};routeTree=new Map;get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,request:!1,route:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new PromiseGroup;return this._promisedModules}constructor(config={}){if(config.tags)if(!config.detail)config.detail={tags:config.tags};else config.detail.tags=config.tags;if(config.nativeStaticResponse===void 0)config.nativeStaticResponse=!0;if(this.config={},this.applyConfig(config??{}),this["~adapter"]=config.adapter??(typeof Bun!=="undefined"?BunAdapter:WebStandardAdapter),config?.analytic&&(config?.name||config?.seed!==void 0))this.telemetry.stack=new Error().stack}"~adapter";env(model,_env=env2){if(getSchemaValidator(model,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0}).Check(_env)===!1){let error2=new ValidationError("env",model,_env);throw new Error(error2.all.map((x)=>x.summary).join(`
`))}return this}wrap(fn){return this.extender.higherOrderFunctions.push({checksum:checksum(JSON.stringify({name:this.config.name,seed:this.config.seed,content:fn.toString()})),fn}),this}applyMacro(localHook){if(this.extender.macros.length){let manage=createMacroManager({globalHook:this.event,localHook}),manager={events:{global:this.event,local:localHook},get onParse(){return manage("parse")},get onTransform(){return manage("transform")},get onBeforeHandle(){return manage("beforeHandle")},get onAfterHandle(){return manage("afterHandle")},get mapResponse(){return manage("mapResponse")},get onAfterResponse(){return manage("afterResponse")},get onError(){return manage("error")}};for(let macro of this.extender.macros)traceBackMacro(macro.fn(manager),localHook,manage)}}applyConfig(config){return this.config={prefix:"",aot:env2.ELYSIA_AOT!=="false",normalize:!0,...config,cookie:{path:"/",...config?.cookie},experimental:config?.experimental??{},seed:config?.seed===void 0?"":config?.seed},this}get models(){let models={};for(let name of Object.keys(this.definitions.type))models[name]=getSchemaValidator(this.definitions.typebox.Import(name));return models.modules=this.definitions.typebox,models}add(method,path,handle,localHook,{allowMeta=!1,skipPrefix=!1}={allowMeta:!1,skipPrefix:!1}){if(localHook=compressHistoryHook(localHookToLifeCycleStore(localHook)),path!==""&&path.charCodeAt(0)!==47)path="/"+path;if(this.config.prefix&&!skipPrefix)path=this.config.prefix+path;if(localHook?.type)switch(localHook.type){case"text":localHook.type="text/plain";break;case"json":localHook.type="application/json";break;case"formdata":localHook.type="multipart/form-data";break;case"urlencoded":localHook.type="application/x-www-form-urlencoded";break;case"arrayBuffer":localHook.type="application/octet-stream";break;default:break}let models=this.definitions.type,dynamic=!this.config.aot,instanceValidator={...this.validator.getCandidate()},cloned={body:localHook?.body??instanceValidator?.body,headers:localHook?.headers??instanceValidator?.headers,params:localHook?.params??instanceValidator?.params,query:localHook?.query??instanceValidator?.query,cookie:localHook?.cookie??instanceValidator?.cookie,response:localHook?.response??instanceValidator?.response},cookieValidator=()=>cloned.cookie?getCookieValidator({modules,validator:cloned.cookie,defaultConfig:this.config.cookie,config:cloned.cookie?.config??{},dynamic,models}):void 0,normalize=this.config.normalize,modules=this.definitions.typebox,validator=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.schema===!0?{body:getSchemaValidator(cloned.body,{modules,dynamic,models,normalize,additionalCoerce:coercePrimitiveRoot()}),headers:getSchemaValidator(cloned.headers,{modules,dynamic,models,additionalProperties:!this.config.normalize,coerce:!0,additionalCoerce:stringToStructureCoercions()}),params:getSchemaValidator(cloned.params,{modules,dynamic,models,coerce:!0,additionalCoerce:stringToStructureCoercions()}),query:getSchemaValidator(cloned.query,{modules,dynamic,models,normalize,coerce:!0,additionalCoerce:stringToStructureCoercions()}),cookie:cookieValidator(),response:getResponseSchemaValidator(cloned.response,{modules,dynamic,models,normalize})}:{createBody(){if(this.body)return this.body;return this.body=getSchemaValidator(cloned.body,{modules,dynamic,models,normalize,additionalCoerce:coercePrimitiveRoot()})},createHeaders(){if(this.headers)return this.headers;return this.headers=getSchemaValidator(cloned.headers,{modules,dynamic,models,additionalProperties:!normalize,coerce:!0,additionalCoerce:stringToStructureCoercions()})},createParams(){if(this.params)return this.params;return this.params=getSchemaValidator(cloned.params,{modules,dynamic,models,coerce:!0,additionalCoerce:stringToStructureCoercions()})},createQuery(){if(this.query)return this.query;return this.query=getSchemaValidator(cloned.query,{modules,dynamic,models,coerce:!0,additionalCoerce:stringToStructureCoercions()})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=cookieValidator()},createResponse(){if(this.response)return this.response;return this.response=getResponseSchemaValidator(cloned.response,{modules,dynamic,models,normalize})}};if(localHook=mergeHook(localHook,compressHistoryHook(instanceValidator)),localHook.tags)if(!localHook.detail)localHook.detail={tags:localHook.tags};else localHook.detail.tags=localHook.tags;if(isNotEmpty(this.config.detail))localHook.detail=mergeDeep(Object.assign({},this.config.detail),localHook.detail);this.applyMacro(localHook);let hooks=compressHistoryHook(mergeHook(this.event,localHook));if(this.config.aot===!1){this.router.dynamic.add(method,path,{validator,hooks,content:localHook?.type,handle,route:path});let encoded=encodePath(path,{dynamic:!0});if(path!==encoded)this.router.dynamic.add(method,encoded,{validator,hooks,content:localHook?.type,handle,route:path});if(this.config.strictPath===!1){let loosePath=getLoosePath(path);this.router.dynamic.add(method,loosePath,{validator,hooks,content:localHook?.type,handle,route:path});let encoded2=encodePath(loosePath);if(loosePath!==encoded2)this.router.dynamic.add(method,loosePath,{validator,hooks,content:localHook?.type,handle,route:path})}this.router.history.push({method,path,composed:null,handler:handle,hooks});return}let shouldPrecompile=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,inference=cloneInference(this.inference),adapter=this["~adapter"].handler,staticHandler=typeof handle!=="function"&&typeof adapter.createStaticHandler==="function"?adapter.createStaticHandler(handle,hooks,this.setHeaders):void 0,nativeStaticHandler=typeof handle!=="function"?adapter.createNativeStaticHandler?.(handle,hooks,this.setHeaders):void 0;if(this.config.nativeStaticResponse===!0&&nativeStaticHandler&&(method==="GET"||method==="ALL"))this.router.static.http.static[path]=nativeStaticHandler();let compile=(asManifest=!1)=>composeHandler({app:this,path,method,hooks,validator,handler:typeof handle!=="function"&&typeof adapter.createStaticHandler!=="function"?()=>handle:handle,allowMeta,inference,asManifest}),oldIndex;if(this.routeTree.has(method+path))for(let i=0;i<this.router.history.length;i++){let route=this.router.history[i];if(route.path===path&&route.method===method){oldIndex=i;break}}else this.routeTree.set(method+path,this.router.history.length);let history=this.router.history,index=oldIndex??this.router.history.length,mainHandler=shouldPrecompile?compile():(ctx)=>{let temp=(history[index].composed=compile())(ctx);return compile=void 0,temp};if(shouldPrecompile)compile=void 0;let isWebSocket=method==="$INTERNALWS";if(oldIndex!==void 0)this.router.history[oldIndex]=Object.assign({method,path,composed:mainHandler,handler:handle,hooks},localHook.webSocket?{websocket:localHook.websocket}:{});else this.router.history.push(Object.assign({method,path,composed:mainHandler,handler:handle,hooks},localHook.webSocket?{websocket:localHook.websocket}:{}));let staticRouter=this.router.static.http,handler={handler:shouldPrecompile?mainHandler:void 0,compile(){return this.handler=compile()}};if(isWebSocket){if(this.router.http.add("ws",path,handler),!this.config.strictPath)this.router.http.add("ws",getLoosePath(path),handler);let encoded=encodePath(path,{dynamic:!0});if(encoded!==path)this.router.http.add("ws",encoded,handler);return}if(path.indexOf(":")===-1&&path.indexOf("*")===-1){if(!staticRouter.map[path])staticRouter.map[path]={code:""};let ctx=staticHandler?"":"c";if(method==="ALL")staticRouter.map[path].all=`default:return ht[${index}].composed(${ctx})
`;else staticRouter.map[path].code=`case '${method}':return ht[${index}].composed(${ctx})
${staticRouter.map[path].code}`;if(!this.config.strictPath&&this.config.nativeStaticResponse===!0&&nativeStaticHandler&&(method==="GET"||method==="ALL"))this.router.static.http.static[getLoosePath(path)]=nativeStaticHandler()}else{if(this.router.http.add(method,path,handler),!this.config.strictPath){let loosePath=getLoosePath(path);if(this.config.nativeStaticResponse===!0&&staticHandler&&(method==="GET"||method==="ALL"))this.router.static.http.static[loosePath]=staticHandler();this.router.http.add(method,loosePath,handler)}let encoded=encodePath(path,{dynamic:!0});if(path!==encoded){if(this.router.http.add(method,encoded,handler),this.config.nativeStaticResponse===!0&&staticHandler&&(method==="GET"||method==="ALL"))this.router.static.http.static[encoded]=staticHandler();this.router.http.add(method,encoded,handler)}}}setHeaders;headers(header){if(!header)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=mergeDeep(this.setHeaders,header),this}onStart(handler){return this.on("start",handler),this}onRequest(handler){return this.on("request",handler),this}onParse(options,handler){if(!handler){if(typeof options==="string")return this.on("parse",this["~parser"][options]);return this.on("parse",options)}return this.on(options,"parse",handler)}parser(name,parser){return this["~parser"][name]=parser,this}onTransform(options,handler){if(!handler)return this.on("transform",options);return this.on(options,"transform",handler)}resolve(optionsOrResolve,resolve){if(!resolve)resolve=optionsOrResolve,optionsOrResolve={as:"local"};let hook={subType:"resolve",fn:resolve};return this.onBeforeHandle(optionsOrResolve,hook)}mapResolve(optionsOrResolve,mapper){if(!mapper)mapper=optionsOrResolve,optionsOrResolve={as:"local"};let hook={subType:"mapResolve",fn:mapper};return this.onBeforeHandle(optionsOrResolve,hook)}onBeforeHandle(options,handler){if(!handler)return this.on("beforeHandle",options);return this.on(options,"beforeHandle",handler)}onAfterHandle(options,handler){if(!handler)return this.on("afterHandle",options);return this.on(options,"afterHandle",handler)}mapResponse(options,handler){if(!handler)return this.on("mapResponse",options);return this.on(options,"mapResponse",handler)}onAfterResponse(options,handler){if(!handler)return this.on("afterResponse",options);return this.on(options,"afterResponse",handler)}trace(options,handler){if(!handler)handler=options,options={as:"local"};if(!Array.isArray(handler))handler=[handler];for(let fn of handler)this.on(options,"trace",createTracer(fn));return this}error(name,error2){switch(typeof name){case"string":return error2.prototype[ERROR_CODE]=name,this.definitions.error[name]=error2,this;case"function":return this.definitions.error=name(this.definitions.error),this}for(let[code,error3]of Object.entries(name))error3.prototype[ERROR_CODE]=code,this.definitions.error[code]=error3;return this}onError(options,handler){if(!handler)return this.on("error",options);return this.on(options,"error",handler)}onStop(handler){return this.on("stop",handler),this}on(optionsOrType,typeOrHandlers,handlers){let type2;switch(typeof optionsOrType){case"string":type2=optionsOrType,handlers=typeOrHandlers;break;case"object":if(type2=typeOrHandlers,!Array.isArray(typeOrHandlers)&&typeof typeOrHandlers==="object")handlers=typeOrHandlers;break}if(Array.isArray(handlers))handlers=fnToContainer(handlers);else if(typeof handlers==="function")handlers=[{fn:handlers}];else handlers=[handlers];let handles=handlers;for(let handle of handles)if(handle.scope=typeof optionsOrType==="string"?"local":optionsOrType?.as??"local",type2==="resolve"||type2==="derive")handle.subType=type2;if(type2!=="trace")sucrose({[type2]:handles.map((x)=>x.fn)},this.inference);for(let handle of handles){let fn=asHookType(handle,"global",{skipIfHasType:!0});switch(type2){case"start":this.event.start??=[],this.event.start.push(fn);break;case"request":this.event.request??=[],this.event.request.push(fn);break;case"parse":this.event.parse??=[],this.event.parse.push(fn);break;case"transform":this.event.transform??=[],this.event.transform.push(fn);break;case"derive":this.event.transform??=[],this.event.transform.push(fnToContainer(fn,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(fn);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push(fnToContainer(fn,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(fn);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(fn);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(fn);break;case"trace":this.event.trace??=[],this.event.trace.push(fn);break;case"error":this.event.error??=[],this.event.error.push(fn);break;case"stop":this.event.stop??=[],this.event.stop.push(fn);break}}return this}propagate(){return promoteEvent(this.event.parse),promoteEvent(this.event.transform),promoteEvent(this.event.beforeHandle),promoteEvent(this.event.afterHandle),promoteEvent(this.event.mapResponse),promoteEvent(this.event.afterResponse),promoteEvent(this.event.trace),promoteEvent(this.event.error),this}as(type2){let castType={plugin:"scoped",scoped:"scoped",global:"global"}[type2];if(promoteEvent(this.event.parse,castType),promoteEvent(this.event.transform,castType),promoteEvent(this.event.beforeHandle,castType),promoteEvent(this.event.afterHandle,castType),promoteEvent(this.event.mapResponse,castType),promoteEvent(this.event.afterResponse,castType),promoteEvent(this.event.trace,castType),promoteEvent(this.event.error,castType),type2==="plugin")this.validator.scoped=mergeSchemaValidator(this.validator.scoped,this.validator.local),this.validator.local=null;else if(type2==="global")this.validator.global=mergeSchemaValidator(this.validator.global,mergeSchemaValidator(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null;return this}group(prefix,schemaOrRun,run){let instance=new Elysia({...this.config,prefix:""});instance.singleton={...this.singleton},instance.definitions={...this.definitions},instance.getServer=()=>this.getServer(),instance.inference=cloneInference(this.inference),instance.extender={...this.extender};let isSchema=typeof schemaOrRun==="object",sandbox=(isSchema?run:schemaOrRun)(instance);if(this.singleton=mergeDeep(this.singleton,instance.singleton),this.definitions=mergeDeep(this.definitions,instance.definitions),sandbox.event.request?.length)this.event.request=[...this.event.request||[],...sandbox.event.request||[]];if(sandbox.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...sandbox.event.mapResponse||[]];return this.model(sandbox.definitions.type),Object.values(instance.router.history).forEach(({method,path,handler,hooks})=>{if(path=(isSchema?"":this.config.prefix)+prefix+path,isSchema){let hook=schemaOrRun,localHook=hooks;this.add(method,path,handler,mergeHook(hook,{...localHook||{},error:!localHook.error?sandbox.event.error:Array.isArray(localHook.error)?[...localHook.error||{},...sandbox.event.error||{}]:[localHook.error,...sandbox.event.error||{}]}))}else this.add(method,path,handler,mergeHook(hooks,{error:sandbox.event.error}),{skipPrefix:!0})}),this}guard(hook,run){if(!run){if(typeof hook==="object"){this.applyMacro(hook);let type2=hook.as??"local";if(this.validator[type2]={body:hook.body??this.validator[type2]?.body,headers:hook.headers??this.validator[type2]?.headers,params:hook.params??this.validator[type2]?.params,query:hook.query??this.validator[type2]?.query,response:hook.response??this.validator[type2]?.response,cookie:hook.cookie??this.validator[type2]?.cookie},hook.parse)this.on({as:type2},"parse",hook.parse);if(hook.transform)this.on({as:type2},"transform",hook.transform);if(hook.derive)this.on({as:type2},"derive",hook.derive);if(hook.beforeHandle)this.on({as:type2},"beforeHandle",hook.beforeHandle);if(hook.resolve)this.on({as:type2},"resolve",hook.resolve);if(hook.afterHandle)this.on({as:type2},"afterHandle",hook.afterHandle);if(hook.mapResponse)this.on({as:type2},"mapResponse",hook.mapResponse);if(hook.afterResponse)this.on({as:type2},"afterResponse",hook.afterResponse);if(hook.error)this.on({as:type2},"error",hook.error);if(hook.detail)if(this.config.detail)this.config.detail=mergeDeep(Object.assign({},this.config.detail),hook.detail);else this.config.detail=hook.detail;if(hook?.tags)if(!this.config.detail)this.config.detail={tags:hook.tags};else this.config.detail.tags=hook.tags;return this}return this.guard({},hook)}let instance=new Elysia({...this.config,prefix:""});instance.singleton={...this.singleton},instance.definitions={...this.definitions},instance.inference=cloneInference(this.inference),instance.extender={...this.extender};let sandbox=run(instance);if(this.singleton=mergeDeep(this.singleton,instance.singleton),this.definitions=mergeDeep(this.definitions,instance.definitions),sandbox.getServer=()=>this.server,sandbox.event.request?.length)this.event.request=[...this.event.request||[],...sandbox.event.request||[]];if(sandbox.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...sandbox.event.mapResponse||[]];return this.model(sandbox.definitions.type),Object.values(instance.router.history).forEach(({method,path,handler,hooks:localHook})=>{this.add(method,path,handler,mergeHook(hook,{...localHook||{},error:!localHook.error?sandbox.event.error:Array.isArray(localHook.error)?[...localHook.error||{},...sandbox.event.error||[]]:[localHook.error,...sandbox.event.error||[]]}))}),this}use(plugin,options){if(Array.isArray(plugin)){let app=this;for(let p of plugin)app=app.use(p);return app}if(options?.scoped)return this.guard({},(app)=>app.use(plugin));if(Array.isArray(plugin)){let current=this;for(let p of plugin)current=this.use(p);return current}if(plugin instanceof Promise)return this.promisedModules.add(plugin.then((plugin2)=>{if(typeof plugin2==="function")return plugin2(this);if(plugin2 instanceof Elysia)return this._use(plugin2).compile();if(plugin2.constructor.name==="Elysia")return this._use(plugin2).compile();if(typeof plugin2.default==="function")return plugin2.default(this);if(plugin2.default instanceof Elysia)return this._use(plugin2.default);if(plugin2.constructor.name==="Elysia")return this._use(plugin2.default);if(plugin2.constructor.name==="_Elysia")return this._use(plugin2.default);try{return this._use(plugin2.default)}catch(error2){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),error2}}).then((v)=>{if(v&&typeof v.compile==="function")v.compile();return v})),this;return this._use(plugin)}propagatePromiseModules(plugin){if(plugin.promisedModules.size<=0)return this;for(let promise of plugin.promisedModules.promises)this.promisedModules.add(promise.then((v)=>{if(!v)return;let t2=this._use(v);if(t2 instanceof Promise)return t2.then((v2)=>{if(v2)v2.compile();else v.compile()});return v.compile()}));return this}_use(plugin){if(typeof plugin==="function"){let instance=plugin(this);if(instance instanceof Promise)return this.promisedModules.add(instance.then((plugin2)=>{if(plugin2 instanceof Elysia){plugin2.getServer=()=>this.getServer(),plugin2.getGlobalRoutes=()=>this.getGlobalRoutes(),plugin2.model(this.definitions.type),plugin2.error(this.definitions.error);for(let{method,path,handler,hooks}of Object.values(plugin2.router.history))this.add(method,path,handler,mergeHook(hooks,{error:plugin2.event.error}));if(plugin2.compile(),plugin2===this)return;return this.propagatePromiseModules(plugin2),plugin2}if(typeof plugin2==="function")return plugin2(this);if(typeof plugin2.default==="function")return plugin2.default(this);return this._use(plugin2)}).then((v)=>{if(v&&typeof v.compile==="function")v.compile();return v})),this;return instance}this.propagatePromiseModules(plugin);let{name,seed}=plugin.config;if(plugin.getParent=()=>this,plugin.getServer=()=>this.getServer(),plugin.getGlobalRoutes=()=>this.getGlobalRoutes(),plugin.model(this.definitions.type),plugin.error(this.definitions.error),this["~parser"]={...plugin["~parser"],...this["~parser"]},this.headers(plugin.setHeaders),name){if(!(name in this.dependencies))this.dependencies[name]=[];let current=seed!==void 0?checksum(name+JSON.stringify(seed)):0;if(!this.dependencies[name].some(({checksum:checksum2})=>current===checksum2))this.extender.macros=this.extender.macros.concat(plugin.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(plugin.extender.higherOrderFunctions)}else this.extender.macros=this.extender.macros.concat(plugin.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(plugin.extender.higherOrderFunctions);deduplicateChecksum(this.extender.macros),deduplicateChecksum(this.extender.higherOrderFunctions);let hofHashes=[];for(let i=0;i<this.extender.higherOrderFunctions.length;i++){let hof=this.extender.higherOrderFunctions[i];if(hof.checksum){if(hofHashes.includes(hof.checksum))this.extender.higherOrderFunctions.splice(i,1),i--;hofHashes.push(hof.checksum)}}this.inference={body:this.inference.body||plugin.inference.body,cookie:this.inference.cookie||plugin.inference.cookie,headers:this.inference.headers||plugin.inference.headers,query:this.inference.query||plugin.inference.query,set:this.inference.set||plugin.inference.set,server:this.inference.server||plugin.inference.server,request:this.inference.request||plugin.inference.request,route:this.inference.route||plugin.inference.route},this.decorate(plugin.singleton.decorator),this.state(plugin.singleton.store),this.model(plugin.definitions.type),this.error(plugin.definitions.error),plugin.extender.macros=this.extender.macros.concat(plugin.extender.macros);for(let{method,path,handler,hooks}of Object.values(plugin.router.history))this.add(method,path,handler,mergeHook(hooks,{error:plugin.event.error}));if(name){if(!(name in this.dependencies))this.dependencies[name]=[];let current=seed!==void 0?checksum(name+JSON.stringify(seed)):0;if(this.dependencies[name].some(({checksum:checksum2})=>current===checksum2))return this;this.dependencies[name].push(this.config?.analytic?{name:plugin.config.name,seed:plugin.config.seed,checksum:current,dependencies:plugin.dependencies,stack:plugin.telemetry.stack,routes:plugin.router.history,decorators:plugin.singleton,store:plugin.singleton.store,error:plugin.definitions.error,derive:plugin.event.transform?.filter((x)=>x?.subType==="derive").map((x)=>({fn:x.toString(),stack:new Error().stack??""})),resolve:plugin.event.transform?.filter((x)=>x?.subType==="resolve").map((x)=>({fn:x.toString(),stack:new Error().stack??""}))}:{name:plugin.config.name,seed:plugin.config.seed,checksum:current,dependencies:plugin.dependencies}),this.event=mergeLifeCycle(this.event,filterGlobalHook(plugin.event),current)}else this.event=mergeLifeCycle(this.event,filterGlobalHook(plugin.event));return this.validator.global=mergeHook(this.validator.global,{...plugin.validator.global}),this.validator.local=mergeHook(this.validator.local,{...plugin.validator.scoped}),this}macro(macro){if(typeof macro==="function"){let hook={checksum:checksum(JSON.stringify({name:this.config.name,seed:this.config.seed,content:macro.toString()})),fn:macro};this.extender.macros.push(hook)}else if(typeof macro==="object"){for(let name of Object.keys(macro))if(typeof macro[name]==="object"){let actualValue={...macro[name]};macro[name]=(v)=>{if(v===!0)return actualValue}}let hook={checksum:checksum(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Object.entries(macro).map(([k2,v])=>`${k2}+${v}`).join(",")})),fn:()=>macro};this.extender.macros.push(hook)}return this}mount(path,handle){if(path instanceof Elysia||typeof path==="function"||path.length===0||path==="/"){let run=typeof path==="function"?path:path instanceof Elysia?path.compile().fetch:handle instanceof Elysia?handle.compile().fetch:handle,handler2=({request,path:path2})=>run(new Request(replaceUrlPath(request.url,path2),{method:request.method,headers:request.headers,signal:request.signal,credentials:request.credentials,referrerPolicy:request.referrerPolicy,duplex:request.duplex,redirect:request.redirect,mode:request.mode,keepalive:request.keepalive,integrity:request.integrity,body:request.body}));return this.all("/*",handler2,{parse:"none"}),this}if(!handle)return this;let length=path.length-(path.endsWith("*")?1:0);if(handle instanceof Elysia)handle=handle.compile().fetch;let handler=({request,path:path2})=>handle(new Request(replaceUrlPath(request.url,path2.slice(length)||"/"),{method:request.method,headers:request.headers,signal:request.signal,credentials:request.credentials,referrerPolicy:request.referrerPolicy,duplex:request.duplex,redirect:request.redirect,mode:request.mode,keepalive:request.keepalive,integrity:request.integrity,body:request.body}));return this.all(path,handler,{parse:"none"}),this.all(path+(path.endsWith("/")?"*":"/*"),handler,{parse:"none"}),this}get(path,handler,hook){return this.add("GET",path,handler,hook),this}post(path,handler,hook){return this.add("POST",path,handler,hook),this}put(path,handler,hook){return this.add("PUT",path,handler,hook),this}patch(path,handler,hook){return this.add("PATCH",path,handler,hook),this}delete(path,handler,hook){return this.add("DELETE",path,handler,hook),this}options(path,handler,hook){return this.add("OPTIONS",path,handler,hook),this}all(path,handler,hook){return this.add("ALL",path,handler,hook),this}head(path,handler,hook){return this.add("HEAD",path,handler,hook),this}connect(path,handler,hook){return this.add("CONNECT",path,handler,hook),this}route(method,path,handler,hook){return this.add(method.toUpperCase(),path,handler,hook,hook?.config),this}ws(path,options){if(this["~adapter"].ws)this["~adapter"].ws(this,path,options);else console.warn("Current adapter doesn't support WebSocket");return this}state(options,name,value){if(name===void 0)value=options,options={as:"append"},name="";else if(value===void 0){if(typeof options==="string")value=name,name=options,options={as:"append"};else if(typeof options==="object")value=name,name=""}let{as}=options;if(typeof name!=="string")return this;switch(typeof value){case"object":if(name){if(name in this.singleton.store)this.singleton.store[name]=mergeDeep(this.singleton.store[name],value,{override:as==="override"});else this.singleton.store[name]=value;return this}if(value===null)return this;return this.singleton.store=mergeDeep(this.singleton.store,value,{override:as==="override"}),this;case"function":if(name){if(as==="override"||!(name in this.singleton.store))this.singleton.store[name]=value}else this.singleton.store=value(this.singleton.store);return this;default:if(as==="override"||!(name in this.singleton.store))this.singleton.store[name]=value;return this}}decorate(options,name,value){if(name===void 0)value=options,options={as:"append"},name="";else if(value===void 0){if(typeof options==="string")value=name,name=options,options={as:"append"};else if(typeof options==="object")value=name,name=""}let{as}=options;if(typeof name!=="string")return this;switch(typeof value){case"object":if(name){if(name in this.singleton.decorator)this.singleton.decorator[name]=mergeDeep(this.singleton.decorator[name],value,{override:as==="override"});else this.singleton.decorator[name]=value;return this}if(value===null)return this;return this.singleton.decorator=mergeDeep(this.singleton.decorator,value,{override:as==="override"}),this;case"function":if(name){if(as==="override"||!(name in this.singleton.decorator))this.singleton.decorator[name]=value}else this.singleton.decorator=value(this.singleton.decorator);return this;default:if(as==="override"||!(name in this.singleton.decorator))this.singleton.decorator[name]=value;return this}}derive(optionsOrTransform,transform2){if(!transform2)transform2=optionsOrTransform,optionsOrTransform={as:"local"};let hook={subType:"derive",fn:transform2};return this.onTransform(optionsOrTransform,hook)}model(name,model){let coerce=(schema)=>replaceSchemaType(schema,[{from:t.Number(),to:(options)=>t.Numeric(options),untilObjectFound:!0},{from:t.Boolean(),to:(options)=>t.BooleanString(options),untilObjectFound:!0}]);switch(typeof name){case"object":let parsedSchemas={},kvs=Object.entries(name);for(let[key,value]of kvs){if(key in this.definitions.type)continue;parsedSchemas[key]=this.definitions.type[key]=coerce(value),parsedSchemas[key].$id??=`#/components/schemas/${key}`}return this.definitions.typebox=t.Module({...this.definitions.typebox.$defs,...parsedSchemas}),this;case"function":let result=coerce(name(this.definitions.type));return this.definitions.type=result,this.definitions.typebox=t.Module(result),this;case"string":if(!model)break;let newModel={...model,id:model.$id??`#/components/schemas/${name}`};return this.definitions.type[name]=model,this.definitions.typebox=t.Module({...this.definitions.typebox.$defs,...newModel}),this}return this.definitions.type[name]=model,this.definitions.typebox=t.Module({...this.definitions.typebox.$defs,[name]:model}),this}mapDerive(optionsOrDerive,mapper){if(!mapper)mapper=optionsOrDerive,optionsOrDerive={as:"local"};let hook={subType:"mapDerive",fn:mapper};return this.onTransform(optionsOrDerive,hook)}affix(base,type2,word){if(word==="")return this;let delimieter=["_","-"," "],capitalize=(word2)=>word2[0].toUpperCase()+word2.slice(1),joinKey=base==="prefix"?(prefix,word2)=>delimieter.includes(prefix.at(-1)??"")?prefix+word2:prefix+capitalize(word2):delimieter.includes(word.at(-1)??"")?(suffix,word2)=>word2+suffix:(suffix,word2)=>word2+capitalize(suffix),remap=(type3)=>{let store={};switch(type3){case"decorator":for(let key in this.singleton.decorator)store[joinKey(word,key)]=this.singleton.decorator[key];this.singleton.decorator=store;break;case"state":for(let key in this.singleton.store)store[joinKey(word,key)]=this.singleton.store[key];this.singleton.store=store;break;case"model":for(let key in this.definitions.type)store[joinKey(word,key)]=this.definitions.type[key];this.definitions.type=store;break;case"error":for(let key in this.definitions.error)store[joinKey(word,key)]=this.definitions.error[key];this.definitions.error=store;break}},types=Array.isArray(type2)?type2:[type2];for(let type3 of types.some((x)=>x==="all")?["decorator","state","model","error"]:types)remap(type3);return this}prefix(type2,word){return this.affix("prefix",type2,word)}suffix(type2,word){return this.affix("suffix",type2,word)}compile(){if(this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?composeGeneralHandler(this):createDynamicHandler(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=composeGeneralHandler(this),this}handle=async(request)=>this.fetch(request);fetch=(request)=>{return(this.fetch=this.config.aot?composeGeneralHandler(this):createDynamicHandler(this))(request)};handleError=async(context,error2)=>{return(this.handleError=this.config.aot?composeErrorHandler(this):createDynamicErrorHandler(this))(context,error2)};outerErrorHandler=(error2)=>new Response(error2.message||error2.name||"Error",{status:error2?.status??500});listen=(options,callback)=>{return this["~adapter"].listen(this)(options,callback),this};stop=async(closeActiveConnections)=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(closeActiveConnections),this.server=null,this.event.stop?.length)for(let i=0;i<this.event.stop.length;i++)this.event.stop[i].fn(this)}};get modules(){return this.promisedModules}}var entityKind=Symbol.for("drizzle:entityKind"),hasOwnEntityKind=Symbol.for("drizzle:hasOwnEntityKind");function is(value,type2){if(!value||typeof value!=="object")return!1;if(value instanceof type2)return!0;if(!Object.prototype.hasOwnProperty.call(type2,entityKind))throw new Error(`Class "${type2.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let cls=Object.getPrototypeOf(value).constructor;if(cls)while(cls){if(entityKind in cls&&cls[entityKind]===type2[entityKind])return!0;cls=Object.getPrototypeOf(cls)}return!1}class Column{constructor(table,config){this.table=table,this.config=config,this.name=config.name,this.keyAsName=config.keyAsName,this.notNull=config.notNull,this.default=config.default,this.defaultFn=config.defaultFn,this.onUpdateFn=config.onUpdateFn,this.hasDefault=config.hasDefault,this.primary=config.primaryKey,this.isUnique=config.isUnique,this.uniqueName=config.uniqueName,this.uniqueType=config.uniqueType,this.dataType=config.dataType,this.columnType=config.columnType,this.generated=config.generated,this.generatedIdentity=config.generatedIdentity}static[entityKind]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(value){return value}mapToDriverValue(value){return value}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class ColumnBuilder{static[entityKind]="ColumnBuilder";config;constructor(name,dataType,columnType){this.config={name,keyAsName:name==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType,columnType,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(value){return this.config.default=value,this.config.hasDefault=!0,this}$defaultFn(fn){return this.config.defaultFn=fn,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(fn){return this.config.onUpdateFn=fn,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(name){if(this.config.name!=="")return;this.config.name=name}}var TableName=Symbol.for("drizzle:Name");class ForeignKeyBuilder{static[entityKind]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(config,actions){if(this.reference=()=>{let{name,columns,foreignColumns}=config();return{name,columns,foreignTable:foreignColumns[0].table,foreignColumns}},actions)this._onUpdate=actions.onUpdate,this._onDelete=actions.onDelete}onUpdate(action){return this._onUpdate=action===void 0?"no action":action,this}onDelete(action){return this._onDelete=action===void 0?"no action":action,this}build(table){return new ForeignKey(table,this)}}class ForeignKey{constructor(table,builder){this.table=table,this.reference=builder.reference,this.onUpdate=builder._onUpdate,this.onDelete=builder._onDelete}static[entityKind]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name,columns,foreignColumns}=this.reference(),columnNames=columns.map((column)=>column.name),foreignColumnNames=foreignColumns.map((column)=>column.name),chunks=[this.table[TableName],...columnNames,foreignColumns[0].table[TableName],...foreignColumnNames];return name??`${chunks.join("_")}_fk`}}function iife(fn,...args){return fn(...args)}function uniqueKeyName(table,columns){return`${table[TableName]}_${columns.join("_")}_unique`}function parsePgArrayValue(arrayString,startFrom,inQuotes){for(let i=startFrom;i<arrayString.length;i++){let char=arrayString[i];if(char==="\\"){i++;continue}if(char==='"')return[arrayString.slice(startFrom,i).replace(/\\/g,""),i+1];if(inQuotes)continue;if(char===","||char==="}")return[arrayString.slice(startFrom,i).replace(/\\/g,""),i]}return[arrayString.slice(startFrom).replace(/\\/g,""),arrayString.length]}function parsePgNestedArray(arrayString,startFrom=0){let result=[],i=startFrom,lastCharIsComma=!1;while(i<arrayString.length){let char=arrayString[i];if(char===","){if(lastCharIsComma||i===startFrom)result.push("");lastCharIsComma=!0,i++;continue}if(lastCharIsComma=!1,char==="\\"){i+=2;continue}if(char==='"'){let[value2,startFrom2]=parsePgArrayValue(arrayString,i+1,!0);result.push(value2),i=startFrom2;continue}if(char==="}")return[result,i+1];if(char==="{"){let[value2,startFrom2]=parsePgNestedArray(arrayString,i+1);result.push(value2),i=startFrom2;continue}let[value,newStartFrom]=parsePgArrayValue(arrayString,i,!1);result.push(value),i=newStartFrom}return[result,i]}function parsePgArray(arrayString){let[result]=parsePgNestedArray(arrayString,1);return result}function makePgArray(array){return`{${array.map((item)=>{if(Array.isArray(item))return makePgArray(item);if(typeof item==="string")return`"${item.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")}"`;return`${item}`}).join(",")}}`}class PgColumnBuilder extends ColumnBuilder{foreignKeyConfigs=[];static[entityKind]="PgColumnBuilder";array(size){return new PgArrayBuilder(this.config.name,this,size)}references(ref,actions={}){return this.foreignKeyConfigs.push({ref,actions}),this}unique(name,config){return this.config.isUnique=!0,this.config.uniqueName=name,this.config.uniqueType=config?.nulls,this}generatedAlwaysAs(as){return this.config.generated={as,type:"always",mode:"stored"},this}buildForeignKeys(column,table){return this.foreignKeyConfigs.map(({ref,actions})=>{return iife((ref2,actions2)=>{let builder=new ForeignKeyBuilder(()=>{let foreignColumn=ref2();return{columns:[column],foreignColumns:[foreignColumn]}});if(actions2.onUpdate)builder.onUpdate(actions2.onUpdate);if(actions2.onDelete)builder.onDelete(actions2.onDelete);return builder.build(table)},ref,actions)})}buildExtraConfigColumn(table){return new ExtraConfigColumn(table,this.config)}}class PgColumn extends Column{constructor(table,config){if(!config.uniqueName)config.uniqueName=uniqueKeyName(table,[config.name]);super(table,config);this.table=table}static[entityKind]="PgColumn"}class ExtraConfigColumn extends PgColumn{static[entityKind]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(opClass){return this.indexConfig.opClass=opClass,this}}class IndexedColumn{static[entityKind]="IndexedColumn";constructor(name,keyAsName,type2,indexConfig){this.name=name,this.keyAsName=keyAsName,this.type=type2,this.indexConfig=indexConfig}name;keyAsName;type;indexConfig}class PgArrayBuilder extends PgColumnBuilder{static[entityKind]="PgArrayBuilder";constructor(name,baseBuilder,size){super(name,"array","PgArray");this.config.baseBuilder=baseBuilder,this.config.size=size}build(table){let baseColumn=this.config.baseBuilder.build(table);return new PgArray(table,this.config,baseColumn)}}class PgArray extends PgColumn{constructor(table,config,baseColumn,range){super(table,config);this.baseColumn=baseColumn,this.range=range,this.size=config.size}size;static[entityKind]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size==="number"?this.size:""}]`}mapFromDriverValue(value){if(typeof value==="string")value=parsePgArray(value);return value.map((v)=>this.baseColumn.mapFromDriverValue(v))}mapToDriverValue(value,isNestedArray=!1){let a=value.map((v)=>v===null?null:is(this.baseColumn,PgArray)?this.baseColumn.mapToDriverValue(v,!0):this.baseColumn.mapToDriverValue(v));if(isNestedArray)return a;return makePgArray(a)}}class PgEnumObjectColumn extends PgColumn{static[entityKind]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(table,config){super(table,config);this.enum=config.enum}getSQLType(){return this.enum.enumName}}var isPgEnumSym=Symbol.for("drizzle:isPgEnum");function isPgEnum(obj){return!!obj&&typeof obj==="function"&&isPgEnumSym in obj&&obj[isPgEnumSym]===!0}class PgEnumColumn extends PgColumn{static[entityKind]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(table,config){super(table,config);this.enum=config.enum}getSQLType(){return this.enum.enumName}}class Subquery{static[entityKind]="Subquery";constructor(sql,selection,alias,isWith=!1){this._={brand:"Subquery",sql,selectedFields:selection,alias,isWith}}}class WithSubquery extends Subquery{static[entityKind]="WithSubquery"}var version="0.43.1";var otel,rawTracer,tracer={startActiveSpan(name,fn){if(!otel)return fn();if(!rawTracer)rawTracer=otel.trace.getTracer("drizzle-orm",version);return iife((otel2,rawTracer2)=>rawTracer2.startActiveSpan(name,(span)=>{try{return fn(span)}catch(e){throw span.setStatus({code:otel2.SpanStatusCode.ERROR,message:e instanceof Error?e.message:"Unknown error"}),e}finally{span.end()}}),otel,rawTracer)}};var ViewBaseConfig=Symbol.for("drizzle:ViewBaseConfig");var Schema=Symbol.for("drizzle:Schema"),Columns=Symbol.for("drizzle:Columns"),ExtraConfigColumns=Symbol.for("drizzle:ExtraConfigColumns"),OriginalName=Symbol.for("drizzle:OriginalName"),BaseName=Symbol.for("drizzle:BaseName"),IsAlias=Symbol.for("drizzle:IsAlias"),ExtraConfigBuilder=Symbol.for("drizzle:ExtraConfigBuilder"),IsDrizzleTable=Symbol.for("drizzle:IsDrizzleTable");class Table{static[entityKind]="Table";static Symbol={Name:TableName,Schema,OriginalName,Columns,ExtraConfigColumns,BaseName,IsAlias,ExtraConfigBuilder};[TableName];[OriginalName];[Schema];[Columns];[ExtraConfigColumns];[BaseName];[IsAlias]=!1;[IsDrizzleTable]=!0;[ExtraConfigBuilder]=void 0;constructor(name,schema,baseName){this[TableName]=this[OriginalName]=name,this[Schema]=schema,this[BaseName]=baseName}}function getTableName(table){return table[TableName]}function getTableUniqueName(table){return`${table[Schema]??"public"}.${table[TableName]}`}function isSQLWrapper(value){return value!==null&&value!==void 0&&typeof value.getSQL==="function"}function mergeQueries(queries){let result={sql:"",params:[]};for(let query of queries)if(result.sql+=query.sql,result.params.push(...query.params),query.typings?.length){if(!result.typings)result.typings=[];result.typings.push(...query.typings)}return result}class StringChunk{static[entityKind]="StringChunk";value;constructor(value){this.value=Array.isArray(value)?value:[value]}getSQL(){return new SQL([this])}}class SQL{constructor(queryChunks){this.queryChunks=queryChunks}static[entityKind]="SQL";decoder=noopDecoder;shouldInlineParams=!1;append(query){return this.queryChunks.push(...query.queryChunks),this}toQuery(config){return tracer.startActiveSpan("drizzle.buildSQL",(span)=>{let query=this.buildQueryFromSourceParams(this.queryChunks,config);return span?.setAttributes({"drizzle.query.text":query.sql,"drizzle.query.params":JSON.stringify(query.params)}),query})}buildQueryFromSourceParams(chunks,_config){let config=Object.assign({},_config,{inlineParams:_config.inlineParams||this.shouldInlineParams,paramStartIndex:_config.paramStartIndex||{value:0}}),{casing,escapeName,escapeParam,prepareTyping,inlineParams,paramStartIndex}=config;return mergeQueries(chunks.map((chunk)=>{if(is(chunk,StringChunk))return{sql:chunk.value.join(""),params:[]};if(is(chunk,Name))return{sql:escapeName(chunk.value),params:[]};if(chunk===void 0)return{sql:"",params:[]};if(Array.isArray(chunk)){let result=[new StringChunk("(")];for(let[i,p]of chunk.entries())if(result.push(p),i<chunk.length-1)result.push(new StringChunk(", "));return result.push(new StringChunk(")")),this.buildQueryFromSourceParams(result,config)}if(is(chunk,SQL))return this.buildQueryFromSourceParams(chunk.queryChunks,{...config,inlineParams:inlineParams||chunk.shouldInlineParams});if(is(chunk,Table)){let schemaName=chunk[Table.Symbol.Schema],tableName=chunk[Table.Symbol.Name];return{sql:schemaName===void 0||chunk[IsAlias]?escapeName(tableName):escapeName(schemaName)+"."+escapeName(tableName),params:[]}}if(is(chunk,Column)){let columnName=casing.getColumnCasing(chunk);if(_config.invokeSource==="indexes")return{sql:escapeName(columnName),params:[]};let schemaName=chunk.table[Table.Symbol.Schema];return{sql:chunk.table[IsAlias]||schemaName===void 0?escapeName(chunk.table[Table.Symbol.Name])+"."+escapeName(columnName):escapeName(schemaName)+"."+escapeName(chunk.table[Table.Symbol.Name])+"."+escapeName(columnName),params:[]}}if(is(chunk,View)){let schemaName=chunk[ViewBaseConfig].schema,viewName=chunk[ViewBaseConfig].name;return{sql:schemaName===void 0||chunk[ViewBaseConfig].isAlias?escapeName(viewName):escapeName(schemaName)+"."+escapeName(viewName),params:[]}}if(is(chunk,Param)){if(is(chunk.value,Placeholder))return{sql:escapeParam(paramStartIndex.value++,chunk),params:[chunk],typings:["none"]};let mappedValue=chunk.value===null?null:chunk.encoder.mapToDriverValue(chunk.value);if(is(mappedValue,SQL))return this.buildQueryFromSourceParams([mappedValue],config);if(inlineParams)return{sql:this.mapInlineParam(mappedValue,config),params:[]};let typings=["none"];if(prepareTyping)typings=[prepareTyping(chunk.encoder)];return{sql:escapeParam(paramStartIndex.value++,mappedValue),params:[mappedValue],typings}}if(is(chunk,Placeholder))return{sql:escapeParam(paramStartIndex.value++,chunk),params:[chunk],typings:["none"]};if(is(chunk,SQL.Aliased)&&chunk.fieldAlias!==void 0)return{sql:escapeName(chunk.fieldAlias),params:[]};if(is(chunk,Subquery)){if(chunk._.isWith)return{sql:escapeName(chunk._.alias),params:[]};return this.buildQueryFromSourceParams([new StringChunk("("),chunk._.sql,new StringChunk(") "),new Name(chunk._.alias)],config)}if(isPgEnum(chunk)){if(chunk.schema)return{sql:escapeName(chunk.schema)+"."+escapeName(chunk.enumName),params:[]};return{sql:escapeName(chunk.enumName),params:[]}}if(isSQLWrapper(chunk)){if(chunk.shouldOmitSQLParens?.())return this.buildQueryFromSourceParams([chunk.getSQL()],config);return this.buildQueryFromSourceParams([new StringChunk("("),chunk.getSQL(),new StringChunk(")")],config)}if(inlineParams)return{sql:this.mapInlineParam(chunk,config),params:[]};return{sql:escapeParam(paramStartIndex.value++,chunk),params:[chunk],typings:["none"]}}))}mapInlineParam(chunk,{escapeString}){if(chunk===null)return"null";if(typeof chunk==="number"||typeof chunk==="boolean")return chunk.toString();if(typeof chunk==="string")return escapeString(chunk);if(typeof chunk==="object"){let mappedValueAsString=chunk.toString();if(mappedValueAsString==="[object Object]")return escapeString(JSON.stringify(chunk));return escapeString(mappedValueAsString)}throw new Error("Unexpected param value: "+chunk)}getSQL(){return this}as(alias){if(alias===void 0)return this;return new SQL.Aliased(this,alias)}mapWith(decoder){return this.decoder=typeof decoder==="function"?{mapFromDriverValue:decoder}:decoder,this}inlineParams(){return this.shouldInlineParams=!0,this}if(condition){return condition?this:void 0}}class Name{constructor(value){this.value=value}static[entityKind]="Name";brand;getSQL(){return new SQL([this])}}function isDriverValueEncoder(value){return typeof value==="object"&&value!==null&&"mapToDriverValue"in value&&typeof value.mapToDriverValue==="function"}var noopDecoder={mapFromDriverValue:(value)=>value},noopEncoder={mapToDriverValue:(value)=>value},noopMapper={...noopDecoder,...noopEncoder};class Param{constructor(value,encoder2=noopEncoder){this.value=value,this.encoder=encoder2}static[entityKind]="Param";brand;getSQL(){return new SQL([this])}}function sql(strings,...params){let queryChunks=[];if(params.length>0||strings.length>0&&strings[0]!=="")queryChunks.push(new StringChunk(strings[0]));for(let[paramIndex,param2]of params.entries())queryChunks.push(param2,new StringChunk(strings[paramIndex+1]));return new SQL(queryChunks)}((sql2)=>{function empty(){return new SQL([])}sql2.empty=empty;function fromList(list){return new SQL(list)}sql2.fromList=fromList;function raw(str){return new SQL([new StringChunk(str)])}sql2.raw=raw;function join(chunks,separator){let result=[];for(let[i,chunk]of chunks.entries()){if(i>0&&separator!==void 0)result.push(separator);result.push(chunk)}return new SQL(result)}sql2.join=join;function identifier(value){return new Name(value)}sql2.identifier=identifier;function placeholder2(name2){return new Placeholder(name2)}sql2.placeholder=placeholder2;function param2(value,encoder2){return new Param(value,encoder2)}sql2.param=param2})(sql||(sql={}));((SQL2)=>{class Aliased{constructor(sql2,fieldAlias){this.sql=sql2,this.fieldAlias=fieldAlias}static[entityKind]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new Aliased(this.sql,this.fieldAlias)}}SQL2.Aliased=Aliased})(SQL||(SQL={}));class Placeholder{constructor(name2){this.name=name2}static[entityKind]="Placeholder";getSQL(){return new SQL([this])}}function fillPlaceholders(params,values){return params.map((p)=>{if(is(p,Placeholder)){if(!(p.name in values))throw new Error(`No value for placeholder "${p.name}" was provided`);return values[p.name]}if(is(p,Param)&&is(p.value,Placeholder)){if(!(p.value.name in values))throw new Error(`No value for placeholder "${p.value.name}" was provided`);return p.encoder.mapToDriverValue(values[p.value.name])}return p})}var IsDrizzleView=Symbol.for("drizzle:IsDrizzleView");class View{static[entityKind]="View";[ViewBaseConfig];[IsDrizzleView]=!0;constructor({name:name2,schema,selectedFields,query}){this[ViewBaseConfig]={name:name2,originalName:name2,schema,selectedFields,query,isExisting:!query,isAlias:!1}}getSQL(){return new SQL([this])}}Column.prototype.getSQL=function(){return new SQL([this])};Table.prototype.getSQL=function(){return new SQL([this])};Subquery.prototype.getSQL=function(){return new SQL([this])};class ColumnAliasProxyHandler{constructor(table){this.table=table}static[entityKind]="ColumnAliasProxyHandler";get(columnObj,prop){if(prop==="table")return this.table;return columnObj[prop]}}class TableAliasProxyHandler{constructor(alias,replaceOriginalName){this.alias=alias,this.replaceOriginalName=replaceOriginalName}static[entityKind]="TableAliasProxyHandler";get(target,prop){if(prop===Table.Symbol.IsAlias)return!0;if(prop===Table.Symbol.Name)return this.alias;if(this.replaceOriginalName&&prop===Table.Symbol.OriginalName)return this.alias;if(prop===ViewBaseConfig)return{...target[ViewBaseConfig],name:this.alias,isAlias:!0};if(prop===Table.Symbol.Columns){let columns=target[Table.Symbol.Columns];if(!columns)return columns;let proxiedColumns={};return Object.keys(columns).map((key)=>{proxiedColumns[key]=new Proxy(columns[key],new ColumnAliasProxyHandler(new Proxy(target,this)))}),proxiedColumns}let value=target[prop];if(is(value,Column))return new Proxy(value,new ColumnAliasProxyHandler(new Proxy(target,this)));return value}}function aliasedTable(table,tableAlias){return new Proxy(table,new TableAliasProxyHandler(tableAlias,!1))}function aliasedTableColumn(column,tableAlias){return new Proxy(column,new ColumnAliasProxyHandler(new Proxy(column.table,new TableAliasProxyHandler(tableAlias,!1))))}function mapColumnsInAliasedSQLToAlias(query,alias){return new SQL.Aliased(mapColumnsInSQLToAlias(query.sql,alias),query.fieldAlias)}function mapColumnsInSQLToAlias(query,alias){return sql.join(query.queryChunks.map((c)=>{if(is(c,Column))return aliasedTableColumn(c,alias);if(is(c,SQL))return mapColumnsInSQLToAlias(c,alias);if(is(c,SQL.Aliased))return mapColumnsInAliasedSQLToAlias(c,alias);return c}))}class DrizzleError extends Error{static[entityKind]="DrizzleError";constructor({message,cause}){super(message);this.name="DrizzleError",this.cause=cause}}class TransactionRollbackError extends DrizzleError{static[entityKind]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}class ConsoleLogWriter{static[entityKind]="ConsoleLogWriter";write(message){console.log(message)}}class DefaultLogger{static[entityKind]="DefaultLogger";writer;constructor(config){this.writer=config?.writer??new ConsoleLogWriter}logQuery(query,params){let stringifiedParams=params.map((p)=>{try{return JSON.stringify(p)}catch{return String(p)}}),paramsStr=stringifiedParams.length?` -- params: [${stringifiedParams.join(", ")}]`:"";this.writer.write(`Query: ${query}${paramsStr}`)}}class NoopLogger{static[entityKind]="NoopLogger";logQuery(){}}class QueryPromise{static[entityKind]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(onRejected){return this.then(void 0,onRejected)}finally(onFinally){return this.then((value)=>{return onFinally?.(),value},(reason)=>{throw onFinally?.(),reason})}then(onFulfilled,onRejected){return this.execute().then(onFulfilled,onRejected)}}function mapResultRow(columns,row,joinsNotNullableMap){let nullifyMap={},result=columns.reduce((result2,{path,field},columnIndex)=>{let decoder;if(is(field,Column))decoder=field;else if(is(field,SQL))decoder=field.decoder;else decoder=field.sql.decoder;let node=result2;for(let[pathChunkIndex,pathChunk]of path.entries())if(pathChunkIndex<path.length-1){if(!(pathChunk in node))node[pathChunk]={};node=node[pathChunk]}else{let rawValue=row[columnIndex],value=node[pathChunk]=rawValue===null?null:decoder.mapFromDriverValue(rawValue);if(joinsNotNullableMap&&is(field,Column)&&path.length===2){let objectName=path[0];if(!(objectName in nullifyMap))nullifyMap[objectName]=value===null?getTableName(field.table):!1;else if(typeof nullifyMap[objectName]==="string"&&nullifyMap[objectName]!==getTableName(field.table))nullifyMap[objectName]=!1}}return result2},{});if(joinsNotNullableMap&&Object.keys(nullifyMap).length>0){for(let[objectName,tableName]of Object.entries(nullifyMap))if(typeof tableName==="string"&&!joinsNotNullableMap[tableName])result[objectName]=null}return result}function orderSelectedFields(fields,pathPrefix){return Object.entries(fields).reduce((result,[name,field])=>{if(typeof name!=="string")return result;let newPath=pathPrefix?[...pathPrefix,name]:[name];if(is(field,Column)||is(field,SQL)||is(field,SQL.Aliased))result.push({path:newPath,field});else if(is(field,Table))result.push(...orderSelectedFields(field[Table.Symbol.Columns],newPath));else result.push(...orderSelectedFields(field,newPath));return result},[])}function haveSameKeys(left,right){let leftKeys=Object.keys(left),rightKeys=Object.keys(right);if(leftKeys.length!==rightKeys.length)return!1;for(let[index,key]of leftKeys.entries())if(key!==rightKeys[index])return!1;return!0}function mapUpdateSet(table,values){let entries=Object.entries(values).filter(([,value])=>value!==void 0).map(([key,value])=>{if(is(value,SQL)||is(value,Column))return[key,value];else return[key,new Param(value,table[Table.Symbol.Columns][key])]});if(entries.length===0)throw new Error("No values to set");return Object.fromEntries(entries)}function applyMixins(baseClass,extendedClasses){for(let extendedClass of extendedClasses)for(let name of Object.getOwnPropertyNames(extendedClass.prototype)){if(name==="constructor")continue;Object.defineProperty(baseClass.prototype,name,Object.getOwnPropertyDescriptor(extendedClass.prototype,name)||Object.create(null))}}function getTableColumns(table){return table[Table.Symbol.Columns]}function getTableLikeName(table){return is(table,Subquery)?table._.alias:is(table,View)?table[ViewBaseConfig].name:is(table,SQL)?void 0:table[Table.Symbol.IsAlias]?table[Table.Symbol.Name]:table[Table.Symbol.BaseName]}function getColumnNameAndConfig(a,b){return{name:typeof a==="string"&&a.length>0?a:"",config:typeof a==="object"?a:b}}function isConfig(data){if(typeof data!=="object"||data===null)return!1;if(data.constructor.name!=="Object")return!1;if("logger"in data){let type2=typeof data.logger;if(type2!=="boolean"&&(type2!=="object"||typeof data.logger.logQuery!=="function")&&type2!=="undefined")return!1;return!0}if("schema"in data){let type2=typeof data.schema;if(type2!=="object"&&type2!=="undefined")return!1;return!0}if("casing"in data){let type2=typeof data.casing;if(type2!=="string"&&type2!=="undefined")return!1;return!0}if("mode"in data){if(data.mode!=="default"||data.mode!=="planetscale"||data.mode!==void 0)return!1;return!0}if("connection"in data){let type2=typeof data.connection;if(type2!=="string"&&type2!=="object"&&type2!=="undefined")return!1;return!0}if("client"in data){let type2=typeof data.client;if(type2!=="object"&&type2!=="function"&&type2!=="undefined")return!1;return!0}if(Object.keys(data).length===0)return!0;return!1}class PgIntColumnBaseBuilder extends PgColumnBuilder{static[entityKind]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(sequence){if(sequence){let{name,...options}=sequence;this.config.generatedIdentity={type:"always",sequenceName:name,sequenceOptions:options}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(sequence){if(sequence){let{name,...options}=sequence;this.config.generatedIdentity={type:"byDefault",sequenceName:name,sequenceOptions:options}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class PgBigInt53Builder extends PgIntColumnBaseBuilder{static[entityKind]="PgBigInt53Builder";constructor(name){super(name,"number","PgBigInt53")}build(table){return new PgBigInt53(table,this.config)}}class PgBigInt53 extends PgColumn{static[entityKind]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(value){if(typeof value==="number")return value;return Number(value)}}class PgBigInt64Builder extends PgIntColumnBaseBuilder{static[entityKind]="PgBigInt64Builder";constructor(name){super(name,"bigint","PgBigInt64")}build(table){return new PgBigInt64(table,this.config)}}class PgBigInt64 extends PgColumn{static[entityKind]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(value){return BigInt(value)}}function bigint(a,b){let{name,config}=getColumnNameAndConfig(a,b);if(config.mode==="number")return new PgBigInt53Builder(name);return new PgBigInt64Builder(name)}class PgBigSerial53Builder extends PgColumnBuilder{static[entityKind]="PgBigSerial53Builder";constructor(name){super(name,"number","PgBigSerial53");this.config.hasDefault=!0,this.config.notNull=!0}build(table){return new PgBigSerial53(table,this.config)}}class PgBigSerial53 extends PgColumn{static[entityKind]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(value){if(typeof value==="number")return value;return Number(value)}}class PgBigSerial64Builder extends PgColumnBuilder{static[entityKind]="PgBigSerial64Builder";constructor(name){super(name,"bigint","PgBigSerial64");this.config.hasDefault=!0}build(table){return new PgBigSerial64(table,this.config)}}class PgBigSerial64 extends PgColumn{static[entityKind]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(value){return BigInt(value)}}function bigserial(a,b){let{name,config}=getColumnNameAndConfig(a,b);if(config.mode==="number")return new PgBigSerial53Builder(name);return new PgBigSerial64Builder(name)}class PgBooleanBuilder extends PgColumnBuilder{static[entityKind]="PgBooleanBuilder";constructor(name){super(name,"boolean","PgBoolean")}build(table){return new PgBoolean(table,this.config)}}class PgBoolean extends PgColumn{static[entityKind]="PgBoolean";getSQLType(){return"boolean"}}function boolean(name){return new PgBooleanBuilder(name??"")}class PgCharBuilder extends PgColumnBuilder{static[entityKind]="PgCharBuilder";constructor(name,config){super(name,"string","PgChar");this.config.length=config.length,this.config.enumValues=config.enum}build(table){return new PgChar(table,this.config)}}class PgChar extends PgColumn{static[entityKind]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function char(a,b={}){let{name,config}=getColumnNameAndConfig(a,b);return new PgCharBuilder(name,config)}class PgCidrBuilder extends PgColumnBuilder{static[entityKind]="PgCidrBuilder";constructor(name){super(name,"string","PgCidr")}build(table){return new PgCidr(table,this.config)}}class PgCidr extends PgColumn{static[entityKind]="PgCidr";getSQLType(){return"cidr"}}function cidr(name){return new PgCidrBuilder(name??"")}class PgCustomColumnBuilder extends PgColumnBuilder{static[entityKind]="PgCustomColumnBuilder";constructor(name,fieldConfig,customTypeParams){super(name,"custom","PgCustomColumn");this.config.fieldConfig=fieldConfig,this.config.customTypeParams=customTypeParams}build(table){return new PgCustomColumn(table,this.config)}}class PgCustomColumn extends PgColumn{static[entityKind]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(table,config){super(table,config);this.sqlName=config.customTypeParams.dataType(config.fieldConfig),this.mapTo=config.customTypeParams.toDriver,this.mapFrom=config.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(value){return typeof this.mapFrom==="function"?this.mapFrom(value):value}mapToDriverValue(value){return typeof this.mapTo==="function"?this.mapTo(value):value}}function customType(customTypeParams){return(a,b)=>{let{name,config}=getColumnNameAndConfig(a,b);return new PgCustomColumnBuilder(name,config,customTypeParams)}}class PgDateColumnBaseBuilder extends PgColumnBuilder{static[entityKind]="PgDateColumnBaseBuilder";defaultNow(){return this.default(sql`now()`)}}class PgDateBuilder extends PgDateColumnBaseBuilder{static[entityKind]="PgDateBuilder";constructor(name){super(name,"date","PgDate")}build(table){return new PgDate(table,this.config)}}class PgDate extends PgColumn{static[entityKind]="PgDate";getSQLType(){return"date"}mapFromDriverValue(value){return new Date(value)}mapToDriverValue(value){return value.toISOString()}}class PgDateStringBuilder extends PgDateColumnBaseBuilder{static[entityKind]="PgDateStringBuilder";constructor(name){super(name,"string","PgDateString")}build(table){return new PgDateString(table,this.config)}}class PgDateString extends PgColumn{static[entityKind]="PgDateString";getSQLType(){return"date"}}function date2(a,b){let{name,config}=getColumnNameAndConfig(a,b);if(config?.mode==="date")return new PgDateBuilder(name);return new PgDateStringBuilder(name)}class PgDoublePrecisionBuilder extends PgColumnBuilder{static[entityKind]="PgDoublePrecisionBuilder";constructor(name){super(name,"number","PgDoublePrecision")}build(table){return new PgDoublePrecision(table,this.config)}}class PgDoublePrecision extends PgColumn{static[entityKind]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(value){if(typeof value==="string")return Number.parseFloat(value);return value}}function doublePrecision(name){return new PgDoublePrecisionBuilder(name??"")}class PgInetBuilder extends PgColumnBuilder{static[entityKind]="PgInetBuilder";constructor(name){super(name,"string","PgInet")}build(table){return new PgInet(table,this.config)}}class PgInet extends PgColumn{static[entityKind]="PgInet";getSQLType(){return"inet"}}function inet(name){return new PgInetBuilder(name??"")}class PgIntegerBuilder extends PgIntColumnBaseBuilder{static[entityKind]="PgIntegerBuilder";constructor(name){super(name,"number","PgInteger")}build(table){return new PgInteger(table,this.config)}}class PgInteger extends PgColumn{static[entityKind]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(value){if(typeof value==="string")return Number.parseInt(value);return value}}function integer(name){return new PgIntegerBuilder(name??"")}class PgIntervalBuilder extends PgColumnBuilder{static[entityKind]="PgIntervalBuilder";constructor(name,intervalConfig){super(name,"string","PgInterval");this.config.intervalConfig=intervalConfig}build(table){return new PgInterval(table,this.config)}}class PgInterval extends PgColumn{static[entityKind]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let fields=this.fields?` ${this.fields}`:"",precision=this.precision?`(${this.precision})`:"";return`interval${fields}${precision}`}}function interval(a,b={}){let{name,config}=getColumnNameAndConfig(a,b);return new PgIntervalBuilder(name,config)}class PgJsonBuilder extends PgColumnBuilder{static[entityKind]="PgJsonBuilder";constructor(name){super(name,"json","PgJson")}build(table){return new PgJson(table,this.config)}}class PgJson extends PgColumn{static[entityKind]="PgJson";constructor(table,config){super(table,config)}getSQLType(){return"json"}mapToDriverValue(value){return JSON.stringify(value)}mapFromDriverValue(value){if(typeof value==="string")try{return JSON.parse(value)}catch{return value}return value}}function json(name){return new PgJsonBuilder(name??"")}class PgJsonbBuilder extends PgColumnBuilder{static[entityKind]="PgJsonbBuilder";constructor(name){super(name,"json","PgJsonb")}build(table){return new PgJsonb(table,this.config)}}class PgJsonb extends PgColumn{static[entityKind]="PgJsonb";constructor(table,config){super(table,config)}getSQLType(){return"jsonb"}mapToDriverValue(value){return JSON.stringify(value)}mapFromDriverValue(value){if(typeof value==="string")try{return JSON.parse(value)}catch{return value}return value}}function jsonb(name){return new PgJsonbBuilder(name??"")}class PgLineBuilder extends PgColumnBuilder{static[entityKind]="PgLineBuilder";constructor(name){super(name,"array","PgLine")}build(table){return new PgLineTuple(table,this.config)}}class PgLineTuple extends PgColumn{static[entityKind]="PgLine";getSQLType(){return"line"}mapFromDriverValue(value){let[a,b,c]=value.slice(1,-1).split(",");return[Number.parseFloat(a),Number.parseFloat(b),Number.parseFloat(c)]}mapToDriverValue(value){return`{${value[0]},${value[1]},${value[2]}}`}}class PgLineABCBuilder extends PgColumnBuilder{static[entityKind]="PgLineABCBuilder";constructor(name){super(name,"json","PgLineABC")}build(table){return new PgLineABC(table,this.config)}}class PgLineABC extends PgColumn{static[entityKind]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(value){let[a,b,c]=value.slice(1,-1).split(",");return{a:Number.parseFloat(a),b:Number.parseFloat(b),c:Number.parseFloat(c)}}mapToDriverValue(value){return`{${value.a},${value.b},${value.c}}`}}function line(a,b){let{name,config}=getColumnNameAndConfig(a,b);if(!config?.mode||config.mode==="tuple")return new PgLineBuilder(name);return new PgLineABCBuilder(name)}class PgMacaddrBuilder extends PgColumnBuilder{static[entityKind]="PgMacaddrBuilder";constructor(name){super(name,"string","PgMacaddr")}build(table){return new PgMacaddr(table,this.config)}}class PgMacaddr extends PgColumn{static[entityKind]="PgMacaddr";getSQLType(){return"macaddr"}}function macaddr(name){return new PgMacaddrBuilder(name??"")}class PgMacaddr8Builder extends PgColumnBuilder{static[entityKind]="PgMacaddr8Builder";constructor(name){super(name,"string","PgMacaddr8")}build(table){return new PgMacaddr8(table,this.config)}}class PgMacaddr8 extends PgColumn{static[entityKind]="PgMacaddr8";getSQLType(){return"macaddr8"}}function macaddr8(name){return new PgMacaddr8Builder(name??"")}class PgNumericBuilder extends PgColumnBuilder{static[entityKind]="PgNumericBuilder";constructor(name,precision,scale){super(name,"string","PgNumeric");this.config.precision=precision,this.config.scale=scale}build(table){return new PgNumeric(table,this.config)}}class PgNumeric extends PgColumn{static[entityKind]="PgNumeric";precision;scale;constructor(table,config){super(table,config);this.precision=config.precision,this.scale=config.scale}mapFromDriverValue(value){if(typeof value==="string")return value;return String(value)}getSQLType(){if(this.precision!==void 0&&this.scale!==void 0)return`numeric(${this.precision}, ${this.scale})`;else if(this.precision===void 0)return"numeric";else return`numeric(${this.precision})`}}class PgNumericNumberBuilder extends PgColumnBuilder{static[entityKind]="PgNumericNumberBuilder";constructor(name,precision,scale){super(name,"number","PgNumericNumber");this.config.precision=precision,this.config.scale=scale}build(table){return new PgNumericNumber(table,this.config)}}class PgNumericNumber extends PgColumn{static[entityKind]="PgNumericNumber";precision;scale;constructor(table,config){super(table,config);this.precision=config.precision,this.scale=config.scale}mapFromDriverValue(value){if(typeof value==="number")return value;return Number(value)}mapToDriverValue=String;getSQLType(){if(this.precision!==void 0&&this.scale!==void 0)return`numeric(${this.precision}, ${this.scale})`;else if(this.precision===void 0)return"numeric";else return`numeric(${this.precision})`}}class PgNumericBigIntBuilder extends PgColumnBuilder{static[entityKind]="PgNumericBigIntBuilder";constructor(name,precision,scale){super(name,"bigint","PgNumericBigInt");this.config.precision=precision,this.config.scale=scale}build(table){return new PgNumericBigInt(table,this.config)}}class PgNumericBigInt extends PgColumn{static[entityKind]="PgNumericBigInt";precision;scale;constructor(table,config){super(table,config);this.precision=config.precision,this.scale=config.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){if(this.precision!==void 0&&this.scale!==void 0)return`numeric(${this.precision}, ${this.scale})`;else if(this.precision===void 0)return"numeric";else return`numeric(${this.precision})`}}function numeric(a,b){let{name,config}=getColumnNameAndConfig(a,b),mode=config?.mode;return mode==="number"?new PgNumericNumberBuilder(name,config?.precision,config?.scale):mode==="bigint"?new PgNumericBigIntBuilder(name,config?.precision,config?.scale):new PgNumericBuilder(name,config?.precision,config?.scale)}var decimal=numeric;class PgPointTupleBuilder extends PgColumnBuilder{static[entityKind]="PgPointTupleBuilder";constructor(name){super(name,"array","PgPointTuple")}build(table){return new PgPointTuple(table,this.config)}}class PgPointTuple extends PgColumn{static[entityKind]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(value){if(typeof value==="string"){let[x,y]=value.slice(1,-1).split(",");return[Number.parseFloat(x),Number.parseFloat(y)]}return[value.x,value.y]}mapToDriverValue(value){return`(${value[0]},${value[1]})`}}class PgPointObjectBuilder extends PgColumnBuilder{static[entityKind]="PgPointObjectBuilder";constructor(name){super(name,"json","PgPointObject")}build(table){return new PgPointObject(table,this.config)}}class PgPointObject extends PgColumn{static[entityKind]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(value){if(typeof value==="string"){let[x,y]=value.slice(1,-1).split(",");return{x:Number.parseFloat(x),y:Number.parseFloat(y)}}return value}mapToDriverValue(value){return`(${value.x},${value.y})`}}function point(a,b){let{name,config}=getColumnNameAndConfig(a,b);if(!config?.mode||config.mode==="tuple")return new PgPointTupleBuilder(name);return new PgPointObjectBuilder(name)}function hexToBytes(hex2){let bytes=[];for(let c=0;c<hex2.length;c+=2)bytes.push(Number.parseInt(hex2.slice(c,c+2),16));return new Uint8Array(bytes)}function bytesToFloat64(bytes,offset){let buffer=new ArrayBuffer(8),view=new DataView(buffer);for(let i=0;i<8;i++)view.setUint8(i,bytes[offset+i]);return view.getFloat64(0,!0)}function parseEWKB(hex2){let bytes=hexToBytes(hex2),offset=0,byteOrder=bytes[offset];offset+=1;let view=new DataView(bytes.buffer),geomType=view.getUint32(offset,byteOrder===1);offset+=4;let _srid;if(geomType&536870912)_srid=view.getUint32(offset,byteOrder===1),offset+=4;if((geomType&65535)===1){let x=bytesToFloat64(bytes,offset);offset+=8;let y=bytesToFloat64(bytes,offset);return offset+=8,[x,y]}throw new Error("Unsupported geometry type")}class PgGeometryBuilder extends PgColumnBuilder{static[entityKind]="PgGeometryBuilder";constructor(name){super(name,"array","PgGeometry")}build(table){return new PgGeometry(table,this.config)}}class PgGeometry extends PgColumn{static[entityKind]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(value){return parseEWKB(value)}mapToDriverValue(value){return`point(${value[0]} ${value[1]})`}}class PgGeometryObjectBuilder extends PgColumnBuilder{static[entityKind]="PgGeometryObjectBuilder";constructor(name){super(name,"json","PgGeometryObject")}build(table){return new PgGeometryObject(table,this.config)}}class PgGeometryObject extends PgColumn{static[entityKind]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(value){let parsed=parseEWKB(value);return{x:parsed[0],y:parsed[1]}}mapToDriverValue(value){return`point(${value.x} ${value.y})`}}function geometry(a,b){let{name,config}=getColumnNameAndConfig(a,b);if(!config?.mode||config.mode==="tuple")return new PgGeometryBuilder(name);return new PgGeometryObjectBuilder(name)}class PgRealBuilder extends PgColumnBuilder{static[entityKind]="PgRealBuilder";constructor(name,length){super(name,"number","PgReal");this.config.length=length}build(table){return new PgReal(table,this.config)}}class PgReal extends PgColumn{static[entityKind]="PgReal";constructor(table,config){super(table,config)}getSQLType(){return"real"}mapFromDriverValue=(value)=>{if(typeof value==="string")return Number.parseFloat(value);return value}}function real(name){return new PgRealBuilder(name??"")}class PgSerialBuilder extends PgColumnBuilder{static[entityKind]="PgSerialBuilder";constructor(name){super(name,"number","PgSerial");this.config.hasDefault=!0,this.config.notNull=!0}build(table){return new PgSerial(table,this.config)}}class PgSerial extends PgColumn{static[entityKind]="PgSerial";getSQLType(){return"serial"}}function serial(name){return new PgSerialBuilder(name??"")}class PgSmallIntBuilder extends PgIntColumnBaseBuilder{static[entityKind]="PgSmallIntBuilder";constructor(name){super(name,"number","PgSmallInt")}build(table){return new PgSmallInt(table,this.config)}}class PgSmallInt extends PgColumn{static[entityKind]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=(value)=>{if(typeof value==="string")return Number(value);return value}}function smallint(name){return new PgSmallIntBuilder(name??"")}class PgSmallSerialBuilder extends PgColumnBuilder{static[entityKind]="PgSmallSerialBuilder";constructor(name){super(name,"number","PgSmallSerial");this.config.hasDefault=!0,this.config.notNull=!0}build(table){return new PgSmallSerial(table,this.config)}}class PgSmallSerial extends PgColumn{static[entityKind]="PgSmallSerial";getSQLType(){return"smallserial"}}function smallserial(name){return new PgSmallSerialBuilder(name??"")}class PgTextBuilder extends PgColumnBuilder{static[entityKind]="PgTextBuilder";constructor(name,config){super(name,"string","PgText");this.config.enumValues=config.enum}build(table){return new PgText(table,this.config)}}class PgText extends PgColumn{static[entityKind]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function text(a,b={}){let{name,config}=getColumnNameAndConfig(a,b);return new PgTextBuilder(name,config)}class PgTimeBuilder extends PgDateColumnBaseBuilder{constructor(name,withTimezone,precision){super(name,"string","PgTime");this.withTimezone=withTimezone,this.precision=precision,this.config.withTimezone=withTimezone,this.config.precision=precision}static[entityKind]="PgTimeBuilder";build(table){return new PgTime(table,this.config)}}class PgTime extends PgColumn{static[entityKind]="PgTime";withTimezone;precision;constructor(table,config){super(table,config);this.withTimezone=config.withTimezone,this.precision=config.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function time(a,b={}){let{name,config}=getColumnNameAndConfig(a,b);return new PgTimeBuilder(name,config.withTimezone??!1,config.precision)}class PgTimestampBuilder extends PgDateColumnBaseBuilder{static[entityKind]="PgTimestampBuilder";constructor(name,withTimezone,precision){super(name,"date","PgTimestamp");this.config.withTimezone=withTimezone,this.config.precision=precision}build(table){return new PgTimestamp(table,this.config)}}class PgTimestamp extends PgColumn{static[entityKind]="PgTimestamp";withTimezone;precision;constructor(table,config){super(table,config);this.withTimezone=config.withTimezone,this.precision=config.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=(value)=>{return new Date(this.withTimezone?value:value+"+0000")};mapToDriverValue=(value)=>{return value.toISOString()}}class PgTimestampStringBuilder extends PgDateColumnBaseBuilder{static[entityKind]="PgTimestampStringBuilder";constructor(name,withTimezone,precision){super(name,"string","PgTimestampString");this.config.withTimezone=withTimezone,this.config.precision=precision}build(table){return new PgTimestampString(table,this.config)}}class PgTimestampString extends PgColumn{static[entityKind]="PgTimestampString";withTimezone;precision;constructor(table,config){super(table,config);this.withTimezone=config.withTimezone,this.precision=config.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function timestamp(a,b={}){let{name,config}=getColumnNameAndConfig(a,b);if(config?.mode==="string")return new PgTimestampStringBuilder(name,config.withTimezone??!1,config.precision);return new PgTimestampBuilder(name,config?.withTimezone??!1,config?.precision)}class PgUUIDBuilder extends PgColumnBuilder{static[entityKind]="PgUUIDBuilder";constructor(name){super(name,"string","PgUUID")}defaultRandom(){return this.default(sql`gen_random_uuid()`)}build(table){return new PgUUID(table,this.config)}}class PgUUID extends PgColumn{static[entityKind]="PgUUID";getSQLType(){return"uuid"}}function uuid(name){return new PgUUIDBuilder(name??"")}class PgVarcharBuilder extends PgColumnBuilder{static[entityKind]="PgVarcharBuilder";constructor(name,config){super(name,"string","PgVarchar");this.config.length=config.length,this.config.enumValues=config.enum}build(table){return new PgVarchar(table,this.config)}}class PgVarchar extends PgColumn{static[entityKind]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function varchar(a,b={}){let{name,config}=getColumnNameAndConfig(a,b);return new PgVarcharBuilder(name,config)}class PgBinaryVectorBuilder extends PgColumnBuilder{static[entityKind]="PgBinaryVectorBuilder";constructor(name,config){super(name,"string","PgBinaryVector");this.config.dimensions=config.dimensions}build(table){return new PgBinaryVector(table,this.config)}}class PgBinaryVector extends PgColumn{static[entityKind]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function bit(a,b){let{name,config}=getColumnNameAndConfig(a,b);return new PgBinaryVectorBuilder(name,config)}class PgHalfVectorBuilder extends PgColumnBuilder{static[entityKind]="PgHalfVectorBuilder";constructor(name,config){super(name,"array","PgHalfVector");this.config.dimensions=config.dimensions}build(table){return new PgHalfVector(table,this.config)}}class PgHalfVector extends PgColumn{static[entityKind]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(value){return JSON.stringify(value)}mapFromDriverValue(value){return value.slice(1,-1).split(",").map((v)=>Number.parseFloat(v))}}function halfvec(a,b){let{name,config}=getColumnNameAndConfig(a,b);return new PgHalfVectorBuilder(name,config)}class PgSparseVectorBuilder extends PgColumnBuilder{static[entityKind]="PgSparseVectorBuilder";constructor(name,config){super(name,"string","PgSparseVector");this.config.dimensions=config.dimensions}build(table){return new PgSparseVector(table,this.config)}}class PgSparseVector extends PgColumn{static[entityKind]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function sparsevec(a,b){let{name,config}=getColumnNameAndConfig(a,b);return new PgSparseVectorBuilder(name,config)}class PgVectorBuilder extends PgColumnBuilder{static[entityKind]="PgVectorBuilder";constructor(name,config){super(name,"array","PgVector");this.config.dimensions=config.dimensions}build(table){return new PgVector(table,this.config)}}class PgVector extends PgColumn{static[entityKind]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(value){return JSON.stringify(value)}mapFromDriverValue(value){return value.slice(1,-1).split(",").map((v)=>Number.parseFloat(v))}}function vector(a,b){let{name,config}=getColumnNameAndConfig(a,b);return new PgVectorBuilder(name,config)}function getPgColumnBuilders(){return{bigint,bigserial,boolean,char,cidr,customType,date:date2,doublePrecision,inet,integer,interval,json,jsonb,line,macaddr,macaddr8,numeric,point,geometry,real,serial,smallint,smallserial,text,time,timestamp,uuid,varchar,bit,halfvec,sparsevec,vector}}var InlineForeignKeys=Symbol.for("drizzle:PgInlineForeignKeys"),EnableRLS=Symbol.for("drizzle:EnableRLS");class PgTable extends Table{static[entityKind]="PgTable";static Symbol=Object.assign({},Table.Symbol,{InlineForeignKeys,EnableRLS});[InlineForeignKeys]=[];[EnableRLS]=!1;[Table.Symbol.ExtraConfigBuilder]=void 0;[Table.Symbol.ExtraConfigColumns]={}}function pgTableWithSchema(name,columns,extraConfig,schema,baseName=name){let rawTable=new PgTable(name,schema,baseName),parsedColumns=typeof columns==="function"?columns(getPgColumnBuilders()):columns,builtColumns=Object.fromEntries(Object.entries(parsedColumns).map(([name2,colBuilderBase])=>{let colBuilder=colBuilderBase;colBuilder.setName(name2);let column=colBuilder.build(rawTable);return rawTable[InlineForeignKeys].push(...colBuilder.buildForeignKeys(column,rawTable)),[name2,column]})),builtColumnsForExtraConfig=Object.fromEntries(Object.entries(parsedColumns).map(([name2,colBuilderBase])=>{let colBuilder=colBuilderBase;colBuilder.setName(name2);let column=colBuilder.buildExtraConfigColumn(rawTable);return[name2,column]})),table=Object.assign(rawTable,builtColumns);if(table[Table.Symbol.Columns]=builtColumns,table[Table.Symbol.ExtraConfigColumns]=builtColumnsForExtraConfig,extraConfig)table[PgTable.Symbol.ExtraConfigBuilder]=extraConfig;return Object.assign(table,{enableRLS:()=>{return table[PgTable.Symbol.EnableRLS]=!0,table}})}var pgTable=(name,columns,extraConfig)=>{return pgTableWithSchema(name,columns,extraConfig,void 0)};class PrimaryKeyBuilder{static[entityKind]="PgPrimaryKeyBuilder";columns;name;constructor(columns,name){this.columns=columns,this.name=name}build(table){return new PrimaryKey(table,this.columns,this.name)}}class PrimaryKey{constructor(table,columns,name){this.table=table,this.columns=columns,this.name=name}static[entityKind]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[PgTable.Symbol.Name]}_${this.columns.map((column)=>column.name).join("_")}_pk`}}function bindIfParam(value,column){if(isDriverValueEncoder(column)&&!isSQLWrapper(value)&&!is(value,Param)&&!is(value,Placeholder)&&!is(value,Column)&&!is(value,Table)&&!is(value,View))return new Param(value,column);return value}var eq=(left,right)=>{return sql`${left} = ${bindIfParam(right,left)}`},ne=(left,right)=>{return sql`${left} <> ${bindIfParam(right,left)}`};function and(...unfilteredConditions){let conditions=unfilteredConditions.filter((c)=>c!==void 0);if(conditions.length===0)return;if(conditions.length===1)return new SQL(conditions);return new SQL([new StringChunk("("),sql.join(conditions,new StringChunk(" and ")),new StringChunk(")")])}function or(...unfilteredConditions){let conditions=unfilteredConditions.filter((c)=>c!==void 0);if(conditions.length===0)return;if(conditions.length===1)return new SQL(conditions);return new SQL([new StringChunk("("),sql.join(conditions,new StringChunk(" or ")),new StringChunk(")")])}function not(condition){return sql`not ${condition}`}var gt=(left,right)=>{return sql`${left} > ${bindIfParam(right,left)}`},gte=(left,right)=>{return sql`${left} >= ${bindIfParam(right,left)}`},lt=(left,right)=>{return sql`${left} < ${bindIfParam(right,left)}`},lte=(left,right)=>{return sql`${left} <= ${bindIfParam(right,left)}`};function inArray(column,values){if(Array.isArray(values)){if(values.length===0)return sql`false`;return sql`${column} in ${values.map((v)=>bindIfParam(v,column))}`}return sql`${column} in ${bindIfParam(values,column)}`}function notInArray(column,values){if(Array.isArray(values)){if(values.length===0)return sql`true`;return sql`${column} not in ${values.map((v)=>bindIfParam(v,column))}`}return sql`${column} not in ${bindIfParam(values,column)}`}function isNull(value){return sql`${value} is null`}function isNotNull(value){return sql`${value} is not null`}function exists(subquery){return sql`exists ${subquery}`}function notExists(subquery){return sql`not exists ${subquery}`}function between(column,min,max){return sql`${column} between ${bindIfParam(min,column)} and ${bindIfParam(max,column)}`}function notBetween(column,min,max){return sql`${column} not between ${bindIfParam(min,column)} and ${bindIfParam(max,column)}`}function like(column,value){return sql`${column} like ${value}`}function notLike(column,value){return sql`${column} not like ${value}`}function ilike(column,value){return sql`${column} ilike ${value}`}function notIlike(column,value){return sql`${column} not ilike ${value}`}function asc(column){return sql`${column} asc`}function desc(column){return sql`${column} desc`}class Relation{constructor(sourceTable,referencedTable,relationName){this.sourceTable=sourceTable,this.referencedTable=referencedTable,this.relationName=relationName,this.referencedTableName=referencedTable[Table.Symbol.Name]}static[entityKind]="Relation";referencedTableName;fieldName}class Relations{constructor(table,config){this.table=table,this.config=config}static[entityKind]="Relations"}class One extends Relation{constructor(sourceTable,referencedTable,config,isNullable){super(sourceTable,referencedTable,config?.relationName);this.config=config,this.isNullable=isNullable}static[entityKind]="One";withFieldName(fieldName){let relation=new One(this.sourceTable,this.referencedTable,this.config,this.isNullable);return relation.fieldName=fieldName,relation}}class Many extends Relation{constructor(sourceTable,referencedTable,config){super(sourceTable,referencedTable,config?.relationName);this.config=config}static[entityKind]="Many";withFieldName(fieldName){let relation=new Many(this.sourceTable,this.referencedTable,this.config);return relation.fieldName=fieldName,relation}}function getOperators(){return{and,between,eq,exists,gt,gte,ilike,inArray,isNull,isNotNull,like,lt,lte,ne,not,notBetween,notExists,notLike,notIlike,notInArray,or,sql}}function getOrderByOperators(){return{sql,asc,desc}}function extractTablesRelationalConfig(schema,configHelpers){if(Object.keys(schema).length===1&&"default"in schema&&!is(schema.default,Table))schema=schema.default;let tableNamesMap={},relationsBuffer={},tablesConfig={};for(let[key,value]of Object.entries(schema))if(is(value,Table)){let dbName=getTableUniqueName(value),bufferedRelations=relationsBuffer[dbName];tableNamesMap[dbName]=key,tablesConfig[key]={tsName:key,dbName:value[Table.Symbol.Name],schema:value[Table.Symbol.Schema],columns:value[Table.Symbol.Columns],relations:bufferedRelations?.relations??{},primaryKey:bufferedRelations?.primaryKey??[]};for(let column of Object.values(value[Table.Symbol.Columns]))if(column.primary)tablesConfig[key].primaryKey.push(column);let extraConfig=value[Table.Symbol.ExtraConfigBuilder]?.(value[Table.Symbol.ExtraConfigColumns]);if(extraConfig){for(let configEntry of Object.values(extraConfig))if(is(configEntry,PrimaryKeyBuilder))tablesConfig[key].primaryKey.push(...configEntry.columns)}}else if(is(value,Relations)){let dbName=getTableUniqueName(value.table),tableName=tableNamesMap[dbName],relations2=value.config(configHelpers(value.table)),primaryKey;for(let[relationName,relation]of Object.entries(relations2))if(tableName){let tableConfig=tablesConfig[tableName];if(tableConfig.relations[relationName]=relation,primaryKey)tableConfig.primaryKey.push(...primaryKey)}else{if(!(dbName in relationsBuffer))relationsBuffer[dbName]={relations:{},primaryKey};relationsBuffer[dbName].relations[relationName]=relation}}return{tables:tablesConfig,tableNamesMap}}function createOne(sourceTable){return function one(table,config){return new One(sourceTable,table,config,config?.fields.reduce((res,f)=>res&&f.notNull,!0)??!1)}}function createMany(sourceTable){return function many(referencedTable,config){return new Many(sourceTable,referencedTable,config)}}function normalizeRelation(schema,tableNamesMap,relation){if(is(relation,One)&&relation.config)return{fields:relation.config.fields,references:relation.config.references};let referencedTableTsName=tableNamesMap[getTableUniqueName(relation.referencedTable)];if(!referencedTableTsName)throw new Error(`Table "${relation.referencedTable[Table.Symbol.Name]}" not found in schema`);let referencedTableConfig=schema[referencedTableTsName];if(!referencedTableConfig)throw new Error(`Table "${referencedTableTsName}" not found in schema`);let sourceTable=relation.sourceTable,sourceTableTsName=tableNamesMap[getTableUniqueName(sourceTable)];if(!sourceTableTsName)throw new Error(`Table "${sourceTable[Table.Symbol.Name]}" not found in schema`);let reverseRelations=[];for(let referencedTableRelation of Object.values(referencedTableConfig.relations))if(relation.relationName&&relation!==referencedTableRelation&&referencedTableRelation.relationName===relation.relationName||!relation.relationName&&referencedTableRelation.referencedTable===relation.sourceTable)reverseRelations.push(referencedTableRelation);if(reverseRelations.length>1)throw relation.relationName?new Error(`There are multiple relations with name "${relation.relationName}" in table "${referencedTableTsName}"`):new Error(`There are multiple relations between "${referencedTableTsName}" and "${relation.sourceTable[Table.Symbol.Name]}". Please specify relation name`);if(reverseRelations[0]&&is(reverseRelations[0],One)&&reverseRelations[0].config)return{fields:reverseRelations[0].config.references,references:reverseRelations[0].config.fields};throw new Error(`There is not enough information to infer relation "${sourceTableTsName}.${relation.fieldName}"`)}function createTableRelationsHelpers(sourceTable){return{one:createOne(sourceTable),many:createMany(sourceTable)}}function mapRelationalRow(tablesConfig,tableConfig,row,buildQueryResultSelection,mapColumnValue=(value)=>value){let result={};for(let[selectionItemIndex,selectionItem]of buildQueryResultSelection.entries())if(selectionItem.isJson){let relation=tableConfig.relations[selectionItem.tsKey],rawSubRows=row[selectionItemIndex],subRows=typeof rawSubRows==="string"?JSON.parse(rawSubRows):rawSubRows;result[selectionItem.tsKey]=is(relation,One)?subRows&&mapRelationalRow(tablesConfig,tablesConfig[selectionItem.relationTableTsKey],subRows,selectionItem.selection,mapColumnValue):subRows.map((subRow)=>mapRelationalRow(tablesConfig,tablesConfig[selectionItem.relationTableTsKey],subRow,selectionItem.selection,mapColumnValue))}else{let value=mapColumnValue(row[selectionItemIndex]),field=selectionItem.field,decoder;if(is(field,Column))decoder=field;else if(is(field,SQL))decoder=field.decoder;else decoder=field.sql.decoder;result[selectionItem.tsKey]=value===null?null:decoder.mapFromDriverValue(value)}return result}function count(expression){return sql`count(${expression||sql.raw("*")})`.mapWith(Number)}var import_config=__toESM(require_config(),1);import os from"os";import fs from"fs";var originCache=new Map,originStackCache=new Map,originError=Symbol("OriginError"),CLOSE={};class Query extends Promise{constructor(strings,args,handler,canceller,options={}){let resolve,reject;super((a,b)=>{resolve=a,reject=b});this.tagged=Array.isArray(strings.raw),this.strings=strings,this.args=args,this.handler=handler,this.canceller=canceller,this.options=options,this.state=null,this.statement=null,this.resolve=(x)=>(this.active=!1,resolve(x)),this.reject=(x)=>(this.active=!1,reject(x)),this.active=!1,this.cancelled=null,this.executed=!1,this.signature="",this[originError]=this.handler.debug?new Error:this.tagged&&cachedError(this.strings)}get origin(){return(this.handler.debug?this[originError].stack:this.tagged&&originStackCache.has(this.strings)?originStackCache.get(this.strings):originStackCache.set(this.strings,this[originError].stack).get(this.strings))||""}static get[Symbol.species](){return Promise}cancel(){return this.canceller&&(this.canceller(this),this.canceller=null)}simple(){return this.options.simple=!0,this.options.prepare=!1,this}async readable(){return this.simple(),this.streaming=!0,this}async writable(){return this.simple(),this.streaming=!0,this}cursor(rows=1,fn){if(this.options.simple=!1,typeof rows==="function")fn=rows,rows=1;if(this.cursorRows=rows,typeof fn==="function")return this.cursorFn=fn,this;let prev;return{[Symbol.asyncIterator]:()=>({next:()=>{if(this.executed&&!this.active)return{done:!0};prev&&prev();let promise=new Promise((resolve,reject)=>{this.cursorFn=(value)=>{return resolve({value,done:!1}),new Promise((r)=>prev=r)},this.resolve=()=>(this.active=!1,resolve({done:!0})),this.reject=(x)=>(this.active=!1,reject(x))});return this.execute(),promise},return(){return prev&&prev(CLOSE),{done:!0}}})}}describe(){return this.options.simple=!1,this.onlyDescribe=this.options.prepare=!0,this}stream(){throw new Error(".stream has been renamed to .forEach")}forEach(fn){return this.forEachFn=fn,this.handle(),this}raw(){return this.isRaw=!0,this}values(){return this.isRaw="values",this}async handle(){!this.executed&&(this.executed=!0)&&await 1&&this.handler(this)}execute(){return this.handle(),this}then(){return this.handle(),super.then.apply(this,arguments)}catch(){return this.handle(),super.catch.apply(this,arguments)}finally(){return this.handle(),super.finally.apply(this,arguments)}}function cachedError(xs){if(originCache.has(xs))return originCache.get(xs);let x=Error.stackTraceLimit;return Error.stackTraceLimit=4,originCache.set(xs,new Error),Error.stackTraceLimit=x,originCache.get(xs)}class PostgresError extends Error{constructor(x){super(x.message);this.name=this.constructor.name,Object.assign(this,x)}}var Errors2={connection,postgres,generic,notSupported};function connection(x,options,socket){let{host,port}=socket||options,error2=Object.assign(new Error("write "+x+" "+(options.path||host+":"+port)),{code:x,errno:x,address:options.path||host},options.path?{}:{port});return Error.captureStackTrace(error2,connection),error2}function postgres(x){let error2=new PostgresError(x);return Error.captureStackTrace(error2,postgres),error2}function generic(code,message){let error2=Object.assign(new Error(code+": "+message),{code});return Error.captureStackTrace(error2,generic),error2}function notSupported(x){let error2=Object.assign(new Error(x+" (B) is not supported"),{code:"MESSAGE_NOT_SUPPORTED",name:x});return Error.captureStackTrace(error2,notSupported),error2}var types={string:{to:25,from:null,serialize:(x)=>""+x},number:{to:0,from:[21,23,26,700,701],serialize:(x)=>""+x,parse:(x)=>+x},json:{to:114,from:[114,3802],serialize:(x)=>JSON.stringify(x),parse:(x)=>JSON.parse(x)},boolean:{to:16,from:16,serialize:(x)=>x===!0?"t":"f",parse:(x)=>x==="t"},date:{to:1184,from:[1082,1114,1184],serialize:(x)=>(x instanceof Date?x:new Date(x)).toISOString(),parse:(x)=>new Date(x)},bytea:{to:17,from:17,serialize:(x)=>"\\x"+Buffer.from(x).toString("hex"),parse:(x)=>Buffer.from(x.slice(2),"hex")}};class NotTagged{then(){notTagged()}catch(){notTagged()}finally(){notTagged()}}class Identifier2 extends NotTagged{constructor(value){super();this.value=escapeIdentifier(value)}}class Parameter extends NotTagged{constructor(value,type2,array){super();this.value=value,this.type=type2,this.array=array}}class Builder extends NotTagged{constructor(first,rest){super();this.first=first,this.rest=rest}build(before,parameters,types2,options){let keyword=builders.map(([x,fn])=>({fn,i:before.search(x)})).sort((a,b)=>a.i-b.i).pop();return keyword.i===-1?escapeIdentifiers(this.first,options):keyword.fn(this.first,this.rest,parameters,types2,options)}}function handleValue(x,parameters,types2,options){let value=x instanceof Parameter?x.value:x;if(value===void 0){if(x instanceof Parameter?x.value=options.transform.undefined:value=x=options.transform.undefined,value===void 0)throw Errors2.generic("UNDEFINED_VALUE","Undefined values are not allowed")}return"$"+types2.push(x instanceof Parameter?(parameters.push(x.value),x.array?x.array[x.type||inferType(x.value)]||x.type||firstIsString(x.value):x.type):(parameters.push(x),inferType(x)))}var defaultHandlers=typeHandlers(types);function stringify(q,string,value,parameters,types2,options){for(let i=1;i<q.strings.length;i++)string+=stringifyValue(string,value,parameters,types2,options)+q.strings[i],value=q.args[i];return string}function stringifyValue(string,value,parameters,types2,o){return value instanceof Builder?value.build(string,parameters,types2,o):value instanceof Query?fragment(value,parameters,types2,o):value instanceof Identifier2?value.value:value&&value[0]instanceof Query?value.reduce((acc,x)=>acc+" "+fragment(x,parameters,types2,o),""):handleValue(value,parameters,types2,o)}function fragment(q,parameters,types2,options){return q.fragment=!0,stringify(q,q.strings[0],q.args[0],parameters,types2,options)}function valuesBuilder(first,parameters,types2,columns,options){return first.map((row)=>"("+columns.map((column)=>stringifyValue("values",row[column],parameters,types2,options)).join(",")+")").join(",")}function values(first,rest,parameters,types2,options){let multi=Array.isArray(first[0]),columns=rest.length?rest.flat():Object.keys(multi?first[0]:first);return valuesBuilder(multi?first:[first],parameters,types2,columns,options)}function select(first,rest,parameters,types2,options){if(typeof first==="string"&&(first=[first].concat(rest)),Array.isArray(first))return escapeIdentifiers(first,options);let value;return(rest.length?rest.flat():Object.keys(first)).map((x)=>{return value=first[x],(value instanceof Query?fragment(value,parameters,types2,options):value instanceof Identifier2?value.value:handleValue(value,parameters,types2,options))+" as "+escapeIdentifier(options.transform.column.to?options.transform.column.to(x):x)}).join(",")}var builders=Object.entries({values,in:(...xs)=>{let x=values(...xs);return x==="()"?"(null)":x},select,as:select,returning:select,"\\(":select,update(first,rest,parameters,types2,options){return(rest.length?rest.flat():Object.keys(first)).map((x)=>escapeIdentifier(options.transform.column.to?options.transform.column.to(x):x)+"="+stringifyValue("values",first[x],parameters,types2,options))},insert(first,rest,parameters,types2,options){let columns=rest.length?rest.flat():Object.keys(Array.isArray(first)?first[0]:first);return"("+escapeIdentifiers(columns,options)+")values"+valuesBuilder(Array.isArray(first)?first:[first],parameters,types2,columns,options)}}).map(([x,fn])=>[new RegExp("((?:^|[\\s(])"+x+"(?:$|[\\s(]))(?![\\s\\S]*\\1)","i"),fn]);function notTagged(){throw Errors2.generic("NOT_TAGGED_CALL","Query not called as a tagged template literal")}var{serializers,parsers}=defaultHandlers;function firstIsString(x){if(Array.isArray(x))return firstIsString(x[0]);return typeof x==="string"?1009:0}var mergeUserTypes=function(types2){let user=typeHandlers(types2||{});return{serializers:Object.assign({},serializers,user.serializers),parsers:Object.assign({},parsers,user.parsers)}};function typeHandlers(types2){return Object.keys(types2).reduce((acc,k2)=>{if(types2[k2].from&&[].concat(types2[k2].from).forEach((x)=>acc.parsers[x]=types2[k2].parse),types2[k2].serialize)acc.serializers[types2[k2].to]=types2[k2].serialize,types2[k2].from&&[].concat(types2[k2].from).forEach((x)=>acc.serializers[x]=types2[k2].serialize);return acc},{parsers:{},serializers:{}})}function escapeIdentifiers(xs,{transform:{column}}){return xs.map((x)=>escapeIdentifier(column.to?column.to(x):x)).join(",")}var escapeIdentifier=function escape(str){return'"'+str.replace(/"/g,'""').replace(/\./g,'"."')+'"'},inferType=function inferType2(x){return x instanceof Parameter?x.type:x instanceof Date?1184:x instanceof Uint8Array?17:x===!0||x===!1?16:typeof x==="bigint"?20:Array.isArray(x)?inferType2(x[0]):0},escapeBackslash=/\\/g,escapeQuote=/"/g;function arrayEscape(x){return x.replace(escapeBackslash,"\\\\").replace(escapeQuote,"\\\"")}var arraySerializer=function arraySerializer2(xs,serializer,options,typarray){if(Array.isArray(xs)===!1)return xs;if(!xs.length)return"{}";let first=xs[0],delimiter=typarray===1020?";":",";if(Array.isArray(first)&&!first.type)return"{"+xs.map((x)=>arraySerializer2(x,serializer,options,typarray)).join(delimiter)+"}";return"{"+xs.map((x)=>{if(x===void 0){if(x=options.transform.undefined,x===void 0)throw Errors2.generic("UNDEFINED_VALUE","Undefined values are not allowed")}return x===null?"null":'"'+arrayEscape(serializer?serializer(x.type?x.value:x):""+x)+'"'}).join(delimiter)+"}"},arrayParserState={i:0,char:null,str:"",quoted:!1,last:0},arrayParser=function arrayParser2(x,parser,typarray){return arrayParserState.i=arrayParserState.last=0,arrayParserLoop(arrayParserState,x,parser,typarray)};function arrayParserLoop(s,x,parser,typarray){let xs=[],delimiter=typarray===1020?";":",";for(;s.i<x.length;s.i++){if(s.char=x[s.i],s.quoted)if(s.char==="\\")s.str+=x[++s.i];else if(s.char==='"')xs.push(parser?parser(s.str):s.str),s.str="",s.quoted=x[s.i+1]==='"',s.last=s.i+2;else s.str+=s.char;else if(s.char==='"')s.quoted=!0;else if(s.char==="{")s.last=++s.i,xs.push(arrayParserLoop(s,x,parser,typarray));else if(s.char==="}"){s.quoted=!1,s.last<s.i&&xs.push(parser?parser(x.slice(s.last,s.i)):x.slice(s.last,s.i)),s.last=s.i+1;break}else if(s.char===delimiter&&s.p!=="}"&&s.p!=='"')xs.push(parser?parser(x.slice(s.last,s.i)):x.slice(s.last,s.i)),s.last=s.i+1;s.p=s.char}return s.last<s.i&&xs.push(parser?parser(x.slice(s.last,s.i+1)):x.slice(s.last,s.i+1)),xs}var toCamel=(x)=>{let str=x[0];for(let i=1;i<x.length;i++)str+=x[i]==="_"?x[++i].toUpperCase():x[i];return str},toPascal=(x)=>{let str=x[0].toUpperCase();for(let i=1;i<x.length;i++)str+=x[i]==="_"?x[++i].toUpperCase():x[i];return str},toKebab=(x)=>x.replace(/_/g,"-"),fromCamel=(x)=>x.replace(/([A-Z])/g,"_$1").toLowerCase(),fromPascal=(x)=>(x.slice(0,1)+x.slice(1).replace(/([A-Z])/g,"_$1")).toLowerCase(),fromKebab=(x)=>x.replace(/-/g,"_");function createJsonTransform(fn){return function jsonTransform(x,column){return typeof x==="object"&&x!==null&&(column.type===114||column.type===3802)?Array.isArray(x)?x.map((x2)=>jsonTransform(x2,column)):Object.entries(x).reduce((acc,[k2,v])=>Object.assign(acc,{[fn(k2)]:jsonTransform(v,column)}),{}):x}}toCamel.column={from:toCamel};toCamel.value={from:createJsonTransform(toCamel)};fromCamel.column={to:fromCamel};var camel={...toCamel};camel.column.to=fromCamel;toPascal.column={from:toPascal};toPascal.value={from:createJsonTransform(toPascal)};fromPascal.column={to:fromPascal};var pascal={...toPascal};pascal.column.to=fromPascal;toKebab.column={from:toKebab};toKebab.value={from:createJsonTransform(toKebab)};fromKebab.column={to:fromKebab};var kebab={...toKebab};kebab.column.to=fromKebab;import net from"net";import tls from"tls";import crypto2 from"crypto";import Stream from"stream";import{performance as performance2}from"perf_hooks";class Result extends Array{constructor(){super();Object.defineProperties(this,{count:{value:null,writable:!0},state:{value:null,writable:!0},command:{value:null,writable:!0},columns:{value:null,writable:!0},statement:{value:null,writable:!0}})}static get[Symbol.species](){return Array}}var queue_default=Queue;function Queue(initial=[]){let xs=initial.slice(),index=0;return{get length(){return xs.length-index},remove:(x)=>{let index2=xs.indexOf(x);return index2===-1?null:(xs.splice(index2,1),x)},push:(x)=>(xs.push(x),x),shift:()=>{let out=xs[index++];if(index===xs.length)index=0,xs=[];else xs[index-1]=void 0;return out}}}var buffer=Buffer.allocUnsafe(256),messages="BCcDdEFfHPpQSX".split("").reduce((acc,x)=>{let v=x.charCodeAt(0);return acc[x]=()=>{return buffer[0]=v,b.i=5,b},acc},{}),b=Object.assign(reset,messages,{N:String.fromCharCode(0),i:0,inc(x){return b.i+=x,b},str(x){let length=Buffer.byteLength(x);return fit(length),b.i+=buffer.write(x,b.i,length,"utf8"),b},i16(x){return fit(2),buffer.writeUInt16BE(x,b.i),b.i+=2,b},i32(x,i){if(i||i===0)return buffer.writeUInt32BE(x,i),b;return fit(4),buffer.writeUInt32BE(x,b.i),b.i+=4,b},z(x){return fit(x),buffer.fill(0,b.i,b.i+x),b.i+=x,b},raw(x){return buffer=Buffer.concat([buffer.subarray(0,b.i),x]),b.i=buffer.length,b},end(at=1){buffer.writeUInt32BE(b.i-at,at);let out=buffer.subarray(0,b.i);return b.i=0,buffer=Buffer.allocUnsafe(256),out}}),bytes_default=b;function fit(x){if(buffer.length-b.i<x){let prev=buffer,length=prev.length;buffer=Buffer.allocUnsafe(length+(length>>1)+x),prev.copy(buffer)}}function reset(){return b.i=0,b}var connection_default=Connection,uid=1,Sync=bytes_default().S().end(),Flush=bytes_default().H().end(),SSLRequest=bytes_default().i32(8).i32(80877103).end(8),ExecuteUnnamed=Buffer.concat([bytes_default().E().str(bytes_default.N).i32(0).end(),Sync]),DescribeUnnamed=bytes_default().D().str("S").str(bytes_default.N).end(),noop=()=>{},retryRoutines=new Set(["FetchPreparedStatement","RevalidateCachedQuery","transformAssignedExpr"]),errorFields={83:"severity_local",86:"severity",67:"code",77:"message",68:"detail",72:"hint",80:"position",112:"internal_position",113:"internal_query",87:"where",115:"schema_name",116:"table_name",99:"column_name",100:"data type_name",110:"constraint_name",70:"file",76:"line",82:"routine"};function Connection(options,queues={},{onopen=noop,onend=noop,onclose=noop}={}){let{ssl,max,user,host,port,database,parsers:parsers2,transform:transform2,onnotice,onnotify,onparameter,max_pipeline,keep_alive,backoff,target_session_attrs}=options,sent=queue_default(),id=uid++,backend={pid:null,secret:null},idleTimer=timer(end,options.idle_timeout),lifeTimer=timer(end,options.max_lifetime),connectTimer=timer(connectTimedOut,options.connect_timeout),socket=null,cancelMessage,result=new Result,incoming=Buffer.alloc(0),needsTypes=options.fetch_types,backendParameters={},statements={},statementId=Math.random().toString(36).slice(2),statementCount=1,closedDate=0,remaining=0,hostIndex=0,retries=0,length=0,delay=0,rows=0,serverSignature=null,nextWriteTimer=null,terminated=!1,incomings=null,results=null,initial=null,ending=null,stream=null,chunk=null,ended=null,nonce=null,query=null,final=null,connection2={queue:queues.closed,idleTimer,connect(query2){initial=query2,reconnect()},terminate,execute,cancel,end,count:0,id};return queues.closed&&queues.closed.push(connection2),connection2;async function createSocket(){let x;try{x=options.socket?await Promise.resolve(options.socket(options)):new net.Socket}catch(e){error2(e);return}return x.on("error",error2),x.on("close",closed),x.on("drain",drain),x}async function cancel({pid,secret},resolve,reject){try{cancelMessage=bytes_default().i32(16).i32(80877102).i32(pid).i32(secret).end(16),await connect(),socket.once("error",reject),socket.once("close",resolve)}catch(error3){reject(error3)}}function execute(q){if(terminated)return queryError(q,Errors2.connection("CONNECTION_DESTROYED",options));if(q.cancelled)return;try{return q.state=backend,query?sent.push(q):(query=q,query.active=!0),build(q),write(toBuffer(q))&&!q.describeFirst&&!q.cursorFn&&sent.length<max_pipeline&&(!q.options.onexecute||q.options.onexecute(connection2))}catch(error3){return sent.length===0&&write(Sync),errored(error3),!0}}function toBuffer(q){if(q.parameters.length>=65534)throw Errors2.generic("MAX_PARAMETERS_EXCEEDED","Max number of parameters (65534) exceeded");return q.options.simple?bytes_default().Q().str(q.statement.string+bytes_default.N).end():q.describeFirst?Buffer.concat([describe(q),Flush]):q.prepare?q.prepared?prepared(q):Buffer.concat([describe(q),prepared(q)]):unnamed(q)}function describe(q){return Buffer.concat([Parse2(q.statement.string,q.parameters,q.statement.types,q.statement.name),Describe("S",q.statement.name)])}function prepared(q){return Buffer.concat([Bind(q.parameters,q.statement.types,q.statement.name,q.cursorName),q.cursorFn?Execute("",q.cursorRows):ExecuteUnnamed])}function unnamed(q){return Buffer.concat([Parse2(q.statement.string,q.parameters,q.statement.types),DescribeUnnamed,prepared(q)])}function build(q){let parameters=[],types2=[],string=stringify(q,q.strings[0],q.args[0],parameters,types2,options);!q.tagged&&q.args.forEach((x)=>handleValue(x,parameters,types2,options)),q.prepare=options.prepare&&("prepare"in q.options?q.options.prepare:!0),q.string=string,q.signature=q.prepare&&types2+string,q.onlyDescribe&&delete statements[q.signature],q.parameters=q.parameters||parameters,q.prepared=q.prepare&&q.signature in statements,q.describeFirst=q.onlyDescribe||parameters.length&&!q.prepared,q.statement=q.prepared?statements[q.signature]:{string,types:types2,name:q.prepare?statementId+statementCount++:""},typeof options.debug==="function"&&options.debug(id,string,parameters,types2)}function write(x,fn){if(chunk=chunk?Buffer.concat([chunk,x]):Buffer.from(x),fn||chunk.length>=1024)return nextWrite(fn);return nextWriteTimer===null&&(nextWriteTimer=setImmediate(nextWrite)),!0}function nextWrite(fn){let x=socket.write(chunk,fn);return nextWriteTimer!==null&&clearImmediate(nextWriteTimer),chunk=nextWriteTimer=null,x}function connectTimedOut(){errored(Errors2.connection("CONNECT_TIMEOUT",options,socket)),socket.destroy()}async function secure(){if(write(SSLRequest),!await new Promise((r)=>socket.once("data",(x)=>r(x[0]===83)))&&ssl==="prefer")return connected();socket.removeAllListeners(),socket=tls.connect({socket,servername:net.isIP(socket.host)?void 0:socket.host,...ssl==="require"||ssl==="allow"||ssl==="prefer"?{rejectUnauthorized:!1}:ssl==="verify-full"?{}:typeof ssl==="object"?ssl:{}}),socket.on("secureConnect",connected),socket.on("error",error2),socket.on("close",closed),socket.on("drain",drain)}function drain(){!query&&onopen(connection2)}function data(x){if(incomings){if(incomings.push(x),remaining-=x.length,remaining>0)return}incoming=incomings?Buffer.concat(incomings,length-remaining):incoming.length===0?x:Buffer.concat([incoming,x],incoming.length+x.length);while(incoming.length>4){if(length=incoming.readUInt32BE(1),length>=incoming.length){remaining=length-incoming.length,incomings=[incoming];break}try{handle(incoming.subarray(0,length+1))}catch(e){query&&(query.cursorFn||query.describeFirst)&&write(Sync),errored(e)}incoming=incoming.subarray(length+1),remaining=0,incomings=null}}async function connect(){if(terminated=!1,backendParameters={},socket||(socket=await createSocket()),!socket)return;if(connectTimer.start(),options.socket)return ssl?secure():connected();if(socket.on("connect",ssl?secure:connected),options.path)return socket.connect(options.path);socket.ssl=ssl,socket.connect(port[hostIndex],host[hostIndex]),socket.host=host[hostIndex],socket.port=port[hostIndex],hostIndex=(hostIndex+1)%port.length}function reconnect(){setTimeout(connect,closedDate?closedDate+delay-performance2.now():0)}function connected(){try{statements={},needsTypes=options.fetch_types,statementId=Math.random().toString(36).slice(2),statementCount=1,lifeTimer.start(),socket.on("data",data),keep_alive&&socket.setKeepAlive&&socket.setKeepAlive(!0,1000*keep_alive);let s=StartupMessage();write(s)}catch(err){error2(err)}}function error2(err){if(connection2.queue===queues.connecting&&options.host[retries+1])return;errored(err);while(sent.length)queryError(sent.shift(),err)}function errored(err){stream&&(stream.destroy(err),stream=null),query&&queryError(query,err),initial&&(queryError(initial,err),initial=null)}function queryError(query2,err){if(query2.reserve)return query2.reject(err);if(!err||typeof err!=="object")err=new Error(err);"query"in err||"parameters"in err||Object.defineProperties(err,{stack:{value:err.stack+query2.origin.replace(/.*\n/,`
`),enumerable:options.debug},query:{value:query2.string,enumerable:options.debug},parameters:{value:query2.parameters,enumerable:options.debug},args:{value:query2.args,enumerable:options.debug},types:{value:query2.statement&&query2.statement.types,enumerable:options.debug}}),query2.reject(err)}function end(){return ending||(!connection2.reserved&&onend(connection2),!connection2.reserved&&!initial&&!query&&sent.length===0?(terminate(),new Promise((r)=>socket&&socket.readyState!=="closed"?socket.once("close",r):r())):ending=new Promise((r)=>ended=r))}function terminate(){if(terminated=!0,stream||query||initial||sent.length)error2(Errors2.connection("CONNECTION_DESTROYED",options));if(clearImmediate(nextWriteTimer),socket)socket.removeListener("data",data),socket.removeListener("connect",connected),socket.readyState==="open"&&socket.end(bytes_default().X().end());ended&&(ended(),ending=ended=null)}async function closed(hadError){if(incoming=Buffer.alloc(0),remaining=0,incomings=null,clearImmediate(nextWriteTimer),socket.removeListener("data",data),socket.removeListener("connect",connected),idleTimer.cancel(),lifeTimer.cancel(),connectTimer.cancel(),socket.removeAllListeners(),socket=null,initial)return reconnect();!hadError&&(query||sent.length)&&error2(Errors2.connection("CONNECTION_CLOSED",options,socket)),closedDate=performance2.now(),hadError&&options.shared.retries++,delay=(typeof backoff==="function"?backoff(options.shared.retries):backoff)*1000,onclose(connection2,Errors2.connection("CONNECTION_CLOSED",options,socket))}function handle(xs,x=xs[0]){(x===68?DataRow:x===100?CopyData:x===65?NotificationResponse:x===83?ParameterStatus:x===90?ReadyForQuery:x===67?CommandComplete:x===50?BindComplete:x===49?ParseComplete:x===116?ParameterDescription:x===84?RowDescription:x===82?Authentication:x===110?NoData:x===75?BackendKeyData:x===69?ErrorResponse:x===115?PortalSuspended:x===51?CloseComplete:x===71?CopyInResponse:x===78?NoticeResponse:x===72?CopyOutResponse:x===99?CopyDone:x===73?EmptyQueryResponse:x===86?FunctionCallResponse:x===118?NegotiateProtocolVersion:x===87?CopyBothResponse:UnknownMessage)(xs)}function DataRow(x){let index=7,length2,column,value,row=query.isRaw?new Array(query.statement.columns.length):{};for(let i=0;i<query.statement.columns.length;i++)column=query.statement.columns[i],length2=x.readInt32BE(index),index+=4,value=length2===-1?null:query.isRaw===!0?x.subarray(index,index+=length2):column.parser===void 0?x.toString("utf8",index,index+=length2):column.parser.array===!0?column.parser(x.toString("utf8",index+1,index+=length2)):column.parser(x.toString("utf8",index,index+=length2)),query.isRaw?row[i]=query.isRaw===!0?value:transform2.value.from?transform2.value.from(value,column):value:row[column.name]=transform2.value.from?transform2.value.from(value,column):value;query.forEachFn?query.forEachFn(transform2.row.from?transform2.row.from(row):row,result):result[rows++]=transform2.row.from?transform2.row.from(row):row}function ParameterStatus(x){let[k2,v]=x.toString("utf8",5,x.length-1).split(bytes_default.N);if(backendParameters[k2]=v,options.parameters[k2]!==v)options.parameters[k2]=v,onparameter&&onparameter(k2,v)}function ReadyForQuery(x){if(query&&query.options.simple&&query.resolve(results||result),query=results=null,result=new Result,connectTimer.cancel(),initial){if(target_session_attrs){if(!backendParameters.in_hot_standby||!backendParameters.default_transaction_read_only)return fetchState();else if(tryNext(target_session_attrs,backendParameters))return terminate()}if(needsTypes)return initial.reserve&&(initial=null),fetchArrayTypes();initial&&!initial.reserve&&execute(initial),options.shared.retries=retries=0,initial=null;return}while(sent.length&&(query=sent.shift())&&(query.active=!0,query.cancelled))Connection(options).cancel(query.state,query.cancelled.resolve,query.cancelled.reject);if(query)return;connection2.reserved?!connection2.reserved.release&&x[5]===73?ending?terminate():(connection2.reserved=null,onopen(connection2)):connection2.reserved():ending?terminate():onopen(connection2)}function CommandComplete(x){rows=0;for(let i=x.length-1;i>0;i--){if(x[i]===32&&x[i+1]<58&&result.count===null)result.count=+x.toString("utf8",i+1,x.length-1);if(x[i-1]>=65){result.command=x.toString("utf8",5,i),result.state=backend;break}}if(final&&(final(),final=null),result.command==="BEGIN"&&max!==1&&!connection2.reserved)return errored(Errors2.generic("UNSAFE_TRANSACTION","Only use sql.begin, sql.reserved or max: 1"));if(query.options.simple)return BindComplete();if(query.cursorFn)result.count&&query.cursorFn(result),write(Sync);query.resolve(result)}function ParseComplete(){query.parsing=!1}function BindComplete(){!result.statement&&(result.statement=query.statement),result.columns=query.statement.columns}function ParameterDescription(x){let length2=x.readUInt16BE(5);for(let i=0;i<length2;++i)!query.statement.types[i]&&(query.statement.types[i]=x.readUInt32BE(7+i*4));query.prepare&&(statements[query.signature]=query.statement),query.describeFirst&&!query.onlyDescribe&&(write(prepared(query)),query.describeFirst=!1)}function RowDescription(x){if(result.command)results=results||[result],results.push(result=new Result),result.count=null,query.statement.columns=null;let length2=x.readUInt16BE(5),index=7,start;query.statement.columns=Array(length2);for(let i=0;i<length2;++i){start=index;while(x[index++]!==0);let table=x.readUInt32BE(index),number=x.readUInt16BE(index+4),type2=x.readUInt32BE(index+6);query.statement.columns[i]={name:transform2.column.from?transform2.column.from(x.toString("utf8",start,index-1)):x.toString("utf8",start,index-1),parser:parsers2[type2],table,number,type:type2},index+=18}if(result.statement=query.statement,query.onlyDescribe)return query.resolve(query.statement),write(Sync)}async function Authentication(x,type2=x.readUInt32BE(5)){(type2===3?AuthenticationCleartextPassword:type2===5?AuthenticationMD5Password:type2===10?SASL:type2===11?SASLContinue:type2===12?SASLFinal:type2!==0?UnknownAuth:noop)(x,type2)}async function AuthenticationCleartextPassword(){let payload=await Pass();write(bytes_default().p().str(payload).z(1).end())}async function AuthenticationMD5Password(x){let payload="md5"+await md5(Buffer.concat([Buffer.from(await md5(await Pass()+user)),x.subarray(9)]));write(bytes_default().p().str(payload).z(1).end())}async function SASL(){nonce=(await crypto2.randomBytes(18)).toString("base64"),bytes_default().p().str("SCRAM-SHA-256"+bytes_default.N);let i=bytes_default.i;write(bytes_default.inc(4).str("n,,n=*,r="+nonce).i32(bytes_default.i-i-4,i).end())}async function SASLContinue(x){let res=x.toString("utf8",9).split(",").reduce((acc,x2)=>(acc[x2[0]]=x2.slice(2),acc),{}),saltedPassword=await crypto2.pbkdf2Sync(await Pass(),Buffer.from(res.s,"base64"),parseInt(res.i),32,"sha256"),clientKey=await hmac(saltedPassword,"Client Key"),auth="n=*,r="+nonce+",r="+res.r+",s="+res.s+",i="+res.i+",c=biws,r="+res.r;serverSignature=(await hmac(await hmac(saltedPassword,"Server Key"),auth)).toString("base64");let payload="c=biws,r="+res.r+",p="+xor(clientKey,Buffer.from(await hmac(await sha256(clientKey),auth))).toString("base64");write(bytes_default().p().str(payload).end())}function SASLFinal(x){if(x.toString("utf8",9).split(bytes_default.N,1)[0].slice(2)===serverSignature)return;errored(Errors2.generic("SASL_SIGNATURE_MISMATCH","The server did not return the correct signature")),socket.destroy()}function Pass(){return Promise.resolve(typeof options.pass==="function"?options.pass():options.pass)}function NoData(){if(result.statement=query.statement,result.statement.columns=[],query.onlyDescribe)return query.resolve(query.statement),write(Sync)}function BackendKeyData(x){backend.pid=x.readUInt32BE(5),backend.secret=x.readUInt32BE(9)}async function fetchArrayTypes(){needsTypes=!1,(await new Query([`
      select b.oid, b.typarray
      from pg_catalog.pg_type a
      left join pg_catalog.pg_type b on b.oid = a.typelem
      where a.typcategory = 'A'
      group by b.oid, b.typarray
      order by b.oid
    `],[],execute)).forEach(({oid,typarray})=>addArrayType(oid,typarray))}function addArrayType(oid,typarray){if(!!options.parsers[typarray]&&!!options.serializers[typarray])return;let parser=options.parsers[oid];options.shared.typeArrayMap[oid]=typarray,options.parsers[typarray]=(xs)=>arrayParser(xs,parser,typarray),options.parsers[typarray].array=!0,options.serializers[typarray]=(xs)=>arraySerializer(xs,options.serializers[oid],options,typarray)}function tryNext(x,xs){return x==="read-write"&&xs.default_transaction_read_only==="on"||x==="read-only"&&xs.default_transaction_read_only==="off"||x==="primary"&&xs.in_hot_standby==="on"||x==="standby"&&xs.in_hot_standby==="off"||x==="prefer-standby"&&xs.in_hot_standby==="off"&&options.host[retries]}function fetchState(){let query2=new Query([`
      show transaction_read_only;
      select pg_catalog.pg_is_in_recovery()
    `],[],execute,null,{simple:!0});query2.resolve=([[a],[b2]])=>{backendParameters.default_transaction_read_only=a.transaction_read_only,backendParameters.in_hot_standby=b2.pg_is_in_recovery?"on":"off"},query2.execute()}function ErrorResponse(x){query&&(query.cursorFn||query.describeFirst)&&write(Sync);let error3=Errors2.postgres(parseError(x));query&&query.retried?errored(query.retried):query&&query.prepared&&retryRoutines.has(error3.routine)?retry(query,error3):errored(error3)}function retry(q,error3){delete statements[q.signature],q.retried=error3,execute(q)}function NotificationResponse(x){if(!onnotify)return;let index=9;while(x[index++]!==0);onnotify(x.toString("utf8",9,index-1),x.toString("utf8",index,x.length-1))}async function PortalSuspended(){try{let x=await Promise.resolve(query.cursorFn(result));rows=0,x===CLOSE?write(Close(query.portal)):(result=new Result,write(Execute("",query.cursorRows)))}catch(err){write(Sync),query.reject(err)}}function CloseComplete(){result.count&&query.cursorFn(result),query.resolve(result)}function CopyInResponse(){stream=new Stream.Writable({autoDestroy:!0,write(chunk2,encoding,callback){socket.write(bytes_default().d().raw(chunk2).end(),callback)},destroy(error3,callback){callback(error3),socket.write(bytes_default().f().str(error3+bytes_default.N).end()),stream=null},final(callback){socket.write(bytes_default().c().end()),final=callback}}),query.resolve(stream)}function CopyOutResponse(){stream=new Stream.Readable({read(){socket.resume()}}),query.resolve(stream)}function CopyBothResponse(){stream=new Stream.Duplex({autoDestroy:!0,read(){socket.resume()},write(chunk2,encoding,callback){socket.write(bytes_default().d().raw(chunk2).end(),callback)},destroy(error3,callback){callback(error3),socket.write(bytes_default().f().str(error3+bytes_default.N).end()),stream=null},final(callback){socket.write(bytes_default().c().end()),final=callback}}),query.resolve(stream)}function CopyData(x){stream&&(stream.push(x.subarray(5))||socket.pause())}function CopyDone(){stream&&stream.push(null),stream=null}function NoticeResponse(x){onnotice?onnotice(parseError(x)):console.log(parseError(x))}function EmptyQueryResponse(){}function FunctionCallResponse(){errored(Errors2.notSupported("FunctionCallResponse"))}function NegotiateProtocolVersion(){errored(Errors2.notSupported("NegotiateProtocolVersion"))}function UnknownMessage(x){console.error("Postgres.js : Unknown Message:",x[0])}function UnknownAuth(x,type2){console.error("Postgres.js : Unknown Auth:",type2)}function Bind(parameters,types2,statement="",portal=""){let prev,type2;return bytes_default().B().str(portal+bytes_default.N).str(statement+bytes_default.N).i16(0).i16(parameters.length),parameters.forEach((x,i)=>{if(x===null)return bytes_default.i32(4294967295);type2=types2[i],parameters[i]=x=type2 in options.serializers?options.serializers[type2](x):""+x,prev=bytes_default.i,bytes_default.inc(4).str(x).i32(bytes_default.i-prev-4,prev)}),bytes_default.i16(0),bytes_default.end()}function Parse2(str,parameters,types2,name=""){return bytes_default().P().str(name+bytes_default.N).str(str+bytes_default.N).i16(parameters.length),parameters.forEach((x,i)=>bytes_default.i32(types2[i]||0)),bytes_default.end()}function Describe(x,name=""){return bytes_default().D().str(x).str(name+bytes_default.N).end()}function Execute(portal="",rows2=0){return Buffer.concat([bytes_default().E().str(portal+bytes_default.N).i32(rows2).end(),Flush])}function Close(portal=""){return Buffer.concat([bytes_default().C().str("P").str(portal+bytes_default.N).end(),bytes_default().S().end()])}function StartupMessage(){return cancelMessage||bytes_default().inc(4).i16(3).z(2).str(Object.entries(Object.assign({user,database,client_encoding:"UTF8"},options.connection)).filter(([,v])=>v).map(([k2,v])=>k2+bytes_default.N+v).join(bytes_default.N)).z(2).end(0)}}function parseError(x){let error2={},start=5;for(let i=5;i<x.length-1;i++)if(x[i]===0)error2[errorFields[x[start]]]=x.toString("utf8",start+1,i),start=i+1;return error2}function md5(x){return crypto2.createHash("md5").update(x).digest("hex")}function hmac(key,x){return crypto2.createHmac("sha256",key).update(x).digest()}function sha256(x){return crypto2.createHash("sha256").update(x).digest()}function xor(a,b2){let length=Math.max(a.length,b2.length),buffer2=Buffer.allocUnsafe(length);for(let i=0;i<length;i++)buffer2[i]=a[i]^b2[i];return buffer2}function timer(fn,seconds){if(seconds=typeof seconds==="function"?seconds():seconds,!seconds)return{cancel:noop,start:noop};let timer2;return{cancel(){timer2&&(clearTimeout(timer2),timer2=null)},start(){timer2&&clearTimeout(timer2),timer2=setTimeout(done,seconds*1000,arguments)}};function done(args){fn.apply(null,args),timer2=null}}var noop2=()=>{};function Subscribe(postgres2,options){let subscribers=new Map,slot="postgresjs_"+Math.random().toString(36).slice(2),state={},connection2,stream,ended=!1,sql2=subscribe.sql=postgres2({...options,transform:{column:{},value:{},row:{}},max:1,fetch_types:!1,idle_timeout:null,max_lifetime:null,connection:{...options.connection,replication:"database"},onclose:async function(){if(ended)return;stream=null,state.pid=state.secret=void 0,connected(await init(sql2,slot,options.publications)),subscribers.forEach((event)=>event.forEach(({onsubscribe})=>onsubscribe()))},no_subscribe:!0}),end=sql2.end,close=sql2.close;return sql2.end=async()=>{return ended=!0,stream&&await new Promise((r)=>(stream.once("close",r),stream.end())),end()},sql2.close=async()=>{return stream&&await new Promise((r)=>(stream.once("close",r),stream.end())),close()},subscribe;async function subscribe(event,fn,onsubscribe=noop2,onerror=noop2){if(event=parseEvent(event),!connection2)connection2=init(sql2,slot,options.publications);let subscriber={fn,onsubscribe},fns=subscribers.has(event)?subscribers.get(event).add(subscriber):subscribers.set(event,new Set([subscriber])).get(event),unsubscribe=()=>{fns.delete(subscriber),fns.size===0&&subscribers.delete(event)};return connection2.then((x)=>{return connected(x),onsubscribe(),stream&&stream.on("error",onerror),{unsubscribe,state,sql:sql2}})}function connected(x){stream=x.stream,state.pid=x.state.pid,state.secret=x.state.secret}async function init(sql3,slot2,publications){if(!publications)throw new Error("Missing publication names");let xs=await sql3.unsafe(`CREATE_REPLICATION_SLOT ${slot2} TEMPORARY LOGICAL pgoutput NOEXPORT_SNAPSHOT`),[x]=xs,stream2=await sql3.unsafe(`START_REPLICATION SLOT ${slot2} LOGICAL ${x.consistent_point} (proto_version '1', publication_names '${publications}')`).writable(),state2={lsn:Buffer.concat(x.consistent_point.split("/").map((x2)=>Buffer.from(("00000000"+x2).slice(-8),"hex")))};return stream2.on("data",data),stream2.on("error",error2),stream2.on("close",sql3.close),{stream:stream2,state:xs.state};function error2(e){console.error("Unexpected error during logical streaming - reconnecting",e)}function data(x2){if(x2[0]===119)parse3(x2.subarray(25),state2,sql3.options.parsers,handle,options.transform);else if(x2[0]===107&&x2[17])state2.lsn=x2.subarray(1,9),pong()}function handle(a,b2){let path=b2.relation.schema+"."+b2.relation.table;call("*",a,b2),call("*:"+path,a,b2),b2.relation.keys.length&&call("*:"+path+"="+b2.relation.keys.map((x2)=>a[x2.name]),a,b2),call(b2.command,a,b2),call(b2.command+":"+path,a,b2),b2.relation.keys.length&&call(b2.command+":"+path+"="+b2.relation.keys.map((x2)=>a[x2.name]),a,b2)}function pong(){let x2=Buffer.alloc(34);x2[0]=114,x2.fill(state2.lsn,1),x2.writeBigInt64BE(BigInt(Date.now()-Date.UTC(2000,0,1))*BigInt(1000),25),stream2.write(x2)}}function call(x,a,b2){subscribers.has(x)&&subscribers.get(x).forEach(({fn})=>fn(a,b2,x))}}function Time(x){return new Date(Date.UTC(2000,0,1)+Number(x/BigInt(1000)))}function parse3(x,state,parsers2,handle,transform2){let char2=(acc,[k2,v])=>(acc[k2.charCodeAt(0)]=v,acc);Object.entries({R:(x2)=>{let i=1,r=state[x2.readUInt32BE(i)]={schema:x2.toString("utf8",i+=4,i=x2.indexOf(0,i))||"pg_catalog",table:x2.toString("utf8",i+1,i=x2.indexOf(0,i+1)),columns:Array(x2.readUInt16BE(i+=2)),keys:[]};i+=2;let columnIndex=0,column;while(i<x2.length)column=r.columns[columnIndex++]={key:x2[i++],name:transform2.column.from?transform2.column.from(x2.toString("utf8",i,i=x2.indexOf(0,i))):x2.toString("utf8",i,i=x2.indexOf(0,i)),type:x2.readUInt32BE(i+=1),parser:parsers2[x2.readUInt32BE(i)],atttypmod:x2.readUInt32BE(i+=4)},column.key&&r.keys.push(column),i+=4},Y:()=>{},O:()=>{},B:(x2)=>{state.date=Time(x2.readBigInt64BE(9)),state.lsn=x2.subarray(1,9)},I:(x2)=>{let i=1,relation=state[x2.readUInt32BE(i)],{row}=tuples(x2,relation.columns,i+=7,transform2);handle(row,{command:"insert",relation})},D:(x2)=>{let i=1,relation=state[x2.readUInt32BE(i)];i+=4;let key=x2[i]===75;handle(key||x2[i]===79?tuples(x2,relation.columns,i+=3,transform2).row:null,{command:"delete",relation,key})},U:(x2)=>{let i=1,relation=state[x2.readUInt32BE(i)];i+=4;let key=x2[i]===75,xs=key||x2[i]===79?tuples(x2,relation.columns,i+=3,transform2):null;xs&&(i=xs.i);let{row}=tuples(x2,relation.columns,i+3,transform2);handle(row,{command:"update",relation,key,old:xs&&xs.row})},T:()=>{},C:()=>{}}).reduce(char2,{})[x[0]](x)}function tuples(x,columns,xi,transform2){let type2,column,value,row=transform2.raw?new Array(columns.length):{};for(let i=0;i<columns.length;i++)type2=x[xi++],column=columns[i],value=type2===110?null:type2===117?void 0:column.parser===void 0?x.toString("utf8",xi+4,xi+=4+x.readUInt32BE(xi)):column.parser.array===!0?column.parser(x.toString("utf8",xi+5,xi+=4+x.readUInt32BE(xi))):column.parser(x.toString("utf8",xi+4,xi+=4+x.readUInt32BE(xi))),transform2.raw?row[i]=transform2.raw===!0?value:transform2.value.from?transform2.value.from(value,column):value:row[column.name]=transform2.value.from?transform2.value.from(value,column):value;return{i:xi,row:transform2.row.from?transform2.row.from(row):row}}function parseEvent(x){let xs=x.match(/^(\*|insert|update|delete)?:?([^.]+?\.?[^=]+)?=?(.+)?/i)||[];if(!xs)throw new Error("Malformed subscribe pattern: "+x);let[,command,path,key]=xs;return(command||"*")+(path?":"+(path.indexOf(".")===-1?"public."+path:path):"")+(key?"="+key:"")}import Stream2 from"stream";function largeObject(sql2,oid,mode=393216){return new Promise(async(resolve,reject)=>{await sql2.begin(async(sql3)=>{let finish;!oid&&([{oid}]=await sql3`select lo_creat(-1) as oid`);let[{fd}]=await sql3`select lo_open(${oid}, ${mode}) as fd`,lo={writable,readable,close:()=>sql3`select lo_close(${fd})`.then(finish),tell:()=>sql3`select lo_tell64(${fd})`,read:(x)=>sql3`select loread(${fd}, ${x}) as data`,write:(x)=>sql3`select lowrite(${fd}, ${x})`,truncate:(x)=>sql3`select lo_truncate64(${fd}, ${x})`,seek:(x,whence=0)=>sql3`select lo_lseek64(${fd}, ${x}, ${whence})`,size:()=>sql3`
          select
            lo_lseek64(${fd}, location, 0) as position,
            seek.size
          from (
            select
              lo_lseek64($1, 0, 2) as size,
              tell.location
            from (select lo_tell64($1) as location) tell
          ) seek
        `};return resolve(lo),new Promise(async(r)=>finish=r);async function readable({highWaterMark=16384,start=0,end=1/0}={}){let max=end-start;return start&&await lo.seek(start),new Stream2.Readable({highWaterMark,async read(size){let l=size>max?size-max:size;max-=size;let[{data}]=await lo.read(l);if(this.push(data),data.length<size)this.push(null)}})}async function writable({highWaterMark=16384,start=0}={}){return start&&await lo.seek(start),new Stream2.Writable({highWaterMark,write(chunk,encoding,callback){lo.write(chunk).then(()=>callback(),callback)}})}}).catch(reject)})}Object.assign(Postgres,{PostgresError,toPascal,pascal,toCamel,camel,toKebab,kebab,fromPascal,fromCamel,fromKebab,BigInt:{to:20,from:[20],parse:(x)=>BigInt(x),serialize:(x)=>x.toString()}});var src_default=Postgres;function Postgres(a,b2){let options=parseOptions(a,b2),subscribe=options.no_subscribe||Subscribe(Postgres,{...options}),ending=!1,queries=queue_default(),connecting=queue_default(),reserved=queue_default(),closed=queue_default(),ended=queue_default(),open=queue_default(),busy=queue_default(),full=queue_default(),queues={connecting,reserved,closed,ended,open,busy,full},connections=[...Array(options.max)].map(()=>connection_default(options,queues,{onopen,onend,onclose})),sql2=Sql(handler);return Object.assign(sql2,{get parameters(){return options.parameters},largeObject:largeObject.bind(null,sql2),subscribe,CLOSE,END:CLOSE,PostgresError,options,reserve,listen,begin,close,end}),sql2;function Sql(handler2){return handler2.debug=options.debug,Object.entries(options.types).reduce((acc,[name,type2])=>{return acc[name]=(x)=>new Parameter(x,type2.to),acc},typed),Object.assign(sql3,{types:typed,typed,unsafe,notify,array,json:json2,file}),sql3;function typed(value,type2){return new Parameter(value,type2)}function sql3(strings,...args){return strings&&Array.isArray(strings.raw)?new Query(strings,args,handler2,cancel):typeof strings==="string"&&!args.length?new Identifier2(options.transform.column.to?options.transform.column.to(strings):strings):new Builder(strings,args)}function unsafe(string,args=[],options2={}){return arguments.length===2&&!Array.isArray(args)&&(options2=args,args=[]),new Query([string],args,handler2,cancel,{prepare:!1,...options2,simple:"simple"in options2?options2.simple:args.length===0})}function file(path,args=[],options2={}){return arguments.length===2&&!Array.isArray(args)&&(options2=args,args=[]),new Query([],args,(query2)=>{fs.readFile(path,"utf8",(err,string)=>{if(err)return query2.reject(err);query2.strings=[string],handler2(query2)})},cancel,{...options2,simple:"simple"in options2?options2.simple:args.length===0})}}async function listen(name,fn,onlisten){let listener={fn,onlisten},sql3=listen.sql||(listen.sql=Postgres({...options,max:1,idle_timeout:null,max_lifetime:null,fetch_types:!1,onclose(){Object.entries(listen.channels).forEach(([name2,{listeners}])=>{delete listen.channels[name2],Promise.all(listeners.map((l)=>listen(name2,l.fn,l.onlisten).catch(()=>{})))})},onnotify(c,x){c in listen.channels&&listen.channels[c].listeners.forEach((l)=>l.fn(x))}})),channels=listen.channels||(listen.channels={});if(name in channels){channels[name].listeners.push(listener);let result2=await channels[name].result;return listener.onlisten&&listener.onlisten(),{state:result2.state,unlisten}}channels[name]={result:sql3`listen ${sql3.unsafe('"'+name.replace(/"/g,'""')+'"')}`,listeners:[listener]};let result=await channels[name].result;return listener.onlisten&&listener.onlisten(),{state:result.state,unlisten};async function unlisten(){if(name in channels===!1)return;if(channels[name].listeners=channels[name].listeners.filter((x)=>x!==listener),channels[name].listeners.length)return;return delete channels[name],sql3`unlisten ${sql3.unsafe('"'+name.replace(/"/g,'""')+'"')}`}}async function notify(channel,payload){return await sql2`select pg_notify(${channel}, ${""+payload})`}async function reserve(){let queue=queue_default(),c=open.length?open.shift():await new Promise((resolve,reject)=>{let query={reserve:resolve,reject};queries.push(query),closed.length&&connect(closed.shift(),query)});move(c,reserved),c.reserved=()=>queue.length?c.execute(queue.shift()):move(c,reserved),c.reserved.release=!0;let sql3=Sql(handler2);return sql3.release=()=>{c.reserved=null,onopen(c)},sql3;function handler2(q){c.queue===full?queue.push(q):c.execute(q)||move(c,full)}}async function begin(options2,fn){!fn&&(fn=options2,options2="");let queries2=queue_default(),savepoints=0,connection2,prepare=null;try{return await sql2.unsafe("begin "+options2.replace(/[^a-z ]/ig,""),[],{onexecute}).execute(),await Promise.race([scope(connection2,fn),new Promise((_2,reject)=>connection2.onclose=reject)])}catch(error2){throw error2}async function scope(c,fn2,name){let sql3=Sql(handler2);sql3.savepoint=savepoint,sql3.prepare=(x)=>prepare=x.replace(/[^a-z0-9$-_. ]/gi);let uncaughtError,result;name&&await sql3`savepoint ${sql3(name)}`;try{if(result=await new Promise((resolve,reject)=>{let x=fn2(sql3);Promise.resolve(Array.isArray(x)?Promise.all(x):x).then(resolve,reject)}),uncaughtError)throw uncaughtError}catch(e){throw await(name?sql3`rollback to ${sql3(name)}`:sql3`rollback`),e instanceof PostgresError&&e.code==="25P02"&&uncaughtError||e}if(!name)prepare?await sql3`prepare transaction '${sql3.unsafe(prepare)}'`:await sql3`commit`;return result;function savepoint(name2,fn3){if(name2&&Array.isArray(name2.raw))return savepoint((sql4)=>sql4.apply(sql4,arguments));return arguments.length===1&&(fn3=name2,name2=null),scope(c,fn3,"s"+savepoints+++(name2?"_"+name2:""))}function handler2(q){q.catch((e)=>uncaughtError||(uncaughtError=e)),c.queue===full?queries2.push(q):c.execute(q)||move(c,full)}}function onexecute(c){connection2=c,move(c,reserved),c.reserved=()=>queries2.length?c.execute(queries2.shift()):move(c,reserved)}}function move(c,queue){return c.queue.remove(c),queue.push(c),c.queue=queue,queue===open?c.idleTimer.start():c.idleTimer.cancel(),c}function json2(x){return new Parameter(x,3802)}function array(x,type2){if(!Array.isArray(x))return array(Array.from(arguments));return new Parameter(x,type2||(x.length?inferType(x)||25:0),options.shared.typeArrayMap)}function handler(query){if(ending)return query.reject(Errors2.connection("CONNECTION_ENDED",options,options));if(open.length)return go(open.shift(),query);if(closed.length)return connect(closed.shift(),query);busy.length?go(busy.shift(),query):queries.push(query)}function go(c,query){return c.execute(query)?move(c,busy):move(c,full)}function cancel(query){return new Promise((resolve,reject)=>{query.state?query.active?connection_default(options).cancel(query.state,resolve,reject):query.cancelled={resolve,reject}:(queries.remove(query),query.cancelled=!0,query.reject(Errors2.generic("57014","canceling statement due to user request")),resolve())})}async function end({timeout=null}={}){if(ending)return ending;await 1;let timer2;return ending=Promise.race([new Promise((r)=>timeout!==null&&(timer2=setTimeout(destroy,timeout*1000,r))),Promise.all(connections.map((c)=>c.end()).concat(listen.sql?listen.sql.end({timeout:0}):[],subscribe.sql?subscribe.sql.end({timeout:0}):[]))]).then(()=>clearTimeout(timer2))}async function close(){await Promise.all(connections.map((c)=>c.end()))}async function destroy(resolve){await Promise.all(connections.map((c)=>c.terminate()));while(queries.length)queries.shift().reject(Errors2.connection("CONNECTION_DESTROYED",options));resolve()}function connect(c,query){return move(c,connecting),c.connect(query),c}function onend(c){move(c,ended)}function onopen(c){if(queries.length===0)return move(c,open);let max=Math.ceil(queries.length/(connecting.length+1)),ready=!0;while(ready&&queries.length&&max-- >0){let query=queries.shift();if(query.reserve)return query.reserve(c);ready=c.execute(query)}ready?move(c,busy):move(c,full)}function onclose(c,e){move(c,closed),c.reserved=null,c.onclose&&(c.onclose(e),c.onclose=null),options.onclose&&options.onclose(c.id),queries.length&&connect(c,queries.shift())}}function parseOptions(a,b2){if(a&&a.shared)return a;let env3=process.env,o=(!a||typeof a==="string"?b2:a)||{},{url,multihost}=parseUrl(a),query=[...url.searchParams].reduce((a2,[b3,c])=>(a2[b3]=c,a2),{}),host=o.hostname||o.host||multihost||url.hostname||env3.PGHOST||"localhost",port=o.port||url.port||env3.PGPORT||5432,user=o.user||o.username||url.username||env3.PGUSERNAME||env3.PGUSER||osUsername();o.no_prepare&&(o.prepare=!1),query.sslmode&&(query.ssl=query.sslmode,delete query.sslmode),"timeout"in o&&(console.log("The timeout option is deprecated, use idle_timeout instead"),o.idle_timeout=o.timeout),query.sslrootcert==="system"&&(query.ssl="verify-full");let ints=["idle_timeout","connect_timeout","max_lifetime","max_pipeline","backoff","keep_alive"],defaults={max:10,ssl:!1,idle_timeout:null,connect_timeout:30,max_lifetime,max_pipeline:100,backoff,keep_alive:60,prepare:!0,debug:!1,fetch_types:!0,publications:"alltables",target_session_attrs:null};return{host:Array.isArray(host)?host:host.split(",").map((x)=>x.split(":")[0]),port:Array.isArray(port)?port:host.split(",").map((x)=>parseInt(x.split(":")[1]||port)),path:o.path||host.indexOf("/")>-1&&host+"/.s.PGSQL."+port,database:o.database||o.db||(url.pathname||"").slice(1)||env3.PGDATABASE||user,user,pass:o.pass||o.password||url.password||env3.PGPASSWORD||"",...Object.entries(defaults).reduce((acc,[k2,d])=>{let value=k2 in o?o[k2]:(k2 in query)?query[k2]==="disable"||query[k2]==="false"?!1:query[k2]:env3["PG"+k2.toUpperCase()]||d;return acc[k2]=typeof value==="string"&&ints.includes(k2)?+value:value,acc},{}),connection:{application_name:env3.PGAPPNAME||"postgres.js",...o.connection,...Object.entries(query).reduce((acc,[k2,v])=>((k2 in defaults)||(acc[k2]=v),acc),{})},types:o.types||{},target_session_attrs:tsa(o,url,env3),onnotice:o.onnotice,onnotify:o.onnotify,onclose:o.onclose,onparameter:o.onparameter,socket:o.socket,transform:parseTransform(o.transform||{undefined:void 0}),parameters:{},shared:{retries:0,typeArrayMap:{}},...mergeUserTypes(o.types)}}function tsa(o,url,env3){let x=o.target_session_attrs||url.searchParams.get("target_session_attrs")||env3.PGTARGETSESSIONATTRS;if(!x||["read-write","read-only","primary","standby","prefer-standby"].includes(x))return x;throw new Error("target_session_attrs "+x+" is not supported")}function backoff(retries){return(0.5+Math.random()/2)*Math.min(3**retries/100,20)}function max_lifetime(){return 60*(30+Math.random()*30)}function parseTransform(x){return{undefined:x.undefined,column:{from:typeof x.column==="function"?x.column:x.column&&x.column.from,to:x.column&&x.column.to},value:{from:typeof x.value==="function"?x.value:x.value&&x.value.from,to:x.value&&x.value.to},row:{from:typeof x.row==="function"?x.row:x.row&&x.row.from,to:x.row&&x.row.to}}}function parseUrl(url){if(!url||typeof url!=="string")return{url:{searchParams:new Map}};let host=url;host=host.slice(host.indexOf("://")+3).split(/[?/]/)[0],host=decodeURIComponent(host.slice(host.indexOf("@")+1));let urlObj=new URL(url.replace(host,host.split(",")[0]));return{url:{username:decodeURIComponent(urlObj.username),password:decodeURIComponent(urlObj.password),host:urlObj.host,hostname:urlObj.hostname,port:urlObj.port,pathname:urlObj.pathname,searchParams:urlObj.searchParams},multihost:host.indexOf(",")>-1&&host}}function osUsername(){try{return os.userInfo().username}catch(_2){return process.env.USERNAME||process.env.USER||process.env.LOGNAME}}class SelectionProxyHandler{static[entityKind]="SelectionProxyHandler";config;constructor(config){this.config={...config}}get(subquery,prop){if(prop==="_")return{...subquery._,selectedFields:new Proxy(subquery._.selectedFields,this)};if(prop===ViewBaseConfig)return{...subquery[ViewBaseConfig],selectedFields:new Proxy(subquery[ViewBaseConfig].selectedFields,this)};if(typeof prop==="symbol")return subquery[prop];let value=(is(subquery,Subquery)?subquery._.selectedFields:is(subquery,View)?subquery[ViewBaseConfig].selectedFields:subquery)[prop];if(is(value,SQL.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!value.isSelectionField)return value.sql;let newValue=value.clone();return newValue.isSelectionField=!0,newValue}if(is(value,SQL)){if(this.config.sqlBehavior==="sql")return value;throw new Error(`You tried to reference "${prop}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}if(is(value,Column)){if(this.config.alias)return new Proxy(value,new ColumnAliasProxyHandler(new Proxy(value.table,new TableAliasProxyHandler(this.config.alias,this.config.replaceOriginalName??!1))));return value}if(typeof value!=="object"||value===null)return value;return new Proxy(value,new SelectionProxyHandler(this.config))}}class PgDeleteBase extends QueryPromise{constructor(table,session,dialect,withList){super();this.session=session,this.dialect=dialect,this.config={table,withList}}static[entityKind]="PgDelete";config;where(where){return this.config.where=where,this}returning(fields=this.config.table[Table.Symbol.Columns]){return this.config.returningFields=fields,this.config.returning=orderSelectedFields(fields),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:_typings,...rest}=this.dialect.sqlToQuery(this.getSQL());return rest}_prepare(name){return tracer.startActiveSpan("drizzle.prepareQuery",()=>{return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,name,!0)})}prepare(name){return this._prepare(name)}authToken;setToken(token){return this.authToken=token,this}execute=(placeholderValues)=>{return tracer.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(placeholderValues,this.authToken)})};getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new SelectionProxyHandler({alias:getTableName(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}function toSnakeCase(input){return(input.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map((word)=>word.toLowerCase()).join("_")}function toCamelCase(input){return(input.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((acc,word,i)=>{let formattedWord=i===0?word.toLowerCase():`${word[0].toUpperCase()}${word.slice(1)}`;return acc+formattedWord},"")}function noopCase(input){return input}class CasingCache{static[entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(casing){this.convert=casing==="snake_case"?toSnakeCase:casing==="camelCase"?toCamelCase:noopCase}getColumnCasing(column){if(!column.keyAsName)return column.name;let schema=column.table[Table.Symbol.Schema]??"public",tableName=column.table[Table.Symbol.OriginalName],key=`${schema}.${tableName}.${column.name}`;if(!this.cache[key])this.cacheTable(column.table);return this.cache[key]}cacheTable(table){let schema=table[Table.Symbol.Schema]??"public",tableName=table[Table.Symbol.OriginalName],tableKey=`${schema}.${tableName}`;if(!this.cachedTables[tableKey]){for(let column of Object.values(table[Table.Symbol.Columns])){let columnKey=`${tableKey}.${column.name}`;this.cache[columnKey]=this.convert(column.name)}this.cachedTables[tableKey]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class PgViewBase extends View{static[entityKind]="PgViewBase"}class PgDialect{static[entityKind]="PgDialect";casing;constructor(config){this.casing=new CasingCache(config?.casing)}async migrate(migrations,session,config){let migrationsTable=typeof config==="string"?"__drizzle_migrations":config.migrationsTable??"__drizzle_migrations",migrationsSchema=typeof config==="string"?"drizzle":config.migrationsSchema??"drizzle",migrationTableCreate=sql`
			CREATE TABLE IF NOT EXISTS ${sql.identifier(migrationsSchema)}.${sql.identifier(migrationsTable)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await session.execute(sql`CREATE SCHEMA IF NOT EXISTS ${sql.identifier(migrationsSchema)}`),await session.execute(migrationTableCreate);let lastDbMigration=(await session.all(sql`select id, hash, created_at from ${sql.identifier(migrationsSchema)}.${sql.identifier(migrationsTable)} order by created_at desc limit 1`))[0];await session.transaction(async(tx)=>{for await(let migration of migrations)if(!lastDbMigration||Number(lastDbMigration.created_at)<migration.folderMillis){for(let stmt of migration.sql)await tx.execute(sql.raw(stmt));await tx.execute(sql`insert into ${sql.identifier(migrationsSchema)}.${sql.identifier(migrationsTable)} ("hash", "created_at") values(${migration.hash}, ${migration.folderMillis})`)}})}escapeName(name){return`"${name}"`}escapeParam(num){return`$${num+1}`}escapeString(str){return`'${str.replace(/'/g,"''")}'`}buildWithCTE(queries){if(!queries?.length)return;let withSqlChunks=[sql`with `];for(let[i,w]of queries.entries())if(withSqlChunks.push(sql`${sql.identifier(w._.alias)} as (${w._.sql})`),i<queries.length-1)withSqlChunks.push(sql`, `);return withSqlChunks.push(sql` `),sql.join(withSqlChunks)}buildDeleteQuery({table,where,returning,withList}){let withSql=this.buildWithCTE(withList),returningSql=returning?sql` returning ${this.buildSelection(returning,{isSingleTable:!0})}`:void 0,whereSql=where?sql` where ${where}`:void 0;return sql`${withSql}delete from ${table}${whereSql}${returningSql}`}buildUpdateSet(table,set2){let tableColumns=table[Table.Symbol.Columns],columnNames=Object.keys(tableColumns).filter((colName)=>set2[colName]!==void 0||tableColumns[colName]?.onUpdateFn!==void 0),setSize=columnNames.length;return sql.join(columnNames.flatMap((colName,i)=>{let col=tableColumns[colName],value=set2[colName]??sql.param(col.onUpdateFn(),col),res=sql`${sql.identifier(this.casing.getColumnCasing(col))} = ${value}`;if(i<setSize-1)return[res,sql.raw(", ")];return[res]}))}buildUpdateQuery({table,set:set2,where,returning,withList,from,joins}){let withSql=this.buildWithCTE(withList),tableName=table[PgTable.Symbol.Name],tableSchema=table[PgTable.Symbol.Schema],origTableName=table[PgTable.Symbol.OriginalName],alias=tableName===origTableName?void 0:tableName,tableSql=sql`${tableSchema?sql`${sql.identifier(tableSchema)}.`:void 0}${sql.identifier(origTableName)}${alias&&sql` ${sql.identifier(alias)}`}`,setSql=this.buildUpdateSet(table,set2),fromSql=from&&sql.join([sql.raw(" from "),this.buildFromTable(from)]),joinsSql=this.buildJoins(joins),returningSql=returning?sql` returning ${this.buildSelection(returning,{isSingleTable:!from})}`:void 0,whereSql=where?sql` where ${where}`:void 0;return sql`${withSql}update ${tableSql} set ${setSql}${fromSql}${joinsSql}${whereSql}${returningSql}`}buildSelection(fields,{isSingleTable=!1}={}){let columnsLen=fields.length,chunks=fields.flatMap(({field},i)=>{let chunk=[];if(is(field,SQL.Aliased)&&field.isSelectionField)chunk.push(sql.identifier(field.fieldAlias));else if(is(field,SQL.Aliased)||is(field,SQL)){let query=is(field,SQL.Aliased)?field.sql:field;if(isSingleTable)chunk.push(new SQL(query.queryChunks.map((c)=>{if(is(c,PgColumn))return sql.identifier(this.casing.getColumnCasing(c));return c})));else chunk.push(query);if(is(field,SQL.Aliased))chunk.push(sql` as ${sql.identifier(field.fieldAlias)}`)}else if(is(field,Column))if(isSingleTable)chunk.push(sql.identifier(this.casing.getColumnCasing(field)));else chunk.push(field);if(i<columnsLen-1)chunk.push(sql`, `);return chunk});return sql.join(chunks)}buildJoins(joins){if(!joins||joins.length===0)return;let joinsArray=[];for(let[index,joinMeta]of joins.entries()){if(index===0)joinsArray.push(sql` `);let table=joinMeta.table,lateralSql=joinMeta.lateral?sql` lateral`:void 0,onSql=joinMeta.on?sql` on ${joinMeta.on}`:void 0;if(is(table,PgTable)){let tableName=table[PgTable.Symbol.Name],tableSchema=table[PgTable.Symbol.Schema],origTableName=table[PgTable.Symbol.OriginalName],alias=tableName===origTableName?void 0:joinMeta.alias;joinsArray.push(sql`${sql.raw(joinMeta.joinType)} join${lateralSql} ${tableSchema?sql`${sql.identifier(tableSchema)}.`:void 0}${sql.identifier(origTableName)}${alias&&sql` ${sql.identifier(alias)}`}${onSql}`)}else if(is(table,View)){let viewName=table[ViewBaseConfig].name,viewSchema=table[ViewBaseConfig].schema,origViewName=table[ViewBaseConfig].originalName,alias=viewName===origViewName?void 0:joinMeta.alias;joinsArray.push(sql`${sql.raw(joinMeta.joinType)} join${lateralSql} ${viewSchema?sql`${sql.identifier(viewSchema)}.`:void 0}${sql.identifier(origViewName)}${alias&&sql` ${sql.identifier(alias)}`}${onSql}`)}else joinsArray.push(sql`${sql.raw(joinMeta.joinType)} join${lateralSql} ${table}${onSql}`);if(index<joins.length-1)joinsArray.push(sql` `)}return sql.join(joinsArray)}buildFromTable(table){if(is(table,Table)&&table[Table.Symbol.IsAlias]){let fullName=sql`${sql.identifier(table[Table.Symbol.OriginalName])}`;if(table[Table.Symbol.Schema])fullName=sql`${sql.identifier(table[Table.Symbol.Schema])}.${fullName}`;return sql`${fullName} ${sql.identifier(table[Table.Symbol.Name])}`}return table}buildSelectQuery({withList,fields,fieldsFlat,where,having,table,joins,orderBy,groupBy,limit,offset,lockingClause,distinct,setOperators}){let fieldsList=fieldsFlat??orderSelectedFields(fields);for(let f of fieldsList)if(is(f.field,Column)&&getTableName(f.field.table)!==(is(table,Subquery)?table._.alias:is(table,PgViewBase)?table[ViewBaseConfig].name:is(table,SQL)?void 0:getTableName(table))&&!((table2)=>joins?.some(({alias})=>alias===(table2[Table.Symbol.IsAlias]?getTableName(table2):table2[Table.Symbol.BaseName])))(f.field.table)){let tableName=getTableName(f.field.table);throw new Error(`Your "${f.path.join("->")}" field references a column "${tableName}"."${f.field.name}", but the table "${tableName}" is not part of the query! Did you forget to join it?`)}let isSingleTable=!joins||joins.length===0,withSql=this.buildWithCTE(withList),distinctSql;if(distinct)distinctSql=distinct===!0?sql` distinct`:sql` distinct on (${sql.join(distinct.on,sql`, `)})`;let selection=this.buildSelection(fieldsList,{isSingleTable}),tableSql=this.buildFromTable(table),joinsSql=this.buildJoins(joins),whereSql=where?sql` where ${where}`:void 0,havingSql=having?sql` having ${having}`:void 0,orderBySql;if(orderBy&&orderBy.length>0)orderBySql=sql` order by ${sql.join(orderBy,sql`, `)}`;let groupBySql;if(groupBy&&groupBy.length>0)groupBySql=sql` group by ${sql.join(groupBy,sql`, `)}`;let limitSql=typeof limit==="object"||typeof limit==="number"&&limit>=0?sql` limit ${limit}`:void 0,offsetSql=offset?sql` offset ${offset}`:void 0,lockingClauseSql=sql.empty();if(lockingClause){let clauseSql=sql` for ${sql.raw(lockingClause.strength)}`;if(lockingClause.config.of)clauseSql.append(sql` of ${sql.join(Array.isArray(lockingClause.config.of)?lockingClause.config.of:[lockingClause.config.of],sql`, `)}`);if(lockingClause.config.noWait)clauseSql.append(sql` nowait`);else if(lockingClause.config.skipLocked)clauseSql.append(sql` skip locked`);lockingClauseSql.append(clauseSql)}let finalQuery=sql`${withSql}select${distinctSql} ${selection} from ${tableSql}${joinsSql}${whereSql}${groupBySql}${havingSql}${orderBySql}${limitSql}${offsetSql}${lockingClauseSql}`;if(setOperators.length>0)return this.buildSetOperations(finalQuery,setOperators);return finalQuery}buildSetOperations(leftSelect,setOperators){let[setOperator,...rest]=setOperators;if(!setOperator)throw new Error("Cannot pass undefined values to any set operator");if(rest.length===0)return this.buildSetOperationQuery({leftSelect,setOperator});return this.buildSetOperations(this.buildSetOperationQuery({leftSelect,setOperator}),rest)}buildSetOperationQuery({leftSelect,setOperator:{type:type2,isAll,rightSelect,limit,orderBy,offset}}){let leftChunk=sql`(${leftSelect.getSQL()}) `,rightChunk=sql`(${rightSelect.getSQL()})`,orderBySql;if(orderBy&&orderBy.length>0){let orderByValues=[];for(let singleOrderBy of orderBy)if(is(singleOrderBy,PgColumn))orderByValues.push(sql.identifier(singleOrderBy.name));else if(is(singleOrderBy,SQL)){for(let i=0;i<singleOrderBy.queryChunks.length;i++){let chunk=singleOrderBy.queryChunks[i];if(is(chunk,PgColumn))singleOrderBy.queryChunks[i]=sql.identifier(chunk.name)}orderByValues.push(sql`${singleOrderBy}`)}else orderByValues.push(sql`${singleOrderBy}`);orderBySql=sql` order by ${sql.join(orderByValues,sql`, `)} `}let limitSql=typeof limit==="object"||typeof limit==="number"&&limit>=0?sql` limit ${limit}`:void 0,operatorChunk=sql.raw(`${type2} ${isAll?"all ":""}`),offsetSql=offset?sql` offset ${offset}`:void 0;return sql`${leftChunk}${operatorChunk}${rightChunk}${orderBySql}${limitSql}${offsetSql}`}buildInsertQuery({table,values:valuesOrSelect,onConflict,returning,withList,select:select2,overridingSystemValue_}){let valuesSqlList=[],columns=table[Table.Symbol.Columns],colEntries=Object.entries(columns).filter(([_2,col])=>!col.shouldDisableInsert()),insertOrder=colEntries.map(([,column])=>sql.identifier(this.casing.getColumnCasing(column)));if(select2){let select22=valuesOrSelect;if(is(select22,SQL))valuesSqlList.push(select22);else valuesSqlList.push(select22.getSQL())}else{let values2=valuesOrSelect;valuesSqlList.push(sql.raw("values "));for(let[valueIndex,value]of values2.entries()){let valueList=[];for(let[fieldName,col]of colEntries){let colValue=value[fieldName];if(colValue===void 0||is(colValue,Param)&&colValue.value===void 0)if(col.defaultFn!==void 0){let defaultFnResult=col.defaultFn(),defaultValue=is(defaultFnResult,SQL)?defaultFnResult:sql.param(defaultFnResult,col);valueList.push(defaultValue)}else if(!col.default&&col.onUpdateFn!==void 0){let onUpdateFnResult=col.onUpdateFn(),newValue=is(onUpdateFnResult,SQL)?onUpdateFnResult:sql.param(onUpdateFnResult,col);valueList.push(newValue)}else valueList.push(sql`default`);else valueList.push(colValue)}if(valuesSqlList.push(valueList),valueIndex<values2.length-1)valuesSqlList.push(sql`, `)}}let withSql=this.buildWithCTE(withList),valuesSql=sql.join(valuesSqlList),returningSql=returning?sql` returning ${this.buildSelection(returning,{isSingleTable:!0})}`:void 0,onConflictSql=onConflict?sql` on conflict ${onConflict}`:void 0,overridingSql=overridingSystemValue_===!0?sql`overriding system value `:void 0;return sql`${withSql}insert into ${table} ${insertOrder} ${overridingSql}${valuesSql}${onConflictSql}${returningSql}`}buildRefreshMaterializedViewQuery({view,concurrently,withNoData}){let concurrentlySql=concurrently?sql` concurrently`:void 0,withNoDataSql=withNoData?sql` with no data`:void 0;return sql`refresh materialized view${concurrentlySql} ${view}${withNoDataSql}`}prepareTyping(encoder2){if(is(encoder2,PgJsonb)||is(encoder2,PgJson))return"json";else if(is(encoder2,PgNumeric))return"decimal";else if(is(encoder2,PgTime))return"time";else if(is(encoder2,PgTimestamp)||is(encoder2,PgTimestampString))return"timestamp";else if(is(encoder2,PgDate)||is(encoder2,PgDateString))return"date";else if(is(encoder2,PgUUID))return"uuid";else return"none"}sqlToQuery(sql2,invokeSource){return sql2.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource})}buildRelationalQueryWithoutPK({fullSchema,schema,tableNamesMap,table,tableConfig,queryConfig:config,tableAlias,nestedQueryRelation,joinOn}){let selection=[],limit,offset,orderBy=[],where,joins=[];if(config===!0)selection=Object.entries(tableConfig.columns).map(([key,value])=>({dbKey:value.name,tsKey:key,field:aliasedTableColumn(value,tableAlias),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let aliasedColumns=Object.fromEntries(Object.entries(tableConfig.columns).map(([key,value])=>[key,aliasedTableColumn(value,tableAlias)]));if(config.where){let whereSql=typeof config.where==="function"?config.where(aliasedColumns,getOperators()):config.where;where=whereSql&&mapColumnsInSQLToAlias(whereSql,tableAlias)}let fieldsSelection=[],selectedColumns=[];if(config.columns){let isIncludeMode=!1;for(let[field,value]of Object.entries(config.columns)){if(value===void 0)continue;if(field in tableConfig.columns){if(!isIncludeMode&&value===!0)isIncludeMode=!0;selectedColumns.push(field)}}if(selectedColumns.length>0)selectedColumns=isIncludeMode?selectedColumns.filter((c)=>config.columns?.[c]===!0):Object.keys(tableConfig.columns).filter((key)=>!selectedColumns.includes(key))}else selectedColumns=Object.keys(tableConfig.columns);for(let field of selectedColumns){let column=tableConfig.columns[field];fieldsSelection.push({tsKey:field,value:column})}let selectedRelations=[];if(config.with)selectedRelations=Object.entries(config.with).filter((entry)=>!!entry[1]).map(([tsKey,queryConfig])=>({tsKey,queryConfig,relation:tableConfig.relations[tsKey]}));let extras;if(config.extras){extras=typeof config.extras==="function"?config.extras(aliasedColumns,{sql}):config.extras;for(let[tsKey,value]of Object.entries(extras))fieldsSelection.push({tsKey,value:mapColumnsInAliasedSQLToAlias(value,tableAlias)})}for(let{tsKey,value}of fieldsSelection)selection.push({dbKey:is(value,SQL.Aliased)?value.fieldAlias:tableConfig.columns[tsKey].name,tsKey,field:is(value,Column)?aliasedTableColumn(value,tableAlias):value,relationTableTsKey:void 0,isJson:!1,selection:[]});let orderByOrig=typeof config.orderBy==="function"?config.orderBy(aliasedColumns,getOrderByOperators()):config.orderBy??[];if(!Array.isArray(orderByOrig))orderByOrig=[orderByOrig];orderBy=orderByOrig.map((orderByValue)=>{if(is(orderByValue,Column))return aliasedTableColumn(orderByValue,tableAlias);return mapColumnsInSQLToAlias(orderByValue,tableAlias)}),limit=config.limit,offset=config.offset;for(let{tsKey:selectedRelationTsKey,queryConfig:selectedRelationConfigValue,relation}of selectedRelations){let normalizedRelation=normalizeRelation(schema,tableNamesMap,relation),relationTableName=getTableUniqueName(relation.referencedTable),relationTableTsName=tableNamesMap[relationTableName],relationTableAlias=`${tableAlias}_${selectedRelationTsKey}`,joinOn2=and(...normalizedRelation.fields.map((field2,i)=>eq(aliasedTableColumn(normalizedRelation.references[i],relationTableAlias),aliasedTableColumn(field2,tableAlias)))),builtRelation=this.buildRelationalQueryWithoutPK({fullSchema,schema,tableNamesMap,table:fullSchema[relationTableTsName],tableConfig:schema[relationTableTsName],queryConfig:is(relation,One)?selectedRelationConfigValue===!0?{limit:1}:{...selectedRelationConfigValue,limit:1}:selectedRelationConfigValue,tableAlias:relationTableAlias,joinOn:joinOn2,nestedQueryRelation:relation}),field=sql`${sql.identifier(relationTableAlias)}.${sql.identifier("data")}`.as(selectedRelationTsKey);joins.push({on:sql`true`,table:new Subquery(builtRelation.sql,{},relationTableAlias),alias:relationTableAlias,joinType:"left",lateral:!0}),selection.push({dbKey:selectedRelationTsKey,tsKey:selectedRelationTsKey,field,relationTableTsKey:relationTableTsName,isJson:!0,selection:builtRelation.selection})}}if(selection.length===0)throw new DrizzleError({message:`No fields selected for table "${tableConfig.tsName}" ("${tableAlias}")`});let result;if(where=and(joinOn,where),nestedQueryRelation){let field=sql`json_build_array(${sql.join(selection.map(({field:field2,tsKey,isJson})=>isJson?sql`${sql.identifier(`${tableAlias}_${tsKey}`)}.${sql.identifier("data")}`:is(field2,SQL.Aliased)?field2.sql:field2),sql`, `)})`;if(is(nestedQueryRelation,Many))field=sql`coalesce(json_agg(${field}${orderBy.length>0?sql` order by ${sql.join(orderBy,sql`, `)}`:void 0}), '[]'::json)`;let nestedSelection=[{dbKey:"data",tsKey:"data",field:field.as("data"),isJson:!0,relationTableTsKey:tableConfig.tsName,selection}];if(limit!==void 0||offset!==void 0||orderBy.length>0)result=this.buildSelectQuery({table:aliasedTable(table,tableAlias),fields:{},fieldsFlat:[{path:[],field:sql.raw("*")}],where,limit,offset,orderBy,setOperators:[]}),where=void 0,limit=void 0,offset=void 0,orderBy=[];else result=aliasedTable(table,tableAlias);result=this.buildSelectQuery({table:is(result,PgTable)?result:new Subquery(result,{},tableAlias),fields:{},fieldsFlat:nestedSelection.map(({field:field2})=>({path:[],field:is(field2,Column)?aliasedTableColumn(field2,tableAlias):field2})),joins,where,limit,offset,orderBy,setOperators:[]})}else result=this.buildSelectQuery({table:aliasedTable(table,tableAlias),fields:{},fieldsFlat:selection.map(({field})=>({path:[],field:is(field,Column)?aliasedTableColumn(field,tableAlias):field})),joins,where,limit,offset,orderBy,setOperators:[]});return{tableTsKey:tableConfig.tsName,sql:result,selection}}}class TypedQueryBuilder{static[entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class PgSelectBuilder{static[entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(config){if(this.fields=config.fields,this.session=config.session,this.dialect=config.dialect,config.withList)this.withList=config.withList;this.distinct=config.distinct}authToken;setToken(token){return this.authToken=token,this}from(source){let isPartialSelect=!!this.fields,src=source,fields;if(this.fields)fields=this.fields;else if(is(src,Subquery))fields=Object.fromEntries(Object.keys(src._.selectedFields).map((key)=>[key,src[key]]));else if(is(src,PgViewBase))fields=src[ViewBaseConfig].selectedFields;else if(is(src,SQL))fields={};else fields=getTableColumns(src);return new PgSelectBase({table:src,fields,isPartialSelect,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class PgSelectQueryBuilderBase extends TypedQueryBuilder{static[entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table,fields,isPartialSelect,session,dialect,withList,distinct}){super();this.config={withList,table,fields:{...fields},distinct,setOperators:[]},this.isPartialSelect=isPartialSelect,this.session=session,this.dialect=dialect,this._={selectedFields:fields},this.tableName=getTableLikeName(table),this.joinsNotNullableMap=typeof this.tableName==="string"?{[this.tableName]:!0}:{}}createJoin(joinType,lateral){return(table,on)=>{let baseTableName=this.tableName,tableName=getTableLikeName(table);if(typeof tableName==="string"&&this.config.joins?.some((join)=>join.alias===tableName))throw new Error(`Alias "${tableName}" is already used in this query`);if(!this.isPartialSelect){if(Object.keys(this.joinsNotNullableMap).length===1&&typeof baseTableName==="string")this.config.fields={[baseTableName]:this.config.fields};if(typeof tableName==="string"&&!is(table,SQL)){let selection=is(table,Subquery)?table._.selectedFields:is(table,View)?table[ViewBaseConfig].selectedFields:table[Table.Symbol.Columns];this.config.fields[tableName]=selection}}if(typeof on==="function")on=on(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})));if(!this.config.joins)this.config.joins=[];if(this.config.joins.push({on,table,joinType,alias:tableName,lateral}),typeof tableName==="string")switch(joinType){case"left":{this.joinsNotNullableMap[tableName]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([key])=>[key,!1])),this.joinsNotNullableMap[tableName]=!0;break}case"cross":case"inner":{this.joinsNotNullableMap[tableName]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([key])=>[key,!1])),this.joinsNotNullableMap[tableName]=!1;break}}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(type2,isAll){return(rightSelection)=>{let rightSelect=typeof rightSelection==="function"?rightSelection(getPgSetOperators()):rightSelection;if(!haveSameKeys(this.getSelectedFields(),rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:type2,isAll,rightSelect}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(setOperators){return this.config.setOperators.push(...setOperators),this}where(where){if(typeof where==="function")where=where(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})));return this.config.where=where,this}having(having){if(typeof having==="function")having=having(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})));return this.config.having=having,this}groupBy(...columns){if(typeof columns[0]==="function"){let groupBy=columns[0](new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(groupBy)?groupBy:[groupBy]}else this.config.groupBy=columns;return this}orderBy(...columns){if(typeof columns[0]==="function"){let orderBy=columns[0](new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),orderByArray=Array.isArray(orderBy)?orderBy:[orderBy];if(this.config.setOperators.length>0)this.config.setOperators.at(-1).orderBy=orderByArray;else this.config.orderBy=orderByArray}else{let orderByArray=columns;if(this.config.setOperators.length>0)this.config.setOperators.at(-1).orderBy=orderByArray;else this.config.orderBy=orderByArray}return this}limit(limit){if(this.config.setOperators.length>0)this.config.setOperators.at(-1).limit=limit;else this.config.limit=limit;return this}offset(offset){if(this.config.setOperators.length>0)this.config.setOperators.at(-1).offset=offset;else this.config.offset=offset;return this}for(strength,config={}){return this.config.lockingClause={strength,config},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:_typings,...rest}=this.dialect.sqlToQuery(this.getSQL());return rest}as(alias){return new Proxy(new Subquery(this.getSQL(),this.config.fields,alias),new SelectionProxyHandler({alias,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class PgSelectBase extends PgSelectQueryBuilderBase{static[entityKind]="PgSelect";_prepare(name){let{session,config,dialect,joinsNotNullableMap,authToken}=this;if(!session)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return tracer.startActiveSpan("drizzle.prepareQuery",()=>{let fieldsList=orderSelectedFields(config.fields),query=session.prepareQuery(dialect.sqlToQuery(this.getSQL()),fieldsList,name,!0);return query.joinsNotNullableMap=joinsNotNullableMap,query.setToken(authToken)})}prepare(name){return this._prepare(name)}authToken;setToken(token){return this.authToken=token,this}execute=(placeholderValues)=>{return tracer.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(placeholderValues,this.authToken)})}}applyMixins(PgSelectBase,[QueryPromise]);function createSetOperator(type2,isAll){return(leftSelect,rightSelect,...restSelects)=>{let setOperators=[rightSelect,...restSelects].map((select2)=>({type:type2,isAll,rightSelect:select2}));for(let setOperator of setOperators)if(!haveSameKeys(leftSelect.getSelectedFields(),setOperator.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return leftSelect.addSetOperators(setOperators)}}var getPgSetOperators=()=>({union,unionAll,intersect,intersectAll,except,exceptAll}),union=createSetOperator("union",!1),unionAll=createSetOperator("union",!0),intersect=createSetOperator("intersect",!1),intersectAll=createSetOperator("intersect",!0),except=createSetOperator("except",!1),exceptAll=createSetOperator("except",!0);class QueryBuilder{static[entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(dialect){this.dialect=is(dialect,PgDialect)?dialect:void 0,this.dialectConfig=is(dialect,PgDialect)?void 0:dialect}$with=(alias,selection)=>{let queryBuilder=this;return{as:(qb)=>{if(typeof qb==="function")qb=qb(queryBuilder);return new Proxy(new WithSubquery(qb.getSQL(),selection??("getSelectedFields"in qb?qb.getSelectedFields()??{}:{}),alias,!0),new SelectionProxyHandler({alias,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}};with(...queries){let self2=this;function select2(fields){return new PgSelectBuilder({fields:fields??void 0,session:void 0,dialect:self2.getDialect(),withList:queries})}function selectDistinct(fields){return new PgSelectBuilder({fields:fields??void 0,session:void 0,dialect:self2.getDialect(),distinct:!0})}function selectDistinctOn(on,fields){return new PgSelectBuilder({fields:fields??void 0,session:void 0,dialect:self2.getDialect(),distinct:{on}})}return{select:select2,selectDistinct,selectDistinctOn}}select(fields){return new PgSelectBuilder({fields:fields??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(fields){return new PgSelectBuilder({fields:fields??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(on,fields){return new PgSelectBuilder({fields:fields??void 0,session:void 0,dialect:this.getDialect(),distinct:{on}})}getDialect(){if(!this.dialect)this.dialect=new PgDialect(this.dialectConfig);return this.dialect}}class PgInsertBuilder{constructor(table,session,dialect,withList,overridingSystemValue_){this.table=table,this.session=session,this.dialect=dialect,this.withList=withList,this.overridingSystemValue_=overridingSystemValue_}static[entityKind]="PgInsertBuilder";authToken;setToken(token){return this.authToken=token,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(values2){if(values2=Array.isArray(values2)?values2:[values2],values2.length===0)throw new Error("values() must be called with at least one value");let mappedValues=values2.map((entry)=>{let result={},cols=this.table[Table.Symbol.Columns];for(let colKey of Object.keys(entry)){let colValue=entry[colKey];result[colKey]=is(colValue,SQL)?colValue:new Param(colValue,cols[colKey])}return result});return new PgInsertBase(this.table,mappedValues,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(selectQuery){let select2=typeof selectQuery==="function"?selectQuery(new QueryBuilder):selectQuery;if(!is(select2,SQL)&&!haveSameKeys(this.table[Columns],select2._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new PgInsertBase(this.table,select2,this.session,this.dialect,this.withList,!0)}}class PgInsertBase extends QueryPromise{constructor(table,values2,session,dialect,withList,select2,overridingSystemValue_){super();this.session=session,this.dialect=dialect,this.config={table,values:values2,withList,select:select2,overridingSystemValue_}}static[entityKind]="PgInsert";config;returning(fields=this.config.table[Table.Symbol.Columns]){return this.config.returningFields=fields,this.config.returning=orderSelectedFields(fields),this}onConflictDoNothing(config={}){if(config.target===void 0)this.config.onConflict=sql`do nothing`;else{let targetColumn="";targetColumn=Array.isArray(config.target)?config.target.map((it)=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(it))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(config.target));let whereSql=config.where?sql` where ${config.where}`:void 0;this.config.onConflict=sql`(${sql.raw(targetColumn)})${whereSql} do nothing`}return this}onConflictDoUpdate(config){if(config.where&&(config.targetWhere||config.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let whereSql=config.where?sql` where ${config.where}`:void 0,targetWhereSql=config.targetWhere?sql` where ${config.targetWhere}`:void 0,setWhereSql=config.setWhere?sql` where ${config.setWhere}`:void 0,setSql=this.dialect.buildUpdateSet(this.config.table,mapUpdateSet(this.config.table,config.set)),targetColumn="";return targetColumn=Array.isArray(config.target)?config.target.map((it)=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(it))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(config.target)),this.config.onConflict=sql`(${sql.raw(targetColumn)})${targetWhereSql} do update set ${setSql}${whereSql}${setWhereSql}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:_typings,...rest}=this.dialect.sqlToQuery(this.getSQL());return rest}_prepare(name){return tracer.startActiveSpan("drizzle.prepareQuery",()=>{return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,name,!0)})}prepare(name){return this._prepare(name)}authToken;setToken(token){return this.authToken=token,this}execute=(placeholderValues)=>{return tracer.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(placeholderValues,this.authToken)})};getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new SelectionProxyHandler({alias:getTableName(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class PgRefreshMaterializedView extends QueryPromise{constructor(view,session,dialect){super();this.session=session,this.dialect=dialect,this.config={view}}static[entityKind]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:_typings,...rest}=this.dialect.sqlToQuery(this.getSQL());return rest}_prepare(name){return tracer.startActiveSpan("drizzle.prepareQuery",()=>{return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,name,!0)})}prepare(name){return this._prepare(name)}authToken;setToken(token){return this.authToken=token,this}execute=(placeholderValues)=>{return tracer.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(placeholderValues,this.authToken)})}}class PgUpdateBuilder{constructor(table,session,dialect,withList){this.table=table,this.session=session,this.dialect=dialect,this.withList=withList}static[entityKind]="PgUpdateBuilder";authToken;setToken(token){return this.authToken=token,this}set(values2){return new PgUpdateBase(this.table,mapUpdateSet(this.table,values2),this.session,this.dialect,this.withList).setToken(this.authToken)}}class PgUpdateBase extends QueryPromise{constructor(table,set2,session,dialect,withList){super();this.session=session,this.dialect=dialect,this.config={set:set2,table,withList,joins:[]},this.tableName=getTableLikeName(table),this.joinsNotNullableMap=typeof this.tableName==="string"?{[this.tableName]:!0}:{}}static[entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;from(source){let src=source,tableName=getTableLikeName(src);if(typeof tableName==="string")this.joinsNotNullableMap[tableName]=!0;return this.config.from=src,this}getTableLikeFields(table){if(is(table,PgTable))return table[Table.Symbol.Columns];else if(is(table,Subquery))return table._.selectedFields;return table[ViewBaseConfig].selectedFields}createJoin(joinType){return(table,on)=>{let tableName=getTableLikeName(table);if(typeof tableName==="string"&&this.config.joins.some((join)=>join.alias===tableName))throw new Error(`Alias "${tableName}" is already used in this query`);if(typeof on==="function"){let from=this.config.from&&!is(this.config.from,SQL)?this.getTableLikeFields(this.config.from):void 0;on=on(new Proxy(this.config.table[Table.Symbol.Columns],new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),from&&new Proxy(from,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on,table,joinType,alias:tableName}),typeof tableName==="string")switch(joinType){case"left":{this.joinsNotNullableMap[tableName]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([key])=>[key,!1])),this.joinsNotNullableMap[tableName]=!0;break}case"inner":{this.joinsNotNullableMap[tableName]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([key])=>[key,!1])),this.joinsNotNullableMap[tableName]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(where){return this.config.where=where,this}returning(fields){if(!fields){if(fields=Object.assign({},this.config.table[Table.Symbol.Columns]),this.config.from){let tableName=getTableLikeName(this.config.from);if(typeof tableName==="string"&&this.config.from&&!is(this.config.from,SQL)){let fromFields=this.getTableLikeFields(this.config.from);fields[tableName]=fromFields}for(let join of this.config.joins){let tableName2=getTableLikeName(join.table);if(typeof tableName2==="string"&&!is(join.table,SQL)){let fromFields=this.getTableLikeFields(join.table);fields[tableName2]=fromFields}}}}return this.config.returningFields=fields,this.config.returning=orderSelectedFields(fields),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:_typings,...rest}=this.dialect.sqlToQuery(this.getSQL());return rest}_prepare(name){let query=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,name,!0);return query.joinsNotNullableMap=this.joinsNotNullableMap,query}prepare(name){return this._prepare(name)}authToken;setToken(token){return this.authToken=token,this}execute=(placeholderValues)=>{return this._prepare().execute(placeholderValues,this.authToken)};getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new SelectionProxyHandler({alias:getTableName(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class PgCountBuilder extends SQL{constructor(params){super(PgCountBuilder.buildEmbeddedCount(params.source,params.filters).queryChunks);this.params=params,this.mapWith(Number),this.session=params.session,this.sql=PgCountBuilder.buildCount(params.source,params.filters)}sql;token;static[entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(source,filters){return sql`(select count(*) from ${source}${sql.raw(" where ").if(filters)}${filters})`}static buildCount(source,filters){return sql`select count(*) as count from ${source}${sql.raw(" where ").if(filters)}${filters};`}setToken(token){return this.token=token,this}then(onfulfilled,onrejected){return Promise.resolve(this.session.count(this.sql,this.token)).then(onfulfilled,onrejected)}catch(onRejected){return this.then(void 0,onRejected)}finally(onFinally){return this.then((value)=>{return onFinally?.(),value},(reason)=>{throw onFinally?.(),reason})}}class RelationalQueryBuilder{constructor(fullSchema,schema,tableNamesMap,table,tableConfig,dialect,session){this.fullSchema=fullSchema,this.schema=schema,this.tableNamesMap=tableNamesMap,this.table=table,this.tableConfig=tableConfig,this.dialect=dialect,this.session=session}static[entityKind]="PgRelationalQueryBuilder";findMany(config){return new PgRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,config?config:{},"many")}findFirst(config){return new PgRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,config?{...config,limit:1}:{limit:1},"first")}}class PgRelationalQuery extends QueryPromise{constructor(fullSchema,schema,tableNamesMap,table,tableConfig,dialect,session,config,mode){super();this.fullSchema=fullSchema,this.schema=schema,this.tableNamesMap=tableNamesMap,this.table=table,this.tableConfig=tableConfig,this.dialect=dialect,this.session=session,this.config=config,this.mode=mode}static[entityKind]="PgRelationalQuery";_prepare(name){return tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query,builtQuery}=this._toSQL();return this.session.prepareQuery(builtQuery,void 0,name,!0,(rawRows,mapColumnValue)=>{let rows=rawRows.map((row)=>mapRelationalRow(this.schema,this.tableConfig,row,query.selection,mapColumnValue));if(this.mode==="first")return rows[0];return rows})})}prepare(name){return this._prepare(name)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let query=this._getQuery(),builtQuery=this.dialect.sqlToQuery(query.sql);return{query,builtQuery}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(token){return this.authToken=token,this}execute(){return tracer.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(void 0,this.authToken)})}}class PgRaw extends QueryPromise{constructor(execute,sql2,query,mapBatchResult){super();this.execute=execute,this.sql=sql2,this.query=query,this.mapBatchResult=mapBatchResult}static[entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(result,isFromBatch){return isFromBatch?this.mapBatchResult(result):result}_prepare(){return this}isResponseInArrayMode(){return!1}}class PgDatabase{constructor(dialect,session,schema){if(this.dialect=dialect,this.session=session,this._=schema?{schema:schema.schema,fullSchema:schema.fullSchema,tableNamesMap:schema.tableNamesMap,session}:{schema:void 0,fullSchema:{},tableNamesMap:{},session},this.query={},this._.schema)for(let[tableName,columns]of Object.entries(this._.schema))this.query[tableName]=new RelationalQueryBuilder(schema.fullSchema,this._.schema,this._.tableNamesMap,schema.fullSchema[tableName],columns,dialect,session)}static[entityKind]="PgDatabase";query;$with=(alias,selection)=>{let self2=this;return{as:(qb)=>{if(typeof qb==="function")qb=qb(new QueryBuilder(self2.dialect));return new Proxy(new WithSubquery(qb.getSQL(),selection??("getSelectedFields"in qb?qb.getSelectedFields()??{}:{}),alias,!0),new SelectionProxyHandler({alias,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}};$count(source,filters){return new PgCountBuilder({source,filters,session:this.session})}with(...queries){let self2=this;function select2(fields){return new PgSelectBuilder({fields:fields??void 0,session:self2.session,dialect:self2.dialect,withList:queries})}function selectDistinct(fields){return new PgSelectBuilder({fields:fields??void 0,session:self2.session,dialect:self2.dialect,withList:queries,distinct:!0})}function selectDistinctOn(on,fields){return new PgSelectBuilder({fields:fields??void 0,session:self2.session,dialect:self2.dialect,withList:queries,distinct:{on}})}function update(table){return new PgUpdateBuilder(table,self2.session,self2.dialect,queries)}function insert(table){return new PgInsertBuilder(table,self2.session,self2.dialect,queries)}function delete_(table){return new PgDeleteBase(table,self2.session,self2.dialect,queries)}return{select:select2,selectDistinct,selectDistinctOn,update,insert,delete:delete_}}select(fields){return new PgSelectBuilder({fields:fields??void 0,session:this.session,dialect:this.dialect})}selectDistinct(fields){return new PgSelectBuilder({fields:fields??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(on,fields){return new PgSelectBuilder({fields:fields??void 0,session:this.session,dialect:this.dialect,distinct:{on}})}update(table){return new PgUpdateBuilder(table,this.session,this.dialect)}insert(table){return new PgInsertBuilder(table,this.session,this.dialect)}delete(table){return new PgDeleteBase(table,this.session,this.dialect)}refreshMaterializedView(view){return new PgRefreshMaterializedView(view,this.session,this.dialect)}authToken;execute(query){let sequel=typeof query==="string"?sql.raw(query):query.getSQL(),builtQuery=this.dialect.sqlToQuery(sequel),prepared=this.session.prepareQuery(builtQuery,void 0,void 0,!1);return new PgRaw(()=>prepared.execute(void 0,this.authToken),sequel,builtQuery,(result)=>prepared.mapResult(result,!0))}transaction(transaction,config){return this.session.transaction(transaction,config)}}class IndexBuilderOn{constructor(unique,name){this.unique=unique,this.name=name}static[entityKind]="PgIndexBuilderOn";on(...columns){return new IndexBuilder(columns.map((it)=>{if(is(it,SQL))return it;it=it;let clonedIndexedColumn=new IndexedColumn(it.name,!!it.keyAsName,it.columnType,it.indexConfig);return it.indexConfig=JSON.parse(JSON.stringify(it.defaultConfig)),clonedIndexedColumn}),this.unique,!1,this.name)}onOnly(...columns){return new IndexBuilder(columns.map((it)=>{if(is(it,SQL))return it;it=it;let clonedIndexedColumn=new IndexedColumn(it.name,!!it.keyAsName,it.columnType,it.indexConfig);return it.indexConfig=it.defaultConfig,clonedIndexedColumn}),this.unique,!0,this.name)}using(method,...columns){return new IndexBuilder(columns.map((it)=>{if(is(it,SQL))return it;it=it;let clonedIndexedColumn=new IndexedColumn(it.name,!!it.keyAsName,it.columnType,it.indexConfig);return it.indexConfig=JSON.parse(JSON.stringify(it.defaultConfig)),clonedIndexedColumn}),this.unique,!0,this.name,method)}}class IndexBuilder{static[entityKind]="PgIndexBuilder";config;constructor(columns,unique,only,name,method="btree"){this.config={name,columns,unique,only,method}}concurrently(){return this.config.concurrently=!0,this}with(obj){return this.config.with=obj,this}where(condition){return this.config.where=condition,this}build(table){return new Index2(this.config,table)}}class Index2{static[entityKind]="PgIndex";config;constructor(config,table){this.config={...config,table}}}function index(name){return new IndexBuilderOn(!1,name)}function uniqueIndex(name){return new IndexBuilderOn(!0,name)}class PgPreparedQuery{constructor(query){this.query=query}authToken;getQuery(){return this.query}mapResult(response,_isFromBatch){return response}setToken(token){return this.authToken=token,this}static[entityKind]="PgPreparedQuery";joinsNotNullableMap}class PgSession{constructor(dialect){this.dialect=dialect}static[entityKind]="PgSession";execute(query,token){return tracer.startActiveSpan("drizzle.operation",()=>{return tracer.startActiveSpan("drizzle.prepareQuery",()=>{return this.prepareQuery(this.dialect.sqlToQuery(query),void 0,void 0,!1)}).setToken(token).execute(void 0,token)})}all(query){return this.prepareQuery(this.dialect.sqlToQuery(query),void 0,void 0,!1).all()}async count(sql2,token){let res=await this.execute(sql2,token);return Number(res[0].count)}}class PgTransaction extends PgDatabase{constructor(dialect,session,schema,nestedIndex=0){super(dialect,session,schema);this.schema=schema,this.nestedIndex=nestedIndex}static[entityKind]="PgTransaction";rollback(){throw new TransactionRollbackError}getTransactionConfigSQL(config){let chunks=[];if(config.isolationLevel)chunks.push(`isolation level ${config.isolationLevel}`);if(config.accessMode)chunks.push(config.accessMode);if(typeof config.deferrable==="boolean")chunks.push(config.deferrable?"deferrable":"not deferrable");return sql.raw(chunks.join(" "))}setTransaction(config){return this.session.execute(sql`set transaction ${this.getTransactionConfigSQL(config)}`)}}class PostgresJsPreparedQuery extends PgPreparedQuery{constructor(client,queryString,params,logger,fields,_isResponseInArrayMode,customResultMapper){super({sql:queryString,params});this.client=client,this.queryString=queryString,this.params=params,this.logger=logger,this.fields=fields,this._isResponseInArrayMode=_isResponseInArrayMode,this.customResultMapper=customResultMapper}static[entityKind]="PostgresJsPreparedQuery";async execute(placeholderValues={}){return tracer.startActiveSpan("drizzle.execute",async(span)=>{let params=fillPlaceholders(this.params,placeholderValues);span?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(params)}),this.logger.logQuery(this.queryString,params);let{fields,queryString:query,client,joinsNotNullableMap,customResultMapper}=this;if(!fields&&!customResultMapper)return tracer.startActiveSpan("drizzle.driver.execute",()=>{return client.unsafe(query,params)});let rows=await tracer.startActiveSpan("drizzle.driver.execute",()=>{return span?.setAttributes({"drizzle.query.text":query,"drizzle.query.params":JSON.stringify(params)}),client.unsafe(query,params).values()});return tracer.startActiveSpan("drizzle.mapResponse",()=>{return customResultMapper?customResultMapper(rows):rows.map((row)=>mapResultRow(fields,row,joinsNotNullableMap))})})}all(placeholderValues={}){return tracer.startActiveSpan("drizzle.execute",async(span)=>{let params=fillPlaceholders(this.params,placeholderValues);return span?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(params)}),this.logger.logQuery(this.queryString,params),tracer.startActiveSpan("drizzle.driver.execute",()=>{return span?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(params)}),this.client.unsafe(this.queryString,params)})})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class PostgresJsSession extends PgSession{constructor(client,dialect,schema,options={}){super(dialect);this.client=client,this.schema=schema,this.options=options,this.logger=options.logger??new NoopLogger}static[entityKind]="PostgresJsSession";logger;prepareQuery(query,fields,name,isResponseInArrayMode,customResultMapper){return new PostgresJsPreparedQuery(this.client,query.sql,query.params,this.logger,fields,isResponseInArrayMode,customResultMapper)}query(query,params){return this.logger.logQuery(query,params),this.client.unsafe(query,params).values()}queryObjects(query,params){return this.client.unsafe(query,params)}transaction(transaction,config){return this.client.begin(async(client)=>{let session=new PostgresJsSession(client,this.dialect,this.schema,this.options),tx=new PostgresJsTransaction(this.dialect,session,this.schema);if(config)await tx.setTransaction(config);return transaction(tx)})}}class PostgresJsTransaction extends PgTransaction{constructor(dialect,session,schema,nestedIndex=0){super(dialect,session,schema,nestedIndex);this.session=session}static[entityKind]="PostgresJsTransaction";transaction(transaction){return this.session.client.savepoint((client)=>{let session=new PostgresJsSession(client,this.dialect,this.schema,this.session.options),tx=new PostgresJsTransaction(this.dialect,session,this.schema);return transaction(tx)})}}class PostgresJsDatabase extends PgDatabase{static[entityKind]="PostgresJsDatabase"}function construct(client,config={}){let transparentParser=(val)=>val;for(let type2 of["1184","1082","1083","1114","1182","1185","1115","1231"])client.options.parsers[type2]=transparentParser,client.options.serializers[type2]=transparentParser;client.options.serializers["114"]=transparentParser,client.options.serializers["3802"]=transparentParser;let dialect=new PgDialect({casing:config.casing}),logger;if(config.logger===!0)logger=new DefaultLogger;else if(config.logger!==!1)logger=config.logger;let schema;if(config.schema){let tablesConfig=extractTablesRelationalConfig(config.schema,createTableRelationsHelpers);schema={fullSchema:config.schema,schema:tablesConfig.tables,tableNamesMap:tablesConfig.tableNamesMap}}let session=new PostgresJsSession(client,dialect,schema,{logger}),db=new PostgresJsDatabase(dialect,session,schema);return db.$client=client,db}function drizzle(...params){if(typeof params[0]==="string"){let instance=src_default(params[0]);return construct(instance,params[1])}if(isConfig(params[0])){let{connection:connection2,client,...drizzleConfig}=params[0];if(client)return construct(client,drizzleConfig);if(typeof connection2==="object"&&connection2.url!==void 0){let{url,...config}=connection2,instance2=src_default(url,config);return construct(instance2,drizzleConfig)}let instance=src_default(connection2);return construct(instance,drizzleConfig)}return construct(params[0],params[1])}((drizzle2)=>{function mock(config){return construct({options:{parsers:{},serializers:{}}},config)}drizzle2.mock=mock})(drizzle||(drizzle={}));var connectionString=process.env.POSTGRES_URL_LOCAL,queryClient=src_default(connectionString),mainDb=drizzle(queryClient);var users=pgTable("users",{id:uuid("id").defaultRandom().primaryKey(),username:text("username").notNull(),email:text("email").unique().notNull(),password:text("password").notNull(),phoneNumber:text("phoneNumber").unique().notNull(),role:text("role").notNull().default("owner"),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").notNull().defaultNow().$onUpdate(()=>new Date)},(table)=>({emailIndex:index("idx_email").on(table.email)})),shops=pgTable("shops",{id:uuid("id").defaultRandom().primaryKey(),name:text("name").unique().notNull(),subscription:text("subscription_type",{enum:["Msingi","Lite","Business","Pro","AI","Trial"]}).default("Trial").notNull(),trialStart:timestamp("trial_start",{mode:"date"}),trialEnd:timestamp("trial_end",{mode:"date"}),paidUntil:timestamp("paid_until",{mode:"date"}),createdAt:timestamp("created_at",{mode:"date"}).defaultNow()}),shopUsers=pgTable("shop_users",{id:uuid("id").defaultRandom().primaryKey(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),userId:uuid("user_id").notNull().references(()=>users.id,{onDelete:"cascade"}),role:text("role").notNull().default("assistant"),isPaid:boolean("is_paid").default(!0)},(table)=>({uniqueUserRole:uniqueIndex("unique_user_role").on(table.shopId,table.userId),uniqueUsername:uniqueIndex("unique_username_per_shop").on(table.shopId,table.userId)})),categories=pgTable("categories",{id:uuid("id").defaultRandom().primaryKey(),generalName:text("name").notNull(),shopId:uuid("shop_id").notNull().references(()=>shops.id)},(table)=>({uniqueCategory:uniqueIndex("unique_category").on(table.generalName,table.shopId)})),suppliers=pgTable("suppliers",{id:uuid("id").defaultRandom().primaryKey(),company:text("company").notNull(),contact:text("contact").notNull(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),mostSoldProduct:uuid("most_sold_product"),highestProfitProduct:uuid("highest_profit_product"),createdAt:timestamp("created_at").defaultNow()},(table)=>({idx_suppliers_shop_id:index("idx_suppliers_shop_id").on(table.shopId)})),products=pgTable("products",{id:uuid("id").defaultRandom().primaryKey(),name:text("name").notNull(),categoryId:uuid("category_id").references(()=>categories.id,{onDelete:"set null"}),priceSold:decimal("price_sold",{precision:15,scale:2}).notNull(),stock:doublePrecision("stock").notNull().default(0),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),supplierId:uuid("supplier_id").notNull().references(()=>suppliers.id,{onDelete:"cascade"}),minStock:doublePrecision("min_stock").notNull().default(0),status:text("status").notNull().default("available"),unit:text("unit"),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").defaultNow(),isQRCode:boolean("is_qr_code").default(!1)},(table)=>({uniqueProductShop:uniqueIndex("unique_product_shop").on(table.name,table.shopId)})),purchases=pgTable("purchases",{id:uuid("id").defaultRandom().primaryKey(),productId:uuid("product_id").notNull().references(()=>products.id,{onDelete:"cascade"}),supplierId:uuid("supplier_id").notNull().references(()=>suppliers.id,{onDelete:"cascade"}),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),quantity:doublePrecision("quantity").notNull().default(0),priceBought:decimal("price_bought",{precision:15,scale:2}).notNull(),totalCost:decimal("total_cost",{precision:15,scale:2}).notNull().default("0"),purchaseDate:timestamp("purchase_date").defaultNow(),createdAt:timestamp("created_at").defaultNow().notNull()},(table)=>({idxProductShop:index("idx_purchases_product_shop").on(table.productId,table.shopId)})),supplierPriceHistory=pgTable("supplier_price_history",{id:uuid("id").defaultRandom().primaryKey(),supplierId:uuid("supplier_id").notNull().references(()=>suppliers.id),productId:uuid("product_id").notNull().references(()=>products.id,{onDelete:"cascade"}),shopId:uuid("shop_id").notNull().references(()=>shops.id),price:decimal("price",{precision:15,scale:2}).notNull(),dateAdded:timestamp("date_added").defaultNow(),createdAt:timestamp("created_at").defaultNow()},(table)=>({uniqueSupplierProduct:uniqueIndex("unique_supplier_product").on(table.supplierId,table.productId,table.shopId)})),sales=pgTable("sales",{id:uuid("id").defaultRandom().primaryKey(),productId:uuid("product_id").notNull().references(()=>products.id,{onDelete:"cascade"}),quantity:doublePrecision("quantity").notNull().default(0),priceSold:decimal("price_sold",{precision:15,scale:2}).notNull(),totalSales:decimal("total_sales",{precision:15,scale:2}).notNull(),discount:doublePrecision("discount").notNull().default(0),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),saleType:text("sale_type").notNull().default("cash"),customerId:uuid("customer_id"),createdAt:timestamp("created_at").defaultNow().notNull()},(table)=>({idxProductShop:index("idx_sales_product_shop").on(table.productId,table.shopId)})),debts=pgTable("debts",{id:uuid("id").defaultRandom().primaryKey(),productId:uuid("product_id").notNull().references(()=>products.id,{onDelete:"cascade"}),customerId:uuid("customer_id").notNull().references(()=>customers.id,{onDelete:"cascade"}),totalAmount:decimal("total_amount",{precision:15,scale:2}).notNull(),quantity:doublePrecision("quantity").notNull().default(0),remainingAmount:decimal("remaining_amount",{precision:15,scale:2}).notNull(),priceSold:decimal("price_sold",{precision:15,scale:2}).notNull(),totalSales:decimal("total_sales",{precision:15,scale:2}).notNull(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),lastPaymentDate:timestamp("last_payment_date"),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").notNull().defaultNow().$onUpdate(()=>new Date)}),debtPayments=pgTable("debt_payments",{id:uuid("id").defaultRandom().primaryKey(),debtId:uuid("debt_id").references(()=>debts.id,{onDelete:"cascade"}),customerId:uuid("customer_id").notNull().references(()=>customers.id,{onDelete:"cascade"}),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),amountPaid:decimal("amount_paid",{precision:15,scale:2}).notNull(),paymentDate:timestamp("payment_date").defaultNow()}),customers=pgTable("customers",{id:uuid("id").defaultRandom().primaryKey(),name:text("name").notNull().unique(),shopId:uuid("shop_id").notNull().references(()=>shops.id),contact:text("contact").notNull(),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").notNull().defaultNow().$onUpdate(()=>new Date)},(table)=>({uniqueCustomer:uniqueIndex("unique_customer_name_per_shop").on(table.name,table.shopId),uniqueContact:uniqueIndex("unique_customer_contact_per_shop").on(table.contact,table.shopId)})),returns=pgTable("returns",{id:uuid("id").defaultRandom().primaryKey(),productId:uuid("product_id").notNull().references(()=>products.id,{onDelete:"cascade"}),quantity:doublePrecision("quantity").notNull().default(0),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),reason:text("reason").notNull(),returnDate:timestamp("return_date").defaultNow(),createdAt:timestamp("created_at").defaultNow()}),expenses=pgTable("expenses",{id:uuid("id").defaultRandom().primaryKey(),description:text("description").notNull(),amount:decimal("amount",{precision:15,scale:2}).notNull(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),date:timestamp("date").defaultNow(),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").notNull().defaultNow().$onUpdate(()=>new Date)}),askedProducts=pgTable("asked_products",{id:uuid("id").defaultRandom().primaryKey(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),productName:text("product_name").notNull(),quantityRequested:integer("quantity_requested").notNull().default(0),date:timestamp("date").defaultNow()}),emailVerifications=pgTable("email_verifications",{id:uuid("id").defaultRandom().primaryKey(),token:uuid("token").defaultRandom().notNull().unique(),email:text("email").notNull(),shopName:text("shop_name").notNull(),username:text("username").notNull(),phone:text("phone").notNull(),password:text("password").notNull(),expiresAt:timestamp("expires_at").notNull(),used:boolean("used").notNull().default(!1),createdAt:timestamp("created_at").defaultNow()}),paymentSaaS=pgTable("payment_saas",{id:uuid("id").defaultRandom().primaryKey(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),token:text("token_clickpesa").notNull(),orderId:text("order_id")}),notifications=pgTable("notifications",{id:uuid("id").defaultRandom().primaryKey(),shopId:uuid("shop_id").notNull().references(()=>shops.id,{onDelete:"cascade"}),title:text("title").notNull(),message:text("message").notNull(),type:text("type",{enum:["info","warning","error","upgrade"]}).default("info"),isRead:boolean("is_read").default(!1),createdAt:timestamp("created_at").defaultNow()});var homeGet=async()=>{try{return await mainDb.delete(emailVerifications).where(eq(emailVerifications.used,!0)),{success:!0,message:"Karibu kwenye seva ya Elysia na Bun!"}}catch(error2){return{success:!1,message:error2 instanceof Error?error2.message:"Hitilafu imetokea kwenye seva"}}};class MemoryCache{cache=new Map;totalSize=0;maxSizeInMB;maxSizeInBytes;constructor(maxSizeInMB=100){this.maxSizeInMB=maxSizeInMB,this.maxSizeInBytes=maxSizeInMB*1024*1024}estimateSize(value){return Buffer.byteLength(JSON.stringify(value))}set(key,value){let size=this.estimateSize(value);if(size>this.maxSizeInBytes)return;this.cache.set(key,{value,size}),this.totalSize+=size,this.evict()}get(key){let entry=this.cache.get(key);if(!entry)return;return this.cache.delete(key),this.cache.set(key,entry),entry.value}delete(key){let entry=this.cache.get(key);if(entry)this.totalSize-=entry.size,this.cache.delete(key)}clear(){this.cache.clear(),this.totalSize=0}evict(){while(this.totalSize>this.maxSizeInBytes){let firstKey=this.cache.keys().next().value;if(!firstKey)break;let entry=this.cache.get(firstKey);if(entry)this.totalSize-=entry.size;this.cache.delete(firstKey)}}getMemoryUsage(){let usedMB=this.totalSize/1048576,freeMB=this.maxSizeInMB-usedMB,usedPercent=usedMB/this.maxSizeInMB*100;return{usedMB,freeMB,usedPercent}}}function isCachedSupplierResponse(value){return typeof value==="object"&&value!==null&&"data"in value&&"total"in value&&"page"in value&&"limit"in value&&"pages"in value}var supplierCache=new MemoryCache(20),userCheckCache=new MemoryCache(15),shopCheckCache=new MemoryCache(15),loginCache=new MemoryCache(40),isPaidCache=new MemoryCache(10);class CacheStatsTracker{stats={};caches;constructor(caches){this.caches=caches;for(let name in caches)this.stats[name]={hits:0,misses:0}}recordHit(cacheName){if(this.stats[cacheName])this.stats[cacheName].hits++}recordMiss(cacheName){if(this.stats[cacheName])this.stats[cacheName].misses++}getStats(){let result={};for(let name in this.caches){let cache=this.caches[name];result[name]={hits:this.stats[name]?.hits||0,misses:this.stats[name]?.misses||0,usage:cache.getMemoryUsage()}}return result}resetStats(){for(let name in this.stats)this.stats[name]={hits:0,misses:0}}}var caches={supplierCache,userCheckCache,shopCheckCache,loginCache},cacheStatsTracker=new CacheStatsTracker(caches);var homePlugin=new Elysia().get("/",homeGet).get("/cache/stats",()=>{return{cacheStats:cacheStatsTracker.getStats()}}),home_default=homePlugin;var webcrypto_default=crypto,isCryptoKey=(key)=>key instanceof CryptoKey;var encoder2=new TextEncoder,decoder=new TextDecoder;function concat(...buffers){let size=buffers.reduce((acc,{length})=>acc+length,0),buf=new Uint8Array(size),i=0;return buffers.forEach((buffer2)=>{buf.set(buffer2,i),i+=buffer2.length}),buf}var encodeBase64=(input)=>{let unencoded=input;if(typeof unencoded==="string")unencoded=encoder2.encode(unencoded);let CHUNK_SIZE=32768,arr=[];for(let i=0;i<unencoded.length;i+=CHUNK_SIZE)arr.push(String.fromCharCode.apply(null,unencoded.subarray(i,i+CHUNK_SIZE)));return btoa(arr.join(""))},encode2=(input)=>{return encodeBase64(input).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},decodeBase64=(encoded)=>{let binary=atob(encoded),bytes=new Uint8Array(binary.length);for(let i=0;i<binary.length;i++)bytes[i]=binary.charCodeAt(i);return bytes},decode3=(input)=>{let encoded=input;if(encoded instanceof Uint8Array)encoded=decoder.decode(encoded);encoded=encoded.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return decodeBase64(encoded)}catch(_a){throw new TypeError("The input to be decoded is not correctly encoded.")}};class JOSEError extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(message){var _a;super(message);this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(_a=Error.captureStackTrace)===null||_a===void 0||_a.call(Error,this,this.constructor)}}class JWTClaimValidationFailed extends JOSEError{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(message,claim="unspecified",reason="unspecified"){super(message);this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=claim,this.reason=reason}}class JWTExpired extends JOSEError{static get code(){return"ERR_JWT_EXPIRED"}constructor(message,claim="unspecified",reason="unspecified"){super(message);this.code="ERR_JWT_EXPIRED",this.claim=claim,this.reason=reason}}class JOSEAlgNotAllowed extends JOSEError{constructor(){super(...arguments);this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class JOSENotSupported extends JOSEError{constructor(){super(...arguments);this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class JWSInvalid extends JOSEError{constructor(){super(...arguments);this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class JWTInvalid extends JOSEError{constructor(){super(...arguments);this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}class JWSSignatureVerificationFailed extends JOSEError{constructor(){super(...arguments);this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}function unusable(name,prop="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${prop} must be ${name}`)}function isAlgorithm(algorithm,name){return algorithm.name===name}function getHashLength(hash2){return parseInt(hash2.name.slice(4),10)}function getNamedCurve(alg){switch(alg){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function checkUsage(key,usages){if(usages.length&&!usages.some((expected)=>key.usages.includes(expected))){let msg="CryptoKey does not support this operation, its usages must include ";if(usages.length>2){let last=usages.pop();msg+=`one of ${usages.join(", ")}, or ${last}.`}else if(usages.length===2)msg+=`one of ${usages[0]} or ${usages[1]}.`;else msg+=`${usages[0]}.`;throw new TypeError(msg)}}function checkSigCryptoKey(key,alg,...usages){switch(alg){case"HS256":case"HS384":case"HS512":{if(!isAlgorithm(key.algorithm,"HMAC"))throw unusable("HMAC");let expected=parseInt(alg.slice(2),10);if(getHashLength(key.algorithm.hash)!==expected)throw unusable(`SHA-${expected}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!isAlgorithm(key.algorithm,"RSASSA-PKCS1-v1_5"))throw unusable("RSASSA-PKCS1-v1_5");let expected=parseInt(alg.slice(2),10);if(getHashLength(key.algorithm.hash)!==expected)throw unusable(`SHA-${expected}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!isAlgorithm(key.algorithm,"RSA-PSS"))throw unusable("RSA-PSS");let expected=parseInt(alg.slice(2),10);if(getHashLength(key.algorithm.hash)!==expected)throw unusable(`SHA-${expected}`,"algorithm.hash");break}case"EdDSA":{if(key.algorithm.name!=="Ed25519"&&key.algorithm.name!=="Ed448")throw unusable("Ed25519 or Ed448");break}case"ES256":case"ES384":case"ES512":{if(!isAlgorithm(key.algorithm,"ECDSA"))throw unusable("ECDSA");let expected=getNamedCurve(alg);if(key.algorithm.namedCurve!==expected)throw unusable(expected,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}checkUsage(key,usages)}function message(msg,actual,...types2){if(types2.length>2){let last=types2.pop();msg+=`one of type ${types2.join(", ")}, or ${last}.`}else if(types2.length===2)msg+=`one of type ${types2[0]} or ${types2[1]}.`;else msg+=`of type ${types2[0]}.`;if(actual==null)msg+=` Received ${actual}`;else if(typeof actual==="function"&&actual.name)msg+=` Received function ${actual.name}`;else if(typeof actual==="object"&&actual!=null){if(actual.constructor&&actual.constructor.name)msg+=` Received an instance of ${actual.constructor.name}`}return msg}var invalid_key_input_default=(actual,...types2)=>{return message("Key must be ",actual,...types2)};function withAlg(alg,actual,...types2){return message(`Key for the ${alg} algorithm must be `,actual,...types2)}var is_key_like_default=(key)=>{return isCryptoKey(key)},types2=["CryptoKey"];var isDisjoint=(...headers)=>{let sources=headers.filter(Boolean);if(sources.length===0||sources.length===1)return!0;let acc;for(let header of sources){let parameters=Object.keys(header);if(!acc||acc.size===0){acc=new Set(parameters);continue}for(let parameter of parameters){if(acc.has(parameter))return!1;acc.add(parameter)}}return!0},is_disjoint_default=isDisjoint;function isObjectLike(value){return typeof value==="object"&&value!==null}function isObject2(input){if(!isObjectLike(input)||Object.prototype.toString.call(input)!=="[object Object]")return!1;if(Object.getPrototypeOf(input)===null)return!0;let proto=input;while(Object.getPrototypeOf(proto)!==null)proto=Object.getPrototypeOf(proto);return Object.getPrototypeOf(input)===proto}var check_key_length_default=(alg,key)=>{if(alg.startsWith("RS")||alg.startsWith("PS")){let{modulusLength}=key.algorithm;if(typeof modulusLength!=="number"||modulusLength<2048)throw new TypeError(`${alg} requires key modulusLength to be 2048 bits or larger`)}};var symmetricTypeCheck=(alg,key)=>{if(key instanceof Uint8Array)return;if(!is_key_like_default(key))throw new TypeError(withAlg(alg,key,...types2,"Uint8Array"));if(key.type!=="secret")throw new TypeError(`${types2.join(" or ")} instances for symmetric algorithms must be of type "secret"`)},asymmetricTypeCheck=(alg,key,usage)=>{if(!is_key_like_default(key))throw new TypeError(withAlg(alg,key,...types2));if(key.type==="secret")throw new TypeError(`${types2.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if(usage==="sign"&&key.type==="public")throw new TypeError(`${types2.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if(usage==="decrypt"&&key.type==="public")throw new TypeError(`${types2.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(key.algorithm&&usage==="verify"&&key.type==="private")throw new TypeError(`${types2.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(key.algorithm&&usage==="encrypt"&&key.type==="private")throw new TypeError(`${types2.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},checkKeyType=(alg,key,usage)=>{if(alg.startsWith("HS")||alg==="dir"||alg.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(alg))symmetricTypeCheck(alg,key);else asymmetricTypeCheck(alg,key,usage)},check_key_type_default=checkKeyType;function validateCrit(Err,recognizedDefault,recognizedOption,protectedHeader,joseHeader){if(joseHeader.crit!==void 0&&protectedHeader.crit===void 0)throw new Err('"crit" (Critical) Header Parameter MUST be integrity protected');if(!protectedHeader||protectedHeader.crit===void 0)return new Set;if(!Array.isArray(protectedHeader.crit)||protectedHeader.crit.length===0||protectedHeader.crit.some((input)=>typeof input!=="string"||input.length===0))throw new Err('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let recognized;if(recognizedOption!==void 0)recognized=new Map([...Object.entries(recognizedOption),...recognizedDefault.entries()]);else recognized=recognizedDefault;for(let parameter of protectedHeader.crit){if(!recognized.has(parameter))throw new JOSENotSupported(`Extension Header Parameter "${parameter}" is not recognized`);if(joseHeader[parameter]===void 0)throw new Err(`Extension Header Parameter "${parameter}" is missing`);else if(recognized.get(parameter)&&protectedHeader[parameter]===void 0)throw new Err(`Extension Header Parameter "${parameter}" MUST be integrity protected`)}return new Set(protectedHeader.crit)}var validate_crit_default=validateCrit;var validateAlgorithms=(option,algorithms)=>{if(algorithms!==void 0&&(!Array.isArray(algorithms)||algorithms.some((s)=>typeof s!=="string")))throw new TypeError(`"${option}" option must be an array of strings`);if(!algorithms)return;return new Set(algorithms)},validate_algorithms_default=validateAlgorithms;function subtleDsa(alg,algorithm){let hash2=`SHA-${alg.slice(-3)}`;switch(alg){case"HS256":case"HS384":case"HS512":return{hash:hash2,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:hash2,name:"RSA-PSS",saltLength:alg.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:hash2,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:hash2,name:"ECDSA",namedCurve:algorithm.namedCurve};case"EdDSA":return{name:algorithm.name};default:throw new JOSENotSupported(`alg ${alg} is not supported either by JOSE or your javascript runtime`)}}function getCryptoKey(alg,key,usage){if(isCryptoKey(key))return checkSigCryptoKey(key,alg,usage),key;if(key instanceof Uint8Array){if(!alg.startsWith("HS"))throw new TypeError(invalid_key_input_default(key,...types2));return webcrypto_default.subtle.importKey("raw",key,{hash:`SHA-${alg.slice(-3)}`,name:"HMAC"},!1,[usage])}throw new TypeError(invalid_key_input_default(key,...types2,"Uint8Array"))}var verify=async(alg,key,signature,data)=>{let cryptoKey=await getCryptoKey(alg,key,"verify");check_key_length_default(alg,cryptoKey);let algorithm=subtleDsa(alg,cryptoKey.algorithm);try{return await webcrypto_default.subtle.verify(algorithm,cryptoKey,signature,data)}catch(_a){return!1}},verify_default=verify;async function flattenedVerify(jws,key,options){var _a;if(!isObject2(jws))throw new JWSInvalid("Flattened JWS must be an object");if(jws.protected===void 0&&jws.header===void 0)throw new JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(jws.protected!==void 0&&typeof jws.protected!=="string")throw new JWSInvalid("JWS Protected Header incorrect type");if(jws.payload===void 0)throw new JWSInvalid("JWS Payload missing");if(typeof jws.signature!=="string")throw new JWSInvalid("JWS Signature missing or incorrect type");if(jws.header!==void 0&&!isObject2(jws.header))throw new JWSInvalid("JWS Unprotected Header incorrect type");let parsedProt={};if(jws.protected)try{let protectedHeader=decode3(jws.protected);parsedProt=JSON.parse(decoder.decode(protectedHeader))}catch(_b){throw new JWSInvalid("JWS Protected Header is invalid")}if(!is_disjoint_default(parsedProt,jws.header))throw new JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let joseHeader={...parsedProt,...jws.header},extensions=validate_crit_default(JWSInvalid,new Map([["b64",!0]]),options===null||options===void 0?void 0:options.crit,parsedProt,joseHeader),b64=!0;if(extensions.has("b64")){if(b64=parsedProt.b64,typeof b64!=="boolean")throw new JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean')}let{alg}=joseHeader;if(typeof alg!=="string"||!alg)throw new JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let algorithms=options&&validate_algorithms_default("algorithms",options.algorithms);if(algorithms&&!algorithms.has(alg))throw new JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(b64){if(typeof jws.payload!=="string")throw new JWSInvalid("JWS Payload must be a string")}else if(typeof jws.payload!=="string"&&!(jws.payload instanceof Uint8Array))throw new JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let resolvedKey=!1;if(typeof key==="function")key=await key(parsedProt,jws),resolvedKey=!0;check_key_type_default(alg,key,"verify");let data=concat(encoder2.encode((_a=jws.protected)!==null&&_a!==void 0?_a:""),encoder2.encode("."),typeof jws.payload==="string"?encoder2.encode(jws.payload):jws.payload),signature;try{signature=decode3(jws.signature)}catch(_c){throw new JWSInvalid("Failed to base64url decode the signature")}if(!await verify_default(alg,key,signature,data))throw new JWSSignatureVerificationFailed;let payload;if(b64)try{payload=decode3(jws.payload)}catch(_d){throw new JWSInvalid("Failed to base64url decode the payload")}else if(typeof jws.payload==="string")payload=encoder2.encode(jws.payload);else payload=jws.payload;let result={payload};if(jws.protected!==void 0)result.protectedHeader=parsedProt;if(jws.header!==void 0)result.unprotectedHeader=jws.header;if(resolvedKey)return{...result,key};return result}async function compactVerify(jws,key,options){if(jws instanceof Uint8Array)jws=decoder.decode(jws);if(typeof jws!=="string")throw new JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:protectedHeader,1:payload,2:signature,length}=jws.split(".");if(length!==3)throw new JWSInvalid("Invalid Compact JWS");let verified=await flattenedVerify({payload,protected:protectedHeader,signature},key,options),result={payload:verified.payload,protectedHeader:verified.protectedHeader};if(typeof key==="function")return{...result,key:verified.key};return result}var epoch_default=(date3)=>Math.floor(date3.getTime()/1000);var REGEX=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,secs_default=(str)=>{let matched=REGEX.exec(str);if(!matched)throw new TypeError("Invalid time period format");let value=parseFloat(matched[1]);switch(matched[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(value);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(value*60);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(value*3600);case"day":case"days":case"d":return Math.round(value*86400);case"week":case"weeks":case"w":return Math.round(value*604800);default:return Math.round(value*31557600)}};var normalizeTyp=(value)=>value.toLowerCase().replace(/^application\//,""),checkAudiencePresence=(audPayload,audOption)=>{if(typeof audPayload==="string")return audOption.includes(audPayload);if(Array.isArray(audPayload))return audOption.some(Set.prototype.has.bind(new Set(audPayload)));return!1},jwt_claims_set_default=(protectedHeader,encodedPayload,options={})=>{let{typ}=options;if(typ&&(typeof protectedHeader.typ!=="string"||normalizeTyp(protectedHeader.typ)!==normalizeTyp(typ)))throw new JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");let payload;try{payload=JSON.parse(decoder.decode(encodedPayload))}catch(_a){}if(!isObject2(payload))throw new JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims=[],issuer,subject,audience,maxTokenAge}=options;if(maxTokenAge!==void 0)requiredClaims.push("iat");if(audience!==void 0)requiredClaims.push("aud");if(subject!==void 0)requiredClaims.push("sub");if(issuer!==void 0)requiredClaims.push("iss");for(let claim of new Set(requiredClaims.reverse()))if(!(claim in payload))throw new JWTClaimValidationFailed(`missing required "${claim}" claim`,claim,"missing");if(issuer&&!(Array.isArray(issuer)?issuer:[issuer]).includes(payload.iss))throw new JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(subject&&payload.sub!==subject)throw new JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(audience&&!checkAudiencePresence(payload.aud,typeof audience==="string"?[audience]:audience))throw new JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");let tolerance;switch(typeof options.clockTolerance){case"string":tolerance=secs_default(options.clockTolerance);break;case"number":tolerance=options.clockTolerance;break;case"undefined":tolerance=0;break;default:throw new TypeError("Invalid clockTolerance option type")}let{currentDate}=options,now=epoch_default(currentDate||new Date);if((payload.iat!==void 0||maxTokenAge)&&typeof payload.iat!=="number")throw new JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(payload.nbf!==void 0){if(typeof payload.nbf!=="number")throw new JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(payload.nbf>now+tolerance)throw new JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(payload.exp!==void 0){if(typeof payload.exp!=="number")throw new JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(payload.exp<=now-tolerance)throw new JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(maxTokenAge){let age=now-payload.iat,max=typeof maxTokenAge==="number"?maxTokenAge:secs_default(maxTokenAge);if(age-tolerance>max)throw new JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(age<0-tolerance)throw new JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return payload};async function jwtVerify(jwt,key,options){var _a;let verified=await compactVerify(jwt,key,options);if(((_a=verified.protectedHeader.crit)===null||_a===void 0?void 0:_a.includes("b64"))&&verified.protectedHeader.b64===!1)throw new JWTInvalid("JWTs MUST NOT use unencoded payload");let result={payload:jwt_claims_set_default(verified.protectedHeader,verified.payload,options),protectedHeader:verified.protectedHeader};if(typeof key==="function")return{...result,key:verified.key};return result}var sign=async(alg,key,data)=>{let cryptoKey=await getCryptoKey(alg,key,"sign");check_key_length_default(alg,cryptoKey);let signature=await webcrypto_default.subtle.sign(subtleDsa(alg,cryptoKey.algorithm),cryptoKey,data);return new Uint8Array(signature)},sign_default=sign;class FlattenedSign{constructor(payload){if(!(payload instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=payload}setProtectedHeader(protectedHeader){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=protectedHeader,this}setUnprotectedHeader(unprotectedHeader){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=unprotectedHeader,this}async sign(key,options){if(!this._protectedHeader&&!this._unprotectedHeader)throw new JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!is_disjoint_default(this._protectedHeader,this._unprotectedHeader))throw new JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let joseHeader={...this._protectedHeader,...this._unprotectedHeader},extensions=validate_crit_default(JWSInvalid,new Map([["b64",!0]]),options===null||options===void 0?void 0:options.crit,this._protectedHeader,joseHeader),b64=!0;if(extensions.has("b64")){if(b64=this._protectedHeader.b64,typeof b64!=="boolean")throw new JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean')}let{alg}=joseHeader;if(typeof alg!=="string"||!alg)throw new JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');check_key_type_default(alg,key,"sign");let payload=this._payload;if(b64)payload=encoder2.encode(encode2(payload));let protectedHeader;if(this._protectedHeader)protectedHeader=encoder2.encode(encode2(JSON.stringify(this._protectedHeader)));else protectedHeader=encoder2.encode("");let data=concat(protectedHeader,encoder2.encode("."),payload),signature=await sign_default(alg,key,data),jws={signature:encode2(signature),payload:""};if(b64)jws.payload=decoder.decode(payload);if(this._unprotectedHeader)jws.header=this._unprotectedHeader;if(this._protectedHeader)jws.protected=decoder.decode(protectedHeader);return jws}}class CompactSign{constructor(payload){this._flattened=new FlattenedSign(payload)}setProtectedHeader(protectedHeader){return this._flattened.setProtectedHeader(protectedHeader),this}async sign(key,options){let jws=await this._flattened.sign(key,options);if(jws.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${jws.protected}.${jws.payload}.${jws.signature}`}}class ProduceJWT{constructor(payload){if(!isObject2(payload))throw new TypeError("JWT Claims Set MUST be an object");this._payload=payload}setIssuer(issuer){return this._payload={...this._payload,iss:issuer},this}setSubject(subject){return this._payload={...this._payload,sub:subject},this}setAudience(audience){return this._payload={...this._payload,aud:audience},this}setJti(jwtId){return this._payload={...this._payload,jti:jwtId},this}setNotBefore(input){if(typeof input==="number")this._payload={...this._payload,nbf:input};else this._payload={...this._payload,nbf:epoch_default(new Date)+secs_default(input)};return this}setExpirationTime(input){if(typeof input==="number")this._payload={...this._payload,exp:input};else this._payload={...this._payload,exp:epoch_default(new Date)+secs_default(input)};return this}setIssuedAt(input){if(typeof input==="undefined")this._payload={...this._payload,iat:epoch_default(new Date)};else this._payload={...this._payload,iat:input};return this}}class SignJWT extends ProduceJWT{setProtectedHeader(protectedHeader){return this._protectedHeader=protectedHeader,this}async sign(key,options){var _a;let sig=new CompactSign(encoder2.encode(JSON.stringify(this._payload)));if(sig.setProtectedHeader(this._protectedHeader),Array.isArray((_a=this._protectedHeader)===null||_a===void 0?void 0:_a.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new JWTInvalid("JWTs MUST NOT use unencoded payload");return sig.sign(key,options)}}var __defProp2=Object.defineProperty,__export2=(target,all)=>{for(var name in all)__defProp2(target,name,{get:all[name],enumerable:!0})},value_exports={};__export2(value_exports,{HasPropertyKey:()=>HasPropertyKey3,IsArray:()=>IsArray5,IsAsyncIterator:()=>IsAsyncIterator5,IsBigInt:()=>IsBigInt5,IsBoolean:()=>IsBoolean5,IsDate:()=>IsDate5,IsFunction:()=>IsFunction5,IsIterator:()=>IsIterator5,IsNull:()=>IsNull5,IsNumber:()=>IsNumber5,IsObject:()=>IsObject5,IsRegExp:()=>IsRegExp4,IsString:()=>IsString5,IsSymbol:()=>IsSymbol5,IsUint8Array:()=>IsUint8Array5,IsUndefined:()=>IsUndefined5});function HasPropertyKey3(value,key){return key in value}function IsAsyncIterator5(value){return IsObject5(value)&&!IsArray5(value)&&!IsUint8Array5(value)&&Symbol.asyncIterator in value}function IsArray5(value){return Array.isArray(value)}function IsBigInt5(value){return typeof value==="bigint"}function IsBoolean5(value){return typeof value==="boolean"}function IsDate5(value){return value instanceof globalThis.Date}function IsFunction5(value){return typeof value==="function"}function IsIterator5(value){return IsObject5(value)&&!IsArray5(value)&&!IsUint8Array5(value)&&Symbol.iterator in value}function IsNull5(value){return value===null}function IsNumber5(value){return typeof value==="number"}function IsObject5(value){return typeof value==="object"&&value!==null}function IsRegExp4(value){return value instanceof globalThis.RegExp}function IsString5(value){return typeof value==="string"}function IsSymbol5(value){return typeof value==="symbol"}function IsUint8Array5(value){return value instanceof globalThis.Uint8Array}function IsUndefined5(value){return value===void 0}function ArrayType6(value){return value.map((value2)=>Visit17(value2))}function DateType4(value){return new Date(value.getTime())}function Uint8ArrayType3(value){return new Uint8Array(value)}function RegExpType2(value){return new RegExp(value.source,value.flags)}function ObjectType6(value){let result={};for(let key of Object.getOwnPropertyNames(value))result[key]=Visit17(value[key]);for(let key of Object.getOwnPropertySymbols(value))result[key]=Visit17(value[key]);return result}function Visit17(value){return IsArray5(value)?ArrayType6(value):IsDate5(value)?DateType4(value):IsUint8Array5(value)?Uint8ArrayType3(value):IsRegExp4(value)?RegExpType2(value):IsObject5(value)?ObjectType6(value):value}function Clone3(value){return Visit17(value)}function CloneType2(schema,options){return options===void 0?Clone3(schema):Clone3({...options,...schema})}function IsObject22(value){return value!==null&&typeof value==="object"}function IsArray22(value){return globalThis.Array.isArray(value)&&!globalThis.ArrayBuffer.isView(value)}function IsUndefined22(value){return value===void 0}function IsNumber22(value){return typeof value==="number"}var TypeSystemPolicy2;(function(TypeSystemPolicy22){TypeSystemPolicy22.InstanceMode="default",TypeSystemPolicy22.ExactOptionalPropertyTypes=!1,TypeSystemPolicy22.AllowArrayObject=!1,TypeSystemPolicy22.AllowNaN=!1,TypeSystemPolicy22.AllowNullVoid=!1;function IsExactOptionalProperty(value,key){return TypeSystemPolicy22.ExactOptionalPropertyTypes?key in value:value[key]!==void 0}TypeSystemPolicy22.IsExactOptionalProperty=IsExactOptionalProperty;function IsObjectLike(value){let isObject3=IsObject22(value);return TypeSystemPolicy22.AllowArrayObject?isObject3:isObject3&&!IsArray22(value)}TypeSystemPolicy22.IsObjectLike=IsObjectLike;function IsRecordLike(value){return IsObjectLike(value)&&!(value instanceof Date)&&!(value instanceof Uint8Array)}TypeSystemPolicy22.IsRecordLike=IsRecordLike;function IsNumberLike(value){return TypeSystemPolicy22.AllowNaN?IsNumber22(value):Number.isFinite(value)}TypeSystemPolicy22.IsNumberLike=IsNumberLike;function IsVoidLike(value){let isUndefined=IsUndefined22(value);return TypeSystemPolicy22.AllowNullVoid?isUndefined||value===null:isUndefined}TypeSystemPolicy22.IsVoidLike=IsVoidLike})(TypeSystemPolicy2||(TypeSystemPolicy2={}));function ImmutableArray2(value){return globalThis.Object.freeze(value).map((value2)=>Immutable2(value2))}function ImmutableDate2(value){return value}function ImmutableUint8Array2(value){return value}function ImmutableRegExp2(value){return value}function ImmutableObject2(value){let result={};for(let key of Object.getOwnPropertyNames(value))result[key]=Immutable2(value[key]);for(let key of Object.getOwnPropertySymbols(value))result[key]=Immutable2(value[key]);return globalThis.Object.freeze(result)}function Immutable2(value){return IsArray5(value)?ImmutableArray2(value):IsDate5(value)?ImmutableDate2(value):IsUint8Array5(value)?ImmutableUint8Array2(value):IsRegExp4(value)?ImmutableRegExp2(value):IsObject5(value)?ImmutableObject2(value):value}function CreateType2(schema,options){let result=options!==void 0?{...options,...schema}:schema;switch(TypeSystemPolicy2.InstanceMode){case"freeze":return Immutable2(result);case"clone":return Clone3(result);default:return result}}var TypeBoxError2=class extends Error{constructor(message2){super(message2)}},TransformKind2=Symbol.for("TypeBox.Transform"),ReadonlyKind2=Symbol.for("TypeBox.Readonly"),OptionalKind2=Symbol.for("TypeBox.Optional"),Hint2=Symbol.for("TypeBox.Hint"),Kind2=Symbol.for("TypeBox.Kind");function IsReadonly3(value){return IsObject5(value)&&value[ReadonlyKind2]==="Readonly"}function IsOptional3(value){return IsObject5(value)&&value[OptionalKind2]==="Optional"}function IsAny3(value){return IsKindOf3(value,"Any")}function IsArgument3(value){return IsKindOf3(value,"Argument")}function IsArray32(value){return IsKindOf3(value,"Array")}function IsAsyncIterator22(value){return IsKindOf3(value,"AsyncIterator")}function IsBigInt22(value){return IsKindOf3(value,"BigInt")}function IsBoolean22(value){return IsKindOf3(value,"Boolean")}function IsComputed3(value){return IsKindOf3(value,"Computed")}function IsConstructor3(value){return IsKindOf3(value,"Constructor")}function IsDate22(value){return IsKindOf3(value,"Date")}function IsFunction22(value){return IsKindOf3(value,"Function")}function IsInteger4(value){return IsKindOf3(value,"Integer")}function IsIntersect3(value){return IsKindOf3(value,"Intersect")}function IsIterator22(value){return IsKindOf3(value,"Iterator")}function IsKindOf3(value,kind){return IsObject5(value)&&Kind2 in value&&value[Kind2]===kind}function IsLiteralValue3(value){return IsBoolean5(value)||IsNumber5(value)||IsString5(value)}function IsLiteral3(value){return IsKindOf3(value,"Literal")}function IsMappedKey3(value){return IsKindOf3(value,"MappedKey")}function IsMappedResult3(value){return IsKindOf3(value,"MappedResult")}function IsNever3(value){return IsKindOf3(value,"Never")}function IsNot3(value){return IsKindOf3(value,"Not")}function IsNull22(value){return IsKindOf3(value,"Null")}function IsNumber32(value){return IsKindOf3(value,"Number")}function IsObject32(value){return IsKindOf3(value,"Object")}function IsPromise4(value){return IsKindOf3(value,"Promise")}function IsRecord3(value){return IsKindOf3(value,"Record")}function IsRef3(value){return IsKindOf3(value,"Ref")}function IsRegExp22(value){return IsKindOf3(value,"RegExp")}function IsString22(value){return IsKindOf3(value,"String")}function IsSymbol22(value){return IsKindOf3(value,"Symbol")}function IsTemplateLiteral3(value){return IsKindOf3(value,"TemplateLiteral")}function IsThis3(value){return IsKindOf3(value,"This")}function IsTransform3(value){return IsObject5(value)&&TransformKind2 in value}function IsTuple3(value){return IsKindOf3(value,"Tuple")}function IsUndefined32(value){return IsKindOf3(value,"Undefined")}function IsUnion3(value){return IsKindOf3(value,"Union")}function IsUint8Array22(value){return IsKindOf3(value,"Uint8Array")}function IsUnknown3(value){return IsKindOf3(value,"Unknown")}function IsUnsafe3(value){return IsKindOf3(value,"Unsafe")}function IsVoid3(value){return IsKindOf3(value,"Void")}function IsKind3(value){return IsObject5(value)&&Kind2 in value&&IsString5(value[Kind2])}function IsSchema3(value){return IsAny3(value)||IsArgument3(value)||IsArray32(value)||IsBoolean22(value)||IsBigInt22(value)||IsAsyncIterator22(value)||IsComputed3(value)||IsConstructor3(value)||IsDate22(value)||IsFunction22(value)||IsInteger4(value)||IsIntersect3(value)||IsIterator22(value)||IsLiteral3(value)||IsMappedKey3(value)||IsMappedResult3(value)||IsNever3(value)||IsNot3(value)||IsNull22(value)||IsNumber32(value)||IsObject32(value)||IsPromise4(value)||IsRecord3(value)||IsRef3(value)||IsRegExp22(value)||IsString22(value)||IsSymbol22(value)||IsTemplateLiteral3(value)||IsThis3(value)||IsTuple3(value)||IsUndefined32(value)||IsUnion3(value)||IsUint8Array22(value)||IsUnknown3(value)||IsUnsafe3(value)||IsVoid3(value)||IsKind3(value)}var type_exports={};__export2(type_exports,{IsAny:()=>IsAny22,IsArgument:()=>IsArgument22,IsArray:()=>IsArray42,IsAsyncIterator:()=>IsAsyncIterator32,IsBigInt:()=>IsBigInt32,IsBoolean:()=>IsBoolean32,IsComputed:()=>IsComputed22,IsConstructor:()=>IsConstructor22,IsDate:()=>IsDate32,IsFunction:()=>IsFunction32,IsImport:()=>IsImport2,IsInteger:()=>IsInteger22,IsIntersect:()=>IsIntersect22,IsIterator:()=>IsIterator32,IsKind:()=>IsKind22,IsKindOf:()=>IsKindOf22,IsLiteral:()=>IsLiteral22,IsLiteralBoolean:()=>IsLiteralBoolean2,IsLiteralNumber:()=>IsLiteralNumber2,IsLiteralString:()=>IsLiteralString2,IsLiteralValue:()=>IsLiteralValue22,IsMappedKey:()=>IsMappedKey22,IsMappedResult:()=>IsMappedResult22,IsNever:()=>IsNever22,IsNot:()=>IsNot22,IsNull:()=>IsNull32,IsNumber:()=>IsNumber42,IsObject:()=>IsObject42,IsOptional:()=>IsOptional22,IsPromise:()=>IsPromise22,IsProperties:()=>IsProperties2,IsReadonly:()=>IsReadonly22,IsRecord:()=>IsRecord22,IsRecursive:()=>IsRecursive2,IsRef:()=>IsRef22,IsRegExp:()=>IsRegExp32,IsSchema:()=>IsSchema22,IsString:()=>IsString32,IsSymbol:()=>IsSymbol32,IsTemplateLiteral:()=>IsTemplateLiteral22,IsThis:()=>IsThis22,IsTransform:()=>IsTransform22,IsTuple:()=>IsTuple22,IsUint8Array:()=>IsUint8Array32,IsUndefined:()=>IsUndefined42,IsUnion:()=>IsUnion22,IsUnionLiteral:()=>IsUnionLiteral2,IsUnknown:()=>IsUnknown22,IsUnsafe:()=>IsUnsafe22,IsVoid:()=>IsVoid22,TypeGuardUnknownTypeError:()=>TypeGuardUnknownTypeError2});var TypeGuardUnknownTypeError2=class extends TypeBoxError2{},KnownTypes2=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function IsPattern2(value){try{return new RegExp(value),!0}catch{return!1}}function IsControlCharacterFree2(value){if(!IsString5(value))return!1;for(let i=0;i<value.length;i++){let code=value.charCodeAt(i);if(code>=7&&code<=13||code===27||code===127)return!1}return!0}function IsAdditionalProperties2(value){return IsOptionalBoolean2(value)||IsSchema22(value)}function IsOptionalBigInt2(value){return IsUndefined5(value)||IsBigInt5(value)}function IsOptionalNumber2(value){return IsUndefined5(value)||IsNumber5(value)}function IsOptionalBoolean2(value){return IsUndefined5(value)||IsBoolean5(value)}function IsOptionalString2(value){return IsUndefined5(value)||IsString5(value)}function IsOptionalPattern2(value){return IsUndefined5(value)||IsString5(value)&&IsControlCharacterFree2(value)&&IsPattern2(value)}function IsOptionalFormat2(value){return IsUndefined5(value)||IsString5(value)&&IsControlCharacterFree2(value)}function IsOptionalSchema2(value){return IsUndefined5(value)||IsSchema22(value)}function IsReadonly22(value){return IsObject5(value)&&value[ReadonlyKind2]==="Readonly"}function IsOptional22(value){return IsObject5(value)&&value[OptionalKind2]==="Optional"}function IsAny22(value){return IsKindOf22(value,"Any")&&IsOptionalString2(value.$id)}function IsArgument22(value){return IsKindOf22(value,"Argument")&&IsNumber5(value.index)}function IsArray42(value){return IsKindOf22(value,"Array")&&value.type==="array"&&IsOptionalString2(value.$id)&&IsSchema22(value.items)&&IsOptionalNumber2(value.minItems)&&IsOptionalNumber2(value.maxItems)&&IsOptionalBoolean2(value.uniqueItems)&&IsOptionalSchema2(value.contains)&&IsOptionalNumber2(value.minContains)&&IsOptionalNumber2(value.maxContains)}function IsAsyncIterator32(value){return IsKindOf22(value,"AsyncIterator")&&value.type==="AsyncIterator"&&IsOptionalString2(value.$id)&&IsSchema22(value.items)}function IsBigInt32(value){return IsKindOf22(value,"BigInt")&&value.type==="bigint"&&IsOptionalString2(value.$id)&&IsOptionalBigInt2(value.exclusiveMaximum)&&IsOptionalBigInt2(value.exclusiveMinimum)&&IsOptionalBigInt2(value.maximum)&&IsOptionalBigInt2(value.minimum)&&IsOptionalBigInt2(value.multipleOf)}function IsBoolean32(value){return IsKindOf22(value,"Boolean")&&value.type==="boolean"&&IsOptionalString2(value.$id)}function IsComputed22(value){return IsKindOf22(value,"Computed")&&IsString5(value.target)&&IsArray5(value.parameters)&&value.parameters.every((schema)=>IsSchema22(schema))}function IsConstructor22(value){return IsKindOf22(value,"Constructor")&&value.type==="Constructor"&&IsOptionalString2(value.$id)&&IsArray5(value.parameters)&&value.parameters.every((schema)=>IsSchema22(schema))&&IsSchema22(value.returns)}function IsDate32(value){return IsKindOf22(value,"Date")&&value.type==="Date"&&IsOptionalString2(value.$id)&&IsOptionalNumber2(value.exclusiveMaximumTimestamp)&&IsOptionalNumber2(value.exclusiveMinimumTimestamp)&&IsOptionalNumber2(value.maximumTimestamp)&&IsOptionalNumber2(value.minimumTimestamp)&&IsOptionalNumber2(value.multipleOfTimestamp)}function IsFunction32(value){return IsKindOf22(value,"Function")&&value.type==="Function"&&IsOptionalString2(value.$id)&&IsArray5(value.parameters)&&value.parameters.every((schema)=>IsSchema22(schema))&&IsSchema22(value.returns)}function IsImport2(value){return IsKindOf22(value,"Import")&&HasPropertyKey3(value,"$defs")&&IsObject5(value.$defs)&&IsProperties2(value.$defs)&&HasPropertyKey3(value,"$ref")&&IsString5(value.$ref)&&value.$ref in value.$defs}function IsInteger22(value){return IsKindOf22(value,"Integer")&&value.type==="integer"&&IsOptionalString2(value.$id)&&IsOptionalNumber2(value.exclusiveMaximum)&&IsOptionalNumber2(value.exclusiveMinimum)&&IsOptionalNumber2(value.maximum)&&IsOptionalNumber2(value.minimum)&&IsOptionalNumber2(value.multipleOf)}function IsProperties2(value){return IsObject5(value)&&Object.entries(value).every(([key,schema])=>IsControlCharacterFree2(key)&&IsSchema22(schema))}function IsIntersect22(value){return IsKindOf22(value,"Intersect")&&(IsString5(value.type)&&value.type!=="object"?!1:!0)&&IsArray5(value.allOf)&&value.allOf.every((schema)=>IsSchema22(schema)&&!IsTransform22(schema))&&IsOptionalString2(value.type)&&(IsOptionalBoolean2(value.unevaluatedProperties)||IsOptionalSchema2(value.unevaluatedProperties))&&IsOptionalString2(value.$id)}function IsIterator32(value){return IsKindOf22(value,"Iterator")&&value.type==="Iterator"&&IsOptionalString2(value.$id)&&IsSchema22(value.items)}function IsKindOf22(value,kind){return IsObject5(value)&&Kind2 in value&&value[Kind2]===kind}function IsLiteralString2(value){return IsLiteral22(value)&&IsString5(value.const)}function IsLiteralNumber2(value){return IsLiteral22(value)&&IsNumber5(value.const)}function IsLiteralBoolean2(value){return IsLiteral22(value)&&IsBoolean5(value.const)}function IsLiteral22(value){return IsKindOf22(value,"Literal")&&IsOptionalString2(value.$id)&&IsLiteralValue22(value.const)}function IsLiteralValue22(value){return IsBoolean5(value)||IsNumber5(value)||IsString5(value)}function IsMappedKey22(value){return IsKindOf22(value,"MappedKey")&&IsArray5(value.keys)&&value.keys.every((key)=>IsNumber5(key)||IsString5(key))}function IsMappedResult22(value){return IsKindOf22(value,"MappedResult")&&IsProperties2(value.properties)}function IsNever22(value){return IsKindOf22(value,"Never")&&IsObject5(value.not)&&Object.getOwnPropertyNames(value.not).length===0}function IsNot22(value){return IsKindOf22(value,"Not")&&IsSchema22(value.not)}function IsNull32(value){return IsKindOf22(value,"Null")&&value.type==="null"&&IsOptionalString2(value.$id)}function IsNumber42(value){return IsKindOf22(value,"Number")&&value.type==="number"&&IsOptionalString2(value.$id)&&IsOptionalNumber2(value.exclusiveMaximum)&&IsOptionalNumber2(value.exclusiveMinimum)&&IsOptionalNumber2(value.maximum)&&IsOptionalNumber2(value.minimum)&&IsOptionalNumber2(value.multipleOf)}function IsObject42(value){return IsKindOf22(value,"Object")&&value.type==="object"&&IsOptionalString2(value.$id)&&IsProperties2(value.properties)&&IsAdditionalProperties2(value.additionalProperties)&&IsOptionalNumber2(value.minProperties)&&IsOptionalNumber2(value.maxProperties)}function IsPromise22(value){return IsKindOf22(value,"Promise")&&value.type==="Promise"&&IsOptionalString2(value.$id)&&IsSchema22(value.item)}function IsRecord22(value){return IsKindOf22(value,"Record")&&value.type==="object"&&IsOptionalString2(value.$id)&&IsAdditionalProperties2(value.additionalProperties)&&IsObject5(value.patternProperties)&&((schema)=>{let keys=Object.getOwnPropertyNames(schema.patternProperties);return keys.length===1&&IsPattern2(keys[0])&&IsObject5(schema.patternProperties)&&IsSchema22(schema.patternProperties[keys[0]])})(value)}function IsRecursive2(value){return IsObject5(value)&&Hint2 in value&&value[Hint2]==="Recursive"}function IsRef22(value){return IsKindOf22(value,"Ref")&&IsOptionalString2(value.$id)&&IsString5(value.$ref)}function IsRegExp32(value){return IsKindOf22(value,"RegExp")&&IsOptionalString2(value.$id)&&IsString5(value.source)&&IsString5(value.flags)&&IsOptionalNumber2(value.maxLength)&&IsOptionalNumber2(value.minLength)}function IsString32(value){return IsKindOf22(value,"String")&&value.type==="string"&&IsOptionalString2(value.$id)&&IsOptionalNumber2(value.minLength)&&IsOptionalNumber2(value.maxLength)&&IsOptionalPattern2(value.pattern)&&IsOptionalFormat2(value.format)}function IsSymbol32(value){return IsKindOf22(value,"Symbol")&&value.type==="symbol"&&IsOptionalString2(value.$id)}function IsTemplateLiteral22(value){return IsKindOf22(value,"TemplateLiteral")&&value.type==="string"&&IsString5(value.pattern)&&value.pattern[0]==="^"&&value.pattern[value.pattern.length-1]==="$"}function IsThis22(value){return IsKindOf22(value,"This")&&IsOptionalString2(value.$id)&&IsString5(value.$ref)}function IsTransform22(value){return IsObject5(value)&&TransformKind2 in value}function IsTuple22(value){return IsKindOf22(value,"Tuple")&&value.type==="array"&&IsOptionalString2(value.$id)&&IsNumber5(value.minItems)&&IsNumber5(value.maxItems)&&value.minItems===value.maxItems&&(IsUndefined5(value.items)&&IsUndefined5(value.additionalItems)&&value.minItems===0||IsArray5(value.items)&&value.items.every((schema)=>IsSchema22(schema)))}function IsUndefined42(value){return IsKindOf22(value,"Undefined")&&value.type==="undefined"&&IsOptionalString2(value.$id)}function IsUnionLiteral2(value){return IsUnion22(value)&&value.anyOf.every((schema)=>IsLiteralString2(schema)||IsLiteralNumber2(schema))}function IsUnion22(value){return IsKindOf22(value,"Union")&&IsOptionalString2(value.$id)&&IsObject5(value)&&IsArray5(value.anyOf)&&value.anyOf.every((schema)=>IsSchema22(schema))}function IsUint8Array32(value){return IsKindOf22(value,"Uint8Array")&&value.type==="Uint8Array"&&IsOptionalString2(value.$id)&&IsOptionalNumber2(value.minByteLength)&&IsOptionalNumber2(value.maxByteLength)}function IsUnknown22(value){return IsKindOf22(value,"Unknown")&&IsOptionalString2(value.$id)}function IsUnsafe22(value){return IsKindOf22(value,"Unsafe")}function IsVoid22(value){return IsKindOf22(value,"Void")&&value.type==="void"&&IsOptionalString2(value.$id)}function IsKind22(value){return IsObject5(value)&&Kind2 in value&&IsString5(value[Kind2])&&!KnownTypes2.includes(value[Kind2])}function IsSchema22(value){return IsObject5(value)&&(IsAny22(value)||IsArgument22(value)||IsArray42(value)||IsBoolean32(value)||IsBigInt32(value)||IsAsyncIterator32(value)||IsComputed22(value)||IsConstructor22(value)||IsDate32(value)||IsFunction32(value)||IsInteger22(value)||IsIntersect22(value)||IsIterator32(value)||IsLiteral22(value)||IsMappedKey22(value)||IsMappedResult22(value)||IsNever22(value)||IsNot22(value)||IsNull32(value)||IsNumber42(value)||IsObject42(value)||IsPromise22(value)||IsRecord22(value)||IsRef22(value)||IsRegExp32(value)||IsString32(value)||IsSymbol32(value)||IsTemplateLiteral22(value)||IsThis22(value)||IsTuple22(value)||IsUndefined42(value)||IsUnion22(value)||IsUint8Array32(value)||IsUnknown22(value)||IsUnsafe22(value)||IsVoid22(value)||IsKind22(value))}var PatternBoolean2="(true|false)",PatternNumber2="(0|[1-9][0-9]*)",PatternString2="(.*)",PatternNever="(?!.*)",PatternBooleanExact=`^${PatternBoolean2}$`,PatternNumberExact2=`^${PatternNumber2}$`,PatternStringExact2=`^${PatternString2}$`,PatternNeverExact2=`^${PatternNever}$`;function SetIncludes2(T2,S){return T2.includes(S)}function SetDistinct2(T2){return[...new Set(T2)]}function SetIntersect2(T2,S){return T2.filter((L)=>S.includes(L))}function SetIntersectManyResolve2(T2,Init){return T2.reduce((Acc,L)=>{return SetIntersect2(Acc,L)},Init)}function SetIntersectMany2(T2){return T2.length===1?T2[0]:T2.length>1?SetIntersectManyResolve2(T2.slice(1),T2[0]):[]}function SetUnionMany2(T2){let Acc=[];for(let L of T2)Acc.push(...L);return Acc}function Any2(options){return CreateType2({[Kind2]:"Any"},options)}function Array22(items,options){return CreateType2({[Kind2]:"Array",type:"array",items},options)}function Argument2(index2){return CreateType2({[Kind2]:"Argument",index:index2})}function AsyncIterator2(items,options){return CreateType2({[Kind2]:"AsyncIterator",type:"AsyncIterator",items},options)}function Computed2(target,parameters,options){return CreateType2({[Kind2]:"Computed",target,parameters},options)}function DiscardKey2(value,key){let{[key]:_2,...rest}=value;return rest}function Discard2(value,keys){return keys.reduce((acc,key)=>DiscardKey2(acc,key),value)}function Never2(options){return CreateType2({[Kind2]:"Never",not:{}},options)}function MappedResult2(properties){return CreateType2({[Kind2]:"MappedResult",properties})}function Constructor2(parameters,returns2,options){return CreateType2({[Kind2]:"Constructor",type:"Constructor",parameters,returns:returns2},options)}function Function3(parameters,returns2,options){return CreateType2({[Kind2]:"Function",type:"Function",parameters,returns:returns2},options)}function UnionCreate2(T2,options){return CreateType2({[Kind2]:"Union",anyOf:T2},options)}function IsUnionOptional2(types3){return types3.some((type2)=>IsOptional3(type2))}function RemoveOptionalFromRest3(types3){return types3.map((left)=>IsOptional3(left)?RemoveOptionalFromType3(left):left)}function RemoveOptionalFromType3(T2){return Discard2(T2,[OptionalKind2])}function ResolveUnion2(types3,options){return IsUnionOptional2(types3)?Optional2(UnionCreate2(RemoveOptionalFromRest3(types3),options)):UnionCreate2(RemoveOptionalFromRest3(types3),options)}function UnionEvaluated2(T2,options){return T2.length===1?CreateType2(T2[0],options):T2.length===0?Never2(options):ResolveUnion2(T2,options)}function Union3(types3,options){return types3.length===0?Never2(options):types3.length===1?CreateType2(types3[0],options):UnionCreate2(types3,options)}var TemplateLiteralParserError2=class extends TypeBoxError2{};function Unescape2(pattern){return pattern.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function IsNonEscaped2(pattern,index2,char2){return pattern[index2]===char2&&pattern.charCodeAt(index2-1)!==92}function IsOpenParen2(pattern,index2){return IsNonEscaped2(pattern,index2,"(")}function IsCloseParen2(pattern,index2){return IsNonEscaped2(pattern,index2,")")}function IsSeparator2(pattern,index2){return IsNonEscaped2(pattern,index2,"|")}function IsGroup2(pattern){if(!(IsOpenParen2(pattern,0)&&IsCloseParen2(pattern,pattern.length-1)))return!1;let count2=0;for(let index2=0;index2<pattern.length;index2++){if(IsOpenParen2(pattern,index2))count2+=1;if(IsCloseParen2(pattern,index2))count2-=1;if(count2===0&&index2!==pattern.length-1)return!1}return!0}function InGroup2(pattern){return pattern.slice(1,pattern.length-1)}function IsPrecedenceOr2(pattern){let count2=0;for(let index2=0;index2<pattern.length;index2++){if(IsOpenParen2(pattern,index2))count2+=1;if(IsCloseParen2(pattern,index2))count2-=1;if(IsSeparator2(pattern,index2)&&count2===0)return!0}return!1}function IsPrecedenceAnd2(pattern){for(let index2=0;index2<pattern.length;index2++)if(IsOpenParen2(pattern,index2))return!0;return!1}function Or2(pattern){let[count2,start]=[0,0],expressions=[];for(let index2=0;index2<pattern.length;index2++){if(IsOpenParen2(pattern,index2))count2+=1;if(IsCloseParen2(pattern,index2))count2-=1;if(IsSeparator2(pattern,index2)&&count2===0){let range2=pattern.slice(start,index2);if(range2.length>0)expressions.push(TemplateLiteralParse2(range2));start=index2+1}}let range=pattern.slice(start);if(range.length>0)expressions.push(TemplateLiteralParse2(range));if(expressions.length===0)return{type:"const",const:""};if(expressions.length===1)return expressions[0];return{type:"or",expr:expressions}}function And2(pattern){function Group(value,index2){if(!IsOpenParen2(value,index2))throw new TemplateLiteralParserError2("TemplateLiteralParser: Index must point to open parens");let count2=0;for(let scan=index2;scan<value.length;scan++){if(IsOpenParen2(value,scan))count2+=1;if(IsCloseParen2(value,scan))count2-=1;if(count2===0)return[index2,scan]}throw new TemplateLiteralParserError2("TemplateLiteralParser: Unclosed group parens in expression")}function Range(pattern2,index2){for(let scan=index2;scan<pattern2.length;scan++)if(IsOpenParen2(pattern2,scan))return[index2,scan];return[index2,pattern2.length]}let expressions=[];for(let index2=0;index2<pattern.length;index2++)if(IsOpenParen2(pattern,index2)){let[start,end]=Group(pattern,index2),range=pattern.slice(start,end+1);expressions.push(TemplateLiteralParse2(range)),index2=end}else{let[start,end]=Range(pattern,index2),range=pattern.slice(start,end);if(range.length>0)expressions.push(TemplateLiteralParse2(range));index2=end-1}return expressions.length===0?{type:"const",const:""}:expressions.length===1?expressions[0]:{type:"and",expr:expressions}}function TemplateLiteralParse2(pattern){return IsGroup2(pattern)?TemplateLiteralParse2(InGroup2(pattern)):IsPrecedenceOr2(pattern)?Or2(pattern):IsPrecedenceAnd2(pattern)?And2(pattern):{type:"const",const:Unescape2(pattern)}}function TemplateLiteralParseExact2(pattern){return TemplateLiteralParse2(pattern.slice(1,pattern.length-1))}var TemplateLiteralFiniteError2=class extends TypeBoxError2{};function IsNumberExpression2(expression){return expression.type==="or"&&expression.expr.length===2&&expression.expr[0].type==="const"&&expression.expr[0].const==="0"&&expression.expr[1].type==="const"&&expression.expr[1].const==="[1-9][0-9]*"}function IsBooleanExpression2(expression){return expression.type==="or"&&expression.expr.length===2&&expression.expr[0].type==="const"&&expression.expr[0].const==="true"&&expression.expr[1].type==="const"&&expression.expr[1].const==="false"}function IsStringExpression2(expression){return expression.type==="const"&&expression.const===".*"}function IsTemplateLiteralExpressionFinite2(expression){return IsNumberExpression2(expression)||IsStringExpression2(expression)?!1:IsBooleanExpression2(expression)?!0:expression.type==="and"?expression.expr.every((expr)=>IsTemplateLiteralExpressionFinite2(expr)):expression.type==="or"?expression.expr.every((expr)=>IsTemplateLiteralExpressionFinite2(expr)):expression.type==="const"?!0:(()=>{throw new TemplateLiteralFiniteError2("Unknown expression type")})()}function IsTemplateLiteralFinite2(schema){let expression=TemplateLiteralParseExact2(schema.pattern);return IsTemplateLiteralExpressionFinite2(expression)}var TemplateLiteralGenerateError2=class extends TypeBoxError2{};function*GenerateReduce2(buffer2){if(buffer2.length===1)return yield*buffer2[0];for(let left of buffer2[0])for(let right of GenerateReduce2(buffer2.slice(1)))yield`${left}${right}`}function*GenerateAnd2(expression){return yield*GenerateReduce2(expression.expr.map((expr)=>[...TemplateLiteralExpressionGenerate2(expr)]))}function*GenerateOr2(expression){for(let expr of expression.expr)yield*TemplateLiteralExpressionGenerate2(expr)}function*GenerateConst2(expression){return yield expression.const}function*TemplateLiteralExpressionGenerate2(expression){return expression.type==="and"?yield*GenerateAnd2(expression):expression.type==="or"?yield*GenerateOr2(expression):expression.type==="const"?yield*GenerateConst2(expression):(()=>{throw new TemplateLiteralGenerateError2("Unknown expression")})()}function TemplateLiteralGenerate2(schema){let expression=TemplateLiteralParseExact2(schema.pattern);return IsTemplateLiteralExpressionFinite2(expression)?[...TemplateLiteralExpressionGenerate2(expression)]:[]}function Literal2(value,options){return CreateType2({[Kind2]:"Literal",const:value,type:typeof value},options)}function Boolean3(options){return CreateType2({[Kind2]:"Boolean",type:"boolean"},options)}function BigInt3(options){return CreateType2({[Kind2]:"BigInt",type:"bigint"},options)}function Number22(options){return CreateType2({[Kind2]:"Number",type:"number"},options)}function String3(options){return CreateType2({[Kind2]:"String",type:"string"},options)}function*FromUnion21(syntax){let trim=syntax.trim().replace(/"|'/g,"");return trim==="boolean"?yield Boolean3():trim==="number"?yield Number22():trim==="bigint"?yield BigInt3():trim==="string"?yield String3():yield(()=>{let literals=trim.split("|").map((literal)=>Literal2(literal.trim()));return literals.length===0?Never2():literals.length===1?literals[0]:UnionEvaluated2(literals)})()}function*FromTerminal2(syntax){if(syntax[1]!=="{"){let L=Literal2("$"),R=FromSyntax2(syntax.slice(1));return yield*[L,...R]}for(let i=2;i<syntax.length;i++)if(syntax[i]==="}"){let L=FromUnion21(syntax.slice(2,i)),R=FromSyntax2(syntax.slice(i+1));return yield*[...L,...R]}yield Literal2(syntax)}function*FromSyntax2(syntax){for(let i=0;i<syntax.length;i++)if(syntax[i]==="$"){let L=Literal2(syntax.slice(0,i)),R=FromTerminal2(syntax.slice(i));return yield*[L,...R]}yield Literal2(syntax)}function TemplateLiteralSyntax2(syntax){return[...FromSyntax2(syntax)]}var TemplateLiteralPatternError2=class extends TypeBoxError2{};function Escape3(value){return value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Visit22(schema,acc){return IsTemplateLiteral3(schema)?schema.pattern.slice(1,schema.pattern.length-1):IsUnion3(schema)?`(${schema.anyOf.map((schema2)=>Visit22(schema2,acc)).join("|")})`:IsNumber32(schema)?`${acc}${PatternNumber2}`:IsInteger4(schema)?`${acc}${PatternNumber2}`:IsBigInt22(schema)?`${acc}${PatternNumber2}`:IsString22(schema)?`${acc}${PatternString2}`:IsLiteral3(schema)?`${acc}${Escape3(schema.const.toString())}`:IsBoolean22(schema)?`${acc}${PatternBoolean2}`:(()=>{throw new TemplateLiteralPatternError2(`Unexpected Kind '${schema[Kind2]}'`)})()}function TemplateLiteralPattern2(kinds){return`^${kinds.map((schema)=>Visit22(schema,"")).join("")}$`}function TemplateLiteralToUnion2(schema){let L=TemplateLiteralGenerate2(schema).map((S)=>Literal2(S));return UnionEvaluated2(L)}function TemplateLiteral2(unresolved,options){let pattern=IsString5(unresolved)?TemplateLiteralPattern2(TemplateLiteralSyntax2(unresolved)):TemplateLiteralPattern2(unresolved);return CreateType2({[Kind2]:"TemplateLiteral",type:"string",pattern},options)}function FromTemplateLiteral7(templateLiteral){return TemplateLiteralGenerate2(templateLiteral).map((key)=>key.toString())}function FromUnion22(types3){let result=[];for(let type2 of types3)result.push(...IndexPropertyKeys2(type2));return result}function FromLiteral7(literalValue){return[literalValue.toString()]}function IndexPropertyKeys2(type2){return[...new Set(IsTemplateLiteral3(type2)?FromTemplateLiteral7(type2):IsUnion3(type2)?FromUnion22(type2.anyOf):IsLiteral3(type2)?FromLiteral7(type2.const):IsNumber32(type2)?["[number]"]:IsInteger4(type2)?["[number]"]:[])]}function FromProperties20(type2,properties,options){let result={};for(let K2 of Object.getOwnPropertyNames(properties))result[K2]=Index3(type2,IndexPropertyKeys2(properties[K2]),options);return result}function FromMappedResult13(type2,mappedResult,options){return FromProperties20(type2,mappedResult.properties,options)}function IndexFromMappedResult2(type2,mappedResult,options){let properties=FromMappedResult13(type2,mappedResult,options);return MappedResult2(properties)}function FromRest8(types3,key){return types3.map((type2)=>IndexFromPropertyKey2(type2,key))}function FromIntersectRest2(types3){return types3.filter((type2)=>!IsNever3(type2))}function FromIntersect19(types3,key){return IntersectEvaluated2(FromIntersectRest2(FromRest8(types3,key)))}function FromUnionRest2(types3){return types3.some((L)=>IsNever3(L))?[]:types3}function FromUnion32(types3,key){return UnionEvaluated2(FromUnionRest2(FromRest8(types3,key)))}function FromTuple16(types3,key){return key in types3?types3[key]:key==="[number]"?UnionEvaluated2(types3):Never2()}function FromArray18(type2,key){return key==="[number]"?type2:Never2()}function FromProperty4(properties,propertyKey){return propertyKey in properties?properties[propertyKey]:Never2()}function IndexFromPropertyKey2(type2,propertyKey){return IsIntersect3(type2)?FromIntersect19(type2.allOf,propertyKey):IsUnion3(type2)?FromUnion32(type2.anyOf,propertyKey):IsTuple3(type2)?FromTuple16(type2.items??[],propertyKey):IsArray32(type2)?FromArray18(type2.items,propertyKey):IsObject32(type2)?FromProperty4(type2.properties,propertyKey):Never2()}function IndexFromPropertyKeys2(type2,propertyKeys){return propertyKeys.map((propertyKey)=>IndexFromPropertyKey2(type2,propertyKey))}function FromSchema2(type2,propertyKeys){return UnionEvaluated2(IndexFromPropertyKeys2(type2,propertyKeys))}function Index3(type2,key,options){if(IsRef3(type2)||IsRef3(key)){if(!IsSchema3(type2)||!IsSchema3(key))throw new TypeBoxError2("Index types using Ref parameters require both Type and Key to be of TSchema");return Computed2("Index",[type2,key])}if(IsMappedResult3(key))return IndexFromMappedResult2(type2,key,options);if(IsMappedKey3(key))return IndexFromMappedKey2(type2,key,options);return CreateType2(IsSchema3(key)?FromSchema2(type2,IndexPropertyKeys2(key)):FromSchema2(type2,key),options)}function MappedIndexPropertyKey2(type2,key,options){return{[key]:Index3(type2,[key],Clone3(options))}}function MappedIndexPropertyKeys2(type2,propertyKeys,options){return propertyKeys.reduce((result,left)=>{return{...result,...MappedIndexPropertyKey2(type2,left,options)}},{})}function MappedIndexProperties2(type2,mappedKey,options){return MappedIndexPropertyKeys2(type2,mappedKey.keys,options)}function IndexFromMappedKey2(type2,mappedKey,options){let properties=MappedIndexProperties2(type2,mappedKey,options);return MappedResult2(properties)}function Iterator2(items,options){return CreateType2({[Kind2]:"Iterator",type:"Iterator",items},options)}function RequiredKeys2(properties){let keys=[];for(let key in properties)if(!IsOptional3(properties[key]))keys.push(key);return keys}function _Object2(properties,options){let required=RequiredKeys2(properties),schematic=required.length>0?{[Kind2]:"Object",type:"object",properties,required}:{[Kind2]:"Object",type:"object",properties};return CreateType2(schematic,options)}var Object22=_Object2;function Promise22(item,options){return CreateType2({[Kind2]:"Promise",type:"Promise",item},options)}function RemoveReadonly2(schema){return CreateType2(Discard2(schema,[ReadonlyKind2]))}function AddReadonly2(schema){return CreateType2({...schema,[ReadonlyKind2]:"Readonly"})}function ReadonlyWithFlag2(schema,F){return F===!1?RemoveReadonly2(schema):AddReadonly2(schema)}function Readonly2(schema,enable){let F=enable??!0;return IsMappedResult3(schema)?ReadonlyFromMappedResult2(schema,F):ReadonlyWithFlag2(schema,F)}function FromProperties22(K,F){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(K))Acc[K2]=Readonly2(K[K2],F);return Acc}function FromMappedResult22(R,F){return FromProperties22(R.properties,F)}function ReadonlyFromMappedResult2(R,F){let P=FromMappedResult22(R,F);return MappedResult2(P)}function Tuple2(types3,options){return CreateType2(types3.length>0?{[Kind2]:"Tuple",type:"array",items:types3,additionalItems:!1,minItems:types3.length,maxItems:types3.length}:{[Kind2]:"Tuple",type:"array",minItems:types3.length,maxItems:types3.length},options)}function FromMappedResult32(K,P){return K in P?FromSchemaType2(K,P[K]):MappedResult2(P)}function MappedKeyToKnownMappedResultProperties2(K){return{[K]:Literal2(K)}}function MappedKeyToUnknownMappedResultProperties2(P){let Acc={};for(let L of P)Acc[L]=Literal2(L);return Acc}function MappedKeyToMappedResultProperties2(K,P){return SetIncludes2(P,K)?MappedKeyToKnownMappedResultProperties2(K):MappedKeyToUnknownMappedResultProperties2(P)}function FromMappedKey5(K,P){let R=MappedKeyToMappedResultProperties2(K,P);return FromMappedResult32(K,R)}function FromRest22(K,T2){return T2.map((L)=>FromSchemaType2(K,L))}function FromProperties32(K,T2){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(T2))Acc[K2]=FromSchemaType2(K,T2[K2]);return Acc}function FromSchemaType2(K,T2){let options={...T2};return IsOptional3(T2)?Optional2(FromSchemaType2(K,Discard2(T2,[OptionalKind2]))):IsReadonly3(T2)?Readonly2(FromSchemaType2(K,Discard2(T2,[ReadonlyKind2]))):IsMappedResult3(T2)?FromMappedResult32(K,T2.properties):IsMappedKey3(T2)?FromMappedKey5(K,T2.keys):IsConstructor3(T2)?Constructor2(FromRest22(K,T2.parameters),FromSchemaType2(K,T2.returns),options):IsFunction22(T2)?Function3(FromRest22(K,T2.parameters),FromSchemaType2(K,T2.returns),options):IsAsyncIterator22(T2)?AsyncIterator2(FromSchemaType2(K,T2.items),options):IsIterator22(T2)?Iterator2(FromSchemaType2(K,T2.items),options):IsIntersect3(T2)?Intersect3(FromRest22(K,T2.allOf),options):IsUnion3(T2)?Union3(FromRest22(K,T2.anyOf),options):IsTuple3(T2)?Tuple2(FromRest22(K,T2.items??[]),options):IsObject32(T2)?Object22(FromProperties32(K,T2.properties),options):IsArray32(T2)?Array22(FromSchemaType2(K,T2.items),options):IsPromise4(T2)?Promise22(FromSchemaType2(K,T2.item),options):T2}function MappedFunctionReturnType2(K,T2){let Acc={};for(let L of K)Acc[L]=FromSchemaType2(L,T2);return Acc}function Mapped2(key,map3,options){let K=IsSchema3(key)?IndexPropertyKeys2(key):key,RT=map3({[Kind2]:"MappedKey",keys:K}),R=MappedFunctionReturnType2(K,RT);return Object22(R,options)}function RemoveOptional2(schema){return CreateType2(Discard2(schema,[OptionalKind2]))}function AddOptional2(schema){return CreateType2({...schema,[OptionalKind2]:"Optional"})}function OptionalWithFlag2(schema,F){return F===!1?RemoveOptional2(schema):AddOptional2(schema)}function Optional2(schema,enable){let F=enable??!0;return IsMappedResult3(schema)?OptionalFromMappedResult2(schema,F):OptionalWithFlag2(schema,F)}function FromProperties42(P,F){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Optional2(P[K2],F);return Acc}function FromMappedResult42(R,F){return FromProperties42(R.properties,F)}function OptionalFromMappedResult2(R,F){let P=FromMappedResult42(R,F);return MappedResult2(P)}function IntersectCreate2(T2,options={}){let allObjects=T2.every((schema)=>IsObject32(schema)),clonedUnevaluatedProperties=IsSchema3(options.unevaluatedProperties)?{unevaluatedProperties:options.unevaluatedProperties}:{};return CreateType2(options.unevaluatedProperties===!1||IsSchema3(options.unevaluatedProperties)||allObjects?{...clonedUnevaluatedProperties,[Kind2]:"Intersect",type:"object",allOf:T2}:{...clonedUnevaluatedProperties,[Kind2]:"Intersect",allOf:T2},options)}function IsIntersectOptional2(types3){return types3.every((left)=>IsOptional3(left))}function RemoveOptionalFromType22(type2){return Discard2(type2,[OptionalKind2])}function RemoveOptionalFromRest22(types3){return types3.map((left)=>IsOptional3(left)?RemoveOptionalFromType22(left):left)}function ResolveIntersect2(types3,options){return IsIntersectOptional2(types3)?Optional2(IntersectCreate2(RemoveOptionalFromRest22(types3),options)):IntersectCreate2(RemoveOptionalFromRest22(types3),options)}function IntersectEvaluated2(types3,options={}){if(types3.length===1)return CreateType2(types3[0],options);if(types3.length===0)return Never2(options);if(types3.some((schema)=>IsTransform3(schema)))throw new Error("Cannot intersect transform types");return ResolveIntersect2(types3,options)}function Intersect3(types3,options){if(types3.length===1)return CreateType2(types3[0],options);if(types3.length===0)return Never2(options);if(types3.some((schema)=>IsTransform3(schema)))throw new Error("Cannot intersect transform types");return IntersectCreate2(types3,options)}function Ref2(...args){let[$ref,options]=typeof args[0]==="string"?[args[0],args[1]]:[args[0].$id,args[1]];if(typeof $ref!=="string")throw new TypeBoxError2("Ref: $ref must be a string");return CreateType2({[Kind2]:"Ref",$ref},options)}function FromComputed6(target,parameters){return Computed2("Awaited",[Computed2(target,parameters)])}function FromRef15($ref){return Computed2("Awaited",[Ref2($ref)])}function FromIntersect22(types3){return Intersect3(FromRest32(types3))}function FromUnion42(types3){return Union3(FromRest32(types3))}function FromPromise8(type2){return Awaited2(type2)}function FromRest32(types3){return types3.map((type2)=>Awaited2(type2))}function Awaited2(type2,options){return CreateType2(IsComputed3(type2)?FromComputed6(type2.target,type2.parameters):IsIntersect3(type2)?FromIntersect22(type2.allOf):IsUnion3(type2)?FromUnion42(type2.anyOf):IsPromise4(type2)?FromPromise8(type2.item):IsRef3(type2)?FromRef15(type2.$ref):type2,options)}function FromRest42(types3){let result=[];for(let L of types3)result.push(KeyOfPropertyKeys2(L));return result}function FromIntersect32(types3){let propertyKeysArray=FromRest42(types3);return SetUnionMany2(propertyKeysArray)}function FromUnion52(types3){let propertyKeysArray=FromRest42(types3);return SetIntersectMany2(propertyKeysArray)}function FromTuple22(types3){return types3.map((_2,indexer)=>indexer.toString())}function FromArray22(_2){return["[number]"]}function FromProperties52(T2){return globalThis.Object.getOwnPropertyNames(T2)}function FromPatternProperties2(patternProperties){if(!includePatternProperties2)return[];return globalThis.Object.getOwnPropertyNames(patternProperties).map((key)=>{return key[0]==="^"&&key[key.length-1]==="$"?key.slice(1,key.length-1):key})}function KeyOfPropertyKeys2(type2){return IsIntersect3(type2)?FromIntersect32(type2.allOf):IsUnion3(type2)?FromUnion52(type2.anyOf):IsTuple3(type2)?FromTuple22(type2.items??[]):IsArray32(type2)?FromArray22(type2.items):IsObject32(type2)?FromProperties52(type2.properties):IsRecord3(type2)?FromPatternProperties2(type2.patternProperties):[]}var includePatternProperties2=!1;function FromComputed22(target,parameters){return Computed2("KeyOf",[Computed2(target,parameters)])}function FromRef22($ref){return Computed2("KeyOf",[Ref2($ref)])}function KeyOfFromType2(type2,options){let propertyKeys=KeyOfPropertyKeys2(type2),propertyKeyTypes=KeyOfPropertyKeysToRest2(propertyKeys),result=UnionEvaluated2(propertyKeyTypes);return CreateType2(result,options)}function KeyOfPropertyKeysToRest2(propertyKeys){return propertyKeys.map((L)=>L==="[number]"?Number22():Literal2(L))}function KeyOf2(type2,options){return IsComputed3(type2)?FromComputed22(type2.target,type2.parameters):IsRef3(type2)?FromRef22(type2.$ref):IsMappedResult3(type2)?KeyOfFromMappedResult2(type2,options):KeyOfFromType2(type2,options)}function FromProperties62(properties,options){let result={};for(let K2 of globalThis.Object.getOwnPropertyNames(properties))result[K2]=KeyOf2(properties[K2],Clone3(options));return result}function FromMappedResult52(mappedResult,options){return FromProperties62(mappedResult.properties,options)}function KeyOfFromMappedResult2(mappedResult,options){let properties=FromMappedResult52(mappedResult,options);return MappedResult2(properties)}function CompositeKeys2(T2){let Acc=[];for(let L of T2)Acc.push(...KeyOfPropertyKeys2(L));return SetDistinct2(Acc)}function FilterNever2(T2){return T2.filter((L)=>!IsNever3(L))}function CompositeProperty2(T2,K){let Acc=[];for(let L of T2)Acc.push(...IndexFromPropertyKeys2(L,[K]));return FilterNever2(Acc)}function CompositeProperties2(T2,K){let Acc={};for(let L of K)Acc[L]=IntersectEvaluated2(CompositeProperty2(T2,L));return Acc}function Composite2(T2,options){let K=CompositeKeys2(T2),P=CompositeProperties2(T2,K);return Object22(P,options)}function Date22(options){return CreateType2({[Kind2]:"Date",type:"Date"},options)}function Null2(options){return CreateType2({[Kind2]:"Null",type:"null"},options)}function Symbol22(options){return CreateType2({[Kind2]:"Symbol",type:"symbol"},options)}function Undefined2(options){return CreateType2({[Kind2]:"Undefined",type:"undefined"},options)}function Uint8Array22(options){return CreateType2({[Kind2]:"Uint8Array",type:"Uint8Array"},options)}function Unknown2(options){return CreateType2({[Kind2]:"Unknown"},options)}function FromArray32(T2){return T2.map((L)=>FromValue3(L,!1))}function FromProperties72(value){let Acc={};for(let K of globalThis.Object.getOwnPropertyNames(value))Acc[K]=Readonly2(FromValue3(value[K],!1));return Acc}function ConditionalReadonly2(T2,root){return root===!0?T2:Readonly2(T2)}function FromValue3(value,root){return IsAsyncIterator5(value)?ConditionalReadonly2(Any2(),root):IsIterator5(value)?ConditionalReadonly2(Any2(),root):IsArray5(value)?Readonly2(Tuple2(FromArray32(value))):IsUint8Array5(value)?Uint8Array22():IsDate5(value)?Date22():IsObject5(value)?ConditionalReadonly2(Object22(FromProperties72(value)),root):IsFunction5(value)?ConditionalReadonly2(Function3([],Unknown2()),root):IsUndefined5(value)?Undefined2():IsNull5(value)?Null2():IsSymbol5(value)?Symbol22():IsBigInt5(value)?BigInt3():IsNumber5(value)?Literal2(value):IsBoolean5(value)?Literal2(value):IsString5(value)?Literal2(value):Object22({})}function Const2(T2,options){return CreateType2(FromValue3(T2,!0),options)}function ConstructorParameters2(schema,options){return IsConstructor3(schema)?Tuple2(schema.parameters,options):Never2(options)}function Enum2(item,options){if(IsUndefined5(item))throw new Error("Enum undefined or empty");let values1=globalThis.Object.getOwnPropertyNames(item).filter((key)=>isNaN(key)).map((key)=>item[key]),anyOf=[...new Set(values1)].map((value)=>Literal2(value));return Union3(anyOf,{...options,[Hint2]:"Enum"})}var ExtendsResolverError2=class extends TypeBoxError2{},ExtendsResult2;(function(ExtendsResult22){ExtendsResult22[ExtendsResult22.Union=0]="Union",ExtendsResult22[ExtendsResult22.True=1]="True",ExtendsResult22[ExtendsResult22.False=2]="False"})(ExtendsResult2||(ExtendsResult2={}));function IntoBooleanResult2(result){return result===ExtendsResult2.False?result:ExtendsResult2.True}function Throw2(message2){throw new ExtendsResolverError2(message2)}function IsStructuralRight2(right){return type_exports.IsNever(right)||type_exports.IsIntersect(right)||type_exports.IsUnion(right)||type_exports.IsUnknown(right)||type_exports.IsAny(right)}function StructuralRight2(left,right){return type_exports.IsNever(right)?FromNeverRight2(left,right):type_exports.IsIntersect(right)?FromIntersectRight2(left,right):type_exports.IsUnion(right)?FromUnionRight2(left,right):type_exports.IsUnknown(right)?FromUnknownRight2(left,right):type_exports.IsAny(right)?FromAnyRight2(left,right):Throw2("StructuralRight")}function FromAnyRight2(left,right){return ExtendsResult2.True}function FromAny5(left,right){return type_exports.IsIntersect(right)?FromIntersectRight2(left,right):type_exports.IsUnion(right)&&right.anyOf.some((schema)=>type_exports.IsAny(schema)||type_exports.IsUnknown(schema))?ExtendsResult2.True:type_exports.IsUnion(right)?ExtendsResult2.Union:type_exports.IsUnknown(right)?ExtendsResult2.True:type_exports.IsAny(right)?ExtendsResult2.True:ExtendsResult2.Union}function FromArrayRight2(left,right){return type_exports.IsUnknown(left)?ExtendsResult2.False:type_exports.IsAny(left)?ExtendsResult2.Union:type_exports.IsNever(left)?ExtendsResult2.True:ExtendsResult2.False}function FromArray42(left,right){return type_exports.IsObject(right)&&IsObjectArrayLike2(right)?ExtendsResult2.True:IsStructuralRight2(right)?StructuralRight2(left,right):!type_exports.IsArray(right)?ExtendsResult2.False:IntoBooleanResult2(Visit32(left.items,right.items))}function FromAsyncIterator8(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):!type_exports.IsAsyncIterator(right)?ExtendsResult2.False:IntoBooleanResult2(Visit32(left.items,right.items))}function FromBigInt6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsBigInt(right)?ExtendsResult2.True:ExtendsResult2.False}function FromBooleanRight2(left,right){return type_exports.IsLiteralBoolean(left)?ExtendsResult2.True:type_exports.IsBoolean(left)?ExtendsResult2.True:ExtendsResult2.False}function FromBoolean6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsBoolean(right)?ExtendsResult2.True:ExtendsResult2.False}function FromConstructor9(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):!type_exports.IsConstructor(right)?ExtendsResult2.False:left.parameters.length>right.parameters.length?ExtendsResult2.False:!left.parameters.every((schema,index2)=>IntoBooleanResult2(Visit32(right.parameters[index2],schema))===ExtendsResult2.True)?ExtendsResult2.False:IntoBooleanResult2(Visit32(left.returns,right.returns))}function FromDate8(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsDate(right)?ExtendsResult2.True:ExtendsResult2.False}function FromFunction8(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):!type_exports.IsFunction(right)?ExtendsResult2.False:left.parameters.length>right.parameters.length?ExtendsResult2.False:!left.parameters.every((schema,index2)=>IntoBooleanResult2(Visit32(right.parameters[index2],schema))===ExtendsResult2.True)?ExtendsResult2.False:IntoBooleanResult2(Visit32(left.returns,right.returns))}function FromIntegerRight2(left,right){return type_exports.IsLiteral(left)&&value_exports.IsNumber(left.const)?ExtendsResult2.True:type_exports.IsNumber(left)||type_exports.IsInteger(left)?ExtendsResult2.True:ExtendsResult2.False}function FromInteger6(left,right){return type_exports.IsInteger(right)||type_exports.IsNumber(right)?ExtendsResult2.True:IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):ExtendsResult2.False}function FromIntersectRight2(left,right){return right.allOf.every((schema)=>Visit32(left,schema)===ExtendsResult2.True)?ExtendsResult2.True:ExtendsResult2.False}function FromIntersect42(left,right){return left.allOf.some((schema)=>Visit32(schema,right)===ExtendsResult2.True)?ExtendsResult2.True:ExtendsResult2.False}function FromIterator8(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):!type_exports.IsIterator(right)?ExtendsResult2.False:IntoBooleanResult2(Visit32(left.items,right.items))}function FromLiteral22(left,right){return type_exports.IsLiteral(right)&&right.const===left.const?ExtendsResult2.True:IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsString(right)?FromStringRight2(left,right):type_exports.IsNumber(right)?FromNumberRight2(left,right):type_exports.IsInteger(right)?FromIntegerRight2(left,right):type_exports.IsBoolean(right)?FromBooleanRight2(left,right):ExtendsResult2.False}function FromNeverRight2(left,right){return ExtendsResult2.False}function FromNever6(left,right){return ExtendsResult2.True}function UnwrapTNot2(schema){let[current,depth]=[schema,0];while(!0){if(!type_exports.IsNot(current))break;current=current.not,depth+=1}return depth%2===0?current:Unknown2()}function FromNot8(left,right){return type_exports.IsNot(left)?Visit32(UnwrapTNot2(left),right):type_exports.IsNot(right)?Visit32(left,UnwrapTNot2(right)):Throw2("Invalid fallthrough for Not")}function FromNull6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsNull(right)?ExtendsResult2.True:ExtendsResult2.False}function FromNumberRight2(left,right){return type_exports.IsLiteralNumber(left)?ExtendsResult2.True:type_exports.IsNumber(left)||type_exports.IsInteger(left)?ExtendsResult2.True:ExtendsResult2.False}function FromNumber6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsInteger(right)||type_exports.IsNumber(right)?ExtendsResult2.True:ExtendsResult2.False}function IsObjectPropertyCount2(schema,count2){return Object.getOwnPropertyNames(schema.properties).length===count2}function IsObjectStringLike2(schema){return IsObjectArrayLike2(schema)}function IsObjectSymbolLike2(schema){return IsObjectPropertyCount2(schema,0)||IsObjectPropertyCount2(schema,1)&&"description"in schema.properties&&type_exports.IsUnion(schema.properties.description)&&schema.properties.description.anyOf.length===2&&(type_exports.IsString(schema.properties.description.anyOf[0])&&type_exports.IsUndefined(schema.properties.description.anyOf[1])||type_exports.IsString(schema.properties.description.anyOf[1])&&type_exports.IsUndefined(schema.properties.description.anyOf[0]))}function IsObjectNumberLike2(schema){return IsObjectPropertyCount2(schema,0)}function IsObjectBooleanLike2(schema){return IsObjectPropertyCount2(schema,0)}function IsObjectBigIntLike2(schema){return IsObjectPropertyCount2(schema,0)}function IsObjectDateLike2(schema){return IsObjectPropertyCount2(schema,0)}function IsObjectUint8ArrayLike2(schema){return IsObjectArrayLike2(schema)}function IsObjectFunctionLike2(schema){let length=Number22();return IsObjectPropertyCount2(schema,0)||IsObjectPropertyCount2(schema,1)&&"length"in schema.properties&&IntoBooleanResult2(Visit32(schema.properties.length,length))===ExtendsResult2.True}function IsObjectConstructorLike2(schema){return IsObjectPropertyCount2(schema,0)}function IsObjectArrayLike2(schema){let length=Number22();return IsObjectPropertyCount2(schema,0)||IsObjectPropertyCount2(schema,1)&&"length"in schema.properties&&IntoBooleanResult2(Visit32(schema.properties.length,length))===ExtendsResult2.True}function IsObjectPromiseLike2(schema){let then=Function3([Any2()],Any2());return IsObjectPropertyCount2(schema,0)||IsObjectPropertyCount2(schema,1)&&"then"in schema.properties&&IntoBooleanResult2(Visit32(schema.properties.then,then))===ExtendsResult2.True}function Property2(left,right){return Visit32(left,right)===ExtendsResult2.False?ExtendsResult2.False:type_exports.IsOptional(left)&&!type_exports.IsOptional(right)?ExtendsResult2.False:ExtendsResult2.True}function FromObjectRight2(left,right){return type_exports.IsUnknown(left)?ExtendsResult2.False:type_exports.IsAny(left)?ExtendsResult2.Union:type_exports.IsNever(left)||type_exports.IsLiteralString(left)&&IsObjectStringLike2(right)||type_exports.IsLiteralNumber(left)&&IsObjectNumberLike2(right)||type_exports.IsLiteralBoolean(left)&&IsObjectBooleanLike2(right)||type_exports.IsSymbol(left)&&IsObjectSymbolLike2(right)||type_exports.IsBigInt(left)&&IsObjectBigIntLike2(right)||type_exports.IsString(left)&&IsObjectStringLike2(right)||type_exports.IsSymbol(left)&&IsObjectSymbolLike2(right)||type_exports.IsNumber(left)&&IsObjectNumberLike2(right)||type_exports.IsInteger(left)&&IsObjectNumberLike2(right)||type_exports.IsBoolean(left)&&IsObjectBooleanLike2(right)||type_exports.IsUint8Array(left)&&IsObjectUint8ArrayLike2(right)||type_exports.IsDate(left)&&IsObjectDateLike2(right)||type_exports.IsConstructor(left)&&IsObjectConstructorLike2(right)||type_exports.IsFunction(left)&&IsObjectFunctionLike2(right)?ExtendsResult2.True:type_exports.IsRecord(left)&&type_exports.IsString(RecordKey3(left))?(()=>{return right[Hint2]==="Record"?ExtendsResult2.True:ExtendsResult2.False})():type_exports.IsRecord(left)&&type_exports.IsNumber(RecordKey3(left))?(()=>{return IsObjectPropertyCount2(right,0)?ExtendsResult2.True:ExtendsResult2.False})():ExtendsResult2.False}function FromObject19(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):!type_exports.IsObject(right)?ExtendsResult2.False:(()=>{for(let key of Object.getOwnPropertyNames(right.properties)){if(!(key in left.properties)&&!type_exports.IsOptional(right.properties[key]))return ExtendsResult2.False;if(type_exports.IsOptional(right.properties[key]))return ExtendsResult2.True;if(Property2(left.properties[key],right.properties[key])===ExtendsResult2.False)return ExtendsResult2.False}return ExtendsResult2.True})()}function FromPromise22(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)&&IsObjectPromiseLike2(right)?ExtendsResult2.True:!type_exports.IsPromise(right)?ExtendsResult2.False:IntoBooleanResult2(Visit32(left.item,right.item))}function RecordKey3(schema){return PatternNumberExact2 in schema.patternProperties?Number22():(PatternStringExact2 in schema.patternProperties)?String3():Throw2("Unknown record key pattern")}function RecordValue3(schema){return PatternNumberExact2 in schema.patternProperties?schema.patternProperties[PatternNumberExact2]:(PatternStringExact2 in schema.patternProperties)?schema.patternProperties[PatternStringExact2]:Throw2("Unable to get record value schema")}function FromRecordRight2(left,right){let[Key,Value]=[RecordKey3(right),RecordValue3(right)];return type_exports.IsLiteralString(left)&&type_exports.IsNumber(Key)&&IntoBooleanResult2(Visit32(left,Value))===ExtendsResult2.True?ExtendsResult2.True:type_exports.IsUint8Array(left)&&type_exports.IsNumber(Key)?Visit32(left,Value):type_exports.IsString(left)&&type_exports.IsNumber(Key)?Visit32(left,Value):type_exports.IsArray(left)&&type_exports.IsNumber(Key)?Visit32(left,Value):type_exports.IsObject(left)?(()=>{for(let key of Object.getOwnPropertyNames(left.properties))if(Property2(Value,left.properties[key])===ExtendsResult2.False)return ExtendsResult2.False;return ExtendsResult2.True})():ExtendsResult2.False}function FromRecord14(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):!type_exports.IsRecord(right)?ExtendsResult2.False:Visit32(RecordValue3(left),RecordValue3(right))}function FromRegExp5(left,right){let L=type_exports.IsRegExp(left)?String3():left,R=type_exports.IsRegExp(right)?String3():right;return Visit32(L,R)}function FromStringRight2(left,right){return type_exports.IsLiteral(left)&&value_exports.IsString(left.const)?ExtendsResult2.True:type_exports.IsString(left)?ExtendsResult2.True:ExtendsResult2.False}function FromString6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsString(right)?ExtendsResult2.True:ExtendsResult2.False}function FromSymbol6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsSymbol(right)?ExtendsResult2.True:ExtendsResult2.False}function FromTemplateLiteral22(left,right){return type_exports.IsTemplateLiteral(left)?Visit32(TemplateLiteralToUnion2(left),right):type_exports.IsTemplateLiteral(right)?Visit32(left,TemplateLiteralToUnion2(right)):Throw2("Invalid fallthrough for TemplateLiteral")}function IsArrayOfTuple2(left,right){return type_exports.IsArray(right)&&left.items!==void 0&&left.items.every((schema)=>Visit32(schema,right.items)===ExtendsResult2.True)}function FromTupleRight2(left,right){return type_exports.IsNever(left)?ExtendsResult2.True:type_exports.IsUnknown(left)?ExtendsResult2.False:type_exports.IsAny(left)?ExtendsResult2.Union:ExtendsResult2.False}function FromTuple32(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)&&IsObjectArrayLike2(right)?ExtendsResult2.True:type_exports.IsArray(right)&&IsArrayOfTuple2(left,right)?ExtendsResult2.True:!type_exports.IsTuple(right)?ExtendsResult2.False:value_exports.IsUndefined(left.items)&&!value_exports.IsUndefined(right.items)||!value_exports.IsUndefined(left.items)&&value_exports.IsUndefined(right.items)?ExtendsResult2.False:value_exports.IsUndefined(left.items)&&!value_exports.IsUndefined(right.items)?ExtendsResult2.True:left.items.every((schema,index2)=>Visit32(schema,right.items[index2])===ExtendsResult2.True)?ExtendsResult2.True:ExtendsResult2.False}function FromUint8Array5(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsUint8Array(right)?ExtendsResult2.True:ExtendsResult2.False}function FromUndefined6(left,right){return IsStructuralRight2(right)?StructuralRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsRecord(right)?FromRecordRight2(left,right):type_exports.IsVoid(right)?FromVoidRight2(left,right):type_exports.IsUndefined(right)?ExtendsResult2.True:ExtendsResult2.False}function FromUnionRight2(left,right){return right.anyOf.some((schema)=>Visit32(left,schema)===ExtendsResult2.True)?ExtendsResult2.True:ExtendsResult2.False}function FromUnion62(left,right){return left.anyOf.every((schema)=>Visit32(schema,right)===ExtendsResult2.True)?ExtendsResult2.True:ExtendsResult2.False}function FromUnknownRight2(left,right){return ExtendsResult2.True}function FromUnknown5(left,right){return type_exports.IsNever(right)?FromNeverRight2(left,right):type_exports.IsIntersect(right)?FromIntersectRight2(left,right):type_exports.IsUnion(right)?FromUnionRight2(left,right):type_exports.IsAny(right)?FromAnyRight2(left,right):type_exports.IsString(right)?FromStringRight2(left,right):type_exports.IsNumber(right)?FromNumberRight2(left,right):type_exports.IsInteger(right)?FromIntegerRight2(left,right):type_exports.IsBoolean(right)?FromBooleanRight2(left,right):type_exports.IsArray(right)?FromArrayRight2(left,right):type_exports.IsTuple(right)?FromTupleRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsUnknown(right)?ExtendsResult2.True:ExtendsResult2.False}function FromVoidRight2(left,right){return type_exports.IsUndefined(left)?ExtendsResult2.True:type_exports.IsUndefined(left)?ExtendsResult2.True:ExtendsResult2.False}function FromVoid5(left,right){return type_exports.IsIntersect(right)?FromIntersectRight2(left,right):type_exports.IsUnion(right)?FromUnionRight2(left,right):type_exports.IsUnknown(right)?FromUnknownRight2(left,right):type_exports.IsAny(right)?FromAnyRight2(left,right):type_exports.IsObject(right)?FromObjectRight2(left,right):type_exports.IsVoid(right)?ExtendsResult2.True:ExtendsResult2.False}function Visit32(left,right){return type_exports.IsTemplateLiteral(left)||type_exports.IsTemplateLiteral(right)?FromTemplateLiteral22(left,right):type_exports.IsRegExp(left)||type_exports.IsRegExp(right)?FromRegExp5(left,right):type_exports.IsNot(left)||type_exports.IsNot(right)?FromNot8(left,right):type_exports.IsAny(left)?FromAny5(left,right):type_exports.IsArray(left)?FromArray42(left,right):type_exports.IsBigInt(left)?FromBigInt6(left,right):type_exports.IsBoolean(left)?FromBoolean6(left,right):type_exports.IsAsyncIterator(left)?FromAsyncIterator8(left,right):type_exports.IsConstructor(left)?FromConstructor9(left,right):type_exports.IsDate(left)?FromDate8(left,right):type_exports.IsFunction(left)?FromFunction8(left,right):type_exports.IsInteger(left)?FromInteger6(left,right):type_exports.IsIntersect(left)?FromIntersect42(left,right):type_exports.IsIterator(left)?FromIterator8(left,right):type_exports.IsLiteral(left)?FromLiteral22(left,right):type_exports.IsNever(left)?FromNever6(left,right):type_exports.IsNull(left)?FromNull6(left,right):type_exports.IsNumber(left)?FromNumber6(left,right):type_exports.IsObject(left)?FromObject19(left,right):type_exports.IsRecord(left)?FromRecord14(left,right):type_exports.IsString(left)?FromString6(left,right):type_exports.IsSymbol(left)?FromSymbol6(left,right):type_exports.IsTuple(left)?FromTuple32(left,right):type_exports.IsPromise(left)?FromPromise22(left,right):type_exports.IsUint8Array(left)?FromUint8Array5(left,right):type_exports.IsUndefined(left)?FromUndefined6(left,right):type_exports.IsUnion(left)?FromUnion62(left,right):type_exports.IsUnknown(left)?FromUnknown5(left,right):type_exports.IsVoid(left)?FromVoid5(left,right):Throw2(`Unknown left type operand '${left[Kind2]}'`)}function ExtendsCheck2(left,right){return Visit32(left,right)}function FromProperties82(P,Right,True,False,options){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Extends2(P[K2],Right,True,False,Clone3(options));return Acc}function FromMappedResult62(Left,Right,True,False,options){return FromProperties82(Left.properties,Right,True,False,options)}function ExtendsFromMappedResult2(Left,Right,True,False,options){let P=FromMappedResult62(Left,Right,True,False,options);return MappedResult2(P)}function ExtendsResolve2(left,right,trueType,falseType){let R=ExtendsCheck2(left,right);return R===ExtendsResult2.Union?Union3([trueType,falseType]):R===ExtendsResult2.True?trueType:falseType}function Extends2(L,R,T2,F,options){return IsMappedResult3(L)?ExtendsFromMappedResult2(L,R,T2,F,options):IsMappedKey3(L)?CreateType2(ExtendsFromMappedKey2(L,R,T2,F,options)):CreateType2(ExtendsResolve2(L,R,T2,F),options)}function FromPropertyKey4(K,U,L,R,options){return{[K]:Extends2(Literal2(K),U,L,R,Clone3(options))}}function FromPropertyKeys4(K,U,L,R,options){return K.reduce((Acc,LK)=>{return{...Acc,...FromPropertyKey4(LK,U,L,R,options)}},{})}function FromMappedKey22(K,U,L,R,options){return FromPropertyKeys4(K.keys,U,L,R,options)}function ExtendsFromMappedKey2(T2,U,L,R,options){let P=FromMappedKey22(T2,U,L,R,options);return MappedResult2(P)}function ExcludeFromTemplateLiteral2(L,R){return Exclude2(TemplateLiteralToUnion2(L),R)}function ExcludeRest2(L,R){let excluded=L.filter((inner)=>ExtendsCheck2(inner,R)===ExtendsResult2.False);return excluded.length===1?excluded[0]:Union3(excluded)}function Exclude2(L,R,options={}){if(IsTemplateLiteral3(L))return CreateType2(ExcludeFromTemplateLiteral2(L,R),options);if(IsMappedResult3(L))return CreateType2(ExcludeFromMappedResult2(L,R),options);return CreateType2(IsUnion3(L)?ExcludeRest2(L.anyOf,R):ExtendsCheck2(L,R)!==ExtendsResult2.False?Never2():L,options)}function FromProperties92(P,U){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Exclude2(P[K2],U);return Acc}function FromMappedResult72(R,T2){return FromProperties92(R.properties,T2)}function ExcludeFromMappedResult2(R,T2){let P=FromMappedResult72(R,T2);return MappedResult2(P)}function ExtractFromTemplateLiteral2(L,R){return Extract2(TemplateLiteralToUnion2(L),R)}function ExtractRest2(L,R){let extracted=L.filter((inner)=>ExtendsCheck2(inner,R)!==ExtendsResult2.False);return extracted.length===1?extracted[0]:Union3(extracted)}function Extract2(L,R,options){if(IsTemplateLiteral3(L))return CreateType2(ExtractFromTemplateLiteral2(L,R),options);if(IsMappedResult3(L))return CreateType2(ExtractFromMappedResult2(L,R),options);return CreateType2(IsUnion3(L)?ExtractRest2(L.anyOf,R):ExtendsCheck2(L,R)!==ExtendsResult2.False?L:Never2(),options)}function FromProperties102(P,T2){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Extract2(P[K2],T2);return Acc}function FromMappedResult82(R,T2){return FromProperties102(R.properties,T2)}function ExtractFromMappedResult2(R,T2){let P=FromMappedResult82(R,T2);return MappedResult2(P)}function InstanceType2(schema,options){return IsConstructor3(schema)?CreateType2(schema.returns,options):Never2(options)}function ReadonlyOptional2(schema){return Readonly2(Optional2(schema))}function RecordCreateFromPattern2(pattern,T2,options){return CreateType2({[Kind2]:"Record",type:"object",patternProperties:{[pattern]:T2}},options)}function RecordCreateFromKeys2(K,T2,options){let result={};for(let K2 of K)result[K2]=T2;return Object22(result,{...options,[Hint2]:"Record"})}function FromTemplateLiteralKey2(K,T2,options){return IsTemplateLiteralFinite2(K)?RecordCreateFromKeys2(IndexPropertyKeys2(K),T2,options):RecordCreateFromPattern2(K.pattern,T2,options)}function FromUnionKey2(key,type2,options){return RecordCreateFromKeys2(IndexPropertyKeys2(Union3(key)),type2,options)}function FromLiteralKey2(key,type2,options){return RecordCreateFromKeys2([key.toString()],type2,options)}function FromRegExpKey2(key,type2,options){return RecordCreateFromPattern2(key.source,type2,options)}function FromStringKey2(key,type2,options){let pattern=IsUndefined5(key.pattern)?PatternStringExact2:key.pattern;return RecordCreateFromPattern2(pattern,type2,options)}function FromAnyKey2(_2,type2,options){return RecordCreateFromPattern2(PatternStringExact2,type2,options)}function FromNeverKey2(_key,type2,options){return RecordCreateFromPattern2(PatternNeverExact2,type2,options)}function FromBooleanKey2(_key,type2,options){return Object22({true:type2,false:type2},options)}function FromIntegerKey2(_key,type2,options){return RecordCreateFromPattern2(PatternNumberExact2,type2,options)}function FromNumberKey2(_2,type2,options){return RecordCreateFromPattern2(PatternNumberExact2,type2,options)}function Record2(key,type2,options={}){return IsUnion3(key)?FromUnionKey2(key.anyOf,type2,options):IsTemplateLiteral3(key)?FromTemplateLiteralKey2(key,type2,options):IsLiteral3(key)?FromLiteralKey2(key.const,type2,options):IsBoolean22(key)?FromBooleanKey2(key,type2,options):IsInteger4(key)?FromIntegerKey2(key,type2,options):IsNumber32(key)?FromNumberKey2(key,type2,options):IsRegExp22(key)?FromRegExpKey2(key,type2,options):IsString22(key)?FromStringKey2(key,type2,options):IsAny3(key)?FromAnyKey2(key,type2,options):IsNever3(key)?FromNeverKey2(key,type2,options):Never2(options)}function RecordPattern2(record){return globalThis.Object.getOwnPropertyNames(record.patternProperties)[0]}function RecordKey22(type2){let pattern=RecordPattern2(type2);return pattern===PatternStringExact2?String3():pattern===PatternNumberExact2?Number22():String3({pattern})}function RecordValue22(type2){return type2.patternProperties[RecordPattern2(type2)]}function FromConstructor22(args,type2){return type2.parameters=FromTypes3(args,type2.parameters),type2.returns=FromType3(args,type2.returns),type2}function FromFunction22(args,type2){return type2.parameters=FromTypes3(args,type2.parameters),type2.returns=FromType3(args,type2.returns),type2}function FromIntersect52(args,type2){return type2.allOf=FromTypes3(args,type2.allOf),type2}function FromUnion72(args,type2){return type2.anyOf=FromTypes3(args,type2.anyOf),type2}function FromTuple42(args,type2){if(IsUndefined5(type2.items))return type2;return type2.items=FromTypes3(args,type2.items),type2}function FromArray52(args,type2){return type2.items=FromType3(args,type2.items),type2}function FromAsyncIterator22(args,type2){return type2.items=FromType3(args,type2.items),type2}function FromIterator22(args,type2){return type2.items=FromType3(args,type2.items),type2}function FromPromise32(args,type2){return type2.item=FromType3(args,type2.item),type2}function FromObject22(args,type2){let mappedProperties=FromProperties112(args,type2.properties);return{...type2,...Object22(mappedProperties)}}function FromRecord22(args,type2){let mappedKey=FromType3(args,RecordKey22(type2)),mappedValue=FromType3(args,RecordValue22(type2)),result=Record2(mappedKey,mappedValue);return{...type2,...result}}function FromArgument5(args,argument){return argument.index in args?args[argument.index]:Unknown2()}function FromProperty22(args,type2){let isReadonly=IsReadonly3(type2),isOptional2=IsOptional3(type2),mapped=FromType3(args,type2);return isReadonly&&isOptional2?ReadonlyOptional2(mapped):isReadonly&&!isOptional2?Readonly2(mapped):!isReadonly&&isOptional2?Optional2(mapped):mapped}function FromProperties112(args,properties){return globalThis.Object.getOwnPropertyNames(properties).reduce((result,key)=>{return{...result,[key]:FromProperty22(args,properties[key])}},{})}function FromTypes3(args,types3){return types3.map((type2)=>FromType3(args,type2))}function FromType3(args,type2){return IsConstructor3(type2)?FromConstructor22(args,type2):IsFunction22(type2)?FromFunction22(args,type2):IsIntersect3(type2)?FromIntersect52(args,type2):IsUnion3(type2)?FromUnion72(args,type2):IsTuple3(type2)?FromTuple42(args,type2):IsArray32(type2)?FromArray52(args,type2):IsAsyncIterator22(type2)?FromAsyncIterator22(args,type2):IsIterator22(type2)?FromIterator22(args,type2):IsPromise4(type2)?FromPromise32(args,type2):IsObject32(type2)?FromObject22(args,type2):IsRecord3(type2)?FromRecord22(args,type2):IsArgument3(type2)?FromArgument5(args,type2):type2}function Instantiate2(type2,args){return FromType3(args,CloneType2(type2))}function Integer2(options){return CreateType2({[Kind2]:"Integer",type:"integer"},options)}function MappedIntrinsicPropertyKey2(K,M,options){return{[K]:Intrinsic2(Literal2(K),M,Clone3(options))}}function MappedIntrinsicPropertyKeys2(K,M,options){return K.reduce((Acc,L)=>{return{...Acc,...MappedIntrinsicPropertyKey2(L,M,options)}},{})}function MappedIntrinsicProperties2(T2,M,options){return MappedIntrinsicPropertyKeys2(T2.keys,M,options)}function IntrinsicFromMappedKey2(T2,M,options){let P=MappedIntrinsicProperties2(T2,M,options);return MappedResult2(P)}function ApplyUncapitalize2(value){let[first,rest]=[value.slice(0,1),value.slice(1)];return[first.toLowerCase(),rest].join("")}function ApplyCapitalize2(value){let[first,rest]=[value.slice(0,1),value.slice(1)];return[first.toUpperCase(),rest].join("")}function ApplyUppercase2(value){return value.toUpperCase()}function ApplyLowercase2(value){return value.toLowerCase()}function FromTemplateLiteral32(schema,mode,options){let expression=TemplateLiteralParseExact2(schema.pattern);if(!IsTemplateLiteralExpressionFinite2(expression))return{...schema,pattern:FromLiteralValue2(schema.pattern,mode)};let literals=[...TemplateLiteralExpressionGenerate2(expression)].map((value)=>Literal2(value)),mapped=FromRest52(literals,mode),union2=Union3(mapped);return TemplateLiteral2([union2],options)}function FromLiteralValue2(value,mode){return typeof value==="string"?mode==="Uncapitalize"?ApplyUncapitalize2(value):mode==="Capitalize"?ApplyCapitalize2(value):mode==="Uppercase"?ApplyUppercase2(value):mode==="Lowercase"?ApplyLowercase2(value):value:value.toString()}function FromRest52(T2,M){return T2.map((L)=>Intrinsic2(L,M))}function Intrinsic2(schema,mode,options={}){return IsMappedKey3(schema)?IntrinsicFromMappedKey2(schema,mode,options):IsTemplateLiteral3(schema)?FromTemplateLiteral32(schema,mode,options):IsUnion3(schema)?Union3(FromRest52(schema.anyOf,mode),options):IsLiteral3(schema)?Literal2(FromLiteralValue2(schema.const,mode),options):CreateType2(schema,options)}function Capitalize2(T2,options={}){return Intrinsic2(T2,"Capitalize",options)}function Lowercase2(T2,options={}){return Intrinsic2(T2,"Lowercase",options)}function Uncapitalize2(T2,options={}){return Intrinsic2(T2,"Uncapitalize",options)}function Uppercase2(T2,options={}){return Intrinsic2(T2,"Uppercase",options)}function FromProperties122(properties,propertyKeys,options){let result={};for(let K2 of globalThis.Object.getOwnPropertyNames(properties))result[K2]=Omit2(properties[K2],propertyKeys,Clone3(options));return result}function FromMappedResult92(mappedResult,propertyKeys,options){return FromProperties122(mappedResult.properties,propertyKeys,options)}function OmitFromMappedResult2(mappedResult,propertyKeys,options){let properties=FromMappedResult92(mappedResult,propertyKeys,options);return MappedResult2(properties)}function FromIntersect62(types3,propertyKeys){return types3.map((type2)=>OmitResolve2(type2,propertyKeys))}function FromUnion82(types3,propertyKeys){return types3.map((type2)=>OmitResolve2(type2,propertyKeys))}function FromProperty32(properties,key){let{[key]:_2,...R}=properties;return R}function FromProperties132(properties,propertyKeys){return propertyKeys.reduce((T2,K2)=>FromProperty32(T2,K2),properties)}function FromObject32(properties,propertyKeys){let options=Discard2(properties,[TransformKind2,"$id","required","properties"]),omittedProperties=FromProperties132(properties.properties,propertyKeys);return Object22(omittedProperties,options)}function UnionFromPropertyKeys3(propertyKeys){let result=propertyKeys.reduce((result2,key)=>IsLiteralValue3(key)?[...result2,Literal2(key)]:result2,[]);return Union3(result)}function OmitResolve2(properties,propertyKeys){return IsIntersect3(properties)?Intersect3(FromIntersect62(properties.allOf,propertyKeys)):IsUnion3(properties)?Union3(FromUnion82(properties.anyOf,propertyKeys)):IsObject32(properties)?FromObject32(properties,propertyKeys):Object22({})}function Omit2(type2,key,options){let typeKey=IsArray5(key)?UnionFromPropertyKeys3(key):key,propertyKeys=IsSchema3(key)?IndexPropertyKeys2(key):key,isTypeRef=IsRef3(type2),isKeyRef=IsRef3(key);return IsMappedResult3(type2)?OmitFromMappedResult2(type2,propertyKeys,options):IsMappedKey3(key)?OmitFromMappedKey2(type2,key,options):isTypeRef&&isKeyRef?Computed2("Omit",[type2,typeKey],options):!isTypeRef&&isKeyRef?Computed2("Omit",[type2,typeKey],options):isTypeRef&&!isKeyRef?Computed2("Omit",[type2,typeKey],options):CreateType2({...OmitResolve2(type2,propertyKeys),...options})}function FromPropertyKey22(type2,key,options){return{[key]:Omit2(type2,[key],Clone3(options))}}function FromPropertyKeys22(type2,propertyKeys,options){return propertyKeys.reduce((Acc,LK)=>{return{...Acc,...FromPropertyKey22(type2,LK,options)}},{})}function FromMappedKey32(type2,mappedKey,options){return FromPropertyKeys22(type2,mappedKey.keys,options)}function OmitFromMappedKey2(type2,mappedKey,options){let properties=FromMappedKey32(type2,mappedKey,options);return MappedResult2(properties)}function FromProperties142(properties,propertyKeys,options){let result={};for(let K2 of globalThis.Object.getOwnPropertyNames(properties))result[K2]=Pick2(properties[K2],propertyKeys,Clone3(options));return result}function FromMappedResult102(mappedResult,propertyKeys,options){return FromProperties142(mappedResult.properties,propertyKeys,options)}function PickFromMappedResult2(mappedResult,propertyKeys,options){let properties=FromMappedResult102(mappedResult,propertyKeys,options);return MappedResult2(properties)}function FromIntersect72(types3,propertyKeys){return types3.map((type2)=>PickResolve2(type2,propertyKeys))}function FromUnion92(types3,propertyKeys){return types3.map((type2)=>PickResolve2(type2,propertyKeys))}function FromProperties152(properties,propertyKeys){let result={};for(let K2 of propertyKeys)if(K2 in properties)result[K2]=properties[K2];return result}function FromObject42(T2,K){let options=Discard2(T2,[TransformKind2,"$id","required","properties"]),properties=FromProperties152(T2.properties,K);return Object22(properties,options)}function UnionFromPropertyKeys22(propertyKeys){let result=propertyKeys.reduce((result2,key)=>IsLiteralValue3(key)?[...result2,Literal2(key)]:result2,[]);return Union3(result)}function PickResolve2(properties,propertyKeys){return IsIntersect3(properties)?Intersect3(FromIntersect72(properties.allOf,propertyKeys)):IsUnion3(properties)?Union3(FromUnion92(properties.anyOf,propertyKeys)):IsObject32(properties)?FromObject42(properties,propertyKeys):Object22({})}function Pick2(type2,key,options){let typeKey=IsArray5(key)?UnionFromPropertyKeys22(key):key,propertyKeys=IsSchema3(key)?IndexPropertyKeys2(key):key,isTypeRef=IsRef3(type2),isKeyRef=IsRef3(key);return IsMappedResult3(type2)?PickFromMappedResult2(type2,propertyKeys,options):IsMappedKey3(key)?PickFromMappedKey2(type2,key,options):isTypeRef&&isKeyRef?Computed2("Pick",[type2,typeKey],options):!isTypeRef&&isKeyRef?Computed2("Pick",[type2,typeKey],options):isTypeRef&&!isKeyRef?Computed2("Pick",[type2,typeKey],options):CreateType2({...PickResolve2(type2,propertyKeys),...options})}function FromPropertyKey32(type2,key,options){return{[key]:Pick2(type2,[key],Clone3(options))}}function FromPropertyKeys32(type2,propertyKeys,options){return propertyKeys.reduce((result,leftKey)=>{return{...result,...FromPropertyKey32(type2,leftKey,options)}},{})}function FromMappedKey42(type2,mappedKey,options){return FromPropertyKeys32(type2,mappedKey.keys,options)}function PickFromMappedKey2(type2,mappedKey,options){let properties=FromMappedKey42(type2,mappedKey,options);return MappedResult2(properties)}function FromComputed32(target,parameters){return Computed2("Partial",[Computed2(target,parameters)])}function FromRef32($ref){return Computed2("Partial",[Ref2($ref)])}function FromProperties162(properties){let partialProperties={};for(let K of globalThis.Object.getOwnPropertyNames(properties))partialProperties[K]=Optional2(properties[K]);return partialProperties}function FromObject52(type2){let options=Discard2(type2,[TransformKind2,"$id","required","properties"]),properties=FromProperties162(type2.properties);return Object22(properties,options)}function FromRest62(types3){return types3.map((type2)=>PartialResolve2(type2))}function PartialResolve2(type2){return IsComputed3(type2)?FromComputed32(type2.target,type2.parameters):IsRef3(type2)?FromRef32(type2.$ref):IsIntersect3(type2)?Intersect3(FromRest62(type2.allOf)):IsUnion3(type2)?Union3(FromRest62(type2.anyOf)):IsObject32(type2)?FromObject52(type2):IsBigInt22(type2)?type2:IsBoolean22(type2)?type2:IsInteger4(type2)?type2:IsLiteral3(type2)?type2:IsNull22(type2)?type2:IsNumber32(type2)?type2:IsString22(type2)?type2:IsSymbol22(type2)?type2:IsUndefined32(type2)?type2:Object22({})}function Partial2(type2,options){if(IsMappedResult3(type2))return PartialFromMappedResult2(type2,options);else return CreateType2({...PartialResolve2(type2),...options})}function FromProperties172(K,options){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(K))Acc[K2]=Partial2(K[K2],Clone3(options));return Acc}function FromMappedResult112(R,options){return FromProperties172(R.properties,options)}function PartialFromMappedResult2(R,options){let P=FromMappedResult112(R,options);return MappedResult2(P)}function FromComputed42(target,parameters){return Computed2("Required",[Computed2(target,parameters)])}function FromRef42($ref){return Computed2("Required",[Ref2($ref)])}function FromProperties182(properties){let requiredProperties={};for(let K of globalThis.Object.getOwnPropertyNames(properties))requiredProperties[K]=Discard2(properties[K],[OptionalKind2]);return requiredProperties}function FromObject62(type2){let options=Discard2(type2,[TransformKind2,"$id","required","properties"]),properties=FromProperties182(type2.properties);return Object22(properties,options)}function FromRest72(types3){return types3.map((type2)=>RequiredResolve2(type2))}function RequiredResolve2(type2){return IsComputed3(type2)?FromComputed42(type2.target,type2.parameters):IsRef3(type2)?FromRef42(type2.$ref):IsIntersect3(type2)?Intersect3(FromRest72(type2.allOf)):IsUnion3(type2)?Union3(FromRest72(type2.anyOf)):IsObject32(type2)?FromObject62(type2):IsBigInt22(type2)?type2:IsBoolean22(type2)?type2:IsInteger4(type2)?type2:IsLiteral3(type2)?type2:IsNull22(type2)?type2:IsNumber32(type2)?type2:IsString22(type2)?type2:IsSymbol22(type2)?type2:IsUndefined32(type2)?type2:Object22({})}function Required2(type2,options){if(IsMappedResult3(type2))return RequiredFromMappedResult2(type2,options);else return CreateType2({...RequiredResolve2(type2),...options})}function FromProperties192(P,options){let Acc={};for(let K2 of globalThis.Object.getOwnPropertyNames(P))Acc[K2]=Required2(P[K2],options);return Acc}function FromMappedResult122(R,options){return FromProperties192(R.properties,options)}function RequiredFromMappedResult2(R,options){let P=FromMappedResult122(R,options);return MappedResult2(P)}function DereferenceParameters2(moduleProperties,types3){return types3.map((type2)=>{return IsRef3(type2)?Dereference2(moduleProperties,type2.$ref):FromType22(moduleProperties,type2)})}function Dereference2(moduleProperties,ref){return ref in moduleProperties?IsRef3(moduleProperties[ref])?Dereference2(moduleProperties,moduleProperties[ref].$ref):FromType22(moduleProperties,moduleProperties[ref]):Never2()}function FromAwaited2(parameters){return Awaited2(parameters[0])}function FromIndex2(parameters){return Index3(parameters[0],parameters[1])}function FromKeyOf2(parameters){return KeyOf2(parameters[0])}function FromPartial2(parameters){return Partial2(parameters[0])}function FromOmit2(parameters){return Omit2(parameters[0],parameters[1])}function FromPick2(parameters){return Pick2(parameters[0],parameters[1])}function FromRequired2(parameters){return Required2(parameters[0])}function FromComputed52(moduleProperties,target,parameters){let dereferenced=DereferenceParameters2(moduleProperties,parameters);return target==="Awaited"?FromAwaited2(dereferenced):target==="Index"?FromIndex2(dereferenced):target==="KeyOf"?FromKeyOf2(dereferenced):target==="Partial"?FromPartial2(dereferenced):target==="Omit"?FromOmit2(dereferenced):target==="Pick"?FromPick2(dereferenced):target==="Required"?FromRequired2(dereferenced):Never2()}function FromArray62(moduleProperties,type2){return Array22(FromType22(moduleProperties,type2))}function FromAsyncIterator32(moduleProperties,type2){return AsyncIterator2(FromType22(moduleProperties,type2))}function FromConstructor32(moduleProperties,parameters,instanceType){return Constructor2(FromTypes22(moduleProperties,parameters),FromType22(moduleProperties,instanceType))}function FromFunction32(moduleProperties,parameters,returnType){return Function3(FromTypes22(moduleProperties,parameters),FromType22(moduleProperties,returnType))}function FromIntersect82(moduleProperties,types3){return Intersect3(FromTypes22(moduleProperties,types3))}function FromIterator32(moduleProperties,type2){return Iterator2(FromType22(moduleProperties,type2))}function FromObject72(moduleProperties,properties){return Object22(globalThis.Object.keys(properties).reduce((result,key)=>{return{...result,[key]:FromType22(moduleProperties,properties[key])}},{}))}function FromRecord32(moduleProperties,type2){let[value,pattern]=[FromType22(moduleProperties,RecordValue22(type2)),RecordPattern2(type2)],result=CloneType2(type2);return result.patternProperties[pattern]=value,result}function FromTransform2(moduleProperties,transform2){return IsRef3(transform2)?{...Dereference2(moduleProperties,transform2.$ref),[TransformKind2]:transform2[TransformKind2]}:transform2}function FromTuple52(moduleProperties,types3){return Tuple2(FromTypes22(moduleProperties,types3))}function FromUnion102(moduleProperties,types3){return Union3(FromTypes22(moduleProperties,types3))}function FromTypes22(moduleProperties,types3){return types3.map((type2)=>FromType22(moduleProperties,type2))}function FromType22(moduleProperties,type2){return IsOptional3(type2)?CreateType2(FromType22(moduleProperties,Discard2(type2,[OptionalKind2])),type2):IsReadonly3(type2)?CreateType2(FromType22(moduleProperties,Discard2(type2,[ReadonlyKind2])),type2):IsTransform3(type2)?CreateType2(FromTransform2(moduleProperties,type2),type2):IsArray32(type2)?CreateType2(FromArray62(moduleProperties,type2.items),type2):IsAsyncIterator22(type2)?CreateType2(FromAsyncIterator32(moduleProperties,type2.items),type2):IsComputed3(type2)?CreateType2(FromComputed52(moduleProperties,type2.target,type2.parameters)):IsConstructor3(type2)?CreateType2(FromConstructor32(moduleProperties,type2.parameters,type2.returns),type2):IsFunction22(type2)?CreateType2(FromFunction32(moduleProperties,type2.parameters,type2.returns),type2):IsIntersect3(type2)?CreateType2(FromIntersect82(moduleProperties,type2.allOf),type2):IsIterator22(type2)?CreateType2(FromIterator32(moduleProperties,type2.items),type2):IsObject32(type2)?CreateType2(FromObject72(moduleProperties,type2.properties),type2):IsRecord3(type2)?CreateType2(FromRecord32(moduleProperties,type2)):IsTuple3(type2)?CreateType2(FromTuple52(moduleProperties,type2.items||[]),type2):IsUnion3(type2)?CreateType2(FromUnion102(moduleProperties,type2.anyOf),type2):type2}function ComputeType2(moduleProperties,key){return key in moduleProperties?FromType22(moduleProperties,moduleProperties[key]):Never2()}function ComputeModuleProperties2(moduleProperties){return globalThis.Object.getOwnPropertyNames(moduleProperties).reduce((result,key)=>{return{...result,[key]:ComputeType2(moduleProperties,key)}},{})}var TModule2=class{constructor($defs){let computed=ComputeModuleProperties2($defs),identified=this.WithIdentifiers(computed);this.$defs=identified}Import(key,options){let $defs={...this.$defs,[key]:CreateType2(this.$defs[key],options)};return CreateType2({[Kind2]:"Import",$defs,$ref:key})}WithIdentifiers($defs){return globalThis.Object.getOwnPropertyNames($defs).reduce((result,key)=>{return{...result,[key]:{...$defs[key],$id:key}}},{})}};function Module2(properties){return new TModule2(properties)}function Not3(type2,options){return CreateType2({[Kind2]:"Not",not:type2},options)}function Parameters2(schema,options){return IsFunction22(schema)?Tuple2(schema.parameters,options):Never2()}var Ordinal2=0;function Recursive2(callback,options={}){if(IsUndefined5(options.$id))options.$id=`T${Ordinal2++}`;let thisType=CloneType2(callback({[Kind2]:"This",$ref:`${options.$id}`}));return thisType.$id=options.$id,CreateType2({[Hint2]:"Recursive",...thisType},options)}function RegExp22(unresolved,options){let expr=IsString5(unresolved)?new globalThis.RegExp(unresolved):unresolved;return CreateType2({[Kind2]:"RegExp",type:"RegExp",source:expr.source,flags:expr.flags},options)}function RestResolve2(T2){return IsIntersect3(T2)?T2.allOf:IsUnion3(T2)?T2.anyOf:IsTuple3(T2)?T2.items??[]:[]}function Rest2(T2){return RestResolve2(T2)}function ReturnType2(schema,options){return IsFunction22(schema)?CreateType2(schema.returns,options):Never2(options)}var TransformDecodeBuilder2=class{constructor(schema){this.schema=schema}Decode(decode4){return new TransformEncodeBuilder2(this.schema,decode4)}},TransformEncodeBuilder2=class{constructor(schema,decode4){this.schema=schema,this.decode=decode4}EncodeTransform(encode3,schema){let Codec={Encode:(value)=>schema[TransformKind2].Encode(encode3(value)),Decode:(value)=>this.decode(schema[TransformKind2].Decode(value))};return{...schema,[TransformKind2]:Codec}}EncodeSchema(encode3,schema){let Codec={Decode:this.decode,Encode:encode3};return{...schema,[TransformKind2]:Codec}}Encode(encode3){return IsTransform3(this.schema)?this.EncodeTransform(encode3,this.schema):this.EncodeSchema(encode3,this.schema)}};function Transform2(schema){return new TransformDecodeBuilder2(schema)}function Unsafe2(options={}){return CreateType2({[Kind2]:options[Kind2]??"Unsafe"},options)}function Void2(options){return CreateType2({[Kind2]:"Void",type:"void"},options)}var type_exports2={};__export2(type_exports2,{Any:()=>Any2,Argument:()=>Argument2,Array:()=>Array22,AsyncIterator:()=>AsyncIterator2,Awaited:()=>Awaited2,BigInt:()=>BigInt3,Boolean:()=>Boolean3,Capitalize:()=>Capitalize2,Composite:()=>Composite2,Const:()=>Const2,Constructor:()=>Constructor2,ConstructorParameters:()=>ConstructorParameters2,Date:()=>Date22,Enum:()=>Enum2,Exclude:()=>Exclude2,Extends:()=>Extends2,Extract:()=>Extract2,Function:()=>Function3,Index:()=>Index3,InstanceType:()=>InstanceType2,Instantiate:()=>Instantiate2,Integer:()=>Integer2,Intersect:()=>Intersect3,Iterator:()=>Iterator2,KeyOf:()=>KeyOf2,Literal:()=>Literal2,Lowercase:()=>Lowercase2,Mapped:()=>Mapped2,Module:()=>Module2,Never:()=>Never2,Not:()=>Not3,Null:()=>Null2,Number:()=>Number22,Object:()=>Object22,Omit:()=>Omit2,Optional:()=>Optional2,Parameters:()=>Parameters2,Partial:()=>Partial2,Pick:()=>Pick2,Promise:()=>Promise22,Readonly:()=>Readonly2,ReadonlyOptional:()=>ReadonlyOptional2,Record:()=>Record2,Recursive:()=>Recursive2,Ref:()=>Ref2,RegExp:()=>RegExp22,Required:()=>Required2,Rest:()=>Rest2,ReturnType:()=>ReturnType2,String:()=>String3,Symbol:()=>Symbol22,TemplateLiteral:()=>TemplateLiteral2,Transform:()=>Transform2,Tuple:()=>Tuple2,Uint8Array:()=>Uint8Array22,Uncapitalize:()=>Uncapitalize2,Undefined:()=>Undefined2,Union:()=>Union3,Unknown:()=>Unknown2,Unsafe:()=>Unsafe2,Uppercase:()=>Uppercase2,Void:()=>Void2});var Type2=type_exports2,jwt=({name="jwt",secret,alg="HS256",crit,schema,nbf,exp,...payload})=>{if(!secret)throw new Error("Secret can't be empty");let key=typeof secret==="string"?new TextEncoder().encode(secret):secret,validator=schema?getSchemaValidator(Type2.Intersect([schema,Type2.Object({iss:Type2.Optional(Type2.String()),sub:Type2.Optional(Type2.String()),aud:Type2.Optional(Type2.Union([Type2.String(),Type2.Array(Type2.String())])),jti:Type2.Optional(Type2.String()),nbf:Type2.Optional(Type2.Union([Type2.String(),Type2.Number()])),exp:Type2.Optional(Type2.Union([Type2.String(),Type2.Number()])),iat:Type2.Optional(Type2.String())})]),{modules:Type2.Module({})}):void 0;return new Elysia({name:"@elysiajs/jwt",seed:{name,secret,alg,crit,schema,nbf,exp,...payload}}).decorate(name,{sign(morePayload){let jwt2=new SignJWT({...payload,...morePayload,nbf:void 0,exp:void 0}).setProtectedHeader({alg,crit});if(nbf)jwt2=jwt2.setNotBefore(nbf);if(exp)jwt2=jwt2.setExpirationTime(exp);return jwt2.sign(key)},async verify(jwt2){if(!jwt2)return!1;try{let data=(await jwtVerify(jwt2,key)).payload;if(validator&&!validator.Check(data))throw new ValidationError("JWT",validator,data);return data}catch(_2){return!1}}})},index_default=jwt;var import_dotenv=__toESM(require_main(),1);import fs3 from"fs/promises";function isDecodedToken(token){if(typeof token==="object"&&token!==null){let t2=token;return typeof t2.userId==="string"&&typeof t2.shopId==="string"}return!1}var extractId=async({jwt:jwt2,cookie})=>{let token=cookie.auth_token?.value;if(!token)return{success:!1,message:"Huna ruhusa! - hakuna token"};let decoded=await jwt2.verify(token);if(!isDecodedToken(decoded))return{success:!1,message:"Huna ruhusa! - Token sio sahihi"};let{userId,shopId}=decoded;if(!shopId||!userId)return{success:!1,message:"shopId au userId haipo"};if((await mainDb.select({userId:shopUsers.userId,shopId:shopUsers.shopId}).from(shopUsers).where(and(eq(shopUsers.shopId,shopId),eq(shopUsers.userId,userId)))).length===0)return{success:!1,message:"Mtumiaji hayupo!"};return{userId,shopId}};var import_qrcode=__toESM(require_server(),1),import_sharp=__toESM(require_lib(),1);import fs2 from"fs/promises";import path from"path";async function generateQRCodeWithLogo(data,logoPath,outputPath){try{let outputDir=path.dirname(outputPath);await fs2.mkdir(outputDir,{recursive:!0});let qrCodeBuffer=await import_qrcode.default.toBuffer(data,{errorCorrectionLevel:"H",width:500}),logoSize=Math.floor(125),logoBuffer=await fs2.readFile(logoPath),resizedLogo=await import_sharp.default(logoBuffer).resize(logoSize,logoSize).toBuffer();return await import_sharp.default(qrCodeBuffer).composite([{input:resizedLogo,gravity:"center"}]).toFile(outputPath),{success:!0,message:`\u2705 QR Code saved to ${outputPath}`}}catch(error2){return{success:!1,message:error2 instanceof Error?error2.message:"Tatizo kwenye seva wakati wa kutengeneza QR Code"}}}var import_tslib=__toESM(require_tslib(),1),{__extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__createBinding,__values,__read,__spread,__spreadArrays,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet:__classPrivateFieldGet2,__classPrivateFieldSet:__classPrivateFieldSet2}=import_tslib.default;var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256);for(i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var i,encodeToBase64=function(bytes){var base64="",len=bytes.length;for(var i2=0;i2<len;i2+=3)base64+=chars[bytes[i2]>>2],base64+=chars[(bytes[i2]&3)<<4|bytes[i2+1]>>4],base64+=chars[(bytes[i2+1]&15)<<2|bytes[i2+2]>>6],base64+=chars[bytes[i2+2]&63];if(len%3===2)base64=base64.substring(0,base64.length-1)+"=";else if(len%3===1)base64=base64.substring(0,base64.length-2)+"==";return base64},decodeFromBase64=function(base64){var bufferLength=base64.length*0.75,len=base64.length,i2,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==="="){if(bufferLength--,base64[base64.length-2]==="=")bufferLength--}var bytes=new Uint8Array(bufferLength);for(i2=0;i2<len;i2+=4)encoded1=lookup[base64.charCodeAt(i2)],encoded2=lookup[base64.charCodeAt(i2+1)],encoded3=lookup[base64.charCodeAt(i2+2)],encoded4=lookup[base64.charCodeAt(i2+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(encoded2&15)<<4|encoded3>>2,bytes[p++]=(encoded3&3)<<6|encoded4&63;return bytes},DATA_URI_PREFIX_REGEX=/^(data)?:?([\w\/\+]+)?;?(charset=[\w-]+|base64)?.*,/i,decodeFromBase64DataUri=function(dataUri){var trimmedUri=dataUri.trim(),prefix=trimmedUri.substring(0,100),res=prefix.match(DATA_URI_PREFIX_REGEX);if(!res)return decodeFromBase64(trimmedUri);var fullMatch=res[0],data=trimmedUri.substring(fullMatch.length);return decodeFromBase64(data)};var toCharCode=function(character){return character.charCodeAt(0)},toCodePoint=function(character){return character.codePointAt(0)},toHexStringOfMinLength=function(num,minLength){return padStart(num.toString(16),minLength,"0").toUpperCase()},toHexString=function(num){return toHexStringOfMinLength(num,2)},charFromCode=function(code){return String.fromCharCode(code)},charFromHexCode=function(hex2){return charFromCode(parseInt(hex2,16))},padStart=function(value,length,padChar){var padding="";for(var idx=0,len=length-value.length;idx<len;idx++)padding+=padChar;return padding+value},copyStringIntoBuffer=function(str,buffer2,offset){var length=str.length;for(var idx=0;idx<length;idx++)buffer2[offset++]=str.charCodeAt(idx);return length};var escapeRegExp=function(str){return str.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},cleanText=function(text2){return text2.replace(/\t|\u0085|\u2028|\u2029/g,"    ").replace(/[\b\v]/g,"")},escapedNewlineChars=["\\n","\\f","\\r","\\u000B"];var isNewlineChar=function(text2){return/^[\n\f\r\u000B]$/.test(text2)},lineSplit=function(text2){return text2.split(/[\n\f\r\u000B]/)},mergeLines=function(text2){return text2.replace(/[\n\f\r\u000B]/g," ")},charAtIndex=function(text2,index2){var cuFirst=text2.charCodeAt(index2),cuSecond,nextIndex=index2+1,length=1;if(cuFirst>=55296&&cuFirst<=56319&&text2.length>nextIndex){if(cuSecond=text2.charCodeAt(nextIndex),cuSecond>=56320&&cuSecond<=57343)length=2}return[text2.slice(index2,index2+length),length]},charSplit=function(text2){var chars2=[];for(var idx=0,len=text2.length;idx<len;){var _a=charAtIndex(text2,idx),c=_a[0],cLen=_a[1];chars2.push(c),idx+=cLen}return chars2},buildWordBreakRegex=function(wordBreaks){var newlineCharUnion=escapedNewlineChars.join("|"),escapedRules=["$"];for(var idx=0,len=wordBreaks.length;idx<len;idx++){var wordBreak=wordBreaks[idx];if(isNewlineChar(wordBreak))throw new TypeError("`wordBreak` must not include "+newlineCharUnion);escapedRules.push(wordBreak===""?".":escapeRegExp(wordBreak))}var breakRules=escapedRules.join("|");return new RegExp("("+newlineCharUnion+")|((.*?)("+breakRules+"))","gm")},breakTextIntoLines=function(text2,wordBreaks,maxWidth,computeWidthOfText){var regex2=buildWordBreakRegex(wordBreaks),words=cleanText(text2).match(regex2),currLine="",currWidth=0,lines=[],pushCurrLine=function(){if(currLine!=="")lines.push(currLine);currLine="",currWidth=0};for(var idx=0,len=words.length;idx<len;idx++){var word=words[idx];if(isNewlineChar(word))pushCurrLine();else{var width=computeWidthOfText(word);if(currWidth+width>maxWidth)pushCurrLine();currLine+=word,currWidth+=width}}return pushCurrLine(),lines},dateRegex=/^D:(\d\d\d\d)(\d\d)?(\d\d)?(\d\d)?(\d\d)?(\d\d)?([+\-Z])?(\d\d)?'?(\d\d)?'?$/,parseDate=function(dateStr){var match=dateStr.match(dateRegex);if(!match)return;var year=match[1],_a=match[2],month=_a===void 0?"01":_a,_b=match[3],day=_b===void 0?"01":_b,_c=match[4],hours=_c===void 0?"00":_c,_d=match[5],mins=_d===void 0?"00":_d,_e=match[6],secs=_e===void 0?"00":_e,_f=match[7],offsetSign=_f===void 0?"Z":_f,_g=match[8],offsetHours=_g===void 0?"00":_g,_h=match[9],offsetMins=_h===void 0?"00":_h,tzOffset=offsetSign==="Z"?"Z":""+offsetSign+offsetHours+":"+offsetMins,date3=new Date(year+"-"+month+"-"+day+"T"+hours+":"+mins+":"+secs+tzOffset);return date3},findLastMatch=function(value,regex2){var _a,position=0,lastMatch;while(position<value.length){var match=value.substring(position).match(regex2);if(!match)return{match:lastMatch,pos:position};lastMatch=match,position+=((_a=match.index)!==null&&_a!==void 0?_a:0)+match[0].length}return{match:lastMatch,pos:position}};var last=function(array){return array[array.length-1]},typedArrayFor=function(value){if(value instanceof Uint8Array)return value;var length=value.length,typedArray=new Uint8Array(length);for(var idx=0;idx<length;idx++)typedArray[idx]=value.charCodeAt(idx);return typedArray},mergeIntoTypedArray=function(){var arrays=[];for(var _i=0;_i<arguments.length;_i++)arrays[_i]=arguments[_i];var arrayCount=arrays.length,typedArrays=[];for(var idx=0;idx<arrayCount;idx++){var element=arrays[idx];typedArrays[idx]=element instanceof Uint8Array?element:typedArrayFor(element)}var totalSize=0;for(var idx=0;idx<arrayCount;idx++)totalSize+=arrays[idx].length;var merged=new Uint8Array(totalSize),offset=0;for(var arrIdx=0;arrIdx<arrayCount;arrIdx++){var arr=typedArrays[arrIdx];for(var byteIdx=0,arrLen=arr.length;byteIdx<arrLen;byteIdx++)merged[offset++]=arr[byteIdx]}return merged},mergeUint8Arrays=function(arrays){var totalSize=0;for(var idx=0,len=arrays.length;idx<len;idx++)totalSize+=arrays[idx].length;var mergedBuffer=new Uint8Array(totalSize),offset=0;for(var idx=0,len=arrays.length;idx<len;idx++){var array=arrays[idx];mergedBuffer.set(array,offset),offset+=array.length}return mergedBuffer},arrayAsString=function(array){var str="";for(var idx=0,len=array.length;idx<len;idx++)str+=charFromCode(array[idx]);return str},byAscendingId=function(a,b2){return a.id-b2.id},sortedUniq=function(array,indexer){var uniq=[];for(var idx=0,len=array.length;idx<len;idx++){var curr=array[idx],prev=array[idx-1];if(idx===0||indexer(curr)!==indexer(prev))uniq.push(curr)}return uniq},reverseArray=function(array){var arrayLen=array.length;for(var idx=0,len=Math.floor(arrayLen/2);idx<len;idx++){var leftIdx=idx,rightIdx=arrayLen-idx-1,temp=array[idx];array[leftIdx]=array[rightIdx],array[rightIdx]=temp}return array},sum=function(array){var total=0;for(var idx=0,len=array.length;idx<len;idx++)total+=array[idx];return total},range=function(start,end){var arr=new Array(end-start);for(var idx=0,len=arr.length;idx<len;idx++)arr[idx]=start+idx;return arr},pluckIndices=function(arr,indices){var plucked=new Array(indices.length);for(var idx=0,len=indices.length;idx<len;idx++)plucked[idx]=arr[indices[idx]];return plucked},canBeConvertedToUint8Array=function(input){return input instanceof Uint8Array||input instanceof ArrayBuffer||typeof input==="string"},toUint8Array=function(input){if(typeof input==="string")return decodeFromBase64DataUri(input);else if(input instanceof ArrayBuffer)return new Uint8Array(input);else if(input instanceof Uint8Array)return input;else throw new TypeError("`input` must be one of `string | ArrayBuffer | Uint8Array`")};var waitForTick=function(){return new Promise(function(resolve){setTimeout(function(){return resolve()},0)})};var utf16Encode=function(input,byteOrderMark){if(byteOrderMark===void 0)byteOrderMark=!0;var encoded=[];if(byteOrderMark)encoded.push(65279);for(var idx=0,len=input.length;idx<len;){var codePoint=input.codePointAt(idx);if(codePoint<65536)encoded.push(codePoint),idx+=1;else if(codePoint<1114112)encoded.push(highSurrogate(codePoint),lowSurrogate(codePoint)),idx+=2;else throw new Error("Invalid code point: 0x"+toHexString(codePoint))}return new Uint16Array(encoded)},isWithinBMP=function(codePoint){return codePoint>=0&&codePoint<=65535},hasSurrogates=function(codePoint){return codePoint>=65536&&codePoint<=1114111},highSurrogate=function(codePoint){return Math.floor((codePoint-65536)/1024)+55296},lowSurrogate=function(codePoint){return(codePoint-65536)%1024+56320},ByteOrder;(function(ByteOrder2){ByteOrder2.BigEndian="BigEndian",ByteOrder2.LittleEndian="LittleEndian"})(ByteOrder||(ByteOrder={}));var REPLACEMENT="\uFFFD".codePointAt(0),utf16Decode=function(input,byteOrderMark){if(byteOrderMark===void 0)byteOrderMark=!0;if(input.length<=1)return String.fromCodePoint(REPLACEMENT);var byteOrder=byteOrderMark?readBOM(input):ByteOrder.BigEndian,idx=byteOrderMark?2:0,codePoints=[];while(input.length-idx>=2){var first=decodeValues(input[idx++],input[idx++],byteOrder);if(isHighSurrogate(first))if(input.length-idx<2)codePoints.push(REPLACEMENT);else{var second=decodeValues(input[idx++],input[idx++],byteOrder);if(isLowSurrogate(second))codePoints.push(first,second);else codePoints.push(REPLACEMENT)}else if(isLowSurrogate(first))idx+=2,codePoints.push(REPLACEMENT);else codePoints.push(first)}if(idx<input.length)codePoints.push(REPLACEMENT);return String.fromCodePoint.apply(String,codePoints)},isHighSurrogate=function(codePoint){return codePoint>=55296&&codePoint<=56319},isLowSurrogate=function(codePoint){return codePoint>=56320&&codePoint<=57343},decodeValues=function(first,second,byteOrder){if(byteOrder===ByteOrder.LittleEndian)return second<<8|first;if(byteOrder===ByteOrder.BigEndian)return first<<8|second;throw new Error("Invalid byteOrder: "+byteOrder)},readBOM=function(bytes){return hasUtf16BigEndianBOM(bytes)?ByteOrder.BigEndian:hasUtf16LittleEndianBOM(bytes)?ByteOrder.LittleEndian:ByteOrder.BigEndian},hasUtf16BigEndianBOM=function(bytes){return bytes[0]===254&&bytes[1]===255},hasUtf16LittleEndianBOM=function(bytes){return bytes[0]===255&&bytes[1]===254},hasUtf16BOM=function(bytes){return hasUtf16BigEndianBOM(bytes)||hasUtf16LittleEndianBOM(bytes)};var numberToString=function(num){var numStr=String(num);if(Math.abs(num)<1){var e=parseInt(num.toString().split("e-")[1]);if(e){var negative=num<0;if(negative)num*=-1;if(num*=Math.pow(10,e-1),numStr="0."+new Array(e).join("0")+num.toString().substring(2),negative)numStr="-"+numStr}}else{var e=parseInt(num.toString().split("+")[1]);if(e>20)e-=20,num/=Math.pow(10,e),numStr=num.toString()+new Array(e+1).join("0")}return numStr},sizeInBytes=function(n){return Math.ceil(n.toString(2).length/8)},bytesFor=function(n){var bytes=new Uint8Array(sizeInBytes(n));for(var i2=1;i2<=bytes.length;i2++)bytes[i2-1]=n>>(bytes.length-i2)*8;return bytes};var error2=function(msg){throw new Error(msg)};var import_pako=__toESM(require_pako(),1),chars2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup2=new Uint8Array(256);for(i2=0;i2<chars2.length;i2++)lookup2[chars2.charCodeAt(i2)]=i2;var i2,decodeFromBase642=function(base64){var bufferLength=base64.length*0.75,len=base64.length,i3,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==="="){if(bufferLength--,base64[base64.length-2]==="=")bufferLength--}var bytes=new Uint8Array(bufferLength);for(i3=0;i3<len;i3+=4)encoded1=lookup2[base64.charCodeAt(i3)],encoded2=lookup2[base64.charCodeAt(i3+1)],encoded3=lookup2[base64.charCodeAt(i3+2)],encoded4=lookup2[base64.charCodeAt(i3+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(encoded2&15)<<4|encoded3>>2,bytes[p++]=(encoded3&3)<<6|encoded4&63;return bytes},arrayToString=function(array){var str="";for(var i3=0;i3<array.length;i3++)str+=String.fromCharCode(array[i3]);return str},decompressJson=function(compressedJson){return arrayToString(import_pako.default.inflate(decodeFromBase642(compressedJson)))},padStart2=function(value,length,padChar){var padding="";for(var idx=0,len=length-value.length;idx<len;idx++)padding+=padChar;return padding+value};var Courier_Bold_compressed_default="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";var Courier_BoldOblique_compressed_default="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";var Courier_Oblique_compressed_default="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";var Courier_compressed_default="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";var Helvetica_Bold_compressed_default="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";var Helvetica_BoldOblique_compressed_default="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";var Helvetica_Oblique_compressed_default="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";var Helvetica_compressed_default="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";var Times_Bold_compressed_default="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";var Times_BoldItalic_compressed_default="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";var Times_Italic_compressed_default="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";var Times_Roman_compressed_default="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";var Symbol_compressed_default="eJx9WFlv2zgQ/iuGnnYBt5DkS85bmk13g27SoEkPbNEHWqIlIhSpklSuov99R7JIkSLtFyGZjxzN8c0h/4oueF1jpqKz6Mt1K1GJZ4s4S+PZYrvdbqJ59J4zdYNqDAfuXuodp52spdSToZrQl6n0KyZl1Sm/xgVpa5BcKURJfs5KCgdj+F++J8+4uCUqr6IzJVo8jy4qJFCusLjD3d27BucE0cGYd+/4c3T2/U2SxfM36XYxT+JtDI8k/jGPPrMCC0oYvuWSKMJZdPYmiWMLuK9I/sCwlNHZCuRfsJD9sSiOk7dxnMFbbrgieefGBW9eROfA7I/8z1myzVbz7rnpn9vuCW/unpvZecF3eHb3IhWu5eyK5Vw0XCCFi7ezc0pnvRo5E1hi8QhCeM0lHCoIK+/yCvdR67zrfd2THPA7VfzzNTrbpv2fX+BPeH8fm2usBMnBg++/oq/forO08+QGNMgGgeG/5wfxYrE4iPFzTlFt5JtkkLeMPIL/EFoNreJBE2vrXReako3YcqvVEXCTKWJdzPS7Gizyjk/mZZvsAKC66d7FCgMtF4NC2eaVqpDyLW+QwIzi/TGoD6tvPQL7BJEPNVKVb39DW2mkJnY5FALyD9eEhU6DL4SPrqTaS0mRrHyDXrHgvpQz7AvVU+CkqgQOnN3zVgSkkFVfKslzQIgfMfPFOBxWRiyDjcs5p5wFIoFr4kImprQrP59WP1ubiVpcCgxlNLq5XC4PwM8Wy77EvSs5ZyU0EpuFaXqAzmlTjVlerzcH8TuskH/4oiLj0WQQ/oWpdXadJAfxZSOJ7exmPfD01lYSD8K/kU0288JLS7Mh+hW337dINCPA5MRX8QE1jXU8Wx/E/6J6V4zyLBtCdd36Km4Cso+QTOG4N6T5dvRusxxsu6/scK5Wgw2fKovZ20HxHSnrQDjv0WjEejvw7/MkxmMD6ZQkvnEfa1xayperg/ibZfN2kN1K4lvxHw4lZAfD6QErpy1lOt2QF4H3XATa8HDP7VnrVWY6SoNZQfKWokBRt90Ak7mt2GACwTVE8bNPE+Tw3VTIzkmQqRuLqsvtUGaFw3cTcjzJxSod3tjYSnQgS4fvpgyc8KaDZuLwXR8FtYlv8YPD9rHBuGxfbQYG1q1vL2v9+3zC9nF0EF+BqoLBFBbbjRfSYbsJprLYboxtpx1Fj23esXoMhqlx7rB9uR2OPxP/aCMDmX61/Vhm8cha7HA91bzbWUR1z0/m8tLUKSyJ1qWNHqeXrTUf16lb76Or6XIzTmWFA4mHyeLOkUS3+H23UpJQPAnbE0bUS2CSUi6IdWM13Mhpu/OlBUE1t/YbA1QYCeWLYVsrRh+SeDm0RCQEf9pxa3Xpds4RcpJhqNVDbXPkzqTpOJcK/mT1VO17gUtn57C3J3cpMlUucW77Px3hRwZ83VJFGvriJ6YRHJboLmnWPUNXWAC7FbQg+/0IrjUL4RMFBxhYkEdSBLxiXB0xD8TkEZorywPXoP0I/jxhXGzWKEoJUFgeiTvs3srq2eO9Hq2Aeq92S9eDIgeYwIeawKoVY+KyVOumuBmpY0r+CgrgQVn7ohl9n6aIoc4TJjB0lEDWvmaGa05ETrGfPRd3lm1jI64b9SKtBJlbhAFTgEhuqWoUvlhCFdwRBW613cNWqnGYyDAdj+OQfdnugpBWHUa14jAKbbN2tlDrfR6mXUT9p7F3peyGvHNBb0UCl933GHgmyN6Hc/0R6+KZxiG7Ba6ReJjg6RiAos0DpTRsHWNz1s284Mr58DI+UF52N8B7vyIGzP4+nGJcWLXiNMtiR0/0S0BPtExAj3ZNwE42zh11e6duTZS/YlZaK6DebfrkOsb4aURMnsqiA+viHpPowDrwsoX1y6moRTZ20cMXtmpOgFYf8sGd8kFrRw4ptuCQagu2lJvwmpXEUu2DNSlOoEf12vY4aXOZkG6WY8OC4hzrwHRcjVhWepjd4KdYKK7jrx5H89WjRxPWoycydlS3jZ/I2VS/G9yp9gB6PG1T1aY4YAp3LfPHPPqABbtFRHS/jf34/T82FAfb";var ZapfDingbats_compressed_default="eJxtmNtu20YQhl+F4FULyMGeD7pz3AY1ChtG7NpFA18w1NomIlECSRcxgrx7SVk7+wOdG8H5OJydf2Z2d5gf9cV+t0v9VK/r+6vXsXlOlbHe28paq229qj/t++m62aXZ4J/m8PRb1z9/baZxefK63Z6eXN5dVMvTCh83u277xr/6kLrnl2XNq7TpXnczuZyabdee98/b2VzM/x4/dd/T5qab2pd6PQ2vaVVfvDRD005puE3Lu7eH1HbN9hTjx4/77/X6y5lcnUmjVzHIVVDicVX/1W/SsO36dLMfu6nb9/X6TAoBD+5euvZbn8axXtuZ36dhPJrVQqgPQoh5hev91LWLkIv94W1Ygq9+aX+tZAx2tfz64284/sblN/rqfLP/mqrbt3FKu7G67Nv9cNgPzZQ2H6rz7bb6vLgZq89pTMO/M/xfEqturJpqSM/d7GJIm2oamk3aNcO3av80O5xh3yyKmm1193ZIT02bqovTKjP+MAf++7zsZvZ3276kYyWWXB0z99S18/PbafPHQ71W4fjn/fxnFO+ZvkrT0LVzTr78qB/+nk38bHM9exgP8zr1z9U7jt6840YW5uSJKcZOCaBBnKgm5mU8MVNYyMwWFvO7Ukagkmgg6sDWQ5yFFqjzUrLEaQ3BEmiwNsMSaZS0vgWfOkPHWQowNeTUc0kumnxZvsgPxlGai6VTGUqAVCTQ6QkWnc77DKEiLktSUBJKqHIQZ86d8gCpHYoiEzMsb1ubYy8vW50DChB5ZhGqrijD0EqUIeiaEHIfCg5Kpuu0ApiToaGPSY0uaQsyr65L2oKi1yFt1PLaQ3lzfXTgXodGoJYzglndSLDMPg1sTPJpQJHJigw0QrGERqD9YhyTOgONQDUyuF1zaxuokc/BW2ztXCMrGZ9WMW1oQZHIXWNBkSCfRZEL5BMUiZw6CzVSFCfUSGZFNjIldoKDkonTKQiJIGzWmFd3BizJJ9SINoLDriOfUCOZS+zg+KGD1qGiLNMLxtJD1/ns00ON6EzyUCM6vbxhoBKaqbG3DFQCNiL1iHccBPV0DHhQH/JW8EW90dkyFKGywCJU0WkVSvSGeiSUODWFFD0HYdPQVoiRgfPMA+/nnRgiAyNYSjpWNQcNSMrtFCUH4ZIRpSCWocFCSuhCEY6hoUClc0WC52BJlCYYLQdhN+hygRRRlo5BKRRLS6oihSqh+ZzzRGG1Mo4Iz1LoP0qsxDGFzk0JE42ji0jCPejomJKCuwil4m5CiRMEUMVSzVLDUstSx1Juc0oVWMpqY295qVltmtWmWW2a1aZZbZrVplltmtWmWW2G1WZYbYbVZlhthtVmWG2G1WZYbYbVZlhtltVmWW2W1WZZbZbVZlltltVmWW2W1QYjQCh7E2aAQHeGhCFgPoNoy8KNb2wxBhmGKBxoUZXlLGsLI6AsftEDHV0wIURVbANLcTKlGGBIKPOAxCmhePCKUwFzAmpDFRQvjA9R06Hq8TONvshgKDCuRAZTXigUxjxNFfKRo3CLhnIJBMFRvMZpqpNBMlQJzGT5WFQMVQI/AikPMIhEU1aDjqJvQwmjSHB05cC9jbYwc5UtAHNLhDw41ha+lEqF4JaH3gmB61SYcqInxTDmQK8v08vjqv4zDf1N0w3Lf4A8/vwPpfK11w==";var compressedJsonForFontName={Courier:Courier_compressed_default,"Courier-Bold":Courier_Bold_compressed_default,"Courier-Oblique":Courier_Oblique_compressed_default,"Courier-BoldOblique":Courier_BoldOblique_compressed_default,Helvetica:Helvetica_compressed_default,"Helvetica-Bold":Helvetica_Bold_compressed_default,"Helvetica-Oblique":Helvetica_Oblique_compressed_default,"Helvetica-BoldOblique":Helvetica_BoldOblique_compressed_default,"Times-Roman":Times_Roman_compressed_default,"Times-Bold":Times_Bold_compressed_default,"Times-Italic":Times_Italic_compressed_default,"Times-BoldItalic":Times_BoldItalic_compressed_default,Symbol:Symbol_compressed_default,ZapfDingbats:ZapfDingbats_compressed_default},FontNames;(function(FontNames2){FontNames2.Courier="Courier",FontNames2.CourierBold="Courier-Bold",FontNames2.CourierOblique="Courier-Oblique",FontNames2.CourierBoldOblique="Courier-BoldOblique",FontNames2.Helvetica="Helvetica",FontNames2.HelveticaBold="Helvetica-Bold",FontNames2.HelveticaOblique="Helvetica-Oblique",FontNames2.HelveticaBoldOblique="Helvetica-BoldOblique",FontNames2.TimesRoman="Times-Roman",FontNames2.TimesRomanBold="Times-Bold",FontNames2.TimesRomanItalic="Times-Italic",FontNames2.TimesRomanBoldItalic="Times-BoldItalic",FontNames2.Symbol="Symbol",FontNames2.ZapfDingbats="ZapfDingbats"})(FontNames||(FontNames={}));var fontCache={},Font=function(){function Font2(){var _this=this;this.getWidthOfGlyph=function(glyphName){return _this.CharWidths[glyphName]},this.getXAxisKerningForPair=function(leftGlyphName,rightGlyphName){return(_this.KernPairXAmounts[leftGlyphName]||{})[rightGlyphName]}}return Font2.load=function(fontName){var cachedFont=fontCache[fontName];if(cachedFont)return cachedFont;var json2=decompressJson(compressedJsonForFontName[fontName]),font=Object.assign(new Font2,JSON.parse(json2));return font.CharWidths=font.CharMetrics.reduce(function(acc,metric){return acc[metric.N]=metric.WX,acc},{}),font.KernPairXAmounts=font.KernPairs.reduce(function(acc,_a){var name1=_a[0],name2=_a[1],width=_a[2];if(!acc[name1])acc[name1]={};return acc[name1][name2]=width,acc},{}),fontCache[fontName]=font,font},Font2}();var all_encodings_compressed_default="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";var decompressedEncodings=decompressJson(all_encodings_compressed_default),allUnicodeMappings=JSON.parse(decompressedEncodings),Encoding=function(){function Encoding2(name,unicodeMappings){var _this=this;this.canEncodeUnicodeCodePoint=function(codePoint){return codePoint in _this.unicodeMappings},this.encodeUnicodeCodePoint=function(codePoint){var mapped=_this.unicodeMappings[codePoint];if(!mapped){var str=String.fromCharCode(codePoint),hexCode="0x"+padStart2(codePoint.toString(16),4,"0"),msg=_this.name+' cannot encode "'+str+'" ('+hexCode+")";throw new Error(msg)}return{code:mapped[0],name:mapped[1]}},this.name=name,this.supportedCodePoints=Object.keys(unicodeMappings).map(Number).sort(function(a,b2){return a-b2}),this.unicodeMappings=unicodeMappings}return Encoding2}(),Encodings={Symbol:new Encoding("Symbol",allUnicodeMappings.symbol),ZapfDingbats:new Encoding("ZapfDingbats",allUnicodeMappings.zapfdingbats),WinAnsi:new Encoding("WinAnsi",allUnicodeMappings.win1252)};var values2=function(obj){return Object.keys(obj).map(function(k2){return obj[k2]})},StandardFontValues=values2(FontNames),isStandardFont=function(input){return StandardFontValues.includes(input)},rectanglesAreEqual=function(a,b2){return a.x===b2.x&&a.y===b2.y&&a.width===b2.width&&a.height===b2.height};var backtick=function(val){return"`"+val+"`"},singleQuote=function(val){return"'"+val+"'"},formatValue=function(value){var type2=typeof value;if(type2==="string")return singleQuote(value);else if(type2==="undefined")return backtick(value);else return value},createValueErrorMsg=function(value,valueName,values3){var allowedValues=new Array(values3.length);for(var idx=0,len=values3.length;idx<len;idx++){var v=values3[idx];allowedValues[idx]=formatValue(v)}var joinedValues=allowedValues.join(" or ");return backtick(valueName)+" must be one of "+joinedValues+", but was actually "+formatValue(value)},assertIsOneOf=function(value,valueName,allowedValues){if(!Array.isArray(allowedValues))allowedValues=values2(allowedValues);for(var idx=0,len=allowedValues.length;idx<len;idx++)if(value===allowedValues[idx])return;throw new TypeError(createValueErrorMsg(value,valueName,allowedValues))},assertIsOneOfOrUndefined=function(value,valueName,allowedValues){if(!Array.isArray(allowedValues))allowedValues=values2(allowedValues);assertIsOneOf(value,valueName,allowedValues.concat(void 0))},assertIsSubset=function(values3,valueName,allowedValues){if(!Array.isArray(allowedValues))allowedValues=values2(allowedValues);for(var idx=0,len=values3.length;idx<len;idx++)assertIsOneOf(values3[idx],valueName,allowedValues)},getType=function(val){if(val===null)return"null";if(val===void 0)return"undefined";if(typeof val==="string")return"string";if(isNaN(val))return"NaN";if(typeof val==="number")return"number";if(typeof val==="boolean")return"boolean";if(typeof val==="symbol")return"symbol";if(typeof val==="bigint")return"bigint";if(val.constructor&&val.constructor.name)return val.constructor.name;if(val.name)return val.name;if(val.constructor)return String(val.constructor);return String(val)},isType=function(value,type2){if(type2==="null")return value===null;if(type2==="undefined")return value===void 0;if(type2==="string")return typeof value==="string";if(type2==="number")return typeof value==="number"&&!isNaN(value);if(type2==="boolean")return typeof value==="boolean";if(type2==="symbol")return typeof value==="symbol";if(type2==="bigint")return typeof value==="bigint";if(type2===Date)return value instanceof Date;if(type2===Array)return value instanceof Array;if(type2===Uint8Array)return value instanceof Uint8Array;if(type2===ArrayBuffer)return value instanceof ArrayBuffer;if(type2===Function)return value instanceof Function;return value instanceof type2[0]},createTypeErrorMsg=function(value,valueName,types3){var allowedTypes=new Array(types3.length);for(var idx=0,len=types3.length;idx<len;idx++){var type2=types3[idx];if(type2==="null")allowedTypes[idx]=backtick("null");if(type2==="undefined")allowedTypes[idx]=backtick("undefined");if(type2==="string")allowedTypes[idx]=backtick("string");else if(type2==="number")allowedTypes[idx]=backtick("number");else if(type2==="boolean")allowedTypes[idx]=backtick("boolean");else if(type2==="symbol")allowedTypes[idx]=backtick("symbol");else if(type2==="bigint")allowedTypes[idx]=backtick("bigint");else if(type2===Array)allowedTypes[idx]=backtick("Array");else if(type2===Uint8Array)allowedTypes[idx]=backtick("Uint8Array");else if(type2===ArrayBuffer)allowedTypes[idx]=backtick("ArrayBuffer");else allowedTypes[idx]=backtick(type2[1])}var joinedTypes=allowedTypes.join(" or ");return backtick(valueName)+" must be of type "+joinedTypes+", but was actually of type "+backtick(getType(value))},assertIs=function(value,valueName,types3){for(var idx=0,len=types3.length;idx<len;idx++)if(isType(value,types3[idx]))return;throw new TypeError(createTypeErrorMsg(value,valueName,types3))},assertOrUndefined=function(value,valueName,types3){assertIs(value,valueName,types3.concat("undefined"))},assertEachIs=function(values3,valueName,types3){for(var idx=0,len=values3.length;idx<len;idx++)assertIs(values3[idx],valueName,types3)},assertRange=function(value,valueName,min,max){if(assertIs(value,valueName,["number"]),assertIs(min,"min",["number"]),assertIs(max,"max",["number"]),max=Math.max(min,max),value<min||value>max)throw new Error(backtick(valueName)+" must be at least "+min+" and at most "+max+", but was actually "+value)},assertRangeOrUndefined=function(value,valueName,min,max){if(assertIs(value,valueName,["number","undefined"]),typeof value==="number")assertRange(value,valueName,min,max)},assertMultiple=function(value,valueName,multiplier){if(assertIs(value,valueName,["number"]),value%multiplier!==0)throw new Error(backtick(valueName)+" must be a multiple of "+multiplier+", but was actually "+value)},assertInteger=function(value,valueName){if(!Number.isInteger(value))throw new Error(backtick(valueName)+" must be an integer, but was actually "+value)},assertPositive=function(value,valueName){if(![1,0].includes(Math.sign(value)))throw new Error(backtick(valueName)+" must be a positive number or 0, but was actually "+value)};var pdfDocEncodingToUnicode=new Uint16Array(256);for(idx=0;idx<256;idx++)pdfDocEncodingToUnicode[idx]=idx;var idx;pdfDocEncodingToUnicode[22]=toCharCode("\x17");pdfDocEncodingToUnicode[24]=toCharCode("\u02D8");pdfDocEncodingToUnicode[25]=toCharCode("\u02C7");pdfDocEncodingToUnicode[26]=toCharCode("\u02C6");pdfDocEncodingToUnicode[27]=toCharCode("\u02D9");pdfDocEncodingToUnicode[28]=toCharCode("\u02DD");pdfDocEncodingToUnicode[29]=toCharCode("\u02DB");pdfDocEncodingToUnicode[30]=toCharCode("\u02DA");pdfDocEncodingToUnicode[31]=toCharCode("\u02DC");pdfDocEncodingToUnicode[127]=toCharCode("\uFFFD");pdfDocEncodingToUnicode[128]=toCharCode("\u2022");pdfDocEncodingToUnicode[129]=toCharCode("\u2020");pdfDocEncodingToUnicode[130]=toCharCode("\u2021");pdfDocEncodingToUnicode[131]=toCharCode("\u2026");pdfDocEncodingToUnicode[132]=toCharCode("\u2014");pdfDocEncodingToUnicode[133]=toCharCode("\u2013");pdfDocEncodingToUnicode[134]=toCharCode("\u0192");pdfDocEncodingToUnicode[135]=toCharCode("\u2044");pdfDocEncodingToUnicode[136]=toCharCode("\u2039");pdfDocEncodingToUnicode[137]=toCharCode("\u203A");pdfDocEncodingToUnicode[138]=toCharCode("\u2212");pdfDocEncodingToUnicode[139]=toCharCode("\u2030");pdfDocEncodingToUnicode[140]=toCharCode("\u201E");pdfDocEncodingToUnicode[141]=toCharCode("\u201C");pdfDocEncodingToUnicode[142]=toCharCode("\u201D");pdfDocEncodingToUnicode[143]=toCharCode("\u2018");pdfDocEncodingToUnicode[144]=toCharCode("\u2019");pdfDocEncodingToUnicode[145]=toCharCode("\u201A");pdfDocEncodingToUnicode[146]=toCharCode("\u2122");pdfDocEncodingToUnicode[147]=toCharCode("\uFB01");pdfDocEncodingToUnicode[148]=toCharCode("\uFB02");pdfDocEncodingToUnicode[149]=toCharCode("\u0141");pdfDocEncodingToUnicode[150]=toCharCode("\u0152");pdfDocEncodingToUnicode[151]=toCharCode("\u0160");pdfDocEncodingToUnicode[152]=toCharCode("\u0178");pdfDocEncodingToUnicode[153]=toCharCode("\u017D");pdfDocEncodingToUnicode[154]=toCharCode("\u0131");pdfDocEncodingToUnicode[155]=toCharCode("\u0142");pdfDocEncodingToUnicode[156]=toCharCode("\u0153");pdfDocEncodingToUnicode[157]=toCharCode("\u0161");pdfDocEncodingToUnicode[158]=toCharCode("\u017E");pdfDocEncodingToUnicode[159]=toCharCode("\uFFFD");pdfDocEncodingToUnicode[160]=toCharCode("\u20AC");pdfDocEncodingToUnicode[173]=toCharCode("\uFFFD");var pdfDocEncodingDecode=function(bytes){var codePoints=new Array(bytes.length);for(var idx2=0,len=bytes.length;idx2<len;idx2++)codePoints[idx2]=pdfDocEncodingToUnicode[bytes[idx2]];return String.fromCodePoint.apply(String,codePoints)};var Cache=function(){function Cache2(populate){this.populate=populate,this.value=void 0}return Cache2.prototype.getValue=function(){return this.value},Cache2.prototype.access=function(){if(!this.value)this.value=this.populate();return this.value},Cache2.prototype.invalidate=function(){this.value=void 0},Cache2.populatedBy=function(populate){return new Cache2(populate)},Cache2}(),Cache_default=Cache;var MethodNotImplementedError=function(_super){__extends(MethodNotImplementedError2,_super);function MethodNotImplementedError2(className,methodName){var _this=this,msg="Method "+className+"."+methodName+"() not implemented";return _this=_super.call(this,msg)||this,_this}return MethodNotImplementedError2}(Error);var PrivateConstructorError=function(_super){__extends(PrivateConstructorError2,_super);function PrivateConstructorError2(className){var _this=this,msg="Cannot construct "+className+" - it has a private constructor";return _this=_super.call(this,msg)||this,_this}return PrivateConstructorError2}(Error);var UnexpectedObjectTypeError=function(_super){__extends(UnexpectedObjectTypeError2,_super);function UnexpectedObjectTypeError2(expected,actual){var _this=this,name=function(t2){var _a,_b;return(_a=t2===null||t2===void 0?void 0:t2.name)!==null&&_a!==void 0?_a:(_b=t2===null||t2===void 0?void 0:t2.constructor)===null||_b===void 0?void 0:_b.name},expectedTypes=Array.isArray(expected)?expected.map(name):[name(expected)],msg="Expected instance of "+expectedTypes.join(" or ")+", "+("but got instance of "+(actual?name(actual):actual));return _this=_super.call(this,msg)||this,_this}return UnexpectedObjectTypeError2}(Error);var UnsupportedEncodingError=function(_super){__extends(UnsupportedEncodingError2,_super);function UnsupportedEncodingError2(encoding){var _this=this,msg=encoding+" stream encoding not supported";return _this=_super.call(this,msg)||this,_this}return UnsupportedEncodingError2}(Error);var ReparseError=function(_super){__extends(ReparseError2,_super);function ReparseError2(className,methodName){var _this=this,msg="Cannot call "+className+"."+methodName+"() more than once";return _this=_super.call(this,msg)||this,_this}return ReparseError2}(Error);var MissingCatalogError=function(_super){__extends(MissingCatalogError2,_super);function MissingCatalogError2(ref){var _this=this,msg="Missing catalog (ref="+ref+")";return _this=_super.call(this,msg)||this,_this}return MissingCatalogError2}(Error);var MissingPageContentsEmbeddingError=function(_super){__extends(MissingPageContentsEmbeddingError2,_super);function MissingPageContentsEmbeddingError2(){var _this=this,msg="Can't embed page with missing Contents";return _this=_super.call(this,msg)||this,_this}return MissingPageContentsEmbeddingError2}(Error);var UnrecognizedStreamTypeError=function(_super){__extends(UnrecognizedStreamTypeError2,_super);function UnrecognizedStreamTypeError2(stream){var _a,_b,_c,_this=this,streamType=(_c=(_b=(_a=stream===null||stream===void 0?void 0:stream.contructor)===null||_a===void 0?void 0:_a.name)!==null&&_b!==void 0?_b:stream===null||stream===void 0?void 0:stream.name)!==null&&_c!==void 0?_c:stream,msg="Unrecognized stream type: "+streamType;return _this=_super.call(this,msg)||this,_this}return UnrecognizedStreamTypeError2}(Error);var PageEmbeddingMismatchedContextError=function(_super){__extends(PageEmbeddingMismatchedContextError2,_super);function PageEmbeddingMismatchedContextError2(){var _this=this,msg="Found mismatched contexts while embedding pages. All pages in the array passed to `PDFDocument.embedPages()` must be from the same document.";return _this=_super.call(this,msg)||this,_this}return PageEmbeddingMismatchedContextError2}(Error);var PDFArrayIsNotRectangleError=function(_super){__extends(PDFArrayIsNotRectangleError2,_super);function PDFArrayIsNotRectangleError2(size){var _this=this,msg="Attempted to convert PDFArray with "+size+" elements to rectangle, but must have exactly 4 elements.";return _this=_super.call(this,msg)||this,_this}return PDFArrayIsNotRectangleError2}(Error);var InvalidPDFDateStringError=function(_super){__extends(InvalidPDFDateStringError2,_super);function InvalidPDFDateStringError2(value){var _this=this,msg='Attempted to convert "'+value+'" to a date, but it does not match the PDF date string format.';return _this=_super.call(this,msg)||this,_this}return InvalidPDFDateStringError2}(Error);var InvalidTargetIndexError=function(_super){__extends(InvalidTargetIndexError2,_super);function InvalidTargetIndexError2(targetIndex,Count){var _this=this,msg="Invalid targetIndex specified: targetIndex="+targetIndex+" must be less than Count="+Count;return _this=_super.call(this,msg)||this,_this}return InvalidTargetIndexError2}(Error);var CorruptPageTreeError=function(_super){__extends(CorruptPageTreeError2,_super);function CorruptPageTreeError2(targetIndex,operation){var _this=this,msg="Failed to "+operation+" at targetIndex="+targetIndex+" due to corrupt page tree: It is likely that one or more 'Count' entries are invalid";return _this=_super.call(this,msg)||this,_this}return CorruptPageTreeError2}(Error);var IndexOutOfBoundsError=function(_super){__extends(IndexOutOfBoundsError2,_super);function IndexOutOfBoundsError2(index2,min,max){var _this=this,msg="index should be at least "+min+" and at most "+max+", but was actually "+index2;return _this=_super.call(this,msg)||this,_this}return IndexOutOfBoundsError2}(Error);var InvalidAcroFieldValueError=function(_super){__extends(InvalidAcroFieldValueError2,_super);function InvalidAcroFieldValueError2(){var _this=this,msg="Attempted to set invalid field value";return _this=_super.call(this,msg)||this,_this}return InvalidAcroFieldValueError2}(Error);var MultiSelectValueError=function(_super){__extends(MultiSelectValueError2,_super);function MultiSelectValueError2(){var _this=this,msg="Attempted to select multiple values for single-select field";return _this=_super.call(this,msg)||this,_this}return MultiSelectValueError2}(Error);var MissingDAEntryError=function(_super){__extends(MissingDAEntryError2,_super);function MissingDAEntryError2(fieldName){var _this=this,msg="No /DA (default appearance) entry found for field: "+fieldName;return _this=_super.call(this,msg)||this,_this}return MissingDAEntryError2}(Error);var MissingTfOperatorError=function(_super){__extends(MissingTfOperatorError2,_super);function MissingTfOperatorError2(fieldName){var _this=this,msg="No Tf operator found for DA of field: "+fieldName;return _this=_super.call(this,msg)||this,_this}return MissingTfOperatorError2}(Error);var NumberParsingError=function(_super){__extends(NumberParsingError2,_super);function NumberParsingError2(pos,value){var _this=this,msg="Failed to parse number "+("(line:"+pos.line+" col:"+pos.column+" offset="+pos.offset+'): "'+value+'"');return _this=_super.call(this,msg)||this,_this}return NumberParsingError2}(Error);var PDFParsingError=function(_super){__extends(PDFParsingError2,_super);function PDFParsingError2(pos,details){var _this=this,msg="Failed to parse PDF document "+("(line:"+pos.line+" col:"+pos.column+" offset="+pos.offset+"): "+details);return _this=_super.call(this,msg)||this,_this}return PDFParsingError2}(Error);var NextByteAssertionError=function(_super){__extends(NextByteAssertionError2,_super);function NextByteAssertionError2(pos,expectedByte,actualByte){var _this=this,msg="Expected next byte to be "+expectedByte+" but it was actually "+actualByte;return _this=_super.call(this,pos,msg)||this,_this}return NextByteAssertionError2}(PDFParsingError);var PDFObjectParsingError=function(_super){__extends(PDFObjectParsingError2,_super);function PDFObjectParsingError2(pos,byte2){var _this=this,msg="Failed to parse PDF object starting with the following byte: "+byte2;return _this=_super.call(this,pos,msg)||this,_this}return PDFObjectParsingError2}(PDFParsingError);var PDFInvalidObjectParsingError=function(_super){__extends(PDFInvalidObjectParsingError2,_super);function PDFInvalidObjectParsingError2(pos){var _this=this,msg="Failed to parse invalid PDF object";return _this=_super.call(this,pos,msg)||this,_this}return PDFInvalidObjectParsingError2}(PDFParsingError);var PDFStreamParsingError=function(_super){__extends(PDFStreamParsingError2,_super);function PDFStreamParsingError2(pos){var _this=this,msg="Failed to parse PDF stream";return _this=_super.call(this,pos,msg)||this,_this}return PDFStreamParsingError2}(PDFParsingError);var UnbalancedParenthesisError=function(_super){__extends(UnbalancedParenthesisError2,_super);function UnbalancedParenthesisError2(pos){var _this=this,msg="Failed to parse PDF literal string due to unbalanced parenthesis";return _this=_super.call(this,pos,msg)||this,_this}return UnbalancedParenthesisError2}(PDFParsingError);var StalledParserError=function(_super){__extends(StalledParserError2,_super);function StalledParserError2(pos){var _this=this,msg="Parser stalled";return _this=_super.call(this,pos,msg)||this,_this}return StalledParserError2}(PDFParsingError);var MissingPDFHeaderError=function(_super){__extends(MissingPDFHeaderError2,_super);function MissingPDFHeaderError2(pos){var _this=this,msg="No PDF header found";return _this=_super.call(this,pos,msg)||this,_this}return MissingPDFHeaderError2}(PDFParsingError);var MissingKeywordError=function(_super){__extends(MissingKeywordError2,_super);function MissingKeywordError2(pos,keyword){var _this=this,msg="Did not find expected keyword '"+arrayAsString(keyword)+"'";return _this=_super.call(this,pos,msg)||this,_this}return MissingKeywordError2}(PDFParsingError);var CharCodes;(function(CharCodes2){CharCodes2[CharCodes2.Null=0]="Null",CharCodes2[CharCodes2.Backspace=8]="Backspace",CharCodes2[CharCodes2.Tab=9]="Tab",CharCodes2[CharCodes2.Newline=10]="Newline",CharCodes2[CharCodes2.FormFeed=12]="FormFeed",CharCodes2[CharCodes2.CarriageReturn=13]="CarriageReturn",CharCodes2[CharCodes2.Space=32]="Space",CharCodes2[CharCodes2.ExclamationPoint=33]="ExclamationPoint",CharCodes2[CharCodes2.Hash=35]="Hash",CharCodes2[CharCodes2.Percent=37]="Percent",CharCodes2[CharCodes2.LeftParen=40]="LeftParen",CharCodes2[CharCodes2.RightParen=41]="RightParen",CharCodes2[CharCodes2.Plus=43]="Plus",CharCodes2[CharCodes2.Minus=45]="Minus",CharCodes2[CharCodes2.Dash=45]="Dash",CharCodes2[CharCodes2.Period=46]="Period",CharCodes2[CharCodes2.ForwardSlash=47]="ForwardSlash",CharCodes2[CharCodes2.Zero=48]="Zero",CharCodes2[CharCodes2.One=49]="One",CharCodes2[CharCodes2.Two=50]="Two",CharCodes2[CharCodes2.Three=51]="Three",CharCodes2[CharCodes2.Four=52]="Four",CharCodes2[CharCodes2.Five=53]="Five",CharCodes2[CharCodes2.Six=54]="Six",CharCodes2[CharCodes2.Seven=55]="Seven",CharCodes2[CharCodes2.Eight=56]="Eight",CharCodes2[CharCodes2.Nine=57]="Nine",CharCodes2[CharCodes2.LessThan=60]="LessThan",CharCodes2[CharCodes2.GreaterThan=62]="GreaterThan",CharCodes2[CharCodes2.A=65]="A",CharCodes2[CharCodes2.D=68]="D",CharCodes2[CharCodes2.E=69]="E",CharCodes2[CharCodes2.F=70]="F",CharCodes2[CharCodes2.O=79]="O",CharCodes2[CharCodes2.P=80]="P",CharCodes2[CharCodes2.R=82]="R",CharCodes2[CharCodes2.LeftSquareBracket=91]="LeftSquareBracket",CharCodes2[CharCodes2.BackSlash=92]="BackSlash",CharCodes2[CharCodes2.RightSquareBracket=93]="RightSquareBracket",CharCodes2[CharCodes2.a=97]="a",CharCodes2[CharCodes2.b=98]="b",CharCodes2[CharCodes2.d=100]="d",CharCodes2[CharCodes2.e=101]="e",CharCodes2[CharCodes2.f=102]="f",CharCodes2[CharCodes2.i=105]="i",CharCodes2[CharCodes2.j=106]="j",CharCodes2[CharCodes2.l=108]="l",CharCodes2[CharCodes2.m=109]="m",CharCodes2[CharCodes2.n=110]="n",CharCodes2[CharCodes2.o=111]="o",CharCodes2[CharCodes2.r=114]="r",CharCodes2[CharCodes2.s=115]="s",CharCodes2[CharCodes2.t=116]="t",CharCodes2[CharCodes2.u=117]="u",CharCodes2[CharCodes2.x=120]="x",CharCodes2[CharCodes2.LeftCurly=123]="LeftCurly",CharCodes2[CharCodes2.RightCurly=125]="RightCurly",CharCodes2[CharCodes2.Tilde=126]="Tilde"})(CharCodes||(CharCodes={}));var CharCodes_default=CharCodes;var import_pako3=__toESM(require_pako(),1);var PDFHeader=function(){function PDFHeader2(major,minor){this.major=String(major),this.minor=String(minor)}return PDFHeader2.prototype.toString=function(){var bc=charFromCode(129);return"%PDF-"+this.major+"."+this.minor+`
%`+bc+bc+bc+bc},PDFHeader2.prototype.sizeInBytes=function(){return 12+this.major.length+this.minor.length},PDFHeader2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;return buffer2[offset++]=CharCodes_default.Percent,buffer2[offset++]=CharCodes_default.P,buffer2[offset++]=CharCodes_default.D,buffer2[offset++]=CharCodes_default.F,buffer2[offset++]=CharCodes_default.Dash,offset+=copyStringIntoBuffer(this.major,buffer2,offset),buffer2[offset++]=CharCodes_default.Period,offset+=copyStringIntoBuffer(this.minor,buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.Percent,buffer2[offset++]=129,buffer2[offset++]=129,buffer2[offset++]=129,buffer2[offset++]=129,offset-initialOffset},PDFHeader2.forVersion=function(major,minor){return new PDFHeader2(major,minor)},PDFHeader2}(),PDFHeader_default=PDFHeader;var PDFObject=function(){function PDFObject2(){}return PDFObject2.prototype.clone=function(_context){throw new MethodNotImplementedError(this.constructor.name,"clone")},PDFObject2.prototype.toString=function(){throw new MethodNotImplementedError(this.constructor.name,"toString")},PDFObject2.prototype.sizeInBytes=function(){throw new MethodNotImplementedError(this.constructor.name,"sizeInBytes")},PDFObject2.prototype.copyBytesInto=function(_buffer,_offset){throw new MethodNotImplementedError(this.constructor.name,"copyBytesInto")},PDFObject2}(),PDFObject_default=PDFObject;var PDFNumber=function(_super){__extends(PDFNumber2,_super);function PDFNumber2(value){var _this=_super.call(this)||this;return _this.numberValue=value,_this.stringValue=numberToString(value),_this}return PDFNumber2.prototype.asNumber=function(){return this.numberValue},PDFNumber2.prototype.value=function(){return this.numberValue},PDFNumber2.prototype.clone=function(){return PDFNumber2.of(this.numberValue)},PDFNumber2.prototype.toString=function(){return this.stringValue},PDFNumber2.prototype.sizeInBytes=function(){return this.stringValue.length},PDFNumber2.prototype.copyBytesInto=function(buffer2,offset){return offset+=copyStringIntoBuffer(this.stringValue,buffer2,offset),this.stringValue.length},PDFNumber2.of=function(value){return new PDFNumber2(value)},PDFNumber2}(PDFObject_default),PDFNumber_default=PDFNumber;var PDFArray=function(_super){__extends(PDFArray2,_super);function PDFArray2(context){var _this=_super.call(this)||this;return _this.array=[],_this.context=context,_this}return PDFArray2.prototype.size=function(){return this.array.length},PDFArray2.prototype.push=function(object){this.array.push(object)},PDFArray2.prototype.insert=function(index2,object){this.array.splice(index2,0,object)},PDFArray2.prototype.indexOf=function(object){var index2=this.array.indexOf(object);return index2===-1?void 0:index2},PDFArray2.prototype.remove=function(index2){this.array.splice(index2,1)},PDFArray2.prototype.set=function(idx2,object){this.array[idx2]=object},PDFArray2.prototype.get=function(index2){return this.array[index2]},PDFArray2.prototype.lookupMaybe=function(index2){var _a,types3=[];for(var _i=1;_i<arguments.length;_i++)types3[_i-1]=arguments[_i];return(_a=this.context).lookupMaybe.apply(_a,__spreadArrays([this.get(index2)],types3))},PDFArray2.prototype.lookup=function(index2){var _a,types3=[];for(var _i=1;_i<arguments.length;_i++)types3[_i-1]=arguments[_i];return(_a=this.context).lookup.apply(_a,__spreadArrays([this.get(index2)],types3))},PDFArray2.prototype.asRectangle=function(){if(this.size()!==4)throw new PDFArrayIsNotRectangleError(this.size());var lowerLeftX=this.lookup(0,PDFNumber_default).asNumber(),lowerLeftY=this.lookup(1,PDFNumber_default).asNumber(),upperRightX=this.lookup(2,PDFNumber_default).asNumber(),upperRightY=this.lookup(3,PDFNumber_default).asNumber(),x=lowerLeftX,y=lowerLeftY,width=upperRightX-lowerLeftX,height=upperRightY-lowerLeftY;return{x,y,width,height}},PDFArray2.prototype.asArray=function(){return this.array.slice()},PDFArray2.prototype.clone=function(context){var clone2=PDFArray2.withContext(context||this.context);for(var idx2=0,len=this.size();idx2<len;idx2++)clone2.push(this.array[idx2]);return clone2},PDFArray2.prototype.toString=function(){var arrayString="[ ";for(var idx2=0,len=this.size();idx2<len;idx2++)arrayString+=this.get(idx2).toString(),arrayString+=" ";return arrayString+="]",arrayString},PDFArray2.prototype.sizeInBytes=function(){var size=3;for(var idx2=0,len=this.size();idx2<len;idx2++)size+=this.get(idx2).sizeInBytes()+1;return size},PDFArray2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;buffer2[offset++]=CharCodes_default.LeftSquareBracket,buffer2[offset++]=CharCodes_default.Space;for(var idx2=0,len=this.size();idx2<len;idx2++)offset+=this.get(idx2).copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Space;return buffer2[offset++]=CharCodes_default.RightSquareBracket,offset-initialOffset},PDFArray2.prototype.scalePDFNumbers=function(x,y){for(var idx2=0,len=this.size();idx2<len;idx2++){var el=this.lookup(idx2);if(el instanceof PDFNumber_default){var factor=idx2%2===0?x:y;this.set(idx2,PDFNumber_default.of(el.asNumber()*factor))}}},PDFArray2.withContext=function(context){return new PDFArray2(context)},PDFArray2}(PDFObject_default),PDFArray_default=PDFArray;var ENFORCER={},PDFBool=function(_super){__extends(PDFBool2,_super);function PDFBool2(enforcer,value){var _this=this;if(enforcer!==ENFORCER)throw new PrivateConstructorError("PDFBool");return _this=_super.call(this)||this,_this.value=value,_this}return PDFBool2.prototype.asBoolean=function(){return this.value},PDFBool2.prototype.clone=function(){return this},PDFBool2.prototype.toString=function(){return String(this.value)},PDFBool2.prototype.sizeInBytes=function(){return this.value?4:5},PDFBool2.prototype.copyBytesInto=function(buffer2,offset){if(this.value)return buffer2[offset++]=CharCodes_default.t,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.u,buffer2[offset++]=CharCodes_default.e,4;else return buffer2[offset++]=CharCodes_default.f,buffer2[offset++]=CharCodes_default.a,buffer2[offset++]=CharCodes_default.l,buffer2[offset++]=CharCodes_default.s,buffer2[offset++]=CharCodes_default.e,5},PDFBool2.True=new PDFBool2(ENFORCER,!0),PDFBool2.False=new PDFBool2(ENFORCER,!1),PDFBool2}(PDFObject_default),PDFBool_default=PDFBool;var IsDelimiter=new Uint8Array(256);IsDelimiter[CharCodes_default.LeftParen]=1;IsDelimiter[CharCodes_default.RightParen]=1;IsDelimiter[CharCodes_default.LessThan]=1;IsDelimiter[CharCodes_default.GreaterThan]=1;IsDelimiter[CharCodes_default.LeftSquareBracket]=1;IsDelimiter[CharCodes_default.RightSquareBracket]=1;IsDelimiter[CharCodes_default.LeftCurly]=1;IsDelimiter[CharCodes_default.RightCurly]=1;IsDelimiter[CharCodes_default.ForwardSlash]=1;IsDelimiter[CharCodes_default.Percent]=1;var IsWhitespace=new Uint8Array(256);IsWhitespace[CharCodes_default.Null]=1;IsWhitespace[CharCodes_default.Tab]=1;IsWhitespace[CharCodes_default.Newline]=1;IsWhitespace[CharCodes_default.FormFeed]=1;IsWhitespace[CharCodes_default.CarriageReturn]=1;IsWhitespace[CharCodes_default.Space]=1;var IsIrregular=new Uint8Array(256);for(idx2=0,len=256;idx2<len;idx2++)IsIrregular[idx2]=IsWhitespace[idx2]||IsDelimiter[idx2]?1:0;var idx2,len;IsIrregular[CharCodes_default.Hash]=1;var decodeName=function(name){return name.replace(/#([\dABCDEF]{2})/g,function(_2,hex2){return charFromHexCode(hex2)})},isRegularChar=function(charCode){return charCode>=CharCodes_default.ExclamationPoint&&charCode<=CharCodes_default.Tilde&&!IsIrregular[charCode]},ENFORCER2={},pool=new Map,PDFName=function(_super){__extends(PDFName2,_super);function PDFName2(enforcer,name){var _this=this;if(enforcer!==ENFORCER2)throw new PrivateConstructorError("PDFName");_this=_super.call(this)||this;var encodedName="/";for(var idx3=0,len2=name.length;idx3<len2;idx3++){var character=name[idx3],code=toCharCode(character);encodedName+=isRegularChar(code)?character:"#"+toHexString(code)}return _this.encodedName=encodedName,_this}return PDFName2.prototype.asBytes=function(){var bytes=[],hex2="",escaped=!1,pushByte=function(byte3){if(byte3!==void 0)bytes.push(byte3);escaped=!1};for(var idx3=1,len2=this.encodedName.length;idx3<len2;idx3++){var char2=this.encodedName[idx3],byte2=toCharCode(char2),nextChar=this.encodedName[idx3+1];if(!escaped)if(byte2===CharCodes_default.Hash)escaped=!0;else pushByte(byte2);else if(byte2>=CharCodes_default.Zero&&byte2<=CharCodes_default.Nine||byte2>=CharCodes_default.a&&byte2<=CharCodes_default.f||byte2>=CharCodes_default.A&&byte2<=CharCodes_default.F){if(hex2+=char2,hex2.length===2||!(nextChar>="0"&&nextChar<="9"||nextChar>="a"&&nextChar<="f"||nextChar>="A"&&nextChar<="F"))pushByte(parseInt(hex2,16)),hex2=""}else pushByte(byte2)}return new Uint8Array(bytes)},PDFName2.prototype.decodeText=function(){var bytes=this.asBytes();return String.fromCharCode.apply(String,Array.from(bytes))},PDFName2.prototype.asString=function(){return this.encodedName},PDFName2.prototype.value=function(){return this.encodedName},PDFName2.prototype.clone=function(){return this},PDFName2.prototype.toString=function(){return this.encodedName},PDFName2.prototype.sizeInBytes=function(){return this.encodedName.length},PDFName2.prototype.copyBytesInto=function(buffer2,offset){return offset+=copyStringIntoBuffer(this.encodedName,buffer2,offset),this.encodedName.length},PDFName2.of=function(name){var decodedValue=decodeName(name),instance=pool.get(decodedValue);if(!instance)instance=new PDFName2(ENFORCER2,decodedValue),pool.set(decodedValue,instance);return instance},PDFName2.Length=PDFName2.of("Length"),PDFName2.FlateDecode=PDFName2.of("FlateDecode"),PDFName2.Resources=PDFName2.of("Resources"),PDFName2.Font=PDFName2.of("Font"),PDFName2.XObject=PDFName2.of("XObject"),PDFName2.ExtGState=PDFName2.of("ExtGState"),PDFName2.Contents=PDFName2.of("Contents"),PDFName2.Type=PDFName2.of("Type"),PDFName2.Parent=PDFName2.of("Parent"),PDFName2.MediaBox=PDFName2.of("MediaBox"),PDFName2.Page=PDFName2.of("Page"),PDFName2.Annots=PDFName2.of("Annots"),PDFName2.TrimBox=PDFName2.of("TrimBox"),PDFName2.ArtBox=PDFName2.of("ArtBox"),PDFName2.BleedBox=PDFName2.of("BleedBox"),PDFName2.CropBox=PDFName2.of("CropBox"),PDFName2.Rotate=PDFName2.of("Rotate"),PDFName2.Title=PDFName2.of("Title"),PDFName2.Author=PDFName2.of("Author"),PDFName2.Subject=PDFName2.of("Subject"),PDFName2.Creator=PDFName2.of("Creator"),PDFName2.Keywords=PDFName2.of("Keywords"),PDFName2.Producer=PDFName2.of("Producer"),PDFName2.CreationDate=PDFName2.of("CreationDate"),PDFName2.ModDate=PDFName2.of("ModDate"),PDFName2}(PDFObject_default),PDFName_default=PDFName;var PDFNull=function(_super){__extends(PDFNull2,_super);function PDFNull2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFNull2.prototype.asNull=function(){return null},PDFNull2.prototype.clone=function(){return this},PDFNull2.prototype.toString=function(){return"null"},PDFNull2.prototype.sizeInBytes=function(){return 4},PDFNull2.prototype.copyBytesInto=function(buffer2,offset){return buffer2[offset++]=CharCodes_default.n,buffer2[offset++]=CharCodes_default.u,buffer2[offset++]=CharCodes_default.l,buffer2[offset++]=CharCodes_default.l,4},PDFNull2}(PDFObject_default),PDFNull_default=new PDFNull;var PDFDict=function(_super){__extends(PDFDict2,_super);function PDFDict2(map3,context){var _this=_super.call(this)||this;return _this.dict=map3,_this.context=context,_this}return PDFDict2.prototype.keys=function(){return Array.from(this.dict.keys())},PDFDict2.prototype.values=function(){return Array.from(this.dict.values())},PDFDict2.prototype.entries=function(){return Array.from(this.dict.entries())},PDFDict2.prototype.set=function(key,value){this.dict.set(key,value)},PDFDict2.prototype.get=function(key,preservePDFNull){if(preservePDFNull===void 0)preservePDFNull=!1;var value=this.dict.get(key);if(value===PDFNull_default&&!preservePDFNull)return;return value},PDFDict2.prototype.has=function(key){var value=this.dict.get(key);return value!==void 0&&value!==PDFNull_default},PDFDict2.prototype.lookupMaybe=function(key){var _a,types3=[];for(var _i=1;_i<arguments.length;_i++)types3[_i-1]=arguments[_i];var preservePDFNull=types3.includes(PDFNull_default),value=(_a=this.context).lookupMaybe.apply(_a,__spreadArrays([this.get(key,preservePDFNull)],types3));if(value===PDFNull_default&&!preservePDFNull)return;return value},PDFDict2.prototype.lookup=function(key){var _a,types3=[];for(var _i=1;_i<arguments.length;_i++)types3[_i-1]=arguments[_i];var preservePDFNull=types3.includes(PDFNull_default),value=(_a=this.context).lookup.apply(_a,__spreadArrays([this.get(key,preservePDFNull)],types3));if(value===PDFNull_default&&!preservePDFNull)return;return value},PDFDict2.prototype.delete=function(key){return this.dict.delete(key)},PDFDict2.prototype.asMap=function(){return new Map(this.dict)},PDFDict2.prototype.uniqueKey=function(tag){if(tag===void 0)tag="";var existingKeys=this.keys(),key=PDFName_default.of(this.context.addRandomSuffix(tag,10));while(existingKeys.includes(key))key=PDFName_default.of(this.context.addRandomSuffix(tag,10));return key},PDFDict2.prototype.clone=function(context){var clone2=PDFDict2.withContext(context||this.context),entries=this.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];clone2.set(key,value)}return clone2},PDFDict2.prototype.toString=function(){var dictString=`<<
`,entries=this.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];dictString+=key.toString()+" "+value.toString()+`
`}return dictString+=">>",dictString},PDFDict2.prototype.sizeInBytes=function(){var size=5,entries=this.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];size+=key.sizeInBytes()+value.sizeInBytes()+2}return size},PDFDict2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;buffer2[offset++]=CharCodes_default.LessThan,buffer2[offset++]=CharCodes_default.LessThan,buffer2[offset++]=CharCodes_default.Newline;var entries=this.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];offset+=key.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Space,offset+=value.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline}return buffer2[offset++]=CharCodes_default.GreaterThan,buffer2[offset++]=CharCodes_default.GreaterThan,offset-initialOffset},PDFDict2.withContext=function(context){return new PDFDict2(new Map,context)},PDFDict2.fromMapWithContext=function(map3,context){return new PDFDict2(map3,context)},PDFDict2}(PDFObject_default),PDFDict_default=PDFDict;var PDFStream=function(_super){__extends(PDFStream2,_super);function PDFStream2(dict){var _this=_super.call(this)||this;return _this.dict=dict,_this}return PDFStream2.prototype.clone=function(_context){throw new MethodNotImplementedError(this.constructor.name,"clone")},PDFStream2.prototype.getContentsString=function(){throw new MethodNotImplementedError(this.constructor.name,"getContentsString")},PDFStream2.prototype.getContents=function(){throw new MethodNotImplementedError(this.constructor.name,"getContents")},PDFStream2.prototype.getContentsSize=function(){throw new MethodNotImplementedError(this.constructor.name,"getContentsSize")},PDFStream2.prototype.updateDict=function(){var contentsSize=this.getContentsSize();this.dict.set(PDFName_default.Length,PDFNumber_default.of(contentsSize))},PDFStream2.prototype.sizeInBytes=function(){return this.updateDict(),this.dict.sizeInBytes()+this.getContentsSize()+18},PDFStream2.prototype.toString=function(){this.updateDict();var streamString=this.dict.toString();return streamString+=`
stream
`,streamString+=this.getContentsString(),streamString+=`
endstream`,streamString},PDFStream2.prototype.copyBytesInto=function(buffer2,offset){this.updateDict();var initialOffset=offset;offset+=this.dict.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.s,buffer2[offset++]=CharCodes_default.t,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.a,buffer2[offset++]=CharCodes_default.m,buffer2[offset++]=CharCodes_default.Newline;var contents=this.getContents();for(var idx3=0,len2=contents.length;idx3<len2;idx3++)buffer2[offset++]=contents[idx3];return buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.n,buffer2[offset++]=CharCodes_default.d,buffer2[offset++]=CharCodes_default.s,buffer2[offset++]=CharCodes_default.t,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.a,buffer2[offset++]=CharCodes_default.m,offset-initialOffset},PDFStream2}(PDFObject_default),PDFStream_default=PDFStream;var PDFRawStream=function(_super){__extends(PDFRawStream2,_super);function PDFRawStream2(dict,contents){var _this=_super.call(this,dict)||this;return _this.contents=contents,_this}return PDFRawStream2.prototype.asUint8Array=function(){return this.contents.slice()},PDFRawStream2.prototype.clone=function(context){return PDFRawStream2.of(this.dict.clone(context),this.contents.slice())},PDFRawStream2.prototype.getContentsString=function(){return arrayAsString(this.contents)},PDFRawStream2.prototype.getContents=function(){return this.contents},PDFRawStream2.prototype.getContentsSize=function(){return this.contents.length},PDFRawStream2.of=function(dict,contents){return new PDFRawStream2(dict,contents)},PDFRawStream2}(PDFStream_default),PDFRawStream_default=PDFRawStream;var ENFORCER3={},pool2=new Map,PDFRef=function(_super){__extends(PDFRef2,_super);function PDFRef2(enforcer,objectNumber,generationNumber){var _this=this;if(enforcer!==ENFORCER3)throw new PrivateConstructorError("PDFRef");return _this=_super.call(this)||this,_this.objectNumber=objectNumber,_this.generationNumber=generationNumber,_this.tag=objectNumber+" "+generationNumber+" R",_this}return PDFRef2.prototype.clone=function(){return this},PDFRef2.prototype.toString=function(){return this.tag},PDFRef2.prototype.sizeInBytes=function(){return this.tag.length},PDFRef2.prototype.copyBytesInto=function(buffer2,offset){return offset+=copyStringIntoBuffer(this.tag,buffer2,offset),this.tag.length},PDFRef2.of=function(objectNumber,generationNumber){if(generationNumber===void 0)generationNumber=0;var tag=objectNumber+" "+generationNumber+" R",instance=pool2.get(tag);if(!instance)instance=new PDFRef2(ENFORCER3,objectNumber,generationNumber),pool2.set(tag,instance);return instance},PDFRef2}(PDFObject_default),PDFRef_default=PDFRef;var PDFOperator=function(){function PDFOperator2(name,args){this.name=name,this.args=args||[]}return PDFOperator2.prototype.clone=function(context){var args=new Array(this.args.length);for(var idx3=0,len2=args.length;idx3<len2;idx3++){var arg=this.args[idx3];args[idx3]=arg instanceof PDFObject_default?arg.clone(context):arg}return PDFOperator2.of(this.name,args)},PDFOperator2.prototype.toString=function(){var value="";for(var idx3=0,len2=this.args.length;idx3<len2;idx3++)value+=String(this.args[idx3])+" ";return value+=this.name,value},PDFOperator2.prototype.sizeInBytes=function(){var size=0;for(var idx3=0,len2=this.args.length;idx3<len2;idx3++){var arg=this.args[idx3];size+=(arg instanceof PDFObject_default?arg.sizeInBytes():arg.length)+1}return size+=this.name.length,size},PDFOperator2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;for(var idx3=0,len2=this.args.length;idx3<len2;idx3++){var arg=this.args[idx3];if(arg instanceof PDFObject_default)offset+=arg.copyBytesInto(buffer2,offset);else offset+=copyStringIntoBuffer(arg,buffer2,offset);buffer2[offset++]=CharCodes_default.Space}return offset+=copyStringIntoBuffer(this.name,buffer2,offset),offset-initialOffset},PDFOperator2.of=function(name,args){return new PDFOperator2(name,args)},PDFOperator2}(),PDFOperator_default=PDFOperator;var PDFOperatorNames;(function(PDFOperatorNames2){PDFOperatorNames2.NonStrokingColor="sc",PDFOperatorNames2.NonStrokingColorN="scn",PDFOperatorNames2.NonStrokingColorRgb="rg",PDFOperatorNames2.NonStrokingColorGray="g",PDFOperatorNames2.NonStrokingColorCmyk="k",PDFOperatorNames2.NonStrokingColorspace="cs",PDFOperatorNames2.StrokingColor="SC",PDFOperatorNames2.StrokingColorN="SCN",PDFOperatorNames2.StrokingColorRgb="RG",PDFOperatorNames2.StrokingColorGray="G",PDFOperatorNames2.StrokingColorCmyk="K",PDFOperatorNames2.StrokingColorspace="CS",PDFOperatorNames2.BeginMarkedContentSequence="BDC",PDFOperatorNames2.BeginMarkedContent="BMC",PDFOperatorNames2.EndMarkedContent="EMC",PDFOperatorNames2.MarkedContentPointWithProps="DP",PDFOperatorNames2.MarkedContentPoint="MP",PDFOperatorNames2.DrawObject="Do",PDFOperatorNames2.ConcatTransformationMatrix="cm",PDFOperatorNames2.PopGraphicsState="Q",PDFOperatorNames2.PushGraphicsState="q",PDFOperatorNames2.SetFlatness="i",PDFOperatorNames2.SetGraphicsStateParams="gs",PDFOperatorNames2.SetLineCapStyle="J",PDFOperatorNames2.SetLineDashPattern="d",PDFOperatorNames2.SetLineJoinStyle="j",PDFOperatorNames2.SetLineMiterLimit="M",PDFOperatorNames2.SetLineWidth="w",PDFOperatorNames2.SetTextMatrix="Tm",PDFOperatorNames2.SetRenderingIntent="ri",PDFOperatorNames2.AppendRectangle="re",PDFOperatorNames2.BeginInlineImage="BI",PDFOperatorNames2.BeginInlineImageData="ID",PDFOperatorNames2.EndInlineImage="EI",PDFOperatorNames2.ClipEvenOdd="W*",PDFOperatorNames2.ClipNonZero="W",PDFOperatorNames2.CloseAndStroke="s",PDFOperatorNames2.CloseFillEvenOddAndStroke="b*",PDFOperatorNames2.CloseFillNonZeroAndStroke="b",PDFOperatorNames2.ClosePath="h",PDFOperatorNames2.AppendBezierCurve="c",PDFOperatorNames2.CurveToReplicateFinalPoint="y",PDFOperatorNames2.CurveToReplicateInitialPoint="v",PDFOperatorNames2.EndPath="n",PDFOperatorNames2.FillEvenOddAndStroke="B*",PDFOperatorNames2.FillEvenOdd="f*",PDFOperatorNames2.FillNonZeroAndStroke="B",PDFOperatorNames2.FillNonZero="f",PDFOperatorNames2.LegacyFillNonZero="F",PDFOperatorNames2.LineTo="l",PDFOperatorNames2.MoveTo="m",PDFOperatorNames2.ShadingFill="sh",PDFOperatorNames2.StrokePath="S",PDFOperatorNames2.BeginText="BT",PDFOperatorNames2.EndText="ET",PDFOperatorNames2.MoveText="Td",PDFOperatorNames2.MoveTextSetLeading="TD",PDFOperatorNames2.NextLine="T*",PDFOperatorNames2.SetCharacterSpacing="Tc",PDFOperatorNames2.SetFontAndSize="Tf",PDFOperatorNames2.SetTextHorizontalScaling="Tz",PDFOperatorNames2.SetTextLineHeight="TL",PDFOperatorNames2.SetTextRenderingMode="Tr",PDFOperatorNames2.SetTextRise="Ts",PDFOperatorNames2.SetWordSpacing="Tw",PDFOperatorNames2.ShowText="Tj",PDFOperatorNames2.ShowTextAdjusted="TJ",PDFOperatorNames2.ShowTextLine="'",PDFOperatorNames2.ShowTextLineAndSpace='"',PDFOperatorNames2.Type3D0="d0",PDFOperatorNames2.Type3D1="d1",PDFOperatorNames2.BeginCompatibilitySection="BX",PDFOperatorNames2.EndCompatibilitySection="EX"})(PDFOperatorNames||(PDFOperatorNames={}));var PDFOperatorNames_default=PDFOperatorNames;var import_pako2=__toESM(require_pako(),1);var PDFFlateStream=function(_super){__extends(PDFFlateStream2,_super);function PDFFlateStream2(dict,encode3){var _this=_super.call(this,dict)||this;if(_this.computeContents=function(){var unencodedContents=_this.getUnencodedContents();return _this.encode?import_pako2.default.deflate(unencodedContents):unencodedContents},_this.encode=encode3,encode3)dict.set(PDFName_default.of("Filter"),PDFName_default.of("FlateDecode"));return _this.contentsCache=Cache_default.populatedBy(_this.computeContents),_this}return PDFFlateStream2.prototype.getContents=function(){return this.contentsCache.access()},PDFFlateStream2.prototype.getContentsSize=function(){return this.contentsCache.access().length},PDFFlateStream2.prototype.getUnencodedContents=function(){throw new MethodNotImplementedError(this.constructor.name,"getUnencodedContents")},PDFFlateStream2}(PDFStream_default),PDFFlateStream_default=PDFFlateStream;var PDFContentStream=function(_super){__extends(PDFContentStream2,_super);function PDFContentStream2(dict,operators,encode3){if(encode3===void 0)encode3=!0;var _this=_super.call(this,dict,encode3)||this;return _this.operators=operators,_this}return PDFContentStream2.prototype.push=function(){var _a,operators=[];for(var _i=0;_i<arguments.length;_i++)operators[_i]=arguments[_i];(_a=this.operators).push.apply(_a,operators)},PDFContentStream2.prototype.clone=function(context){var operators=new Array(this.operators.length);for(var idx3=0,len2=this.operators.length;idx3<len2;idx3++)operators[idx3]=this.operators[idx3].clone(context);var _a=this,dict=_a.dict,encode3=_a.encode;return PDFContentStream2.of(dict.clone(context),operators,encode3)},PDFContentStream2.prototype.getContentsString=function(){var value="";for(var idx3=0,len2=this.operators.length;idx3<len2;idx3++)value+=this.operators[idx3]+`
`;return value},PDFContentStream2.prototype.getUnencodedContents=function(){var buffer2=new Uint8Array(this.getUnencodedContentsSize()),offset=0;for(var idx3=0,len2=this.operators.length;idx3<len2;idx3++)offset+=this.operators[idx3].copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline;return buffer2},PDFContentStream2.prototype.getUnencodedContentsSize=function(){var size=0;for(var idx3=0,len2=this.operators.length;idx3<len2;idx3++)size+=this.operators[idx3].sizeInBytes()+1;return size},PDFContentStream2.of=function(dict,operators,encode3){if(encode3===void 0)encode3=!0;return new PDFContentStream2(dict,operators,encode3)},PDFContentStream2}(PDFFlateStream_default),PDFContentStream_default=PDFContentStream;var SimpleRNG=function(){function SimpleRNG2(seed){this.seed=seed}return SimpleRNG2.prototype.nextInt=function(){var x=Math.sin(this.seed++)*1e4;return x-Math.floor(x)},SimpleRNG2.withSeed=function(seed){return new SimpleRNG2(seed)},SimpleRNG2}();var byAscendingObjectNumber=function(_a,_b){var a=_a[0],b2=_b[0];return a.objectNumber-b2.objectNumber},PDFContext=function(){function PDFContext2(){this.largestObjectNumber=0,this.header=PDFHeader_default.forVersion(1,7),this.trailerInfo={},this.indirectObjects=new Map,this.rng=SimpleRNG.withSeed(1)}return PDFContext2.prototype.assign=function(ref,object){if(this.indirectObjects.set(ref,object),ref.objectNumber>this.largestObjectNumber)this.largestObjectNumber=ref.objectNumber},PDFContext2.prototype.nextRef=function(){return this.largestObjectNumber+=1,PDFRef_default.of(this.largestObjectNumber)},PDFContext2.prototype.register=function(object){var ref=this.nextRef();return this.assign(ref,object),ref},PDFContext2.prototype.delete=function(ref){return this.indirectObjects.delete(ref)},PDFContext2.prototype.lookupMaybe=function(ref){var types3=[];for(var _i=1;_i<arguments.length;_i++)types3[_i-1]=arguments[_i];var preservePDFNull=types3.includes(PDFNull_default),result=ref instanceof PDFRef_default?this.indirectObjects.get(ref):ref;if(!result||result===PDFNull_default&&!preservePDFNull)return;for(var idx3=0,len2=types3.length;idx3<len2;idx3++){var type2=types3[idx3];if(type2===PDFNull_default){if(result===PDFNull_default)return result}else if(result instanceof type2)return result}throw new UnexpectedObjectTypeError(types3,result)},PDFContext2.prototype.lookup=function(ref){var types3=[];for(var _i=1;_i<arguments.length;_i++)types3[_i-1]=arguments[_i];var result=ref instanceof PDFRef_default?this.indirectObjects.get(ref):ref;if(types3.length===0)return result;for(var idx3=0,len2=types3.length;idx3<len2;idx3++){var type2=types3[idx3];if(type2===PDFNull_default){if(result===PDFNull_default)return result}else if(result instanceof type2)return result}throw new UnexpectedObjectTypeError(types3,result)},PDFContext2.prototype.getObjectRef=function(pdfObject){var entries=Array.from(this.indirectObjects.entries());for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],ref=_a[0],object=_a[1];if(object===pdfObject)return ref}return},PDFContext2.prototype.enumerateIndirectObjects=function(){return Array.from(this.indirectObjects.entries()).sort(byAscendingObjectNumber)},PDFContext2.prototype.obj=function(literal){if(literal instanceof PDFObject_default)return literal;else if(literal===null||literal===void 0)return PDFNull_default;else if(typeof literal==="string")return PDFName_default.of(literal);else if(typeof literal==="number")return PDFNumber_default.of(literal);else if(typeof literal==="boolean")return literal?PDFBool_default.True:PDFBool_default.False;else if(Array.isArray(literal)){var array=PDFArray_default.withContext(this);for(var idx3=0,len2=literal.length;idx3<len2;idx3++)array.push(this.obj(literal[idx3]));return array}else{var dict=PDFDict_default.withContext(this),keys=Object.keys(literal);for(var idx3=0,len2=keys.length;idx3<len2;idx3++){var key=keys[idx3],value=literal[key];if(value!==void 0)dict.set(PDFName_default.of(key),this.obj(value))}return dict}},PDFContext2.prototype.stream=function(contents,dict){if(dict===void 0)dict={};return PDFRawStream_default.of(this.obj(dict),typedArrayFor(contents))},PDFContext2.prototype.flateStream=function(contents,dict){if(dict===void 0)dict={};return this.stream(import_pako3.default.deflate(typedArrayFor(contents)),__assign(__assign({},dict),{Filter:"FlateDecode"}))},PDFContext2.prototype.contentStream=function(operators,dict){if(dict===void 0)dict={};return PDFContentStream_default.of(this.obj(dict),operators)},PDFContext2.prototype.formXObject=function(operators,dict){if(dict===void 0)dict={};return this.contentStream(operators,__assign(__assign({BBox:this.obj([0,0,0,0]),Matrix:this.obj([1,0,0,1,0,0])},dict),{Type:"XObject",Subtype:"Form"}))},PDFContext2.prototype.getPushGraphicsStateContentStream=function(){if(this.pushGraphicsStateContentStreamRef)return this.pushGraphicsStateContentStreamRef;var dict=this.obj({}),op=PDFOperator_default.of(PDFOperatorNames_default.PushGraphicsState),stream=PDFContentStream_default.of(dict,[op]);return this.pushGraphicsStateContentStreamRef=this.register(stream),this.pushGraphicsStateContentStreamRef},PDFContext2.prototype.getPopGraphicsStateContentStream=function(){if(this.popGraphicsStateContentStreamRef)return this.popGraphicsStateContentStreamRef;var dict=this.obj({}),op=PDFOperator_default.of(PDFOperatorNames_default.PopGraphicsState),stream=PDFContentStream_default.of(dict,[op]);return this.popGraphicsStateContentStreamRef=this.register(stream),this.popGraphicsStateContentStreamRef},PDFContext2.prototype.addRandomSuffix=function(prefix,suffixLength){if(suffixLength===void 0)suffixLength=4;return prefix+"-"+Math.floor(this.rng.nextInt()*Math.pow(10,suffixLength))},PDFContext2.create=function(){return new PDFContext2},PDFContext2}(),PDFContext_default=PDFContext;var PDFPageLeaf=function(_super){__extends(PDFPageLeaf2,_super);function PDFPageLeaf2(map3,context,autoNormalizeCTM){if(autoNormalizeCTM===void 0)autoNormalizeCTM=!0;var _this=_super.call(this,map3,context)||this;return _this.normalized=!1,_this.autoNormalizeCTM=autoNormalizeCTM,_this}return PDFPageLeaf2.prototype.clone=function(context){var clone2=PDFPageLeaf2.fromMapWithContext(new Map,context||this.context,this.autoNormalizeCTM),entries=this.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];clone2.set(key,value)}return clone2},PDFPageLeaf2.prototype.Parent=function(){return this.lookupMaybe(PDFName_default.Parent,PDFDict_default)},PDFPageLeaf2.prototype.Contents=function(){return this.lookup(PDFName_default.of("Contents"))},PDFPageLeaf2.prototype.Annots=function(){return this.lookupMaybe(PDFName_default.Annots,PDFArray_default)},PDFPageLeaf2.prototype.BleedBox=function(){return this.lookupMaybe(PDFName_default.BleedBox,PDFArray_default)},PDFPageLeaf2.prototype.TrimBox=function(){return this.lookupMaybe(PDFName_default.TrimBox,PDFArray_default)},PDFPageLeaf2.prototype.ArtBox=function(){return this.lookupMaybe(PDFName_default.ArtBox,PDFArray_default)},PDFPageLeaf2.prototype.Resources=function(){var dictOrRef=this.getInheritableAttribute(PDFName_default.Resources);return this.context.lookupMaybe(dictOrRef,PDFDict_default)},PDFPageLeaf2.prototype.MediaBox=function(){var arrayOrRef=this.getInheritableAttribute(PDFName_default.MediaBox);return this.context.lookup(arrayOrRef,PDFArray_default)},PDFPageLeaf2.prototype.CropBox=function(){var arrayOrRef=this.getInheritableAttribute(PDFName_default.CropBox);return this.context.lookupMaybe(arrayOrRef,PDFArray_default)},PDFPageLeaf2.prototype.Rotate=function(){var numberOrRef=this.getInheritableAttribute(PDFName_default.Rotate);return this.context.lookupMaybe(numberOrRef,PDFNumber_default)},PDFPageLeaf2.prototype.getInheritableAttribute=function(name){var attribute;return this.ascend(function(node){if(!attribute)attribute=node.get(name)}),attribute},PDFPageLeaf2.prototype.setParent=function(parentRef){this.set(PDFName_default.Parent,parentRef)},PDFPageLeaf2.prototype.addContentStream=function(contentStreamRef){var Contents=this.normalizedEntries().Contents||this.context.obj([]);this.set(PDFName_default.Contents,Contents),Contents.push(contentStreamRef)},PDFPageLeaf2.prototype.wrapContentStreams=function(startStream,endStream){var Contents=this.Contents();if(Contents instanceof PDFArray_default)return Contents.insert(0,startStream),Contents.push(endStream),!0;return!1},PDFPageLeaf2.prototype.addAnnot=function(annotRef){var Annots=this.normalizedEntries().Annots;Annots.push(annotRef)},PDFPageLeaf2.prototype.removeAnnot=function(annotRef){var Annots=this.normalizedEntries().Annots,index2=Annots.indexOf(annotRef);if(index2!==void 0)Annots.remove(index2)},PDFPageLeaf2.prototype.setFontDictionary=function(name,fontDictRef){var Font3=this.normalizedEntries().Font;Font3.set(name,fontDictRef)},PDFPageLeaf2.prototype.newFontDictionaryKey=function(tag){var Font3=this.normalizedEntries().Font;return Font3.uniqueKey(tag)},PDFPageLeaf2.prototype.newFontDictionary=function(tag,fontDictRef){var key=this.newFontDictionaryKey(tag);return this.setFontDictionary(key,fontDictRef),key},PDFPageLeaf2.prototype.setXObject=function(name,xObjectRef){var XObject=this.normalizedEntries().XObject;XObject.set(name,xObjectRef)},PDFPageLeaf2.prototype.newXObjectKey=function(tag){var XObject=this.normalizedEntries().XObject;return XObject.uniqueKey(tag)},PDFPageLeaf2.prototype.newXObject=function(tag,xObjectRef){var key=this.newXObjectKey(tag);return this.setXObject(key,xObjectRef),key},PDFPageLeaf2.prototype.setExtGState=function(name,extGStateRef){var ExtGState=this.normalizedEntries().ExtGState;ExtGState.set(name,extGStateRef)},PDFPageLeaf2.prototype.newExtGStateKey=function(tag){var ExtGState=this.normalizedEntries().ExtGState;return ExtGState.uniqueKey(tag)},PDFPageLeaf2.prototype.newExtGState=function(tag,extGStateRef){var key=this.newExtGStateKey(tag);return this.setExtGState(key,extGStateRef),key},PDFPageLeaf2.prototype.ascend=function(visitor){visitor(this);var Parent=this.Parent();if(Parent)Parent.ascend(visitor)},PDFPageLeaf2.prototype.normalize=function(){if(this.normalized)return;var context=this.context,contentsRef=this.get(PDFName_default.Contents),contents=this.context.lookup(contentsRef);if(contents instanceof PDFStream_default)this.set(PDFName_default.Contents,context.obj([contentsRef]));if(this.autoNormalizeCTM)this.wrapContentStreams(this.context.getPushGraphicsStateContentStream(),this.context.getPopGraphicsStateContentStream());var dictOrRef=this.getInheritableAttribute(PDFName_default.Resources),Resources=context.lookupMaybe(dictOrRef,PDFDict_default)||context.obj({});this.set(PDFName_default.Resources,Resources);var Font3=Resources.lookupMaybe(PDFName_default.Font,PDFDict_default)||context.obj({});Resources.set(PDFName_default.Font,Font3);var XObject=Resources.lookupMaybe(PDFName_default.XObject,PDFDict_default)||context.obj({});Resources.set(PDFName_default.XObject,XObject);var ExtGState=Resources.lookupMaybe(PDFName_default.ExtGState,PDFDict_default)||context.obj({});Resources.set(PDFName_default.ExtGState,ExtGState);var Annots=this.Annots()||context.obj([]);this.set(PDFName_default.Annots,Annots),this.normalized=!0},PDFPageLeaf2.prototype.normalizedEntries=function(){this.normalize();var Annots=this.Annots(),Resources=this.Resources(),Contents=this.Contents();return{Annots,Resources,Contents,Font:Resources.lookup(PDFName_default.Font,PDFDict_default),XObject:Resources.lookup(PDFName_default.XObject,PDFDict_default),ExtGState:Resources.lookup(PDFName_default.ExtGState,PDFDict_default)}},PDFPageLeaf2.InheritableEntries=["Resources","MediaBox","CropBox","Rotate"],PDFPageLeaf2.withContextAndParent=function(context,parent){var dict=new Map;return dict.set(PDFName_default.Type,PDFName_default.Page),dict.set(PDFName_default.Parent,parent),dict.set(PDFName_default.Resources,context.obj({})),dict.set(PDFName_default.MediaBox,context.obj([0,0,612,792])),new PDFPageLeaf2(dict,context,!1)},PDFPageLeaf2.fromMapWithContext=function(map3,context,autoNormalizeCTM){if(autoNormalizeCTM===void 0)autoNormalizeCTM=!0;return new PDFPageLeaf2(map3,context,autoNormalizeCTM)},PDFPageLeaf2}(PDFDict_default),PDFPageLeaf_default=PDFPageLeaf;var PDFObjectCopier=function(){function PDFObjectCopier2(src,dest){var _this=this;this.traversedObjects=new Map,this.copy=function(object){return object instanceof PDFPageLeaf_default?_this.copyPDFPage(object):object instanceof PDFDict_default?_this.copyPDFDict(object):object instanceof PDFArray_default?_this.copyPDFArray(object):object instanceof PDFStream_default?_this.copyPDFStream(object):object instanceof PDFRef_default?_this.copyPDFIndirectObject(object):object.clone()},this.copyPDFPage=function(originalPage){var clonedPage=originalPage.clone(),InheritableEntries=PDFPageLeaf_default.InheritableEntries;for(var idx3=0,len2=InheritableEntries.length;idx3<len2;idx3++){var key=PDFName_default.of(InheritableEntries[idx3]),value=clonedPage.getInheritableAttribute(key);if(!clonedPage.get(key)&&value)clonedPage.set(key,value)}return clonedPage.delete(PDFName_default.of("Parent")),_this.copyPDFDict(clonedPage)},this.copyPDFDict=function(originalDict){if(_this.traversedObjects.has(originalDict))return _this.traversedObjects.get(originalDict);var clonedDict=originalDict.clone(_this.dest);_this.traversedObjects.set(originalDict,clonedDict);var entries=originalDict.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];clonedDict.set(key,_this.copy(value))}return clonedDict},this.copyPDFArray=function(originalArray){if(_this.traversedObjects.has(originalArray))return _this.traversedObjects.get(originalArray);var clonedArray=originalArray.clone(_this.dest);_this.traversedObjects.set(originalArray,clonedArray);for(var idx3=0,len2=originalArray.size();idx3<len2;idx3++){var value=originalArray.get(idx3);clonedArray.set(idx3,_this.copy(value))}return clonedArray},this.copyPDFStream=function(originalStream){if(_this.traversedObjects.has(originalStream))return _this.traversedObjects.get(originalStream);var clonedStream=originalStream.clone(_this.dest);_this.traversedObjects.set(originalStream,clonedStream);var entries=originalStream.dict.entries();for(var idx3=0,len2=entries.length;idx3<len2;idx3++){var _a=entries[idx3],key=_a[0],value=_a[1];clonedStream.dict.set(key,_this.copy(value))}return clonedStream},this.copyPDFIndirectObject=function(ref){var alreadyMapped=_this.traversedObjects.has(ref);if(!alreadyMapped){var newRef=_this.dest.nextRef();_this.traversedObjects.set(ref,newRef);var dereferencedValue=_this.src.lookup(ref);if(dereferencedValue){var cloned=_this.copy(dereferencedValue);_this.dest.assign(newRef,cloned)}}return _this.traversedObjects.get(ref)},this.src=src,this.dest=dest}return PDFObjectCopier2.for=function(src,dest){return new PDFObjectCopier2(src,dest)},PDFObjectCopier2}(),PDFObjectCopier_default=PDFObjectCopier;var PDFCrossRefSection=function(){function PDFCrossRefSection2(firstEntry){this.subsections=firstEntry?[[firstEntry]]:[],this.chunkIdx=0,this.chunkLength=firstEntry?1:0}return PDFCrossRefSection2.prototype.addEntry=function(ref,offset){this.append({ref,offset,deleted:!1})},PDFCrossRefSection2.prototype.addDeletedEntry=function(ref,nextFreeObjectNumber){this.append({ref,offset:nextFreeObjectNumber,deleted:!0})},PDFCrossRefSection2.prototype.toString=function(){var section=`xref
`;for(var rangeIdx=0,rangeLen=this.subsections.length;rangeIdx<rangeLen;rangeIdx++){var range2=this.subsections[rangeIdx];section+=range2[0].ref.objectNumber+" "+range2.length+`
`;for(var entryIdx=0,entryLen=range2.length;entryIdx<entryLen;entryIdx++){var entry=range2[entryIdx];section+=padStart(String(entry.offset),10,"0"),section+=" ",section+=padStart(String(entry.ref.generationNumber),5,"0"),section+=" ",section+=entry.deleted?"f":"n",section+=` 
`}}return section},PDFCrossRefSection2.prototype.sizeInBytes=function(){var size=5;for(var idx3=0,len2=this.subsections.length;idx3<len2;idx3++){var subsection=this.subsections[idx3],subsectionLength=subsection.length,firstEntry=subsection[0];size+=2,size+=String(firstEntry.ref.objectNumber).length,size+=String(subsectionLength).length,size+=20*subsectionLength}return size},PDFCrossRefSection2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;return buffer2[offset++]=CharCodes_default.x,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.f,buffer2[offset++]=CharCodes_default.Newline,offset+=this.copySubsectionsIntoBuffer(this.subsections,buffer2,offset),offset-initialOffset},PDFCrossRefSection2.prototype.copySubsectionsIntoBuffer=function(subsections,buffer2,offset){var initialOffset=offset,length=subsections.length;for(var idx3=0;idx3<length;idx3++){var subsection=this.subsections[idx3],firstObjectNumber=String(subsection[0].ref.objectNumber);offset+=copyStringIntoBuffer(firstObjectNumber,buffer2,offset),buffer2[offset++]=CharCodes_default.Space;var rangeLength=String(subsection.length);offset+=copyStringIntoBuffer(rangeLength,buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,offset+=this.copyEntriesIntoBuffer(subsection,buffer2,offset)}return offset-initialOffset},PDFCrossRefSection2.prototype.copyEntriesIntoBuffer=function(entries,buffer2,offset){var length=entries.length;for(var idx3=0;idx3<length;idx3++){var entry=entries[idx3],entryOffset=padStart(String(entry.offset),10,"0");offset+=copyStringIntoBuffer(entryOffset,buffer2,offset),buffer2[offset++]=CharCodes_default.Space;var entryGen=padStart(String(entry.ref.generationNumber),5,"0");offset+=copyStringIntoBuffer(entryGen,buffer2,offset),buffer2[offset++]=CharCodes_default.Space,buffer2[offset++]=entry.deleted?CharCodes_default.f:CharCodes_default.n,buffer2[offset++]=CharCodes_default.Space,buffer2[offset++]=CharCodes_default.Newline}return 20*length},PDFCrossRefSection2.prototype.append=function(currEntry){if(this.chunkLength===0){this.subsections.push([currEntry]),this.chunkIdx=0,this.chunkLength=1;return}var chunk=this.subsections[this.chunkIdx],prevEntry=chunk[this.chunkLength-1];if(currEntry.ref.objectNumber-prevEntry.ref.objectNumber>1)this.subsections.push([currEntry]),this.chunkIdx+=1,this.chunkLength=1;else chunk.push(currEntry),this.chunkLength+=1},PDFCrossRefSection2.create=function(){return new PDFCrossRefSection2({ref:PDFRef_default.of(0,65535),offset:0,deleted:!0})},PDFCrossRefSection2.createEmpty=function(){return new PDFCrossRefSection2},PDFCrossRefSection2}(),PDFCrossRefSection_default=PDFCrossRefSection;var PDFTrailer=function(){function PDFTrailer2(lastXRefOffset){this.lastXRefOffset=String(lastXRefOffset)}return PDFTrailer2.prototype.toString=function(){return`startxref
`+this.lastXRefOffset+`
%%EOF`},PDFTrailer2.prototype.sizeInBytes=function(){return 16+this.lastXRefOffset.length},PDFTrailer2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;return buffer2[offset++]=CharCodes_default.s,buffer2[offset++]=CharCodes_default.t,buffer2[offset++]=CharCodes_default.a,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.t,buffer2[offset++]=CharCodes_default.x,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.f,buffer2[offset++]=CharCodes_default.Newline,offset+=copyStringIntoBuffer(this.lastXRefOffset,buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.Percent,buffer2[offset++]=CharCodes_default.Percent,buffer2[offset++]=CharCodes_default.E,buffer2[offset++]=CharCodes_default.O,buffer2[offset++]=CharCodes_default.F,offset-initialOffset},PDFTrailer2.forLastCrossRefSectionOffset=function(offset){return new PDFTrailer2(offset)},PDFTrailer2}(),PDFTrailer_default=PDFTrailer;var PDFTrailerDict=function(){function PDFTrailerDict2(dict){this.dict=dict}return PDFTrailerDict2.prototype.toString=function(){return`trailer
`+this.dict.toString()},PDFTrailerDict2.prototype.sizeInBytes=function(){return 8+this.dict.sizeInBytes()},PDFTrailerDict2.prototype.copyBytesInto=function(buffer2,offset){var initialOffset=offset;return buffer2[offset++]=CharCodes_default.t,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.a,buffer2[offset++]=CharCodes_default.i,buffer2[offset++]=CharCodes_default.l,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.r,buffer2[offset++]=CharCodes_default.Newline,offset+=this.dict.copyBytesInto(buffer2,offset),offset-initialOffset},PDFTrailerDict2.of=function(dict){return new PDFTrailerDict2(dict)},PDFTrailerDict2}(),PDFTrailerDict_default=PDFTrailerDict;var PDFObjectStream=function(_super){__extends(PDFObjectStream2,_super);function PDFObjectStream2(context,objects2,encode3){if(encode3===void 0)encode3=!0;var _this=_super.call(this,context.obj({}),encode3)||this;return _this.objects=objects2,_this.offsets=_this.computeObjectOffsets(),_this.offsetsString=_this.computeOffsetsString(),_this.dict.set(PDFName_default.of("Type"),PDFName_default.of("ObjStm")),_this.dict.set(PDFName_default.of("N"),PDFNumber_default.of(_this.objects.length)),_this.dict.set(PDFName_default.of("First"),PDFNumber_default.of(_this.offsetsString.length)),_this}return PDFObjectStream2.prototype.getObjectsCount=function(){return this.objects.length},PDFObjectStream2.prototype.clone=function(context){return PDFObjectStream2.withContextAndObjects(context||this.dict.context,this.objects.slice(),this.encode)},PDFObjectStream2.prototype.getContentsString=function(){var value=this.offsetsString;for(var idx3=0,len2=this.objects.length;idx3<len2;idx3++){var _a=this.objects[idx3],object=_a[1];value+=object+`
`}return value},PDFObjectStream2.prototype.getUnencodedContents=function(){var buffer2=new Uint8Array(this.getUnencodedContentsSize()),offset=copyStringIntoBuffer(this.offsetsString,buffer2,0);for(var idx3=0,len2=this.objects.length;idx3<len2;idx3++){var _a=this.objects[idx3],object=_a[1];offset+=object.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline}return buffer2},PDFObjectStream2.prototype.getUnencodedContentsSize=function(){return this.offsetsString.length+last(this.offsets)[1]+last(this.objects)[1].sizeInBytes()+1},PDFObjectStream2.prototype.computeOffsetsString=function(){var offsetsString="";for(var idx3=0,len2=this.offsets.length;idx3<len2;idx3++){var _a=this.offsets[idx3],objectNumber=_a[0],offset=_a[1];offsetsString+=objectNumber+" "+offset+" "}return offsetsString},PDFObjectStream2.prototype.computeObjectOffsets=function(){var offset=0,offsets=new Array(this.objects.length);for(var idx3=0,len2=this.objects.length;idx3<len2;idx3++){var _a=this.objects[idx3],ref=_a[0],object=_a[1];offsets[idx3]=[ref.objectNumber,offset],offset+=object.sizeInBytes()+1}return offsets},PDFObjectStream2.withContextAndObjects=function(context,objects2,encode3){if(encode3===void 0)encode3=!0;return new PDFObjectStream2(context,objects2,encode3)},PDFObjectStream2}(PDFFlateStream_default),PDFObjectStream_default=PDFObjectStream;var PDFWriter=function(){function PDFWriter2(context,objectsPerTick){var _this=this;this.parsedObjects=0,this.shouldWaitForTick=function(n){return _this.parsedObjects+=n,_this.parsedObjects%_this.objectsPerTick===0},this.context=context,this.objectsPerTick=objectsPerTick}return PDFWriter2.prototype.serializeToBuffer=function(){return __awaiter(this,void 0,void 0,function(){var _a,size,header,indirectObjects,xref,trailerDict,trailer,offset,buffer2,idx3,len2,_b,ref,object,objectNumber,generationNumber,n;return __generator(this,function(_c){switch(_c.label){case 0:return[4,this.computeBufferSize()];case 1:_a=_c.sent(),size=_a.size,header=_a.header,indirectObjects=_a.indirectObjects,xref=_a.xref,trailerDict=_a.trailerDict,trailer=_a.trailer,offset=0,buffer2=new Uint8Array(size),offset+=header.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.Newline,idx3=0,len2=indirectObjects.length,_c.label=2;case 2:if(!(idx3<len2))return[3,5];if(_b=indirectObjects[idx3],ref=_b[0],object=_b[1],objectNumber=String(ref.objectNumber),offset+=copyStringIntoBuffer(objectNumber,buffer2,offset),buffer2[offset++]=CharCodes_default.Space,generationNumber=String(ref.generationNumber),offset+=copyStringIntoBuffer(generationNumber,buffer2,offset),buffer2[offset++]=CharCodes_default.Space,buffer2[offset++]=CharCodes_default.o,buffer2[offset++]=CharCodes_default.b,buffer2[offset++]=CharCodes_default.j,buffer2[offset++]=CharCodes_default.Newline,offset+=object.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.e,buffer2[offset++]=CharCodes_default.n,buffer2[offset++]=CharCodes_default.d,buffer2[offset++]=CharCodes_default.o,buffer2[offset++]=CharCodes_default.b,buffer2[offset++]=CharCodes_default.j,buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.Newline,n=object instanceof PDFObjectStream_default?object.getObjectsCount():1,!this.shouldWaitForTick(n))return[3,4];return[4,waitForTick()];case 3:_c.sent(),_c.label=4;case 4:return idx3++,[3,2];case 5:if(xref)offset+=xref.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline;if(trailerDict)offset+=trailerDict.copyBytesInto(buffer2,offset),buffer2[offset++]=CharCodes_default.Newline,buffer2[offset++]=CharCodes_default.Newline;return offset+=trailer.copyBytesInto(buffer2,offset),[2,buffer2]}})})},PDFWriter2.prototype.computeIndirectObjectSize=function(_a){var ref=_a[0],object=_a[1],refSize=ref.sizeInBytes()+3,objectSize=object.sizeInBytes()+9;return refSize+objectSize},PDFWriter2.prototype.createTrailerDict=function(){return this.context.obj({Size:this.context.largestObjectNumber+1,Root:this.context.trailerInfo.Root,Encrypt:this.context.trailerInfo.Encrypt,Info:this.context.trailerInfo.Info,ID:this.context.trailerInfo.ID})},PDFWriter2.prototype.computeBufferSize=function(){return __awaiter(this,void 0,void 0,function(){var header,size,xref,indirectObjects,idx3,len2,indirectObject,ref,xrefOffset,trailerDict,trailer;return __generator(this,function(_a){switch(_a.label){case 0:header=PDFHeader_default.forVersion(1,7),size=header.sizeInBytes()+2,xref=PDFCrossRefSection_default.create(),indirectObjects=this.context.enumerateIndirectObjects(),idx3=0,len2=indirectObjects.length,_a.label=1;case 1:if(!(idx3<len2))return[3,4];if(indirectObject=indirectObjects[idx3],ref=indirectObject[0],xref.addEntry(ref,size),size+=this.computeIndirectObjectSize(indirectObject),!this.shouldWaitForTick(1))return[3,3];return[4,waitForTick()];case 2:_a.sent(),_a.label=3;case 3:return idx3++,[3,1];case 4:return xrefOffset=size,size+=xref.sizeInBytes()+1,trailerDict=PDFTrailerDict_default.of(this.createTrailerDict()),size+=trailerDict.sizeInBytes()+2,trailer=PDFTrailer_default.forLastCrossRefSectionOffset(xrefOffset),size+=trailer.sizeInBytes(),[2,{size,header,indirectObjects,xref,trailerDict,trailer}]}})})},PDFWriter2.forContext=function(context,objectsPerTick){return new PDFWriter2(context,objectsPerTick)},PDFWriter2}(),PDFWriter_default=PDFWriter;var PDFInvalidObject=function(_super){__extends(PDFInvalidObject2,_super);function PDFInvalidObject2(data){var _this=_super.call(this)||this;return _this.data=data,_this}return PDFInvalidObject2.prototype.clone=function(){return PDFInvalidObject2.of(this.data.slice())},PDFInvalidObject2.prototype.toString=function(){return"PDFInvalidObject("+this.data.length+" bytes)"},PDFInvalidObject2.prototype.sizeInBytes=function(){return this.data.length},PDFInvalidObject2.prototype.copyBytesInto=function(buffer2,offset){var length=this.data.length;for(var idx3=0;idx3<length;idx3++)buffer2[offset++]=this.data[idx3];return length},PDFInvalidObject2.of=function(data){return new PDFInvalidObject2(data)},PDFInvalidObject2}(PDFObject_default),PDFInvalidObject_default=PDFInvalidObject;var EntryType;(function(EntryType2){EntryType2[EntryType2.Deleted=0]="Deleted",EntryType2[EntryType2.Uncompressed=1]="Uncompressed",EntryType2[EntryType2.Compressed=2]="Compressed"})(EntryType||(EntryType={}));var PDFCrossRefStream=function(_super){__extends(PDFCrossRefStream2,_super);function PDFCrossRefStream2(dict,entries,encode3){if(encode3===void 0)encode3=!0;var _this=_super.call(this,dict,encode3)||this;return _this.computeIndex=function(){var subsections=[],subsectionLength=0;for(var idx3=0,len2=_this.entries.length;idx3<len2;idx3++){var currEntry=_this.entries[idx3],prevEntry=_this.entries[idx3-1];if(idx3===0)subsections.push(currEntry.ref.objectNumber);else if(currEntry.ref.objectNumber-prevEntry.ref.objectNumber>1)subsections.push(subsectionLength),subsections.push(currEntry.ref.objectNumber),subsectionLength=0;subsectionLength+=1}return subsections.push(subsectionLength),subsections},_this.computeEntryTuples=function(){var entryTuples=new Array(_this.entries.length);for(var idx3=0,len2=_this.entries.length;idx3<len2;idx3++){var entry=_this.entries[idx3];if(entry.type===EntryType.Deleted){var{type:type2,nextFreeObjectNumber,ref}=entry;entryTuples[idx3]=[type2,nextFreeObjectNumber,ref.generationNumber]}if(entry.type===EntryType.Uncompressed){var{type:type2,offset,ref}=entry;entryTuples[idx3]=[type2,offset,ref.generationNumber]}if(entry.type===EntryType.Compressed){var{type:type2,objectStreamRef,index:index2}=entry;entryTuples[idx3]=[type2,objectStreamRef.objectNumber,index2]}}return entryTuples},_this.computeMaxEntryByteWidths=function(){var entryTuples=_this.entryTuplesCache.access(),widths=[0,0,0];for(var idx3=0,len2=entryTuples.length;idx3<len2;idx3++){var _a=entryTuples[idx3],first=_a[0],second=_a[1],third=_a[2],firstSize=sizeInBytes(first),secondSize=sizeInBytes(second),thirdSize=sizeInBytes(third);if(firstSize>widths[0])widths[0]=firstSize;if(secondSize>widths[1])widths[1]=secondSize;if(thirdSize>widths[2])widths[2]=thirdSize}return widths},_this.entries=entries||[],_this.entryTuplesCache=Cache_default.populatedBy(_this.computeEntryTuples),_this.maxByteWidthsCache=Cache_default.populatedBy(_this.computeMaxEntryByteWidths),_this.indexCache=Cache_default.populatedBy(_this.computeIndex),dict.set(PDFName_default.of("Type"),PDFName_default.of("XRef")),_this}return PDFCrossRefStream2.prototype.addDeletedEntry=function(ref,nextFreeObjectNumber){var type2=EntryType.Deleted;this.entries.push({type:type2,ref,nextFreeObjectNumber}),this.entryTuplesCache.invalidate(),this.maxByteWidthsCache.invalidate(),this.indexCache.invalidate(),this.contentsCache.invalidate()},PDFCrossRefStream2.prototype.addUncompressedEntry=function(ref,offset){var type2=EntryType.Uncompressed;this.entries.push({type:type2,ref,offset}),this.entryTuplesCache.invalidate(),this.maxByteWidthsCache.invalidate(),this.indexCache.invalidate(),this.contentsCache.invalidate()},PDFCrossRefStream2.prototype.addCompressedEntry=function(ref,objectStreamRef,index2){var type2=EntryType.Compressed;this.entries.push({type:type2,ref,objectStreamRef,index:index2}),this.entryTuplesCache.invalidate(),this.maxByteWidthsCache.invalidate(),this.indexCache.invalidate(),this.contentsCache.invalidate()},PDFCrossRefStream2.prototype.clone=function(context){var _a=this,dict=_a.dict,entries=_a.entries,encode3=_a.encode;return PDFCrossRefStream2.of(dict.clone(context),entries.slice(),encode3)},PDFCrossRefStream2.prototype.getContentsString=function(){var entryTuples=this.entryTuplesCache.access(),byteWidths=this.maxByteWidthsCache.access(),value="";for(var entryIdx=0,entriesLen=entryTuples.length;entryIdx<entriesLen;entryIdx++){var _a=entryTuples[entryIdx],first=_a[0],second=_a[1],third=_a[2],firstBytes=reverseArray(bytesFor(first)),secondBytes=reverseArray(bytesFor(second)),thirdBytes=reverseArray(bytesFor(third));for(var idx3=byteWidths[0]-1;idx3>=0;idx3--)value+=(firstBytes[idx3]||0).toString(2);for(var idx3=byteWidths[1]-1;idx3>=0;idx3--)value+=(secondBytes[idx3]||0).toString(2);for(var idx3=byteWidths[2]-1;idx3>=0;idx3--)value+=(thirdBytes[idx3]||0).toString(2)}return value},PDFCrossRefStream2.prototype.getUnencodedContents=function(){var entryTuples=this.entryTuplesCache.access(),byteWidths=this.maxByteWidthsCache.access(),buffer2=new Uint8Array(this.getUnencodedContentsSize()),offset=0;for(var entryIdx=0,entriesLen=entryTuples.length;entryIdx<entriesLen;entryIdx++){var _a=entryTuples[entryIdx],first=_a[0],second=_a[1],third=_a[2],firstBytes=reverseArray(bytesFor(first)),secondBytes=reverseArray(bytesFor(second)),thirdBytes=reverseArray(bytesFor(third));for(var idx3=byteWidths[0]-1;idx3>=0;idx3--)buffer2[offset++]=firstBytes[idx3]||0;for(var idx3=byteWidths[1]-1;idx3>=0;idx3--)buffer2[offset++]=secondBytes[idx3]||0;for(var idx3=byteWidths[2]-1;idx3>=0;idx3--)buffer2[offset++]=thirdBytes[idx3]||0}return buffer2},PDFCrossRefStream2.prototype.getUnencodedContentsSize=function(){var byteWidths=this.maxByteWidthsCache.access(),entryWidth=sum(byteWidths);return entryWidth*this.entries.length},PDFCrossRefStream2.prototype.updateDict=function(){_super.prototype.updateDict.call(this);var byteWidths=this.maxByteWidthsCache.access(),index2=this.indexCache.access(),context=this.dict.context;this.dict.set(PDFName_default.of("W"),context.obj(byteWidths)),this.dict.set(PDFName_default.of("Index"),context.obj(index2))},PDFCrossRefStream2.create=function(dict,encode3){if(encode3===void 0)encode3=!0;var stream=new PDFCrossRefStream2(dict,[],encode3);return stream.addDeletedEntry(PDFRef_default.of(0,65535),0),stream},PDFCrossRefStream2.of=function(dict,entries,encode3){if(encode3===void 0)encode3=!0;return new PDFCrossRefStream2(dict,entries,encode3)},PDFCrossRefStream2}(PDFFlateStream_default),PDFCrossRefStream_default=PDFCrossRefStream;var PDFStreamWriter=function(_super){__extends(PDFStreamWriter2,_super);function PDFStreamWriter2(context,objectsPerTick,encodeStreams,objectsPerStream){var _this=_super.call(this,context,objectsPerTick)||this;return _this.encodeStreams=encodeStreams,_this.objectsPerStream=objectsPerStream,_this}return PDFStreamWriter2.prototype.computeBufferSize=function(){return __awaiter(this,void 0,void 0,function(){var objectNumber,header,size,xrefStream,uncompressedObjects,compressedObjects,objectStreamRefs,indirectObjects,idx3,len2,indirectObject,ref,object,shouldNotCompress,chunk,objectStreamRef,idx3,len2,chunk,ref,objectStream,xrefStreamRef,xrefOffset,trailer;return __generator(this,function(_a){switch(_a.label){case 0:objectNumber=this.context.largestObjectNumber+1,header=PDFHeader_default.forVersion(1,7),size=header.sizeInBytes()+2,xrefStream=PDFCrossRefStream_default.create(this.createTrailerDict(),this.encodeStreams),uncompressedObjects=[],compressedObjects=[],objectStreamRefs=[],indirectObjects=this.context.enumerateIndirectObjects(),idx3=0,len2=indirectObjects.length,_a.label=1;case 1:if(!(idx3<len2))return[3,6];if(indirectObject=indirectObjects[idx3],ref=indirectObject[0],object=indirectObject[1],shouldNotCompress=ref===this.context.trailerInfo.Encrypt||object instanceof PDFStream_default||object instanceof PDFInvalidObject_default||ref.generationNumber!==0,!shouldNotCompress)return[3,4];if(uncompressedObjects.push(indirectObject),xrefStream.addUncompressedEntry(ref,size),size+=this.computeIndirectObjectSize(indirectObject),!this.shouldWaitForTick(1))return[3,3];return[4,waitForTick()];case 2:_a.sent(),_a.label=3;case 3:return[3,5];case 4:if(chunk=last(compressedObjects),objectStreamRef=last(objectStreamRefs),!chunk||chunk.length%this.objectsPerStream===0)chunk=[],compressedObjects.push(chunk),objectStreamRef=PDFRef_default.of(objectNumber++),objectStreamRefs.push(objectStreamRef);xrefStream.addCompressedEntry(ref,objectStreamRef,chunk.length),chunk.push(indirectObject),_a.label=5;case 5:return idx3++,[3,1];case 6:idx3=0,len2=compressedObjects.length,_a.label=7;case 7:if(!(idx3<len2))return[3,10];if(chunk=compressedObjects[idx3],ref=objectStreamRefs[idx3],objectStream=PDFObjectStream_default.withContextAndObjects(this.context,chunk,this.encodeStreams),xrefStream.addUncompressedEntry(ref,size),size+=this.computeIndirectObjectSize([ref,objectStream]),uncompressedObjects.push([ref,objectStream]),!this.shouldWaitForTick(chunk.length))return[3,9];return[4,waitForTick()];case 8:_a.sent(),_a.label=9;case 9:return idx3++,[3,7];case 10:return xrefStreamRef=PDFRef_default.of(objectNumber++),xrefStream.dict.set(PDFName_default.of("Size"),PDFNumber_default.of(objectNumber)),xrefStream.addUncompressedEntry(xrefStreamRef,size),xrefOffset=size,size+=this.computeIndirectObjectSize([xrefStreamRef,xrefStream]),uncompressedObjects.push([xrefStreamRef,xrefStream]),trailer=PDFTrailer_default.forLastCrossRefSectionOffset(xrefOffset),size+=trailer.sizeInBytes(),[2,{size,header,indirectObjects:uncompressedObjects,trailer}]}})})},PDFStreamWriter2.forContext=function(context,objectsPerTick,encodeStreams,objectsPerStream){if(encodeStreams===void 0)encodeStreams=!0;if(objectsPerStream===void 0)objectsPerStream=50;return new PDFStreamWriter2(context,objectsPerTick,encodeStreams,objectsPerStream)},PDFStreamWriter2}(PDFWriter_default),PDFStreamWriter_default=PDFStreamWriter;var PDFHexString=function(_super){__extends(PDFHexString2,_super);function PDFHexString2(value){var _this=_super.call(this)||this;return _this.value=value,_this}return PDFHexString2.prototype.asBytes=function(){var hex2=this.value+(this.value.length%2===1?"0":""),hexLength=hex2.length,bytes=new Uint8Array(hex2.length/2),hexOffset=0,bytesOffset=0;while(hexOffset<hexLength){var byte2=parseInt(hex2.substring(hexOffset,hexOffset+2),16);bytes[bytesOffset]=byte2,hexOffset+=2,bytesOffset+=1}return bytes},PDFHexString2.prototype.decodeText=function(){var bytes=this.asBytes();if(hasUtf16BOM(bytes))return utf16Decode(bytes);return pdfDocEncodingDecode(bytes)},PDFHexString2.prototype.decodeDate=function(){var text2=this.decodeText(),date3=parseDate(text2);if(!date3)throw new InvalidPDFDateStringError(text2);return date3},PDFHexString2.prototype.asString=function(){return this.value},PDFHexString2.prototype.clone=function(){return PDFHexString2.of(this.value)},PDFHexString2.prototype.toString=function(){return"<"+this.value+">"},PDFHexString2.prototype.sizeInBytes=function(){return this.value.length+2},PDFHexString2.prototype.copyBytesInto=function(buffer2,offset){return buffer2[offset++]=CharCodes_default.LessThan,offset+=copyStringIntoBuffer(this.value,buffer2,offset),buffer2[offset++]=CharCodes_default.GreaterThan,this.value.length+2},PDFHexString2.of=function(value){return new PDFHexString2(value)},PDFHexString2.fromText=function(value){var encoded=utf16Encode(value),hex2="";for(var idx3=0,len2=encoded.length;idx3<len2;idx3++)hex2+=toHexStringOfMinLength(encoded[idx3],4);return new PDFHexString2(hex2)},PDFHexString2}(PDFObject_default),PDFHexString_default=PDFHexString;var StandardFontEmbedder=function(){function StandardFontEmbedder2(fontName,customName){this.encoding=fontName===FontNames.ZapfDingbats?Encodings.ZapfDingbats:fontName===FontNames.Symbol?Encodings.Symbol:Encodings.WinAnsi,this.font=Font.load(fontName),this.fontName=this.font.FontName,this.customName=customName}return StandardFontEmbedder2.prototype.encodeText=function(text2){var glyphs=this.encodeTextAsGlyphs(text2),hexCodes=new Array(glyphs.length);for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++)hexCodes[idx3]=toHexString(glyphs[idx3].code);return PDFHexString_default.of(hexCodes.join(""))},StandardFontEmbedder2.prototype.widthOfTextAtSize=function(text2,size){var glyphs=this.encodeTextAsGlyphs(text2),totalWidth=0;for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++){var left=glyphs[idx3].name,right=(glyphs[idx3+1]||{}).name,kernAmount=this.font.getXAxisKerningForPair(left,right)||0;totalWidth+=this.widthOfGlyph(left)+kernAmount}var scale=size/1000;return totalWidth*scale},StandardFontEmbedder2.prototype.heightOfFontAtSize=function(size,options){if(options===void 0)options={};var _a=options.descender,descender=_a===void 0?!0:_a,_b=this.font,Ascender=_b.Ascender,Descender=_b.Descender,FontBBox=_b.FontBBox,yTop=Ascender||FontBBox[3],yBottom=Descender||FontBBox[1],height=yTop-yBottom;if(!descender)height+=Descender||0;return height/1000*size},StandardFontEmbedder2.prototype.sizeOfFontAtHeight=function(height){var _a=this.font,Ascender=_a.Ascender,Descender=_a.Descender,FontBBox=_a.FontBBox,yTop=Ascender||FontBBox[3],yBottom=Descender||FontBBox[1];return 1000*height/(yTop-yBottom)},StandardFontEmbedder2.prototype.embedIntoContext=function(context,ref){var fontDict=context.obj({Type:"Font",Subtype:"Type1",BaseFont:this.customName||this.fontName,Encoding:this.encoding===Encodings.WinAnsi?"WinAnsiEncoding":void 0});if(ref)return context.assign(ref,fontDict),ref;else return context.register(fontDict)},StandardFontEmbedder2.prototype.widthOfGlyph=function(glyphName){return this.font.getWidthOfGlyph(glyphName)||250},StandardFontEmbedder2.prototype.encodeTextAsGlyphs=function(text2){var codePoints=Array.from(text2),glyphs=new Array(codePoints.length);for(var idx3=0,len2=codePoints.length;idx3<len2;idx3++){var codePoint=toCodePoint(codePoints[idx3]);glyphs[idx3]=this.encoding.encodeUnicodeCodePoint(codePoint)}return glyphs},StandardFontEmbedder2.for=function(fontName,customName){return new StandardFontEmbedder2(fontName,customName)},StandardFontEmbedder2}(),StandardFontEmbedder_default=StandardFontEmbedder;var createCmap=function(glyphs,glyphId){var bfChars=new Array(glyphs.length);for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++){var glyph=glyphs[idx3],id=cmapHexFormat(cmapHexString(glyphId(glyph))),unicode2=cmapHexFormat.apply(void 0,glyph.codePoints.map(cmapCodePointFormat));bfChars[idx3]=[id,unicode2]}return fillCmapTemplate(bfChars)},fillCmapTemplate=function(bfChars){return`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange
`+bfChars.length+` beginbfchar
`+bfChars.map(function(_a){var glyphId=_a[0],codePoint=_a[1];return glyphId+" "+codePoint}).join(`
`)+`
endbfchar
endcmap
CMapName currentdict /CMap defineresource pop
end
end`},cmapHexFormat=function(){var values3=[];for(var _i=0;_i<arguments.length;_i++)values3[_i]=arguments[_i];return"<"+values3.join("")+">"},cmapHexString=function(value){return toHexStringOfMinLength(value,4)},cmapCodePointFormat=function(codePoint){if(isWithinBMP(codePoint))return cmapHexString(codePoint);if(hasSurrogates(codePoint)){var hs=highSurrogate(codePoint),ls=lowSurrogate(codePoint);return""+cmapHexString(hs)+cmapHexString(ls)}var hex2=toHexString(codePoint),msg="0x"+hex2+" is not a valid UTF-8 or UTF-16 codepoint.";throw new Error(msg)};var makeFontFlags=function(options){var flags=0,flipBit=function(bit2){flags|=1<<bit2-1};if(options.fixedPitch)flipBit(1);if(options.serif)flipBit(2);if(options.symbolic)flipBit(3);if(options.script)flipBit(4);if(options.nonsymbolic)flipBit(6);if(options.italic)flipBit(7);if(options.allCap)flipBit(17);if(options.smallCap)flipBit(18);if(options.forceBold)flipBit(19);return flags},deriveFontFlags=function(font){var familyClass=font["OS/2"]?font["OS/2"].sFamilyClass:0,flags=makeFontFlags({fixedPitch:font.post.isFixedPitch,serif:1<=familyClass&&familyClass<=7,symbolic:!0,script:familyClass===10,italic:font.head.macStyle.italic});return flags};var PDFString=function(_super){__extends(PDFString2,_super);function PDFString2(value){var _this=_super.call(this)||this;return _this.value=value,_this}return PDFString2.prototype.asBytes=function(){var bytes=[],octal="",escaped=!1,pushByte=function(byte3){if(byte3!==void 0)bytes.push(byte3);escaped=!1};for(var idx3=0,len2=this.value.length;idx3<len2;idx3++){var char2=this.value[idx3],byte2=toCharCode(char2),nextChar=this.value[idx3+1];if(!escaped)if(byte2===CharCodes_default.BackSlash)escaped=!0;else pushByte(byte2);else if(byte2===CharCodes_default.Newline)pushByte();else if(byte2===CharCodes_default.CarriageReturn)pushByte();else if(byte2===CharCodes_default.n)pushByte(CharCodes_default.Newline);else if(byte2===CharCodes_default.r)pushByte(CharCodes_default.CarriageReturn);else if(byte2===CharCodes_default.t)pushByte(CharCodes_default.Tab);else if(byte2===CharCodes_default.b)pushByte(CharCodes_default.Backspace);else if(byte2===CharCodes_default.f)pushByte(CharCodes_default.FormFeed);else if(byte2===CharCodes_default.LeftParen)pushByte(CharCodes_default.LeftParen);else if(byte2===CharCodes_default.RightParen)pushByte(CharCodes_default.RightParen);else if(byte2===CharCodes_default.Backspace)pushByte(CharCodes_default.BackSlash);else if(byte2>=CharCodes_default.Zero&&byte2<=CharCodes_default.Seven){if(octal+=char2,octal.length===3||!(nextChar>="0"&&nextChar<="7"))pushByte(parseInt(octal,8)),octal=""}else pushByte(byte2)}return new Uint8Array(bytes)},PDFString2.prototype.decodeText=function(){var bytes=this.asBytes();if(hasUtf16BOM(bytes))return utf16Decode(bytes);return pdfDocEncodingDecode(bytes)},PDFString2.prototype.decodeDate=function(){var text2=this.decodeText(),date3=parseDate(text2);if(!date3)throw new InvalidPDFDateStringError(text2);return date3},PDFString2.prototype.asString=function(){return this.value},PDFString2.prototype.clone=function(){return PDFString2.of(this.value)},PDFString2.prototype.toString=function(){return"("+this.value+")"},PDFString2.prototype.sizeInBytes=function(){return this.value.length+2},PDFString2.prototype.copyBytesInto=function(buffer2,offset){return buffer2[offset++]=CharCodes_default.LeftParen,offset+=copyStringIntoBuffer(this.value,buffer2,offset),buffer2[offset++]=CharCodes_default.RightParen,this.value.length+2},PDFString2.of=function(value){return new PDFString2(value)},PDFString2.fromDate=function(date3){var year=padStart(String(date3.getUTCFullYear()),4,"0"),month=padStart(String(date3.getUTCMonth()+1),2,"0"),day=padStart(String(date3.getUTCDate()),2,"0"),hours=padStart(String(date3.getUTCHours()),2,"0"),mins=padStart(String(date3.getUTCMinutes()),2,"0"),secs=padStart(String(date3.getUTCSeconds()),2,"0");return new PDFString2("D:"+year+month+day+hours+mins+secs+"Z")},PDFString2}(PDFObject_default),PDFString_default=PDFString;var CustomFontEmbedder=function(){function CustomFontEmbedder2(font,fontData,customName,fontFeatures){var _this=this;this.allGlyphsInFontSortedById=function(){var glyphs=new Array(_this.font.characterSet.length);for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++){var codePoint=_this.font.characterSet[idx3];glyphs[idx3]=_this.font.glyphForCodePoint(codePoint)}return sortedUniq(glyphs.sort(byAscendingId),function(g){return g.id})},this.font=font,this.scale=1000/this.font.unitsPerEm,this.fontData=fontData,this.fontName=this.font.postscriptName||"Font",this.customName=customName,this.fontFeatures=fontFeatures,this.baseFontName="",this.glyphCache=Cache_default.populatedBy(this.allGlyphsInFontSortedById)}return CustomFontEmbedder2.for=function(fontkit,fontData,customName,fontFeatures){return __awaiter(this,void 0,void 0,function(){var font;return __generator(this,function(_a){switch(_a.label){case 0:return[4,fontkit.create(fontData)];case 1:return font=_a.sent(),[2,new CustomFontEmbedder2(font,fontData,customName,fontFeatures)]}})})},CustomFontEmbedder2.prototype.encodeText=function(text2){var glyphs=this.font.layout(text2,this.fontFeatures).glyphs,hexCodes=new Array(glyphs.length);for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++)hexCodes[idx3]=toHexStringOfMinLength(glyphs[idx3].id,4);return PDFHexString_default.of(hexCodes.join(""))},CustomFontEmbedder2.prototype.widthOfTextAtSize=function(text2,size){var glyphs=this.font.layout(text2,this.fontFeatures).glyphs,totalWidth=0;for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++)totalWidth+=glyphs[idx3].advanceWidth*this.scale;var scale=size/1000;return totalWidth*scale},CustomFontEmbedder2.prototype.heightOfFontAtSize=function(size,options){if(options===void 0)options={};var _a=options.descender,descender=_a===void 0?!0:_a,_b=this.font,ascent=_b.ascent,descent=_b.descent,bbox=_b.bbox,yTop=(ascent||bbox.maxY)*this.scale,yBottom=(descent||bbox.minY)*this.scale,height=yTop-yBottom;if(!descender)height-=Math.abs(descent)||0;return height/1000*size},CustomFontEmbedder2.prototype.sizeOfFontAtHeight=function(height){var _a=this.font,ascent=_a.ascent,descent=_a.descent,bbox=_a.bbox,yTop=(ascent||bbox.maxY)*this.scale,yBottom=(descent||bbox.minY)*this.scale;return 1000*height/(yTop-yBottom)},CustomFontEmbedder2.prototype.embedIntoContext=function(context,ref){return this.baseFontName=this.customName||context.addRandomSuffix(this.fontName),this.embedFontDict(context,ref)},CustomFontEmbedder2.prototype.embedFontDict=function(context,ref){return __awaiter(this,void 0,void 0,function(){var cidFontDictRef,unicodeCMapRef,fontDict;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.embedCIDFontDict(context)];case 1:if(cidFontDictRef=_a.sent(),unicodeCMapRef=this.embedUnicodeCmap(context),fontDict=context.obj({Type:"Font",Subtype:"Type0",BaseFont:this.baseFontName,Encoding:"Identity-H",DescendantFonts:[cidFontDictRef],ToUnicode:unicodeCMapRef}),ref)return context.assign(ref,fontDict),[2,ref];else return[2,context.register(fontDict)];return[2]}})})},CustomFontEmbedder2.prototype.isCFF=function(){return this.font.cff},CustomFontEmbedder2.prototype.embedCIDFontDict=function(context){return __awaiter(this,void 0,void 0,function(){var fontDescriptorRef,cidFontDict;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.embedFontDescriptor(context)];case 1:return fontDescriptorRef=_a.sent(),cidFontDict=context.obj({Type:"Font",Subtype:this.isCFF()?"CIDFontType0":"CIDFontType2",CIDToGIDMap:"Identity",BaseFont:this.baseFontName,CIDSystemInfo:{Registry:PDFString_default.of("Adobe"),Ordering:PDFString_default.of("Identity"),Supplement:0},FontDescriptor:fontDescriptorRef,W:this.computeWidths()}),[2,context.register(cidFontDict)]}})})},CustomFontEmbedder2.prototype.embedFontDescriptor=function(context){return __awaiter(this,void 0,void 0,function(){var fontStreamRef,scale,_a,italicAngle,ascent,descent,capHeight,xHeight,_b,minX,minY,maxX,maxY,fontDescriptor,_c;return __generator(this,function(_d){switch(_d.label){case 0:return[4,this.embedFontStream(context)];case 1:return fontStreamRef=_d.sent(),scale=this.scale,_a=this.font,italicAngle=_a.italicAngle,ascent=_a.ascent,descent=_a.descent,capHeight=_a.capHeight,xHeight=_a.xHeight,_b=this.font.bbox,minX=_b.minX,minY=_b.minY,maxX=_b.maxX,maxY=_b.maxY,fontDescriptor=context.obj((_c={Type:"FontDescriptor",FontName:this.baseFontName,Flags:deriveFontFlags(this.font),FontBBox:[minX*scale,minY*scale,maxX*scale,maxY*scale],ItalicAngle:italicAngle,Ascent:ascent*scale,Descent:descent*scale,CapHeight:(capHeight||ascent)*scale,XHeight:(xHeight||0)*scale,StemV:0},_c[this.isCFF()?"FontFile3":"FontFile2"]=fontStreamRef,_c)),[2,context.register(fontDescriptor)]}})})},CustomFontEmbedder2.prototype.serializeFont=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this.fontData]})})},CustomFontEmbedder2.prototype.embedFontStream=function(context){return __awaiter(this,void 0,void 0,function(){var fontStream,_a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return _b=(_a=context).flateStream,[4,this.serializeFont()];case 1:return fontStream=_b.apply(_a,[_c.sent(),{Subtype:this.isCFF()?"CIDFontType0C":void 0}]),[2,context.register(fontStream)]}})})},CustomFontEmbedder2.prototype.embedUnicodeCmap=function(context){var cmap=createCmap(this.glyphCache.access(),this.glyphId.bind(this)),cmapStream=context.flateStream(cmap);return context.register(cmapStream)},CustomFontEmbedder2.prototype.glyphId=function(glyph){return glyph?glyph.id:-1},CustomFontEmbedder2.prototype.computeWidths=function(){var glyphs=this.glyphCache.access(),widths=[],currSection=[];for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++){var currGlyph=glyphs[idx3],prevGlyph=glyphs[idx3-1],currGlyphId=this.glyphId(currGlyph),prevGlyphId=this.glyphId(prevGlyph);if(idx3===0)widths.push(currGlyphId);else if(currGlyphId-prevGlyphId!==1)widths.push(currSection),widths.push(currGlyphId),currSection=[];currSection.push(currGlyph.advanceWidth*this.scale)}return widths.push(currSection),widths},CustomFontEmbedder2}(),CustomFontEmbedder_default=CustomFontEmbedder;var CustomFontSubsetEmbedder=function(_super){__extends(CustomFontSubsetEmbedder2,_super);function CustomFontSubsetEmbedder2(font,fontData,customFontName,fontFeatures){var _this=_super.call(this,font,fontData,customFontName,fontFeatures)||this;return _this.subset=_this.font.createSubset(),_this.glyphs=[],_this.glyphCache=Cache_default.populatedBy(function(){return _this.glyphs}),_this.glyphIdMap=new Map,_this}return CustomFontSubsetEmbedder2.for=function(fontkit,fontData,customFontName,fontFeatures){return __awaiter(this,void 0,void 0,function(){var font;return __generator(this,function(_a){switch(_a.label){case 0:return[4,fontkit.create(fontData)];case 1:return font=_a.sent(),[2,new CustomFontSubsetEmbedder2(font,fontData,customFontName,fontFeatures)]}})})},CustomFontSubsetEmbedder2.prototype.encodeText=function(text2){var glyphs=this.font.layout(text2,this.fontFeatures).glyphs,hexCodes=new Array(glyphs.length);for(var idx3=0,len2=glyphs.length;idx3<len2;idx3++){var glyph=glyphs[idx3],subsetGlyphId=this.subset.includeGlyph(glyph);this.glyphs[subsetGlyphId-1]=glyph,this.glyphIdMap.set(glyph.id,subsetGlyphId),hexCodes[idx3]=toHexStringOfMinLength(subsetGlyphId,4)}return this.glyphCache.invalidate(),PDFHexString_default.of(hexCodes.join(""))},CustomFontSubsetEmbedder2.prototype.isCFF=function(){return this.subset.cff},CustomFontSubsetEmbedder2.prototype.glyphId=function(glyph){return glyph?this.glyphIdMap.get(glyph.id):-1},CustomFontSubsetEmbedder2.prototype.serializeFont=function(){var _this=this;return new Promise(function(resolve,reject){var parts=[];_this.subset.encodeStream().on("data",function(bytes){return parts.push(bytes)}).on("end",function(){return resolve(mergeUint8Arrays(parts))}).on("error",function(err){return reject(err)})})},CustomFontSubsetEmbedder2}(CustomFontEmbedder_default),CustomFontSubsetEmbedder_default=CustomFontSubsetEmbedder;var AFRelationship;(function(AFRelationship2){AFRelationship2.Source="Source",AFRelationship2.Data="Data",AFRelationship2.Alternative="Alternative",AFRelationship2.Supplement="Supplement",AFRelationship2.EncryptedPayload="EncryptedPayload",AFRelationship2.FormData="EncryptedPayload",AFRelationship2.Schema="Schema",AFRelationship2.Unspecified="Unspecified"})(AFRelationship||(AFRelationship={}));var FileEmbedder=function(){function FileEmbedder2(fileData,fileName,options){if(options===void 0)options={};this.fileData=fileData,this.fileName=fileName,this.options=options}return FileEmbedder2.for=function(bytes,fileName,options){if(options===void 0)options={};return new FileEmbedder2(bytes,fileName,options)},FileEmbedder2.prototype.embedIntoContext=function(context,ref){return __awaiter(this,void 0,void 0,function(){var _a,mimeType,description,creationDate,modificationDate,afRelationship,embeddedFileStream,embeddedFileStreamRef,fileSpecDict;return __generator(this,function(_b){if(_a=this.options,mimeType=_a.mimeType,description=_a.description,creationDate=_a.creationDate,modificationDate=_a.modificationDate,afRelationship=_a.afRelationship,embeddedFileStream=context.flateStream(this.fileData,{Type:"EmbeddedFile",Subtype:mimeType!==null&&mimeType!==void 0?mimeType:void 0,Params:{Size:this.fileData.length,CreationDate:creationDate?PDFString_default.fromDate(creationDate):void 0,ModDate:modificationDate?PDFString_default.fromDate(modificationDate):void 0}}),embeddedFileStreamRef=context.register(embeddedFileStream),fileSpecDict=context.obj({Type:"Filespec",F:PDFString_default.of(this.fileName),UF:PDFHexString_default.fromText(this.fileName),EF:{F:embeddedFileStreamRef},Desc:description?PDFHexString_default.fromText(description):void 0,AFRelationship:afRelationship!==null&&afRelationship!==void 0?afRelationship:void 0}),ref)return context.assign(ref,fileSpecDict),[2,ref];else return[2,context.register(fileSpecDict)];return[2]})})},FileEmbedder2}(),FileEmbedder_default=FileEmbedder;var MARKERS=[65472,65473,65474,65475,65477,65478,65479,65480,65481,65482,65483,65484,65485,65486,65487],ColorSpace;(function(ColorSpace2){ColorSpace2.DeviceGray="DeviceGray",ColorSpace2.DeviceRGB="DeviceRGB",ColorSpace2.DeviceCMYK="DeviceCMYK"})(ColorSpace||(ColorSpace={}));var ChannelToColorSpace={1:ColorSpace.DeviceGray,3:ColorSpace.DeviceRGB,4:ColorSpace.DeviceCMYK},JpegEmbedder=function(){function JpegEmbedder2(imageData,bitsPerComponent,width,height,colorSpace){this.imageData=imageData,this.bitsPerComponent=bitsPerComponent,this.width=width,this.height=height,this.colorSpace=colorSpace}return JpegEmbedder2.for=function(imageData){return __awaiter(this,void 0,void 0,function(){var dataView,soi,pos,marker,bitsPerComponent,height,width,channelByte,channelName,colorSpace;return __generator(this,function(_a){if(dataView=new DataView(imageData.buffer),soi=dataView.getUint16(0),soi!==65496)throw new Error("SOI not found in JPEG");pos=2;while(pos<dataView.byteLength){if(marker=dataView.getUint16(pos),pos+=2,MARKERS.includes(marker))break;pos+=dataView.getUint16(pos)}if(!MARKERS.includes(marker))throw new Error("Invalid JPEG");if(pos+=2,bitsPerComponent=dataView.getUint8(pos++),height=dataView.getUint16(pos),pos+=2,width=dataView.getUint16(pos),pos+=2,channelByte=dataView.getUint8(pos++),channelName=ChannelToColorSpace[channelByte],!channelName)throw new Error("Unknown JPEG channel.");return colorSpace=channelName,[2,new JpegEmbedder2(imageData,bitsPerComponent,width,height,colorSpace)]})})},JpegEmbedder2.prototype.embedIntoContext=function(context,ref){return __awaiter(this,void 0,void 0,function(){var xObject;return __generator(this,function(_a){if(xObject=context.stream(this.imageData,{Type:"XObject",Subtype:"Image",BitsPerComponent:this.bitsPerComponent,Width:this.width,Height:this.height,ColorSpace:this.colorSpace,Filter:"DCTDecode",Decode:this.colorSpace===ColorSpace.DeviceCMYK?[1,0,1,0,1,0,1,0]:void 0}),ref)return context.assign(ref,xObject),[2,ref];else return[2,context.register(xObject)];return[2]})})},JpegEmbedder2}(),JpegEmbedder_default=JpegEmbedder;var import_pako4=__toESM(require_pako(),1),UPNG={};UPNG.toRGBA8=function(out){var{width:w,height:h}=out;if(out.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(out.data,w,h,out).buffer];var frms=[];if(out.frames[0].data==null)out.frames[0].data=out.data;var len2=w*h*4,img=new Uint8Array(len2),empty=new Uint8Array(len2),prev=new Uint8Array(len2);for(var i3=0;i3<out.frames.length;i3++){var frm=out.frames[i3],fx=frm.rect.x,fy=frm.rect.y,fw=frm.rect.width,fh=frm.rect.height,fdata=UPNG.toRGBA8.decodeImage(frm.data,fw,fh,out);if(i3!=0)for(var j=0;j<len2;j++)prev[j]=img[j];if(frm.blend==0)UPNG._copyTile(fdata,fw,fh,img,w,h,fx,fy,0);else if(frm.blend==1)UPNG._copyTile(fdata,fw,fh,img,w,h,fx,fy,1);if(frms.push(img.buffer.slice(0)),frm.dispose==0);else if(frm.dispose==1)UPNG._copyTile(empty,fw,fh,img,w,h,fx,fy,0);else if(frm.dispose==2)for(var j=0;j<len2;j++)img[j]=prev[j]}return frms};UPNG.toRGBA8.decodeImage=function(data,w,h,out){var area=w*h,bpp=UPNG.decode._getBPP(out),bpl=Math.ceil(w*bpp/8),bf=new Uint8Array(area*4),bf32=new Uint32Array(bf.buffer),ctype=out.ctype,depth=out.depth,rs=UPNG._bin.readUshort,time2=Date.now();if(ctype==6){var qarea=area<<2;if(depth==8)for(var i3=0;i3<qarea;i3+=4)bf[i3]=data[i3],bf[i3+1]=data[i3+1],bf[i3+2]=data[i3+2],bf[i3+3]=data[i3+3];if(depth==16)for(var i3=0;i3<qarea;i3++)bf[i3]=data[i3<<1]}else if(ctype==2){var ts=out.tabs.tRNS;if(ts==null){if(depth==8)for(var i3=0;i3<area;i3++){var ti=i3*3;bf32[i3]=-16777216|data[ti+2]<<16|data[ti+1]<<8|data[ti]}if(depth==16)for(var i3=0;i3<area;i3++){var ti=i3*6;bf32[i3]=-16777216|data[ti+4]<<16|data[ti+2]<<8|data[ti]}}else{var tr=ts[0],tg=ts[1],tb=ts[2];if(depth==8)for(var i3=0;i3<area;i3++){var qi=i3<<2,ti=i3*3;if(bf32[i3]=-16777216|data[ti+2]<<16|data[ti+1]<<8|data[ti],data[ti]==tr&&data[ti+1]==tg&&data[ti+2]==tb)bf[qi+3]=0}if(depth==16)for(var i3=0;i3<area;i3++){var qi=i3<<2,ti=i3*6;if(bf32[i3]=-16777216|data[ti+4]<<16|data[ti+2]<<8|data[ti],rs(data,ti)==tr&&rs(data,ti+2)==tg&&rs(data,ti+4)==tb)bf[qi+3]=0}}}else if(ctype==3){var p=out.tabs.PLTE,ap=out.tabs.tRNS,tl=ap?ap.length:0;if(depth==1)for(var y=0;y<h;y++){var s0=y*bpl,t0=y*w;for(var i3=0;i3<w;i3++){var qi=t0+i3<<2,j=data[s0+(i3>>3)]>>7-((i3&7)<<0)&1,cj=3*j;bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}}if(depth==2)for(var y=0;y<h;y++){var s0=y*bpl,t0=y*w;for(var i3=0;i3<w;i3++){var qi=t0+i3<<2,j=data[s0+(i3>>2)]>>6-((i3&3)<<1)&3,cj=3*j;bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}}if(depth==4)for(var y=0;y<h;y++){var s0=y*bpl,t0=y*w;for(var i3=0;i3<w;i3++){var qi=t0+i3<<2,j=data[s0+(i3>>1)]>>4-((i3&1)<<2)&15,cj=3*j;bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}}if(depth==8)for(var i3=0;i3<area;i3++){var qi=i3<<2,j=data[i3],cj=3*j;bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}}else if(ctype==4){if(depth==8)for(var i3=0;i3<area;i3++){var qi=i3<<2,di=i3<<1,gr=data[di];bf[qi]=gr,bf[qi+1]=gr,bf[qi+2]=gr,bf[qi+3]=data[di+1]}if(depth==16)for(var i3=0;i3<area;i3++){var qi=i3<<2,di=i3<<2,gr=data[di];bf[qi]=gr,bf[qi+1]=gr,bf[qi+2]=gr,bf[qi+3]=data[di+2]}}else if(ctype==0){var tr=out.tabs.tRNS?out.tabs.tRNS:-1;for(var y=0;y<h;y++){var off=y*bpl,to=y*w;if(depth==1)for(var x=0;x<w;x++){var gr=255*(data[off+(x>>>3)]>>>7-(x&7)&1),al=gr==tr*255?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(depth==2)for(var x=0;x<w;x++){var gr=85*(data[off+(x>>>2)]>>>6-((x&3)<<1)&3),al=gr==tr*85?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(depth==4)for(var x=0;x<w;x++){var gr=17*(data[off+(x>>>1)]>>>4-((x&1)<<2)&15),al=gr==tr*17?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(depth==8)for(var x=0;x<w;x++){var gr=data[off+x],al=gr==tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(depth==16)for(var x=0;x<w;x++){var gr=data[off+(x<<1)],al=rs(data,off+(x<<i3))==tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}}}return bf};UPNG.decode=function(buff){var data=new Uint8Array(buff),offset=8,bin=UPNG._bin,rUs=bin.readUshort,rUi=bin.readUint,out={tabs:{},frames:[]},dd=new Uint8Array(data.length),doff=0,fd,foff=0,mgck=[137,80,78,71,13,10,26,10];for(var i3=0;i3<8;i3++)if(data[i3]!=mgck[i3])throw"The input is not a PNG file!";while(offset<data.length){var len2=bin.readUint(data,offset);offset+=4;var type2=bin.readASCII(data,offset,4);if(offset+=4,type2=="IHDR")UPNG.decode._IHDR(data,offset,out);else if(type2=="IDAT"){for(var i3=0;i3<len2;i3++)dd[doff+i3]=data[offset+i3];doff+=len2}else if(type2=="acTL")out.tabs[type2]={num_frames:rUi(data,offset),num_plays:rUi(data,offset+4)},fd=new Uint8Array(data.length);else if(type2=="fcTL"){if(foff!=0){var fr=out.frames[out.frames.length-1];fr.data=UPNG.decode._decompress(out,fd.slice(0,foff),fr.rect.width,fr.rect.height),foff=0}var rct={x:rUi(data,offset+12),y:rUi(data,offset+16),width:rUi(data,offset+4),height:rUi(data,offset+8)},del=rUs(data,offset+22);del=rUs(data,offset+20)/(del==0?100:del);var frm={rect:rct,delay:Math.round(del*1000),dispose:data[offset+24],blend:data[offset+25]};out.frames.push(frm)}else if(type2=="fdAT"){for(var i3=0;i3<len2-4;i3++)fd[foff+i3]=data[offset+i3+4];foff+=len2-4}else if(type2=="pHYs")out.tabs[type2]=[bin.readUint(data,offset),bin.readUint(data,offset+4),data[offset+8]];else if(type2=="cHRM"){out.tabs[type2]=[];for(var i3=0;i3<8;i3++)out.tabs[type2].push(bin.readUint(data,offset+i3*4))}else if(type2=="tEXt"){if(out.tabs[type2]==null)out.tabs[type2]={};var nz=bin.nextZero(data,offset),keyw=bin.readASCII(data,offset,nz-offset),text2=bin.readASCII(data,nz+1,offset+len2-nz-1);out.tabs[type2][keyw]=text2}else if(type2=="iTXt"){if(out.tabs[type2]==null)out.tabs[type2]={};var nz=0,off=offset;nz=bin.nextZero(data,off);var keyw=bin.readASCII(data,off,nz-off);off=nz+1;var cflag=data[off],cmeth=data[off+1];off+=2,nz=bin.nextZero(data,off);var ltag=bin.readASCII(data,off,nz-off);off=nz+1,nz=bin.nextZero(data,off);var tkeyw=bin.readUTF8(data,off,nz-off);off=nz+1;var text2=bin.readUTF8(data,off,len2-(off-offset));out.tabs[type2][keyw]=text2}else if(type2=="PLTE")out.tabs[type2]=bin.readBytes(data,offset,len2);else if(type2=="hIST"){var pl=out.tabs.PLTE.length/3;out.tabs[type2]=[];for(var i3=0;i3<pl;i3++)out.tabs[type2].push(rUs(data,offset+i3*2))}else if(type2=="tRNS"){if(out.ctype==3)out.tabs[type2]=bin.readBytes(data,offset,len2);else if(out.ctype==0)out.tabs[type2]=rUs(data,offset);else if(out.ctype==2)out.tabs[type2]=[rUs(data,offset),rUs(data,offset+2),rUs(data,offset+4)]}else if(type2=="gAMA")out.tabs[type2]=bin.readUint(data,offset)/1e5;else if(type2=="sRGB")out.tabs[type2]=data[offset];else if(type2=="bKGD"){if(out.ctype==0||out.ctype==4)out.tabs[type2]=[rUs(data,offset)];else if(out.ctype==2||out.ctype==6)out.tabs[type2]=[rUs(data,offset),rUs(data,offset+2),rUs(data,offset+4)];else if(out.ctype==3)out.tabs[type2]=data[offset]}else if(type2=="IEND")break;offset+=len2;var crc=bin.readUint(data,offset);offset+=4}if(foff!=0){var fr=out.frames[out.frames.length-1];fr.data=UPNG.decode._decompress(out,fd.slice(0,foff),fr.rect.width,fr.rect.height),foff=0}return out.data=UPNG.decode._decompress(out,dd,out.width,out.height),delete out.compress,delete out.interlace,delete out.filter,out};UPNG.decode._decompress=function(out,dd,w,h){var time2=Date.now(),bpp=UPNG.decode._getBPP(out),bpl=Math.ceil(w*bpp/8),buff=new Uint8Array((bpl+1+out.interlace)*h);dd=UPNG.decode._inflate(dd,buff);var time2=Date.now();if(out.interlace==0)dd=UPNG.decode._filterZero(dd,out,0,w,h);else if(out.interlace==1)dd=UPNG.decode._readInterlace(dd,out);return dd};UPNG.decode._inflate=function(data,buff){var out=UPNG.inflateRaw(new Uint8Array(data.buffer,2,data.length-6),buff);return out};UPNG.inflateRaw=function(){var H={};return H.H={},H.H.N=function(N,W){var R=Uint8Array,i3=0,m=0,J=0,h=0,Q=0,X=0,u=0,w=0,d=0,v,C;if(N[0]==3&&N[1]==0)return W?W:new R(0);var V=H.H,n=V.b,A=V.e,l=V.R,M=V.n,I=V.A,e=V.Z,b2=V.m,Z=W==null;if(Z)W=new R(N.length>>>2<<3);while(i3==0){if(i3=n(N,d,1),m=n(N,d+1,2),d+=3,m==0){if((d&7)!=0)d+=8-(d&7);var D=(d>>>3)+4,q=N[D-4]|N[D-3]<<8;if(Z)W=H.H.W(W,w+q);W.set(new R(N.buffer,N.byteOffset+D,q),w),d=D+q<<3,w+=q;continue}if(Z)W=H.H.W(W,w+131072);if(m==1)v=b2.J,C=b2.h,X=511,u=31;if(m==2){J=A(N,d,5)+257,h=A(N,d+5,5)+1,Q=A(N,d+10,4)+4,d+=14;var E=d,j=1;for(var c=0;c<38;c+=2)b2.Q[c]=0,b2.Q[c+1]=0;for(var c=0;c<Q;c++){var K=A(N,d+c*3,3);if(b2.Q[(b2.X[c]<<1)+1]=K,K>j)j=K}d+=3*Q,M(b2.Q,j),I(b2.Q,j,b2.u),v=b2.w,C=b2.d,d=l(b2.u,(1<<j)-1,J+h,N,d,b2.v);var r=V.V(b2.v,0,J,b2.C);X=(1<<r)-1;var S=V.V(b2.v,J,h,b2.D);u=(1<<S)-1,M(b2.C,r),I(b2.C,r,v),M(b2.D,S),I(b2.D,S,C)}while(!0){var T2=v[e(N,d)&X];d+=T2&15;var p=T2>>>4;if(p>>>8==0)W[w++]=p;else if(p==256)break;else{var z=w+p-254;if(p>264){var _2=b2.q[p-257];z=w+(_2>>>3)+A(N,d,_2&7),d+=_2&7}var $2=C[e(N,d)&u];d+=$2&15;var s=$2>>>4,Y2=b2.c[s],a=(Y2>>>4)+n(N,d,Y2&15);d+=Y2&15;while(w<z)W[w]=W[w++-a],W[w]=W[w++-a],W[w]=W[w++-a],W[w]=W[w++-a];w=z}}}return W.length==w?W:W.slice(0,w)},H.H.W=function(N,W){var R=N.length;if(W<=R)return N;var V=new Uint8Array(R<<1);return V.set(N,0),V},H.H.R=function(N,W,R,V,n,A){var l=H.H.e,M=H.H.Z,I=0;while(I<R){var e=N[M(V,n)&W];n+=e&15;var b2=e>>>4;if(b2<=15)A[I]=b2,I++;else{var Z=0,m=0;if(b2==16)m=3+l(V,n,2),n+=2,Z=A[I-1];else if(b2==17)m=3+l(V,n,3),n+=3;else if(b2==18)m=11+l(V,n,7),n+=7;var J=I+m;while(I<J)A[I]=Z,I++}}return n},H.H.V=function(N,W,R,V){var n=0,A=0,l=V.length>>>1;while(A<R){var M=N[A+W];if(V[A<<1]=0,V[(A<<1)+1]=M,M>n)n=M;A++}while(A<l)V[A<<1]=0,V[(A<<1)+1]=0,A++;return n},H.H.n=function(N,W){var R=H.H.m,V=N.length,n,A,l,M,I,e=R.j;for(var M=0;M<=W;M++)e[M]=0;for(M=1;M<V;M+=2)e[N[M]]++;var b2=R.K;n=0,e[0]=0;for(A=1;A<=W;A++)n=n+e[A-1]<<1,b2[A]=n;for(l=0;l<V;l+=2)if(I=N[l+1],I!=0)N[l]=b2[I],b2[I]++},H.H.A=function(N,W,R){var V=N.length,n=H.H.m,A=n.r;for(var l=0;l<V;l+=2)if(N[l+1]!=0){var M=l>>1,I=N[l+1],e=M<<4|I,b2=W-I,Z=N[l]<<b2,m=Z+(1<<b2);while(Z!=m){var J=A[Z]>>>15-W;R[J]=e,Z++}}},H.H.l=function(N,W){var R=H.H.m.r,V=15-W;for(var n=0;n<N.length;n+=2){var A=N[n]<<W-N[n+1];N[n]=R[A]>>>V}},H.H.M=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R,N[V+1]|=R>>>8},H.H.I=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R,N[V+1]|=R>>>8,N[V+2]|=R>>>16},H.H.e=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8)>>>(W&7)&(1<<R)-1},H.H.b=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)&(1<<R)-1},H.H.Z=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)},H.H.i=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16|N[(W>>>3)+3]<<24)>>>(W&7)},H.H.m=function(){var N=Uint16Array,W=Uint32Array;return{K:new N(16),j:new N(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new N(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new W(32),J:new N(512),_:[],h:new N(32),$:[],w:new N(32768),C:[],v:[],d:new N(32768),D:[],u:new N(512),Q:[],r:new N(32768),s:new W(286),Y:new W(30),a:new W(19),t:new W(15000),k:new N(65536),g:new N(32768)}}(),function(){var N=H.H.m,W=32768;for(var R=0;R<W;R++){var V=R;V=(V&2863311530)>>>1|(V&1431655765)<<1,V=(V&3435973836)>>>2|(V&858993459)<<2,V=(V&4042322160)>>>4|(V&252645135)<<4,V=(V&4278255360)>>>8|(V&16711935)<<8,N.r[R]=(V>>>16|V<<16)>>>17}function n(A,l,M){while(l--!=0)A.push(0,M)}for(var R=0;R<32;R++)N.q[R]=N.S[R]<<3|N.T[R],N.c[R]=N.p[R]<<4|N.z[R];n(N._,144,8),n(N._,112,9),n(N._,24,7),n(N._,8,8),H.H.n(N._,9),H.H.A(N._,9,N.J),H.H.l(N._,9),n(N.$,32,5),H.H.n(N.$,5),H.H.A(N.$,5,N.h),H.H.l(N.$,5),n(N.Q,19,0),n(N.C,286,0),n(N.D,30,0),n(N.v,320,0)}(),H.H.N}();UPNG.decode._readInterlace=function(data,out){var{width:w,height:h}=out,bpp=UPNG.decode._getBPP(out),cbpp=bpp>>3,bpl=Math.ceil(w*bpp/8),img=new Uint8Array(h*bpl),di=0,starting_row=[0,0,4,0,2,0,1],starting_col=[0,4,0,2,0,1,0],row_increment=[8,8,8,4,4,2,2],col_increment=[8,8,4,4,2,2,1],pass=0;while(pass<7){var ri=row_increment[pass],ci=col_increment[pass],sw=0,sh=0,cr=starting_row[pass];while(cr<h)cr+=ri,sh++;var cc=starting_col[pass];while(cc<w)cc+=ci,sw++;var bpll=Math.ceil(sw*bpp/8);UPNG.decode._filterZero(data,out,di,sw,sh);var y=0,row=starting_row[pass];while(row<h){var col=starting_col[pass],cdi=di+y*bpll<<3;while(col<w){if(bpp==1){var val=data[cdi>>3];val=val>>7-(cdi&7)&1,img[row*bpl+(col>>3)]|=val<<7-((col&7)<<0)}if(bpp==2){var val=data[cdi>>3];val=val>>6-(cdi&7)&3,img[row*bpl+(col>>2)]|=val<<6-((col&3)<<1)}if(bpp==4){var val=data[cdi>>3];val=val>>4-(cdi&7)&15,img[row*bpl+(col>>1)]|=val<<4-((col&1)<<2)}if(bpp>=8){var ii=row*bpl+col*cbpp;for(var j=0;j<cbpp;j++)img[ii+j]=data[(cdi>>3)+j]}cdi+=bpp,col+=ci}y++,row+=ri}if(sw*sh!=0)di+=sh*(1+bpll);pass=pass+1}return img};UPNG.decode._getBPP=function(out){var noc=[1,null,3,1,2,null,4][out.ctype];return noc*out.depth};UPNG.decode._filterZero=function(data,out,off,w,h){var bpp=UPNG.decode._getBPP(out),bpl=Math.ceil(w*bpp/8),paeth=UPNG.decode._paeth;bpp=Math.ceil(bpp/8);var i3=0,di=1,type2=data[off],x=0;if(type2>1)data[off]=[0,0,1][type2-2];if(type2==3)for(x=bpp;x<bpl;x++)data[x+1]=data[x+1]+(data[x+1-bpp]>>>1)&255;for(var y=0;y<h;y++)if(i3=off+y*bpl,di=i3+y+1,type2=data[di-1],x=0,type2==0)for(;x<bpl;x++)data[i3+x]=data[di+x];else if(type2==1){for(;x<bpp;x++)data[i3+x]=data[di+x];for(;x<bpl;x++)data[i3+x]=data[di+x]+data[i3+x-bpp]}else if(type2==2)for(;x<bpl;x++)data[i3+x]=data[di+x]+data[i3+x-bpl];else if(type2==3){for(;x<bpp;x++)data[i3+x]=data[di+x]+(data[i3+x-bpl]>>>1);for(;x<bpl;x++)data[i3+x]=data[di+x]+(data[i3+x-bpl]+data[i3+x-bpp]>>>1)}else{for(;x<bpp;x++)data[i3+x]=data[di+x]+paeth(0,data[i3+x-bpl],0);for(;x<bpl;x++)data[i3+x]=data[di+x]+paeth(data[i3+x-bpp],data[i3+x-bpl],data[i3+x-bpp-bpl])}return data};UPNG.decode._paeth=function(a,b2,c){var p=a+b2-c,pa=p-a,pb=p-b2,pc=p-c;if(pa*pa<=pb*pb&&pa*pa<=pc*pc)return a;else if(pb*pb<=pc*pc)return b2;return c};UPNG.decode._IHDR=function(data,offset,out){var bin=UPNG._bin;out.width=bin.readUint(data,offset),offset+=4,out.height=bin.readUint(data,offset),offset+=4,out.depth=data[offset],offset++,out.ctype=data[offset],offset++,out.compress=data[offset],offset++,out.filter=data[offset],offset++,out.interlace=data[offset],offset++};UPNG._bin={nextZero:function(data,p){while(data[p]!=0)p++;return p},readUshort:function(buff,p){return buff[p]<<8|buff[p+1]},writeUshort:function(buff,p,n){buff[p]=n>>8&255,buff[p+1]=n&255},readUint:function(buff,p){return buff[p]*16777216+(buff[p+1]<<16|buff[p+2]<<8|buff[p+3])},writeUint:function(buff,p,n){buff[p]=n>>24&255,buff[p+1]=n>>16&255,buff[p+2]=n>>8&255,buff[p+3]=n&255},readASCII:function(buff,p,l){var s="";for(var i3=0;i3<l;i3++)s+=String.fromCharCode(buff[p+i3]);return s},writeASCII:function(data,p,s){for(var i3=0;i3<s.length;i3++)data[p+i3]=s.charCodeAt(i3)},readBytes:function(buff,p,l){var arr=[];for(var i3=0;i3<l;i3++)arr.push(buff[p+i3]);return arr},pad:function(n){return n.length<2?"0"+n:n},readUTF8:function(buff,p,l){var s="",ns;for(var i3=0;i3<l;i3++)s+="%"+UPNG._bin.pad(buff[p+i3].toString(16));try{ns=decodeURIComponent(s)}catch(e){return UPNG._bin.readASCII(buff,p,l)}return ns}};UPNG._copyTile=function(sb,sw,sh,tb,tw,th,xoff,yoff,mode){var w=Math.min(sw,tw),h=Math.min(sh,th),si=0,ti=0;for(var y=0;y<h;y++)for(var x=0;x<w;x++){if(xoff>=0&&yoff>=0)si=y*sw+x<<2,ti=(yoff+y)*tw+xoff+x<<2;else si=(-yoff+y)*sw-xoff+x<<2,ti=y*tw+x<<2;if(mode==0)tb[ti]=sb[si],tb[ti+1]=sb[si+1],tb[ti+2]=sb[si+2],tb[ti+3]=sb[si+3];else if(mode==1){var fa=sb[si+3]*0.00392156862745098,fr=sb[si]*fa,fg=sb[si+1]*fa,fb=sb[si+2]*fa,ba=tb[ti+3]*0.00392156862745098,br=tb[ti]*ba,bg=tb[ti+1]*ba,bb=tb[ti+2]*ba,ifa=1-fa,oa=fa+ba*ifa,ioa=oa==0?0:1/oa;tb[ti+3]=255*oa,tb[ti+0]=(fr+br*ifa)*ioa,tb[ti+1]=(fg+bg*ifa)*ioa,tb[ti+2]=(fb+bb*ifa)*ioa}else if(mode==2){var fa=sb[si+3],fr=sb[si],fg=sb[si+1],fb=sb[si+2],ba=tb[ti+3],br=tb[ti],bg=tb[ti+1],bb=tb[ti+2];if(fa==ba&&fr==br&&fg==bg&&fb==bb)tb[ti]=0,tb[ti+1]=0,tb[ti+2]=0,tb[ti+3]=0;else tb[ti]=fr,tb[ti+1]=fg,tb[ti+2]=fb,tb[ti+3]=fa}else if(mode==3){var fa=sb[si+3],fr=sb[si],fg=sb[si+1],fb=sb[si+2],ba=tb[ti+3],br=tb[ti],bg=tb[ti+1],bb=tb[ti+2];if(fa==ba&&fr==br&&fg==bg&&fb==bb)continue;if(fa<220&&ba>20)return!1}}return!0};UPNG.encode=function(bufs,w,h,ps,dels,tabs,forbidPlte){if(ps==null)ps=0;if(forbidPlte==null)forbidPlte=!1;var nimg=UPNG.encode.compress(bufs,w,h,ps,[!1,!1,!1,0,forbidPlte]);return UPNG.encode.compressPNG(nimg,-1),UPNG.encode._main(nimg,w,h,dels,tabs)};UPNG.encodeLL=function(bufs,w,h,cc,ac,depth,dels,tabs){var nimg={ctype:0+(cc==1?0:2)+(ac==0?0:4),depth,frames:[]},time2=Date.now(),bipp=(cc+ac)*depth,bipl=bipp*w;for(var i3=0;i3<bufs.length;i3++)nimg.frames.push({rect:{x:0,y:0,width:w,height:h},img:new Uint8Array(bufs[i3]),blend:0,dispose:1,bpp:Math.ceil(bipp/8),bpl:Math.ceil(bipl/8)});UPNG.encode.compressPNG(nimg,0,!0);var out=UPNG.encode._main(nimg,w,h,dels,tabs);return out};UPNG.encode._main=function(nimg,w,h,dels,tabs){if(tabs==null)tabs={};var crc=UPNG.crc.crc,wUi=UPNG._bin.writeUint,wUs=UPNG._bin.writeUshort,wAs=UPNG._bin.writeASCII,offset=8,anim=nimg.frames.length>1,pltAlpha=!1,leng=33+(anim?20:0);if(tabs.sRGB!=null)leng+=13;if(tabs.pHYs!=null)leng+=21;if(nimg.ctype==3){var dl=nimg.plte.length;for(var i3=0;i3<dl;i3++)if(nimg.plte[i3]>>>24!=255)pltAlpha=!0;leng+=8+dl*3+4+(pltAlpha?8+dl*1+4:0)}for(var j=0;j<nimg.frames.length;j++){var fr=nimg.frames[j];if(anim)leng+=38;if(leng+=fr.cimg.length+12,j!=0)leng+=4}leng+=12;var data=new Uint8Array(leng),wr=[137,80,78,71,13,10,26,10];for(var i3=0;i3<8;i3++)data[i3]=wr[i3];if(wUi(data,offset,13),offset+=4,wAs(data,offset,"IHDR"),offset+=4,wUi(data,offset,w),offset+=4,wUi(data,offset,h),offset+=4,data[offset]=nimg.depth,offset++,data[offset]=nimg.ctype,offset++,data[offset]=0,offset++,data[offset]=0,offset++,data[offset]=0,offset++,wUi(data,offset,crc(data,offset-17,17)),offset+=4,tabs.sRGB!=null)wUi(data,offset,1),offset+=4,wAs(data,offset,"sRGB"),offset+=4,data[offset]=tabs.sRGB,offset++,wUi(data,offset,crc(data,offset-5,5)),offset+=4;if(tabs.pHYs!=null)wUi(data,offset,9),offset+=4,wAs(data,offset,"pHYs"),offset+=4,wUi(data,offset,tabs.pHYs[0]),offset+=4,wUi(data,offset,tabs.pHYs[1]),offset+=4,data[offset]=tabs.pHYs[2],offset++,wUi(data,offset,crc(data,offset-13,13)),offset+=4;if(anim)wUi(data,offset,8),offset+=4,wAs(data,offset,"acTL"),offset+=4,wUi(data,offset,nimg.frames.length),offset+=4,wUi(data,offset,tabs.loop!=null?tabs.loop:0),offset+=4,wUi(data,offset,crc(data,offset-12,12)),offset+=4;if(nimg.ctype==3){var dl=nimg.plte.length;wUi(data,offset,dl*3),offset+=4,wAs(data,offset,"PLTE"),offset+=4;for(var i3=0;i3<dl;i3++){var ti=i3*3,c=nimg.plte[i3],r=c&255,g=c>>>8&255,b2=c>>>16&255;data[offset+ti+0]=r,data[offset+ti+1]=g,data[offset+ti+2]=b2}if(offset+=dl*3,wUi(data,offset,crc(data,offset-dl*3-4,dl*3+4)),offset+=4,pltAlpha){wUi(data,offset,dl),offset+=4,wAs(data,offset,"tRNS"),offset+=4;for(var i3=0;i3<dl;i3++)data[offset+i3]=nimg.plte[i3]>>>24&255;offset+=dl,wUi(data,offset,crc(data,offset-dl-4,dl+4)),offset+=4}}var fi=0;for(var j=0;j<nimg.frames.length;j++){var fr=nimg.frames[j];if(anim)wUi(data,offset,26),offset+=4,wAs(data,offset,"fcTL"),offset+=4,wUi(data,offset,fi++),offset+=4,wUi(data,offset,fr.rect.width),offset+=4,wUi(data,offset,fr.rect.height),offset+=4,wUi(data,offset,fr.rect.x),offset+=4,wUi(data,offset,fr.rect.y),offset+=4,wUs(data,offset,dels[j]),offset+=2,wUs(data,offset,1000),offset+=2,data[offset]=fr.dispose,offset++,data[offset]=fr.blend,offset++,wUi(data,offset,crc(data,offset-30,30)),offset+=4;var imgd=fr.cimg,dl=imgd.length;wUi(data,offset,dl+(j==0?0:4)),offset+=4;var ioff=offset;if(wAs(data,offset,j==0?"IDAT":"fdAT"),offset+=4,j!=0)wUi(data,offset,fi++),offset+=4;data.set(imgd,offset),offset+=dl,wUi(data,offset,crc(data,ioff,offset-ioff)),offset+=4}return wUi(data,offset,0),offset+=4,wAs(data,offset,"IEND"),offset+=4,wUi(data,offset,crc(data,offset-4,4)),offset+=4,data.buffer};UPNG.encode.compressPNG=function(out,filter,levelZero){for(var i3=0;i3<out.frames.length;i3++){var frm=out.frames[i3],nw=frm.rect.width,nh=frm.rect.height,fdata=new Uint8Array(nh*frm.bpl+nh);frm.cimg=UPNG.encode._filterZero(frm.img,nh,frm.bpp,frm.bpl,fdata,filter,levelZero)}};UPNG.encode.compress=function(bufs,w,h,ps,prms){var onlyBlend=prms[0],evenCrd=prms[1],forbidPrev=prms[2],minBits=prms[3],forbidPlte=prms[4],ctype=6,depth=8,alphaAnd=255;for(var j=0;j<bufs.length;j++){var img=new Uint8Array(bufs[j]),ilen=img.length;for(var i3=0;i3<ilen;i3+=4)alphaAnd&=img[i3+3]}var gotAlpha=alphaAnd!=255,frms=UPNG.encode.framize(bufs,w,h,onlyBlend,evenCrd,forbidPrev),cmap={},plte=[],inds=[];if(ps!=0){var nbufs=[];for(var i3=0;i3<frms.length;i3++)nbufs.push(frms[i3].img.buffer);var abuf=UPNG.encode.concatRGBA(nbufs),qres=UPNG.quantize(abuf,ps),cof=0,bb=new Uint8Array(qres.abuf);for(var i3=0;i3<frms.length;i3++){var ti=frms[i3].img,bln=ti.length;inds.push(new Uint8Array(qres.inds.buffer,cof>>2,bln>>2));for(var j=0;j<bln;j+=4)ti[j]=bb[cof+j],ti[j+1]=bb[cof+j+1],ti[j+2]=bb[cof+j+2],ti[j+3]=bb[cof+j+3];cof+=bln}for(var i3=0;i3<qres.plte.length;i3++)plte.push(qres.plte[i3].est.rgba)}else for(var j=0;j<frms.length;j++){var frm=frms[j],img32=new Uint32Array(frm.img.buffer),nw=frm.rect.width,ilen=img32.length,ind=new Uint8Array(ilen);inds.push(ind);for(var i3=0;i3<ilen;i3++){var c=img32[i3];if(i3!=0&&c==img32[i3-1])ind[i3]=ind[i3-1];else if(i3>nw&&c==img32[i3-nw])ind[i3]=ind[i3-nw];else{var cmc=cmap[c];if(cmc==null){if(cmap[c]=cmc=plte.length,plte.push(c),plte.length>=300)break}ind[i3]=cmc}}}var cc=plte.length;if(cc<=256&&forbidPlte==!1){if(cc<=2)depth=1;else if(cc<=4)depth=2;else if(cc<=16)depth=4;else depth=8;depth=Math.max(depth,minBits)}for(var j=0;j<frms.length;j++){var frm=frms[j],nx=frm.rect.x,ny=frm.rect.y,nw=frm.rect.width,nh=frm.rect.height,cimg=frm.img,cimg32=new Uint32Array(cimg.buffer),bpl=4*nw,bpp=4;if(cc<=256&&forbidPlte==!1){bpl=Math.ceil(depth*nw/8);var nimg=new Uint8Array(bpl*nh),inj=inds[j];for(var y=0;y<nh;y++){var i3=y*bpl,ii=y*nw;if(depth==8)for(var x=0;x<nw;x++)nimg[i3+x]=inj[ii+x];else if(depth==4)for(var x=0;x<nw;x++)nimg[i3+(x>>1)]|=inj[ii+x]<<4-(x&1)*4;else if(depth==2)for(var x=0;x<nw;x++)nimg[i3+(x>>2)]|=inj[ii+x]<<6-(x&3)*2;else if(depth==1)for(var x=0;x<nw;x++)nimg[i3+(x>>3)]|=inj[ii+x]<<7-(x&7)*1}cimg=nimg,ctype=3,bpp=1}else if(gotAlpha==!1&&frms.length==1){var nimg=new Uint8Array(nw*nh*3),area=nw*nh;for(var i3=0;i3<area;i3++){var ti=i3*3,qi=i3*4;nimg[ti]=cimg[qi],nimg[ti+1]=cimg[qi+1],nimg[ti+2]=cimg[qi+2]}cimg=nimg,ctype=2,bpp=3,bpl=3*nw}frm.img=cimg,frm.bpl=bpl,frm.bpp=bpp}return{ctype,depth,plte,frames:frms}};UPNG.encode.framize=function(bufs,w,h,alwaysBlend,evenCrd,forbidPrev){var frms=[];for(var j=0;j<bufs.length;j++){var cimg=new Uint8Array(bufs[j]),cimg32=new Uint32Array(cimg.buffer),nimg,nx=0,ny=0,nw=w,nh=h,blend=alwaysBlend?1:0;if(j!=0){var tlim=forbidPrev||alwaysBlend||j==1||frms[j-2].dispose!=0?1:2,tstp=0,tarea=1e9;for(var it=0;it<tlim;it++){var pimg=new Uint8Array(bufs[j-1-it]),p32=new Uint32Array(bufs[j-1-it]),mix=w,miy=h,max=-1,may=-1;for(var y=0;y<h;y++)for(var x=0;x<w;x++){var i3=y*w+x;if(cimg32[i3]!=p32[i3]){if(x<mix)mix=x;if(x>max)max=x;if(y<miy)miy=y;if(y>may)may=y}}if(max==-1)mix=miy=max=may=0;if(evenCrd){if((mix&1)==1)mix--;if((miy&1)==1)miy--}var sarea=(max-mix+1)*(may-miy+1);if(sarea<tarea)tarea=sarea,tstp=it,nx=mix,ny=miy,nw=max-mix+1,nh=may-miy+1}var pimg=new Uint8Array(bufs[j-1-tstp]);if(tstp==1)frms[j-1].dispose=2;if(nimg=new Uint8Array(nw*nh*4),UPNG._copyTile(pimg,w,h,nimg,nw,nh,-nx,-ny,0),blend=UPNG._copyTile(cimg,w,h,nimg,nw,nh,-nx,-ny,3)?1:0,blend==1)UPNG.encode._prepareDiff(cimg,w,h,nimg,{x:nx,y:ny,width:nw,height:nh});else UPNG._copyTile(cimg,w,h,nimg,nw,nh,-nx,-ny,0)}else nimg=cimg.slice(0);frms.push({rect:{x:nx,y:ny,width:nw,height:nh},img:nimg,blend,dispose:0})}if(alwaysBlend)for(var j=0;j<frms.length;j++){var frm=frms[j];if(frm.blend==1)continue;var r0=frm.rect,r1=frms[j-1].rect,miX=Math.min(r0.x,r1.x),miY=Math.min(r0.y,r1.y),maX=Math.max(r0.x+r0.width,r1.x+r1.width),maY=Math.max(r0.y+r0.height,r1.y+r1.height),r={x:miX,y:miY,width:maX-miX,height:maY-miY};if(frms[j-1].dispose=1,j-1!=0)UPNG.encode._updateFrame(bufs,w,h,frms,j-1,r,evenCrd);UPNG.encode._updateFrame(bufs,w,h,frms,j,r,evenCrd)}var area=0;if(bufs.length!=1)for(var i3=0;i3<frms.length;i3++){var frm=frms[i3];area+=frm.rect.width*frm.rect.height}return frms};UPNG.encode._updateFrame=function(bufs,w,h,frms,i3,r,evenCrd){var U8=Uint8Array,U32=Uint32Array,pimg=new U8(bufs[i3-1]),pimg32=new U32(bufs[i3-1]),nimg=i3+1<bufs.length?new U8(bufs[i3+1]):null,cimg=new U8(bufs[i3]),cimg32=new U32(cimg.buffer),mix=w,miy=h,max=-1,may=-1;for(var y=0;y<r.height;y++)for(var x=0;x<r.width;x++){var cx=r.x+x,cy=r.y+y,j=cy*w+cx,cc=cimg32[j];if(cc==0||frms[i3-1].dispose==0&&pimg32[j]==cc&&(nimg==null||nimg[j*4+3]!=0));else{if(cx<mix)mix=cx;if(cx>max)max=cx;if(cy<miy)miy=cy;if(cy>may)may=cy}}if(max==-1)mix=miy=max=may=0;if(evenCrd){if((mix&1)==1)mix--;if((miy&1)==1)miy--}r={x:mix,y:miy,width:max-mix+1,height:may-miy+1};var fr=frms[i3];if(fr.rect=r,fr.blend=1,fr.img=new Uint8Array(r.width*r.height*4),frms[i3-1].dispose==0)UPNG._copyTile(pimg,w,h,fr.img,r.width,r.height,-r.x,-r.y,0),UPNG.encode._prepareDiff(cimg,w,h,fr.img,r);else UPNG._copyTile(cimg,w,h,fr.img,r.width,r.height,-r.x,-r.y,0)};UPNG.encode._prepareDiff=function(cimg,w,h,nimg,rec){UPNG._copyTile(cimg,w,h,nimg,rec.width,rec.height,-rec.x,-rec.y,2)};UPNG.encode._filterZero=function(img,h,bpp,bpl,data,filter,levelZero){var fls=[],ftry=[0,1,2,3,4];if(filter!=-1)ftry=[filter];else if(h*bpl>500000||bpp==1)ftry=[0];var opts;if(levelZero)opts={level:0};var CMPR=levelZero&&UZIP!=null?UZIP:import_pako4.default;for(var i3=0;i3<ftry.length;i3++){for(var y=0;y<h;y++)UPNG.encode._filterLine(data,img,y,bpl,bpp,ftry[i3]);fls.push(CMPR.deflate(data,opts))}var ti,tsize=1e9;for(var i3=0;i3<fls.length;i3++)if(fls[i3].length<tsize)ti=i3,tsize=fls[i3].length;return fls[ti]};UPNG.encode._filterLine=function(data,img,y,bpl,bpp,type2){var i3=y*bpl,di=i3+y,paeth=UPNG.decode._paeth;if(data[di]=type2,di++,type2==0)if(bpl<500)for(var x=0;x<bpl;x++)data[di+x]=img[i3+x];else data.set(new Uint8Array(img.buffer,i3,bpl),di);else if(type2==1){for(var x=0;x<bpp;x++)data[di+x]=img[i3+x];for(var x=bpp;x<bpl;x++)data[di+x]=img[i3+x]-img[i3+x-bpp]+256&255}else if(y==0){for(var x=0;x<bpp;x++)data[di+x]=img[i3+x];if(type2==2)for(var x=bpp;x<bpl;x++)data[di+x]=img[i3+x];if(type2==3)for(var x=bpp;x<bpl;x++)data[di+x]=img[i3+x]-(img[i3+x-bpp]>>1)+256&255;if(type2==4)for(var x=bpp;x<bpl;x++)data[di+x]=img[i3+x]-paeth(img[i3+x-bpp],0,0)+256&255}else{if(type2==2)for(var x=0;x<bpl;x++)data[di+x]=img[i3+x]+256-img[i3+x-bpl]&255;if(type2==3){for(var x=0;x<bpp;x++)data[di+x]=img[i3+x]+256-(img[i3+x-bpl]>>1)&255;for(var x=bpp;x<bpl;x++)data[di+x]=img[i3+x]+256-(img[i3+x-bpl]+img[i3+x-bpp]>>1)&255}if(type2==4){for(var x=0;x<bpp;x++)data[di+x]=img[i3+x]+256-paeth(0,img[i3+x-bpl],0)&255;for(var x=bpp;x<bpl;x++)data[di+x]=img[i3+x]+256-paeth(img[i3+x-bpp],img[i3+x-bpl],img[i3+x-bpp-bpl])&255}}};UPNG.crc={table:function(){var tab=new Uint32Array(256);for(var n=0;n<256;n++){var c=n;for(var k2=0;k2<8;k2++)if(c&1)c=3988292384^c>>>1;else c=c>>>1;tab[n]=c}return tab}(),update:function(c,buf,off,len2){for(var i3=0;i3<len2;i3++)c=UPNG.crc.table[(c^buf[off+i3])&255]^c>>>8;return c},crc:function(b2,o,l){return UPNG.crc.update(4294967295,b2,o,l)^4294967295}};UPNG.quantize=function(abuf,ps){var oimg=new Uint8Array(abuf),nimg=oimg.slice(0),nimg32=new Uint32Array(nimg.buffer),KD=UPNG.quantize.getKDtree(nimg,ps),root=KD[0],leafs=KD[1],planeDst=UPNG.quantize.planeDst,sb=oimg,tb=nimg32,len2=sb.length,inds=new Uint8Array(oimg.length>>2);for(var i3=0;i3<len2;i3+=4){var r=sb[i3]*0.00392156862745098,g=sb[i3+1]*0.00392156862745098,b2=sb[i3+2]*0.00392156862745098,a=sb[i3+3]*0.00392156862745098,nd=UPNG.quantize.getNearest(root,r,g,b2,a);inds[i3>>2]=nd.ind,tb[i3>>2]=nd.est.rgba}return{abuf:nimg.buffer,inds,plte:leafs}};UPNG.quantize.getKDtree=function(nimg,ps,err){if(err==null)err=0.0001;var nimg32=new Uint32Array(nimg.buffer),root={i0:0,i1:nimg.length,bst:null,est:null,tdst:0,left:null,right:null};root.bst=UPNG.quantize.stats(nimg,root.i0,root.i1),root.est=UPNG.quantize.estats(root.bst);var leafs=[root];while(leafs.length<ps){var maxL=0,mi=0;for(var i3=0;i3<leafs.length;i3++)if(leafs[i3].est.L>maxL)maxL=leafs[i3].est.L,mi=i3;if(maxL<err)break;var node=leafs[mi],s0=UPNG.quantize.splitPixels(nimg,nimg32,node.i0,node.i1,node.est.e,node.est.eMq255),s0wrong=node.i0>=s0||node.i1<=s0;if(s0wrong){node.est.L=0;continue}var ln={i0:node.i0,i1:s0,bst:null,est:null,tdst:0,left:null,right:null};ln.bst=UPNG.quantize.stats(nimg,ln.i0,ln.i1),ln.est=UPNG.quantize.estats(ln.bst);var rn={i0:s0,i1:node.i1,bst:null,est:null,tdst:0,left:null,right:null};rn.bst={R:[],m:[],N:node.bst.N-ln.bst.N};for(var i3=0;i3<16;i3++)rn.bst.R[i3]=node.bst.R[i3]-ln.bst.R[i3];for(var i3=0;i3<4;i3++)rn.bst.m[i3]=node.bst.m[i3]-ln.bst.m[i3];rn.est=UPNG.quantize.estats(rn.bst),node.left=ln,node.right=rn,leafs[mi]=ln,leafs.push(rn)}leafs.sort(function(a,b2){return b2.bst.N-a.bst.N});for(var i3=0;i3<leafs.length;i3++)leafs[i3].ind=i3;return[root,leafs]};UPNG.quantize.getNearest=function(nd,r,g,b2,a){if(nd.left==null)return nd.tdst=UPNG.quantize.dist(nd.est.q,r,g,b2,a),nd;var planeDst=UPNG.quantize.planeDst(nd.est,r,g,b2,a),node0=nd.left,node1=nd.right;if(planeDst>0)node0=nd.right,node1=nd.left;var ln=UPNG.quantize.getNearest(node0,r,g,b2,a);if(ln.tdst<=planeDst*planeDst)return ln;var rn=UPNG.quantize.getNearest(node1,r,g,b2,a);return rn.tdst<ln.tdst?rn:ln};UPNG.quantize.planeDst=function(est,r,g,b2,a){var e=est.e;return e[0]*r+e[1]*g+e[2]*b2+e[3]*a-est.eMq};UPNG.quantize.dist=function(q,r,g,b2,a){var d0=r-q[0],d1=g-q[1],d2=b2-q[2],d3=a-q[3];return d0*d0+d1*d1+d2*d2+d3*d3};UPNG.quantize.splitPixels=function(nimg,nimg32,i0,i1,e,eMq){var vecDot=UPNG.quantize.vecDot;i1-=4;var shfs=0;while(i0<i1){while(vecDot(nimg,i0,e)<=eMq)i0+=4;while(vecDot(nimg,i1,e)>eMq)i1-=4;if(i0>=i1)break;var t2=nimg32[i0>>2];nimg32[i0>>2]=nimg32[i1>>2],nimg32[i1>>2]=t2,i0+=4,i1-=4}while(vecDot(nimg,i0,e)>eMq)i0-=4;return i0+4};UPNG.quantize.vecDot=function(nimg,i3,e){return nimg[i3]*e[0]+nimg[i3+1]*e[1]+nimg[i3+2]*e[2]+nimg[i3+3]*e[3]};UPNG.quantize.stats=function(nimg,i0,i1){var R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,0],N=i1-i0>>2;for(var i3=i0;i3<i1;i3+=4){var r=nimg[i3]*0.00392156862745098,g=nimg[i3+1]*0.00392156862745098,b2=nimg[i3+2]*0.00392156862745098,a=nimg[i3+3]*0.00392156862745098;m[0]+=r,m[1]+=g,m[2]+=b2,m[3]+=a,R[0]+=r*r,R[1]+=r*g,R[2]+=r*b2,R[3]+=r*a,R[5]+=g*g,R[6]+=g*b2,R[7]+=g*a,R[10]+=b2*b2,R[11]+=b2*a,R[15]+=a*a}return R[4]=R[1],R[8]=R[2],R[9]=R[6],R[12]=R[3],R[13]=R[7],R[14]=R[11],{R,m,N}};UPNG.quantize.estats=function(stats){var{R,m,N}=stats,m0=m[0],m1=m[1],m2=m[2],m3=m[3],iN=N==0?0:1/N,Rj=[R[0]-m0*m0*iN,R[1]-m0*m1*iN,R[2]-m0*m2*iN,R[3]-m0*m3*iN,R[4]-m1*m0*iN,R[5]-m1*m1*iN,R[6]-m1*m2*iN,R[7]-m1*m3*iN,R[8]-m2*m0*iN,R[9]-m2*m1*iN,R[10]-m2*m2*iN,R[11]-m2*m3*iN,R[12]-m3*m0*iN,R[13]-m3*m1*iN,R[14]-m3*m2*iN,R[15]-m3*m3*iN],A=Rj,M=UPNG.M4,b2=[0.5,0.5,0.5,0.5],mi=0,tmi=0;if(N!=0)for(var i3=0;i3<10;i3++){if(b2=M.multVec(A,b2),tmi=Math.sqrt(M.dot(b2,b2)),b2=M.sml(1/tmi,b2),Math.abs(tmi-mi)<0.000000001)break;mi=tmi}var q=[m0*iN,m1*iN,m2*iN,m3*iN],eMq255=M.dot(M.sml(255,q),b2);return{Cov:Rj,q,e:b2,L:mi,eMq255,eMq:M.dot(b2,q),rgba:(Math.round(255*q[3])<<24|Math.round(255*q[2])<<16|Math.round(255*q[1])<<8|Math.round(255*q[0])<<0)>>>0}};UPNG.M4={multVec:function(m,v){return[m[0]*v[0]+m[1]*v[1]+m[2]*v[2]+m[3]*v[3],m[4]*v[0]+m[5]*v[1]+m[6]*v[2]+m[7]*v[3],m[8]*v[0]+m[9]*v[1]+m[10]*v[2]+m[11]*v[3],m[12]*v[0]+m[13]*v[1]+m[14]*v[2]+m[15]*v[3]]},dot:function(x,y){return x[0]*y[0]+x[1]*y[1]+x[2]*y[2]+x[3]*y[3]},sml:function(a,y){return[a*y[0],a*y[1],a*y[2],a*y[3]]}};UPNG.encode.concatRGBA=function(bufs){var tlen=0;for(var i3=0;i3<bufs.length;i3++)tlen+=bufs[i3].byteLength;var nimg=new Uint8Array(tlen),noff=0;for(var i3=0;i3<bufs.length;i3++){var img=new Uint8Array(bufs[i3]),il=img.length;for(var j=0;j<il;j+=4){var r=img[j],g=img[j+1],b2=img[j+2],a=img[j+3];if(a==0)r=g=b2=0;nimg[noff+j]=r,nimg[noff+j+1]=g,nimg[noff+j+2]=b2,nimg[noff+j+3]=a}noff+=il}return nimg.buffer};var UPNG_default=UPNG;var getImageType=function(ctype){if(ctype===0)return PngType.Greyscale;if(ctype===2)return PngType.Truecolour;if(ctype===3)return PngType.IndexedColour;if(ctype===4)return PngType.GreyscaleWithAlpha;if(ctype===6)return PngType.TruecolourWithAlpha;throw new Error("Unknown color type: "+ctype)},splitAlphaChannel=function(rgbaChannel){var pixelCount=Math.floor(rgbaChannel.length/4),rgbChannel=new Uint8Array(pixelCount*3),alphaChannel=new Uint8Array(pixelCount*1),rgbaOffset=0,rgbOffset=0,alphaOffset=0;while(rgbaOffset<rgbaChannel.length)rgbChannel[rgbOffset++]=rgbaChannel[rgbaOffset++],rgbChannel[rgbOffset++]=rgbaChannel[rgbaOffset++],rgbChannel[rgbOffset++]=rgbaChannel[rgbaOffset++],alphaChannel[alphaOffset++]=rgbaChannel[rgbaOffset++];return{rgbChannel,alphaChannel}},PngType;(function(PngType2){PngType2.Greyscale="Greyscale",PngType2.Truecolour="Truecolour",PngType2.IndexedColour="IndexedColour",PngType2.GreyscaleWithAlpha="GreyscaleWithAlpha",PngType2.TruecolourWithAlpha="TruecolourWithAlpha"})(PngType||(PngType={}));var PNG=function(){function PNG2(pngData){var upng=UPNG_default.decode(pngData),frames=UPNG_default.toRGBA8(upng);if(frames.length>1)throw new Error("Animated PNGs are not supported");var frame=new Uint8Array(frames[0]),_a=splitAlphaChannel(frame),rgbChannel=_a.rgbChannel,alphaChannel=_a.alphaChannel;this.rgbChannel=rgbChannel;var hasAlphaValues=alphaChannel.some(function(a){return a<255});if(hasAlphaValues)this.alphaChannel=alphaChannel;this.type=getImageType(upng.ctype),this.width=upng.width,this.height=upng.height,this.bitsPerComponent=8}return PNG2.load=function(pngData){return new PNG2(pngData)},PNG2}();var PngEmbedder=function(){function PngEmbedder2(png){this.image=png,this.bitsPerComponent=png.bitsPerComponent,this.width=png.width,this.height=png.height,this.colorSpace="DeviceRGB"}return PngEmbedder2.for=function(imageData){return __awaiter(this,void 0,void 0,function(){var png;return __generator(this,function(_a){return png=PNG.load(imageData),[2,new PngEmbedder2(png)]})})},PngEmbedder2.prototype.embedIntoContext=function(context,ref){return __awaiter(this,void 0,void 0,function(){var SMask,xObject;return __generator(this,function(_a){if(SMask=this.embedAlphaChannel(context),xObject=context.flateStream(this.image.rgbChannel,{Type:"XObject",Subtype:"Image",BitsPerComponent:this.image.bitsPerComponent,Width:this.image.width,Height:this.image.height,ColorSpace:this.colorSpace,SMask}),ref)return context.assign(ref,xObject),[2,ref];else return[2,context.register(xObject)];return[2]})})},PngEmbedder2.prototype.embedAlphaChannel=function(context){if(!this.image.alphaChannel)return;var xObject=context.flateStream(this.image.alphaChannel,{Type:"XObject",Subtype:"Image",Height:this.image.height,Width:this.image.width,BitsPerComponent:this.image.bitsPerComponent,ColorSpace:"DeviceGray",Decode:[0,1]});return context.register(xObject)},PngEmbedder2}(),PngEmbedder_default=PngEmbedder;var Stream3=function(){function Stream4(buffer2,start,length){this.bytes=buffer2,this.start=start||0,this.pos=this.start,this.end=!!start&&!!length?start+length:this.bytes.length}return Object.defineProperty(Stream4.prototype,"length",{get:function(){return this.end-this.start},enumerable:!1,configurable:!0}),Object.defineProperty(Stream4.prototype,"isEmpty",{get:function(){return this.length===0},enumerable:!1,configurable:!0}),Stream4.prototype.getByte=function(){if(this.pos>=this.end)return-1;return this.bytes[this.pos++]},Stream4.prototype.getUint16=function(){var b0=this.getByte(),b1=this.getByte();if(b0===-1||b1===-1)return-1;return(b0<<8)+b1},Stream4.prototype.getInt32=function(){var b0=this.getByte(),b1=this.getByte(),b2=this.getByte(),b3=this.getByte();return(b0<<24)+(b1<<16)+(b2<<8)+b3},Stream4.prototype.getBytes=function(length,forceClamped){if(forceClamped===void 0)forceClamped=!1;var bytes=this.bytes,pos=this.pos,strEnd=this.end;if(!length){var subarray=bytes.subarray(pos,strEnd);return forceClamped?new Uint8ClampedArray(subarray):subarray}else{var end=pos+length;if(end>strEnd)end=strEnd;this.pos=end;var subarray=bytes.subarray(pos,end);return forceClamped?new Uint8ClampedArray(subarray):subarray}},Stream4.prototype.peekByte=function(){var peekedByte=this.getByte();return this.pos--,peekedByte},Stream4.prototype.peekBytes=function(length,forceClamped){if(forceClamped===void 0)forceClamped=!1;var bytes=this.getBytes(length,forceClamped);return this.pos-=bytes.length,bytes},Stream4.prototype.skip=function(n){if(!n)n=1;this.pos+=n},Stream4.prototype.reset=function(){this.pos=this.start},Stream4.prototype.moveStart=function(){this.start=this.pos},Stream4.prototype.makeSubStream=function(start,length){return new Stream4(this.bytes,start,length)},Stream4.prototype.decode=function(){return this.bytes},Stream4}(),Stream_default=Stream3;var emptyBuffer=new Uint8Array(0),DecodeStream=function(){function DecodeStream2(maybeMinBufferLength){if(this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=emptyBuffer,this.minBufferLength=512,maybeMinBufferLength)while(this.minBufferLength<maybeMinBufferLength)this.minBufferLength*=2}return Object.defineProperty(DecodeStream2.prototype,"isEmpty",{get:function(){while(!this.eof&&this.bufferLength===0)this.readBlock();return this.bufferLength===0},enumerable:!1,configurable:!0}),DecodeStream2.prototype.getByte=function(){var pos=this.pos;while(this.bufferLength<=pos){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]},DecodeStream2.prototype.getUint16=function(){var b0=this.getByte(),b1=this.getByte();if(b0===-1||b1===-1)return-1;return(b0<<8)+b1},DecodeStream2.prototype.getInt32=function(){var b0=this.getByte(),b1=this.getByte(),b2=this.getByte(),b3=this.getByte();return(b0<<24)+(b1<<16)+(b2<<8)+b3},DecodeStream2.prototype.getBytes=function(length,forceClamped){if(forceClamped===void 0)forceClamped=!1;var end,pos=this.pos;if(length){this.ensureBuffer(pos+length),end=pos+length;while(!this.eof&&this.bufferLength<end)this.readBlock();var bufEnd=this.bufferLength;if(end>bufEnd)end=bufEnd}else{while(!this.eof)this.readBlock();end=this.bufferLength}this.pos=end;var subarray=this.buffer.subarray(pos,end);return forceClamped&&!(subarray instanceof Uint8ClampedArray)?new Uint8ClampedArray(subarray):subarray},DecodeStream2.prototype.peekByte=function(){var peekedByte=this.getByte();return this.pos--,peekedByte},DecodeStream2.prototype.peekBytes=function(length,forceClamped){if(forceClamped===void 0)forceClamped=!1;var bytes=this.getBytes(length,forceClamped);return this.pos-=bytes.length,bytes},DecodeStream2.prototype.skip=function(n){if(!n)n=1;this.pos+=n},DecodeStream2.prototype.reset=function(){this.pos=0},DecodeStream2.prototype.makeSubStream=function(start,length){var end=start+length;while(this.bufferLength<=end&&!this.eof)this.readBlock();return new Stream_default(this.buffer,start,length)},DecodeStream2.prototype.decode=function(){while(!this.eof)this.readBlock();return this.buffer.subarray(0,this.bufferLength)},DecodeStream2.prototype.readBlock=function(){throw new MethodNotImplementedError(this.constructor.name,"readBlock")},DecodeStream2.prototype.ensureBuffer=function(requested){var buffer2=this.buffer;if(requested<=buffer2.byteLength)return buffer2;var size=this.minBufferLength;while(size<requested)size*=2;var buffer22=new Uint8Array(size);return buffer22.set(buffer2),this.buffer=buffer22},DecodeStream2}(),DecodeStream_default=DecodeStream;var isSpace=function(ch){return ch===32||ch===9||ch===13||ch===10},Ascii85Stream=function(_super){__extends(Ascii85Stream2,_super);function Ascii85Stream2(stream,maybeLength){var _this=_super.call(this,maybeLength)||this;if(_this.stream=stream,_this.input=new Uint8Array(5),maybeLength)maybeLength=0.8*maybeLength;return _this}return Ascii85Stream2.prototype.readBlock=function(){var TILDA_CHAR=126,Z_LOWER_CHAR=122,EOF=-1,stream=this.stream,c=stream.getByte();while(isSpace(c))c=stream.getByte();if(c===EOF||c===TILDA_CHAR){this.eof=!0;return}var bufferLength=this.bufferLength,buffer2,i3;if(c===Z_LOWER_CHAR){buffer2=this.ensureBuffer(bufferLength+4);for(i3=0;i3<4;++i3)buffer2[bufferLength+i3]=0;this.bufferLength+=4}else{var input=this.input;input[0]=c;for(i3=1;i3<5;++i3){c=stream.getByte();while(isSpace(c))c=stream.getByte();if(input[i3]=c,c===EOF||c===TILDA_CHAR)break}if(buffer2=this.ensureBuffer(bufferLength+i3-1),this.bufferLength+=i3-1,i3<5){for(;i3<5;++i3)input[i3]=117;this.eof=!0}var t2=0;for(i3=0;i3<5;++i3)t2=t2*85+(input[i3]-33);for(i3=3;i3>=0;--i3)buffer2[bufferLength+i3]=t2&255,t2>>=8}},Ascii85Stream2}(DecodeStream_default),Ascii85Stream_default=Ascii85Stream;var AsciiHexStream=function(_super){__extends(AsciiHexStream2,_super);function AsciiHexStream2(stream,maybeLength){var _this=_super.call(this,maybeLength)||this;if(_this.stream=stream,_this.firstDigit=-1,maybeLength)maybeLength=0.5*maybeLength;return _this}return AsciiHexStream2.prototype.readBlock=function(){var UPSTREAM_BLOCK_SIZE=8000,bytes=this.stream.getBytes(UPSTREAM_BLOCK_SIZE);if(!bytes.length){this.eof=!0;return}var maxDecodeLength=bytes.length+1>>1,buffer2=this.ensureBuffer(this.bufferLength+maxDecodeLength),bufferLength=this.bufferLength,firstDigit=this.firstDigit;for(var i3=0,ii=bytes.length;i3<ii;i3++){var ch=bytes[i3],digit=void 0;if(ch>=48&&ch<=57)digit=ch&15;else if(ch>=65&&ch<=70||ch>=97&&ch<=102)digit=(ch&15)+9;else if(ch===62){this.eof=!0;break}else continue;if(firstDigit<0)firstDigit=digit;else buffer2[bufferLength++]=firstDigit<<4|digit,firstDigit=-1}if(firstDigit>=0&&this.eof)buffer2[bufferLength++]=firstDigit<<4,firstDigit=-1;this.firstDigit=firstDigit,this.bufferLength=bufferLength},AsciiHexStream2}(DecodeStream_default),AsciiHexStream_default=AsciiHexStream;var codeLenCodeMap=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lengthDecode=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),distDecode=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),fixedLitCodeTab=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,590000,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],fixedDistCodeTab=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5],FlateStream=function(_super){__extends(FlateStream2,_super);function FlateStream2(stream,maybeLength){var _this=_super.call(this,maybeLength)||this;_this.stream=stream;var cmf=stream.getByte(),flg=stream.getByte();if(cmf===-1||flg===-1)throw new Error("Invalid header in flate stream: "+cmf+", "+flg);if((cmf&15)!==8)throw new Error("Unknown compression method in flate stream: "+cmf+", "+flg);if(((cmf<<8)+flg)%31!==0)throw new Error("Bad FCHECK in flate stream: "+cmf+", "+flg);if(flg&32)throw new Error("FDICT bit set in flate stream: "+cmf+", "+flg);return _this.codeSize=0,_this.codeBuf=0,_this}return FlateStream2.prototype.readBlock=function(){var buffer2,len2,str=this.stream,hdr=this.getBits(3);if(hdr&1)this.eof=!0;if(hdr>>=1,hdr===0){var b2=void 0;if((b2=str.getByte())===-1)throw new Error("Bad block header in flate stream");var blockLen=b2;if((b2=str.getByte())===-1)throw new Error("Bad block header in flate stream");if(blockLen|=b2<<8,(b2=str.getByte())===-1)throw new Error("Bad block header in flate stream");var check2=b2;if((b2=str.getByte())===-1)throw new Error("Bad block header in flate stream");if(check2|=b2<<8,check2!==(~blockLen&65535)&&(blockLen!==0||check2!==0))throw new Error("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;var bufferLength=this.bufferLength;buffer2=this.ensureBuffer(bufferLength+blockLen);var end=bufferLength+blockLen;if(this.bufferLength=end,blockLen===0){if(str.peekByte()===-1)this.eof=!0}else for(var n=bufferLength;n<end;++n){if((b2=str.getByte())===-1){this.eof=!0;break}buffer2[n]=b2}return}var litCodeTable,distCodeTable;if(hdr===1)litCodeTable=fixedLitCodeTab,distCodeTable=fixedDistCodeTab;else if(hdr===2){var numLitCodes=this.getBits(5)+257,numDistCodes=this.getBits(5)+1,numCodeLenCodes=this.getBits(4)+4,codeLenCodeLengths=new Uint8Array(codeLenCodeMap.length),i3=void 0;for(i3=0;i3<numCodeLenCodes;++i3)codeLenCodeLengths[codeLenCodeMap[i3]]=this.getBits(3);var codeLenCodeTab=this.generateHuffmanTable(codeLenCodeLengths);len2=0,i3=0;var codes=numLitCodes+numDistCodes,codeLengths=new Uint8Array(codes),bitsLength=void 0,bitsOffset=void 0,what=void 0;while(i3<codes){var code=this.getCode(codeLenCodeTab);if(code===16)bitsLength=2,bitsOffset=3,what=len2;else if(code===17)bitsLength=3,bitsOffset=3,what=len2=0;else if(code===18)bitsLength=7,bitsOffset=11,what=len2=0;else{codeLengths[i3++]=len2=code;continue}var repeatLength=this.getBits(bitsLength)+bitsOffset;while(repeatLength-- >0)codeLengths[i3++]=what}litCodeTable=this.generateHuffmanTable(codeLengths.subarray(0,numLitCodes)),distCodeTable=this.generateHuffmanTable(codeLengths.subarray(numLitCodes,codes))}else throw new Error("Unknown block type in flate stream");buffer2=this.buffer;var limit=buffer2?buffer2.length:0,pos=this.bufferLength;while(!0){var code1=this.getCode(litCodeTable);if(code1<256){if(pos+1>=limit)buffer2=this.ensureBuffer(pos+1),limit=buffer2.length;buffer2[pos++]=code1;continue}if(code1===256){this.bufferLength=pos;return}code1-=257,code1=lengthDecode[code1];var code2=code1>>16;if(code2>0)code2=this.getBits(code2);if(len2=(code1&65535)+code2,code1=this.getCode(distCodeTable),code1=distDecode[code1],code2=code1>>16,code2>0)code2=this.getBits(code2);var dist=(code1&65535)+code2;if(pos+len2>=limit)buffer2=this.ensureBuffer(pos+len2),limit=buffer2.length;for(var k2=0;k2<len2;++k2,++pos)buffer2[pos]=buffer2[pos-dist]}},FlateStream2.prototype.getBits=function(bits){var str=this.stream,codeSize=this.codeSize,codeBuf=this.codeBuf,b2;while(codeSize<bits){if((b2=str.getByte())===-1)throw new Error("Bad encoding in flate stream");codeBuf|=b2<<codeSize,codeSize+=8}return b2=codeBuf&(1<<bits)-1,this.codeBuf=codeBuf>>bits,this.codeSize=codeSize-=bits,b2},FlateStream2.prototype.getCode=function(table){var str=this.stream,codes=table[0],maxLen=table[1],codeSize=this.codeSize,codeBuf=this.codeBuf,b2;while(codeSize<maxLen){if((b2=str.getByte())===-1)break;codeBuf|=b2<<codeSize,codeSize+=8}var code=codes[codeBuf&(1<<maxLen)-1];if(typeof codes==="number")console.log("FLATE:",code);var codeLen=code>>16,codeVal=code&65535;if(codeLen<1||codeSize<codeLen)throw new Error("Bad encoding in flate stream");return this.codeBuf=codeBuf>>codeLen,this.codeSize=codeSize-codeLen,codeVal},FlateStream2.prototype.generateHuffmanTable=function(lengths){var n=lengths.length,maxLen=0,i3;for(i3=0;i3<n;++i3)if(lengths[i3]>maxLen)maxLen=lengths[i3];var size=1<<maxLen,codes=new Int32Array(size);for(var len2=1,code=0,skip=2;len2<=maxLen;++len2,code<<=1,skip<<=1)for(var val=0;val<n;++val)if(lengths[val]===len2){var code2=0,t2=code;for(i3=0;i3<len2;++i3)code2=code2<<1|t2&1,t2>>=1;for(i3=code2;i3<size;i3+=skip)codes[i3]=len2<<16|val;++code}return[codes,maxLen]},FlateStream2}(DecodeStream_default),FlateStream_default=FlateStream;var LZWStream=function(_super){__extends(LZWStream2,_super);function LZWStream2(stream,maybeLength,earlyChange){var _this=_super.call(this,maybeLength)||this;_this.stream=stream,_this.cachedData=0,_this.bitsCached=0;var maxLzwDictionarySize=4096,lzwState={earlyChange,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(maxLzwDictionarySize),dictionaryLengths:new Uint16Array(maxLzwDictionarySize),dictionaryPrevCodes:new Uint16Array(maxLzwDictionarySize),currentSequence:new Uint8Array(maxLzwDictionarySize),currentSequenceLength:0};for(var i3=0;i3<256;++i3)lzwState.dictionaryValues[i3]=i3,lzwState.dictionaryLengths[i3]=1;return _this.lzwState=lzwState,_this}return LZWStream2.prototype.readBlock=function(){var blockSize=512,estimatedDecodedSize=blockSize*2,decodedSizeDelta=blockSize,i3,j,q,lzwState=this.lzwState;if(!lzwState)return;var{earlyChange,nextCode,dictionaryValues,dictionaryLengths,dictionaryPrevCodes,codeLength,prevCode,currentSequence,currentSequenceLength}=lzwState,decodedLength=0,currentBufferLength=this.bufferLength,buffer2=this.ensureBuffer(this.bufferLength+estimatedDecodedSize);for(i3=0;i3<blockSize;i3++){var code=this.readBits(codeLength),hasPrev=currentSequenceLength>0;if(!code||code<256)currentSequence[0]=code,currentSequenceLength=1;else if(code>=258)if(code<nextCode){currentSequenceLength=dictionaryLengths[code];for(j=currentSequenceLength-1,q=code;j>=0;j--)currentSequence[j]=dictionaryValues[q],q=dictionaryPrevCodes[q]}else currentSequence[currentSequenceLength++]=currentSequence[0];else if(code===256){codeLength=9,nextCode=258,currentSequenceLength=0;continue}else{this.eof=!0,delete this.lzwState;break}if(hasPrev)dictionaryPrevCodes[nextCode]=prevCode,dictionaryLengths[nextCode]=dictionaryLengths[prevCode]+1,dictionaryValues[nextCode]=currentSequence[0],nextCode++,codeLength=nextCode+earlyChange&nextCode+earlyChange-1?codeLength:Math.min(Math.log(nextCode+earlyChange)/0.6931471805599453+1,12)|0;if(prevCode=code,decodedLength+=currentSequenceLength,estimatedDecodedSize<decodedLength){do estimatedDecodedSize+=decodedSizeDelta;while(estimatedDecodedSize<decodedLength);buffer2=this.ensureBuffer(this.bufferLength+estimatedDecodedSize)}for(j=0;j<currentSequenceLength;j++)buffer2[currentBufferLength++]=currentSequence[j]}lzwState.nextCode=nextCode,lzwState.codeLength=codeLength,lzwState.prevCode=prevCode,lzwState.currentSequenceLength=currentSequenceLength,this.bufferLength=currentBufferLength},LZWStream2.prototype.readBits=function(n){var bitsCached=this.bitsCached,cachedData=this.cachedData;while(bitsCached<n){var c=this.stream.getByte();if(c===-1)return this.eof=!0,null;cachedData=cachedData<<8|c,bitsCached+=8}return this.bitsCached=bitsCached-=n,this.cachedData=cachedData,cachedData>>>bitsCached&(1<<n)-1},LZWStream2}(DecodeStream_default),LZWStream_default=LZWStream;var RunLengthStream=function(_super){__extends(RunLengthStream2,_super);function RunLengthStream2(stream,maybeLength){var _this=_super.call(this,maybeLength)||this;return _this.stream=stream,_this}return RunLengthStream2.prototype.readBlock=function(){var repeatHeader=this.stream.getBytes(2);if(!repeatHeader||repeatHeader.length<2||repeatHeader[0]===128){this.eof=!0;return}var buffer2,bufferLength=this.bufferLength,n=repeatHeader[0];if(n<128){if(buffer2=this.ensureBuffer(bufferLength+n+1),buffer2[bufferLength++]=repeatHeader[1],n>0){var source=this.stream.getBytes(n);buffer2.set(source,bufferLength),bufferLength+=n}}else{n=257-n;var b2=repeatHeader[1];buffer2=this.ensureBuffer(bufferLength+n+1);for(var i3=0;i3<n;i3++)buffer2[bufferLength++]=b2}this.bufferLength=bufferLength},RunLengthStream2}(DecodeStream_default),RunLengthStream_default=RunLengthStream;var decodeStream=function(stream,encoding,params){if(encoding===PDFName_default.of("FlateDecode"))return new FlateStream_default(stream);if(encoding===PDFName_default.of("LZWDecode")){var earlyChange=1;if(params instanceof PDFDict_default){var EarlyChange=params.lookup(PDFName_default.of("EarlyChange"));if(EarlyChange instanceof PDFNumber_default)earlyChange=EarlyChange.asNumber()}return new LZWStream_default(stream,void 0,earlyChange)}if(encoding===PDFName_default.of("ASCII85Decode"))return new Ascii85Stream_default(stream);if(encoding===PDFName_default.of("ASCIIHexDecode"))return new AsciiHexStream_default(stream);if(encoding===PDFName_default.of("RunLengthDecode"))return new RunLengthStream_default(stream);throw new UnsupportedEncodingError(encoding.asString())},decodePDFRawStream=function(_a){var{dict,contents}=_a,stream=new Stream_default(contents),Filter=dict.lookup(PDFName_default.of("Filter")),DecodeParms=dict.lookup(PDFName_default.of("DecodeParms"));if(Filter instanceof PDFName_default)stream=decodeStream(stream,Filter,DecodeParms);else if(Filter instanceof PDFArray_default)for(var idx3=0,len2=Filter.size();idx3<len2;idx3++)stream=decodeStream(stream,Filter.lookup(idx3,PDFName_default),DecodeParms&&DecodeParms.lookupMaybe(idx3,PDFDict_default));else if(Filter)throw new UnexpectedObjectTypeError([PDFName_default,PDFArray_default],Filter);return stream};var fullPageBoundingBox=function(page){var mediaBox=page.MediaBox(),width=mediaBox.lookup(2,PDFNumber_default).asNumber()-mediaBox.lookup(0,PDFNumber_default).asNumber(),height=mediaBox.lookup(3,PDFNumber_default).asNumber()-mediaBox.lookup(1,PDFNumber_default).asNumber();return{left:0,bottom:0,right:width,top:height}},boundingBoxAdjustedMatrix=function(bb){return[1,0,0,1,-bb.left,-bb.bottom]},PDFPageEmbedder=function(){function PDFPageEmbedder2(page,boundingBox,transformationMatrix){this.page=page;var bb=boundingBox!==null&&boundingBox!==void 0?boundingBox:fullPageBoundingBox(page);this.width=bb.right-bb.left,this.height=bb.top-bb.bottom,this.boundingBox=bb,this.transformationMatrix=transformationMatrix!==null&&transformationMatrix!==void 0?transformationMatrix:boundingBoxAdjustedMatrix(bb)}return PDFPageEmbedder2.for=function(page,boundingBox,transformationMatrix){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,new PDFPageEmbedder2(page,boundingBox,transformationMatrix)]})})},PDFPageEmbedder2.prototype.embedIntoContext=function(context,ref){return __awaiter(this,void 0,void 0,function(){var _a,Contents,Resources,decodedContents,_b,left,bottom,right,top,xObject;return __generator(this,function(_c){if(_a=this.page.normalizedEntries(),Contents=_a.Contents,Resources=_a.Resources,!Contents)throw new MissingPageContentsEmbeddingError;if(decodedContents=this.decodeContents(Contents),_b=this.boundingBox,left=_b.left,bottom=_b.bottom,right=_b.right,top=_b.top,xObject=context.flateStream(decodedContents,{Type:"XObject",Subtype:"Form",FormType:1,BBox:[left,bottom,right,top],Matrix:this.transformationMatrix,Resources}),ref)return context.assign(ref,xObject),[2,ref];else return[2,context.register(xObject)];return[2]})})},PDFPageEmbedder2.prototype.decodeContents=function(contents){var newline=Uint8Array.of(CharCodes_default.Newline),decodedContents=[];for(var idx3=0,len2=contents.size();idx3<len2;idx3++){var stream=contents.lookup(idx3,PDFStream_default),content=void 0;if(stream instanceof PDFRawStream_default)content=decodePDFRawStream(stream).decode();else if(stream instanceof PDFContentStream_default)content=stream.getUnencodedContents();else throw new UnrecognizedStreamTypeError(stream);decodedContents.push(content,newline)}return mergeIntoTypedArray.apply(void 0,decodedContents)},PDFPageEmbedder2}(),PDFPageEmbedder_default=PDFPageEmbedder;var asEnum=function(rawValue,enumType){if(rawValue===void 0)return;return enumType[rawValue]},NonFullScreenPageMode;(function(NonFullScreenPageMode2){NonFullScreenPageMode2.UseNone="UseNone",NonFullScreenPageMode2.UseOutlines="UseOutlines",NonFullScreenPageMode2.UseThumbs="UseThumbs",NonFullScreenPageMode2.UseOC="UseOC"})(NonFullScreenPageMode||(NonFullScreenPageMode={}));var ReadingDirection;(function(ReadingDirection2){ReadingDirection2.L2R="L2R",ReadingDirection2.R2L="R2L"})(ReadingDirection||(ReadingDirection={}));var PrintScaling;(function(PrintScaling2){PrintScaling2.None="None",PrintScaling2.AppDefault="AppDefault"})(PrintScaling||(PrintScaling={}));var Duplex;(function(Duplex2){Duplex2.Simplex="Simplex",Duplex2.DuplexFlipShortEdge="DuplexFlipShortEdge",Duplex2.DuplexFlipLongEdge="DuplexFlipLongEdge"})(Duplex||(Duplex={}));var ViewerPreferences=function(){function ViewerPreferences2(dict){this.dict=dict}return ViewerPreferences2.prototype.lookupBool=function(key){var returnObj=this.dict.lookup(PDFName_default.of(key));if(returnObj instanceof PDFBool_default)return returnObj;return},ViewerPreferences2.prototype.lookupName=function(key){var returnObj=this.dict.lookup(PDFName_default.of(key));if(returnObj instanceof PDFName_default)return returnObj;return},ViewerPreferences2.prototype.HideToolbar=function(){return this.lookupBool("HideToolbar")},ViewerPreferences2.prototype.HideMenubar=function(){return this.lookupBool("HideMenubar")},ViewerPreferences2.prototype.HideWindowUI=function(){return this.lookupBool("HideWindowUI")},ViewerPreferences2.prototype.FitWindow=function(){return this.lookupBool("FitWindow")},ViewerPreferences2.prototype.CenterWindow=function(){return this.lookupBool("CenterWindow")},ViewerPreferences2.prototype.DisplayDocTitle=function(){return this.lookupBool("DisplayDocTitle")},ViewerPreferences2.prototype.NonFullScreenPageMode=function(){return this.lookupName("NonFullScreenPageMode")},ViewerPreferences2.prototype.Direction=function(){return this.lookupName("Direction")},ViewerPreferences2.prototype.PrintScaling=function(){return this.lookupName("PrintScaling")},ViewerPreferences2.prototype.Duplex=function(){return this.lookupName("Duplex")},ViewerPreferences2.prototype.PickTrayByPDFSize=function(){return this.lookupBool("PickTrayByPDFSize")},ViewerPreferences2.prototype.PrintPageRange=function(){var PrintPageRange=this.dict.lookup(PDFName_default.of("PrintPageRange"));if(PrintPageRange instanceof PDFArray_default)return PrintPageRange;return},ViewerPreferences2.prototype.NumCopies=function(){var NumCopies=this.dict.lookup(PDFName_default.of("NumCopies"));if(NumCopies instanceof PDFNumber_default)return NumCopies;return},ViewerPreferences2.prototype.getHideToolbar=function(){var _a,_b;return(_b=(_a=this.HideToolbar())===null||_a===void 0?void 0:_a.asBoolean())!==null&&_b!==void 0?_b:!1},ViewerPreferences2.prototype.getHideMenubar=function(){var _a,_b;return(_b=(_a=this.HideMenubar())===null||_a===void 0?void 0:_a.asBoolean())!==null&&_b!==void 0?_b:!1},ViewerPreferences2.prototype.getHideWindowUI=function(){var _a,_b;return(_b=(_a=this.HideWindowUI())===null||_a===void 0?void 0:_a.asBoolean())!==null&&_b!==void 0?_b:!1},ViewerPreferences2.prototype.getFitWindow=function(){var _a,_b;return(_b=(_a=this.FitWindow())===null||_a===void 0?void 0:_a.asBoolean())!==null&&_b!==void 0?_b:!1},ViewerPreferences2.prototype.getCenterWindow=function(){var _a,_b;return(_b=(_a=this.CenterWindow())===null||_a===void 0?void 0:_a.asBoolean())!==null&&_b!==void 0?_b:!1},ViewerPreferences2.prototype.getDisplayDocTitle=function(){var _a,_b;return(_b=(_a=this.DisplayDocTitle())===null||_a===void 0?void 0:_a.asBoolean())!==null&&_b!==void 0?_b:!1},ViewerPreferences2.prototype.getNonFullScreenPageMode=function(){var _a,_b,mode=(_a=this.NonFullScreenPageMode())===null||_a===void 0?void 0:_a.decodeText();return(_b=asEnum(mode,NonFullScreenPageMode))!==null&&_b!==void 0?_b:NonFullScreenPageMode.UseNone},ViewerPreferences2.prototype.getReadingDirection=function(){var _a,_b,direction=(_a=this.Direction())===null||_a===void 0?void 0:_a.decodeText();return(_b=asEnum(direction,ReadingDirection))!==null&&_b!==void 0?_b:ReadingDirection.L2R},ViewerPreferences2.prototype.getPrintScaling=function(){var _a,_b,scaling=(_a=this.PrintScaling())===null||_a===void 0?void 0:_a.decodeText();return(_b=asEnum(scaling,PrintScaling))!==null&&_b!==void 0?_b:PrintScaling.AppDefault},ViewerPreferences2.prototype.getDuplex=function(){var _a,duplex=(_a=this.Duplex())===null||_a===void 0?void 0:_a.decodeText();return asEnum(duplex,Duplex)},ViewerPreferences2.prototype.getPickTrayByPDFSize=function(){var _a;return(_a=this.PickTrayByPDFSize())===null||_a===void 0?void 0:_a.asBoolean()},ViewerPreferences2.prototype.getPrintPageRange=function(){var rng=this.PrintPageRange();if(!rng)return[];var pageRanges=[];for(var i3=0;i3<rng.size();i3+=2){var start=rng.lookup(i3,PDFNumber_default).asNumber(),end=rng.lookup(i3+1,PDFNumber_default).asNumber();pageRanges.push({start,end})}return pageRanges},ViewerPreferences2.prototype.getNumCopies=function(){var _a,_b;return(_b=(_a=this.NumCopies())===null||_a===void 0?void 0:_a.asNumber())!==null&&_b!==void 0?_b:1},ViewerPreferences2.prototype.setHideToolbar=function(hideToolbar){var HideToolbar=this.dict.context.obj(hideToolbar);this.dict.set(PDFName_default.of("HideToolbar"),HideToolbar)},ViewerPreferences2.prototype.setHideMenubar=function(hideMenubar){var HideMenubar=this.dict.context.obj(hideMenubar);this.dict.set(PDFName_default.of("HideMenubar"),HideMenubar)},ViewerPreferences2.prototype.setHideWindowUI=function(hideWindowUI){var HideWindowUI=this.dict.context.obj(hideWindowUI);this.dict.set(PDFName_default.of("HideWindowUI"),HideWindowUI)},ViewerPreferences2.prototype.setFitWindow=function(fitWindow){var FitWindow=this.dict.context.obj(fitWindow);this.dict.set(PDFName_default.of("FitWindow"),FitWindow)},ViewerPreferences2.prototype.setCenterWindow=function(centerWindow){var CenterWindow=this.dict.context.obj(centerWindow);this.dict.set(PDFName_default.of("CenterWindow"),CenterWindow)},ViewerPreferences2.prototype.setDisplayDocTitle=function(displayTitle){var DisplayDocTitle=this.dict.context.obj(displayTitle);this.dict.set(PDFName_default.of("DisplayDocTitle"),DisplayDocTitle)},ViewerPreferences2.prototype.setNonFullScreenPageMode=function(nonFullScreenPageMode){assertIsOneOf(nonFullScreenPageMode,"nonFullScreenPageMode",NonFullScreenPageMode);var mode=PDFName_default.of(nonFullScreenPageMode);this.dict.set(PDFName_default.of("NonFullScreenPageMode"),mode)},ViewerPreferences2.prototype.setReadingDirection=function(readingDirection){assertIsOneOf(readingDirection,"readingDirection",ReadingDirection);var direction=PDFName_default.of(readingDirection);this.dict.set(PDFName_default.of("Direction"),direction)},ViewerPreferences2.prototype.setPrintScaling=function(printScaling){assertIsOneOf(printScaling,"printScaling",PrintScaling);var scaling=PDFName_default.of(printScaling);this.dict.set(PDFName_default.of("PrintScaling"),scaling)},ViewerPreferences2.prototype.setDuplex=function(duplex){assertIsOneOf(duplex,"duplex",Duplex);var dup=PDFName_default.of(duplex);this.dict.set(PDFName_default.of("Duplex"),dup)},ViewerPreferences2.prototype.setPickTrayByPDFSize=function(pickTrayByPDFSize){var PickTrayByPDFSize=this.dict.context.obj(pickTrayByPDFSize);this.dict.set(PDFName_default.of("PickTrayByPDFSize"),PickTrayByPDFSize)},ViewerPreferences2.prototype.setPrintPageRange=function(printPageRange){if(!Array.isArray(printPageRange))printPageRange=[printPageRange];var flatRange=[];for(var idx3=0,len2=printPageRange.length;idx3<len2;idx3++)flatRange.push(printPageRange[idx3].start),flatRange.push(printPageRange[idx3].end);assertEachIs(flatRange,"printPageRange",["number"]);var pageRanges=this.dict.context.obj(flatRange);this.dict.set(PDFName_default.of("PrintPageRange"),pageRanges)},ViewerPreferences2.prototype.setNumCopies=function(numCopies){assertRange(numCopies,"numCopies",1,Number.MAX_VALUE),assertInteger(numCopies,"numCopies");var NumCopies=this.dict.context.obj(numCopies);this.dict.set(PDFName_default.of("NumCopies"),NumCopies)},ViewerPreferences2.fromDict=function(dict){return new ViewerPreferences2(dict)},ViewerPreferences2.create=function(context){var dict=context.obj({});return new ViewerPreferences2(dict)},ViewerPreferences2}(),ViewerPreferences_default=ViewerPreferences;var tfRegex=/\/([^\0\t\n\f\r\ ]+)[\0\t\n\f\r\ ]*(\d*\.\d+|\d+)?[\0\t\n\f\r\ ]+Tf/,PDFAcroField=function(){function PDFAcroField2(dict,ref){this.dict=dict,this.ref=ref}return PDFAcroField2.prototype.T=function(){return this.dict.lookupMaybe(PDFName_default.of("T"),PDFString_default,PDFHexString_default)},PDFAcroField2.prototype.Ff=function(){var numberOrRef=this.getInheritableAttribute(PDFName_default.of("Ff"));return this.dict.context.lookupMaybe(numberOrRef,PDFNumber_default)},PDFAcroField2.prototype.V=function(){var valueOrRef=this.getInheritableAttribute(PDFName_default.of("V"));return this.dict.context.lookup(valueOrRef)},PDFAcroField2.prototype.Kids=function(){return this.dict.lookupMaybe(PDFName_default.of("Kids"),PDFArray_default)},PDFAcroField2.prototype.DA=function(){var da=this.dict.lookup(PDFName_default.of("DA"));if(da instanceof PDFString_default||da instanceof PDFHexString_default)return da;return},PDFAcroField2.prototype.setKids=function(kids){this.dict.set(PDFName_default.of("Kids"),this.dict.context.obj(kids))},PDFAcroField2.prototype.getParent=function(){var parentRef=this.dict.get(PDFName_default.of("Parent"));if(parentRef instanceof PDFRef_default){var parent_1=this.dict.lookup(PDFName_default.of("Parent"),PDFDict_default);return new PDFAcroField2(parent_1,parentRef)}return},PDFAcroField2.prototype.setParent=function(parent){if(!parent)this.dict.delete(PDFName_default.of("Parent"));else this.dict.set(PDFName_default.of("Parent"),parent)},PDFAcroField2.prototype.getFullyQualifiedName=function(){var parent=this.getParent();if(!parent)return this.getPartialName();return parent.getFullyQualifiedName()+"."+this.getPartialName()},PDFAcroField2.prototype.getPartialName=function(){var _a;return(_a=this.T())===null||_a===void 0?void 0:_a.decodeText()},PDFAcroField2.prototype.setPartialName=function(partialName){if(!partialName)this.dict.delete(PDFName_default.of("T"));else this.dict.set(PDFName_default.of("T"),PDFHexString_default.fromText(partialName))},PDFAcroField2.prototype.setDefaultAppearance=function(appearance){this.dict.set(PDFName_default.of("DA"),PDFString_default.of(appearance))},PDFAcroField2.prototype.getDefaultAppearance=function(){var DA=this.DA();if(DA instanceof PDFHexString_default)return DA.decodeText();return DA===null||DA===void 0?void 0:DA.asString()},PDFAcroField2.prototype.setFontSize=function(fontSize){var _a,name=(_a=this.getFullyQualifiedName())!==null&&_a!==void 0?_a:"",da=this.getDefaultAppearance();if(!da)throw new MissingDAEntryError(name);var daMatch=findLastMatch(da,tfRegex);if(!daMatch.match)throw new MissingTfOperatorError(name);var daStart=da.slice(0,daMatch.pos-daMatch.match[0].length),daEnd=daMatch.pos<=da.length?da.slice(daMatch.pos):"",fontName=daMatch.match[1],modifiedDa=daStart+" /"+fontName+" "+fontSize+" Tf "+daEnd;this.setDefaultAppearance(modifiedDa)},PDFAcroField2.prototype.getFlags=function(){var _a,_b;return(_b=(_a=this.Ff())===null||_a===void 0?void 0:_a.asNumber())!==null&&_b!==void 0?_b:0},PDFAcroField2.prototype.setFlags=function(flags){this.dict.set(PDFName_default.of("Ff"),PDFNumber_default.of(flags))},PDFAcroField2.prototype.hasFlag=function(flag){var flags=this.getFlags();return(flags&flag)!==0},PDFAcroField2.prototype.setFlag=function(flag){var flags=this.getFlags();this.setFlags(flags|flag)},PDFAcroField2.prototype.clearFlag=function(flag){var flags=this.getFlags();this.setFlags(flags&~flag)},PDFAcroField2.prototype.setFlagTo=function(flag,enable){if(enable)this.setFlag(flag);else this.clearFlag(flag)},PDFAcroField2.prototype.getInheritableAttribute=function(name){var attribute;return this.ascend(function(node){if(!attribute)attribute=node.dict.get(name)}),attribute},PDFAcroField2.prototype.ascend=function(visitor){visitor(this);var parent=this.getParent();if(parent)parent.ascend(visitor)},PDFAcroField2}(),PDFAcroField_default=PDFAcroField;var BorderStyle=function(){function BorderStyle2(dict){this.dict=dict}return BorderStyle2.prototype.W=function(){var W=this.dict.lookup(PDFName_default.of("W"));if(W instanceof PDFNumber_default)return W;return},BorderStyle2.prototype.getWidth=function(){var _a,_b;return(_b=(_a=this.W())===null||_a===void 0?void 0:_a.asNumber())!==null&&_b!==void 0?_b:1},BorderStyle2.prototype.setWidth=function(width){var W=this.dict.context.obj(width);this.dict.set(PDFName_default.of("W"),W)},BorderStyle2.fromDict=function(dict){return new BorderStyle2(dict)},BorderStyle2}(),BorderStyle_default=BorderStyle;var PDFAnnotation=function(){function PDFAnnotation2(dict){this.dict=dict}return PDFAnnotation2.prototype.Rect=function(){return this.dict.lookup(PDFName_default.of("Rect"),PDFArray_default)},PDFAnnotation2.prototype.AP=function(){return this.dict.lookupMaybe(PDFName_default.of("AP"),PDFDict_default)},PDFAnnotation2.prototype.F=function(){var numberOrRef=this.dict.lookup(PDFName_default.of("F"));return this.dict.context.lookupMaybe(numberOrRef,PDFNumber_default)},PDFAnnotation2.prototype.getRectangle=function(){var _a,Rect=this.Rect();return(_a=Rect===null||Rect===void 0?void 0:Rect.asRectangle())!==null&&_a!==void 0?_a:{x:0,y:0,width:0,height:0}},PDFAnnotation2.prototype.setRectangle=function(rect){var{x,y,width,height}=rect,Rect=this.dict.context.obj([x,y,x+width,y+height]);this.dict.set(PDFName_default.of("Rect"),Rect)},PDFAnnotation2.prototype.getAppearanceState=function(){var AS=this.dict.lookup(PDFName_default.of("AS"));if(AS instanceof PDFName_default)return AS;return},PDFAnnotation2.prototype.setAppearanceState=function(state){this.dict.set(PDFName_default.of("AS"),state)},PDFAnnotation2.prototype.setAppearances=function(appearances){this.dict.set(PDFName_default.of("AP"),appearances)},PDFAnnotation2.prototype.ensureAP=function(){var AP=this.AP();if(!AP)AP=this.dict.context.obj({}),this.dict.set(PDFName_default.of("AP"),AP);return AP},PDFAnnotation2.prototype.getNormalAppearance=function(){var AP=this.ensureAP(),N=AP.get(PDFName_default.of("N"));if(N instanceof PDFRef_default||N instanceof PDFDict_default)return N;throw new Error("Unexpected N type: "+(N===null||N===void 0?void 0:N.constructor.name))},PDFAnnotation2.prototype.setNormalAppearance=function(appearance){var AP=this.ensureAP();AP.set(PDFName_default.of("N"),appearance)},PDFAnnotation2.prototype.setRolloverAppearance=function(appearance){var AP=this.ensureAP();AP.set(PDFName_default.of("R"),appearance)},PDFAnnotation2.prototype.setDownAppearance=function(appearance){var AP=this.ensureAP();AP.set(PDFName_default.of("D"),appearance)},PDFAnnotation2.prototype.removeRolloverAppearance=function(){var AP=this.AP();AP===null||AP===void 0||AP.delete(PDFName_default.of("R"))},PDFAnnotation2.prototype.removeDownAppearance=function(){var AP=this.AP();AP===null||AP===void 0||AP.delete(PDFName_default.of("D"))},PDFAnnotation2.prototype.getAppearances=function(){var AP=this.AP();if(!AP)return;var N=AP.lookup(PDFName_default.of("N"),PDFDict_default,PDFStream_default),R=AP.lookupMaybe(PDFName_default.of("R"),PDFDict_default,PDFStream_default),D=AP.lookupMaybe(PDFName_default.of("D"),PDFDict_default,PDFStream_default);return{normal:N,rollover:R,down:D}},PDFAnnotation2.prototype.getFlags=function(){var _a,_b;return(_b=(_a=this.F())===null||_a===void 0?void 0:_a.asNumber())!==null&&_b!==void 0?_b:0},PDFAnnotation2.prototype.setFlags=function(flags){this.dict.set(PDFName_default.of("F"),PDFNumber_default.of(flags))},PDFAnnotation2.prototype.hasFlag=function(flag){var flags=this.getFlags();return(flags&flag)!==0},PDFAnnotation2.prototype.setFlag=function(flag){var flags=this.getFlags();this.setFlags(flags|flag)},PDFAnnotation2.prototype.clearFlag=function(flag){var flags=this.getFlags();this.setFlags(flags&~flag)},PDFAnnotation2.prototype.setFlagTo=function(flag,enable){if(enable)this.setFlag(flag);else this.clearFlag(flag)},PDFAnnotation2.fromDict=function(dict){return new PDFAnnotation2(dict)},PDFAnnotation2}(),PDFAnnotation_default=PDFAnnotation;var AppearanceCharacteristics=function(){function AppearanceCharacteristics2(dict){this.dict=dict}return AppearanceCharacteristics2.prototype.R=function(){var R=this.dict.lookup(PDFName_default.of("R"));if(R instanceof PDFNumber_default)return R;return},AppearanceCharacteristics2.prototype.BC=function(){var BC=this.dict.lookup(PDFName_default.of("BC"));if(BC instanceof PDFArray_default)return BC;return},AppearanceCharacteristics2.prototype.BG=function(){var BG=this.dict.lookup(PDFName_default.of("BG"));if(BG instanceof PDFArray_default)return BG;return},AppearanceCharacteristics2.prototype.CA=function(){var CA=this.dict.lookup(PDFName_default.of("CA"));if(CA instanceof PDFHexString_default||CA instanceof PDFString_default)return CA;return},AppearanceCharacteristics2.prototype.RC=function(){var RC=this.dict.lookup(PDFName_default.of("RC"));if(RC instanceof PDFHexString_default||RC instanceof PDFString_default)return RC;return},AppearanceCharacteristics2.prototype.AC=function(){var AC=this.dict.lookup(PDFName_default.of("AC"));if(AC instanceof PDFHexString_default||AC instanceof PDFString_default)return AC;return},AppearanceCharacteristics2.prototype.getRotation=function(){var _a;return(_a=this.R())===null||_a===void 0?void 0:_a.asNumber()},AppearanceCharacteristics2.prototype.getBorderColor=function(){var BC=this.BC();if(!BC)return;var components=[];for(var idx3=0,len2=BC===null||BC===void 0?void 0:BC.size();idx3<len2;idx3++){var component=BC.get(idx3);if(component instanceof PDFNumber_default)components.push(component.asNumber())}return components},AppearanceCharacteristics2.prototype.getBackgroundColor=function(){var BG=this.BG();if(!BG)return;var components=[];for(var idx3=0,len2=BG===null||BG===void 0?void 0:BG.size();idx3<len2;idx3++){var component=BG.get(idx3);if(component instanceof PDFNumber_default)components.push(component.asNumber())}return components},AppearanceCharacteristics2.prototype.getCaptions=function(){var CA=this.CA(),RC=this.RC(),AC=this.AC();return{normal:CA===null||CA===void 0?void 0:CA.decodeText(),rollover:RC===null||RC===void 0?void 0:RC.decodeText(),down:AC===null||AC===void 0?void 0:AC.decodeText()}},AppearanceCharacteristics2.prototype.setRotation=function(rotation){var R=this.dict.context.obj(rotation);this.dict.set(PDFName_default.of("R"),R)},AppearanceCharacteristics2.prototype.setBorderColor=function(color){var BC=this.dict.context.obj(color);this.dict.set(PDFName_default.of("BC"),BC)},AppearanceCharacteristics2.prototype.setBackgroundColor=function(color){var BG=this.dict.context.obj(color);this.dict.set(PDFName_default.of("BG"),BG)},AppearanceCharacteristics2.prototype.setCaptions=function(captions){var CA=PDFHexString_default.fromText(captions.normal);if(this.dict.set(PDFName_default.of("CA"),CA),captions.rollover){var RC=PDFHexString_default.fromText(captions.rollover);this.dict.set(PDFName_default.of("RC"),RC)}else this.dict.delete(PDFName_default.of("RC"));if(captions.down){var AC=PDFHexString_default.fromText(captions.down);this.dict.set(PDFName_default.of("AC"),AC)}else this.dict.delete(PDFName_default.of("AC"))},AppearanceCharacteristics2.fromDict=function(dict){return new AppearanceCharacteristics2(dict)},AppearanceCharacteristics2}(),AppearanceCharacteristics_default=AppearanceCharacteristics;var PDFWidgetAnnotation=function(_super){__extends(PDFWidgetAnnotation2,_super);function PDFWidgetAnnotation2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFWidgetAnnotation2.prototype.MK=function(){var MK=this.dict.lookup(PDFName_default.of("MK"));if(MK instanceof PDFDict_default)return MK;return},PDFWidgetAnnotation2.prototype.BS=function(){var BS=this.dict.lookup(PDFName_default.of("BS"));if(BS instanceof PDFDict_default)return BS;return},PDFWidgetAnnotation2.prototype.DA=function(){var da=this.dict.lookup(PDFName_default.of("DA"));if(da instanceof PDFString_default||da instanceof PDFHexString_default)return da;return},PDFWidgetAnnotation2.prototype.P=function(){var P=this.dict.get(PDFName_default.of("P"));if(P instanceof PDFRef_default)return P;return},PDFWidgetAnnotation2.prototype.setP=function(page){this.dict.set(PDFName_default.of("P"),page)},PDFWidgetAnnotation2.prototype.setDefaultAppearance=function(appearance){this.dict.set(PDFName_default.of("DA"),PDFString_default.of(appearance))},PDFWidgetAnnotation2.prototype.getDefaultAppearance=function(){var DA=this.DA();if(DA instanceof PDFHexString_default)return DA.decodeText();return DA===null||DA===void 0?void 0:DA.asString()},PDFWidgetAnnotation2.prototype.getAppearanceCharacteristics=function(){var MK=this.MK();if(MK)return AppearanceCharacteristics_default.fromDict(MK);return},PDFWidgetAnnotation2.prototype.getOrCreateAppearanceCharacteristics=function(){var MK=this.MK();if(MK)return AppearanceCharacteristics_default.fromDict(MK);var ac=AppearanceCharacteristics_default.fromDict(this.dict.context.obj({}));return this.dict.set(PDFName_default.of("MK"),ac.dict),ac},PDFWidgetAnnotation2.prototype.getBorderStyle=function(){var BS=this.BS();if(BS)return BorderStyle_default.fromDict(BS);return},PDFWidgetAnnotation2.prototype.getOrCreateBorderStyle=function(){var BS=this.BS();if(BS)return BorderStyle_default.fromDict(BS);var bs=BorderStyle_default.fromDict(this.dict.context.obj({}));return this.dict.set(PDFName_default.of("BS"),bs.dict),bs},PDFWidgetAnnotation2.prototype.getOnValue=function(){var _a,normal=(_a=this.getAppearances())===null||_a===void 0?void 0:_a.normal;if(normal instanceof PDFDict_default){var keys=normal.keys();for(var idx3=0,len2=keys.length;idx3<len2;idx3++){var key=keys[idx3];if(key!==PDFName_default.of("Off"))return key}}return},PDFWidgetAnnotation2.fromDict=function(dict){return new PDFWidgetAnnotation2(dict)},PDFWidgetAnnotation2.create=function(context,parent){var dict=context.obj({Type:"Annot",Subtype:"Widget",Rect:[0,0,0,0],Parent:parent});return new PDFWidgetAnnotation2(dict)},PDFWidgetAnnotation2}(PDFAnnotation_default),PDFWidgetAnnotation_default=PDFWidgetAnnotation;var PDFAcroTerminal=function(_super){__extends(PDFAcroTerminal2,_super);function PDFAcroTerminal2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroTerminal2.prototype.FT=function(){var nameOrRef=this.getInheritableAttribute(PDFName_default.of("FT"));return this.dict.context.lookup(nameOrRef,PDFName_default)},PDFAcroTerminal2.prototype.getWidgets=function(){var kidDicts=this.Kids();if(!kidDicts)return[PDFWidgetAnnotation_default.fromDict(this.dict)];var widgets=new Array(kidDicts.size());for(var idx3=0,len2=kidDicts.size();idx3<len2;idx3++){var dict=kidDicts.lookup(idx3,PDFDict_default);widgets[idx3]=PDFWidgetAnnotation_default.fromDict(dict)}return widgets},PDFAcroTerminal2.prototype.addWidget=function(ref){var Kids=this.normalizedEntries().Kids;Kids.push(ref)},PDFAcroTerminal2.prototype.removeWidget=function(idx3){var kidDicts=this.Kids();if(!kidDicts){if(idx3!==0)throw new IndexOutOfBoundsError(idx3,0,0);this.setKids([])}else{if(idx3<0||idx3>kidDicts.size())throw new IndexOutOfBoundsError(idx3,0,kidDicts.size());kidDicts.remove(idx3)}},PDFAcroTerminal2.prototype.normalizedEntries=function(){var Kids=this.Kids();if(!Kids)Kids=this.dict.context.obj([this.ref]),this.dict.set(PDFName_default.of("Kids"),Kids);return{Kids}},PDFAcroTerminal2.fromDict=function(dict,ref){return new PDFAcroTerminal2(dict,ref)},PDFAcroTerminal2}(PDFAcroField_default),PDFAcroTerminal_default=PDFAcroTerminal;var PDFAcroButton=function(_super){__extends(PDFAcroButton2,_super);function PDFAcroButton2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroButton2.prototype.Opt=function(){return this.dict.lookupMaybe(PDFName_default.of("Opt"),PDFString_default,PDFHexString_default,PDFArray_default)},PDFAcroButton2.prototype.setOpt=function(opt){this.dict.set(PDFName_default.of("Opt"),this.dict.context.obj(opt))},PDFAcroButton2.prototype.getExportValues=function(){var opt=this.Opt();if(!opt)return;if(opt instanceof PDFString_default||opt instanceof PDFHexString_default)return[opt];var values3=[];for(var idx3=0,len2=opt.size();idx3<len2;idx3++){var value=opt.lookup(idx3);if(value instanceof PDFString_default||value instanceof PDFHexString_default)values3.push(value)}return values3},PDFAcroButton2.prototype.removeExportValue=function(idx3){var opt=this.Opt();if(!opt)return;if(opt instanceof PDFString_default||opt instanceof PDFHexString_default){if(idx3!==0)throw new IndexOutOfBoundsError(idx3,0,0);this.setOpt([])}else{if(idx3<0||idx3>opt.size())throw new IndexOutOfBoundsError(idx3,0,opt.size());opt.remove(idx3)}},PDFAcroButton2.prototype.normalizeExportValues=function(){var _a,_b,_c,_d,exportValues=(_a=this.getExportValues())!==null&&_a!==void 0?_a:[],Opt=[],widgets=this.getWidgets();for(var idx3=0,len2=widgets.length;idx3<len2;idx3++){var widget=widgets[idx3],exportVal=(_b=exportValues[idx3])!==null&&_b!==void 0?_b:PDFHexString_default.fromText((_d=(_c=widget.getOnValue())===null||_c===void 0?void 0:_c.decodeText())!==null&&_d!==void 0?_d:"");Opt.push(exportVal)}this.setOpt(Opt)},PDFAcroButton2.prototype.addOpt=function(opt,useExistingOptIdx){var _a;this.normalizeExportValues();var optText=opt.decodeText(),existingIdx;if(useExistingOptIdx){var exportValues=(_a=this.getExportValues())!==null&&_a!==void 0?_a:[];for(var idx3=0,len2=exportValues.length;idx3<len2;idx3++){var exportVal=exportValues[idx3];if(exportVal.decodeText()===optText)existingIdx=idx3}}var Opt=this.Opt();return Opt.push(opt),existingIdx!==null&&existingIdx!==void 0?existingIdx:Opt.size()-1},PDFAcroButton2.prototype.addWidgetWithOpt=function(widget,opt,useExistingOptIdx){var optIdx=this.addOpt(opt,useExistingOptIdx),apStateValue=PDFName_default.of(String(optIdx));return this.addWidget(widget),apStateValue},PDFAcroButton2}(PDFAcroTerminal_default),PDFAcroButton_default=PDFAcroButton;var PDFAcroCheckBox=function(_super){__extends(PDFAcroCheckBox2,_super);function PDFAcroCheckBox2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroCheckBox2.prototype.setValue=function(value){var _a,onValue=(_a=this.getOnValue())!==null&&_a!==void 0?_a:PDFName_default.of("Yes");if(value!==onValue&&value!==PDFName_default.of("Off"))throw new InvalidAcroFieldValueError;this.dict.set(PDFName_default.of("V"),value);var widgets=this.getWidgets();for(var idx3=0,len2=widgets.length;idx3<len2;idx3++){var widget=widgets[idx3],state=widget.getOnValue()===value?value:PDFName_default.of("Off");widget.setAppearanceState(state)}},PDFAcroCheckBox2.prototype.getValue=function(){var v=this.V();if(v instanceof PDFName_default)return v;return PDFName_default.of("Off")},PDFAcroCheckBox2.prototype.getOnValue=function(){var widget=this.getWidgets()[0];return widget===null||widget===void 0?void 0:widget.getOnValue()},PDFAcroCheckBox2.fromDict=function(dict,ref){return new PDFAcroCheckBox2(dict,ref)},PDFAcroCheckBox2.create=function(context){var dict=context.obj({FT:"Btn",Kids:[]}),ref=context.register(dict);return new PDFAcroCheckBox2(dict,ref)},PDFAcroCheckBox2}(PDFAcroButton_default),PDFAcroCheckBox_default=PDFAcroCheckBox;var flag=function(bitIndex){return 1<<bitIndex},AcroFieldFlags;(function(AcroFieldFlags2){AcroFieldFlags2[AcroFieldFlags2.ReadOnly=flag(0)]="ReadOnly",AcroFieldFlags2[AcroFieldFlags2.Required=flag(1)]="Required",AcroFieldFlags2[AcroFieldFlags2.NoExport=flag(2)]="NoExport"})(AcroFieldFlags||(AcroFieldFlags={}));var AcroButtonFlags;(function(AcroButtonFlags2){AcroButtonFlags2[AcroButtonFlags2.NoToggleToOff=flag(14)]="NoToggleToOff",AcroButtonFlags2[AcroButtonFlags2.Radio=flag(15)]="Radio",AcroButtonFlags2[AcroButtonFlags2.PushButton=flag(16)]="PushButton",AcroButtonFlags2[AcroButtonFlags2.RadiosInUnison=flag(25)]="RadiosInUnison"})(AcroButtonFlags||(AcroButtonFlags={}));var AcroTextFlags;(function(AcroTextFlags2){AcroTextFlags2[AcroTextFlags2.Multiline=flag(12)]="Multiline",AcroTextFlags2[AcroTextFlags2.Password=flag(13)]="Password",AcroTextFlags2[AcroTextFlags2.FileSelect=flag(20)]="FileSelect",AcroTextFlags2[AcroTextFlags2.DoNotSpellCheck=flag(22)]="DoNotSpellCheck",AcroTextFlags2[AcroTextFlags2.DoNotScroll=flag(23)]="DoNotScroll",AcroTextFlags2[AcroTextFlags2.Comb=flag(24)]="Comb",AcroTextFlags2[AcroTextFlags2.RichText=flag(25)]="RichText"})(AcroTextFlags||(AcroTextFlags={}));var AcroChoiceFlags;(function(AcroChoiceFlags2){AcroChoiceFlags2[AcroChoiceFlags2.Combo=flag(17)]="Combo",AcroChoiceFlags2[AcroChoiceFlags2.Edit=flag(18)]="Edit",AcroChoiceFlags2[AcroChoiceFlags2.Sort=flag(19)]="Sort",AcroChoiceFlags2[AcroChoiceFlags2.MultiSelect=flag(21)]="MultiSelect",AcroChoiceFlags2[AcroChoiceFlags2.DoNotSpellCheck=flag(22)]="DoNotSpellCheck",AcroChoiceFlags2[AcroChoiceFlags2.CommitOnSelChange=flag(26)]="CommitOnSelChange"})(AcroChoiceFlags||(AcroChoiceFlags={}));var PDFAcroChoice=function(_super){__extends(PDFAcroChoice2,_super);function PDFAcroChoice2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroChoice2.prototype.setValues=function(values3){if(this.hasFlag(AcroChoiceFlags.Combo)&&!this.hasFlag(AcroChoiceFlags.Edit)&&!this.valuesAreValid(values3))throw new InvalidAcroFieldValueError;if(values3.length===0)this.dict.delete(PDFName_default.of("V"));if(values3.length===1)this.dict.set(PDFName_default.of("V"),values3[0]);if(values3.length>1){if(!this.hasFlag(AcroChoiceFlags.MultiSelect))throw new MultiSelectValueError;this.dict.set(PDFName_default.of("V"),this.dict.context.obj(values3))}this.updateSelectedIndices(values3)},PDFAcroChoice2.prototype.valuesAreValid=function(values3){var options=this.getOptions(),_loop_1=function(idx4,len3){var val=values3[idx4].decodeText();if(!options.find(function(o){return val===(o.display||o.value).decodeText()}))return{value:!1}};for(var idx3=0,len2=values3.length;idx3<len2;idx3++){var state_1=_loop_1(idx3,len2);if(typeof state_1==="object")return state_1.value}return!0},PDFAcroChoice2.prototype.updateSelectedIndices=function(values3){if(values3.length>1){var indices=new Array(values3.length),options=this.getOptions(),_loop_2=function(idx4,len3){var val=values3[idx4].decodeText();indices[idx4]=options.findIndex(function(o){return val===(o.display||o.value).decodeText()})};for(var idx3=0,len2=values3.length;idx3<len2;idx3++)_loop_2(idx3,len2);this.dict.set(PDFName_default.of("I"),this.dict.context.obj(indices.sort()))}else this.dict.delete(PDFName_default.of("I"))},PDFAcroChoice2.prototype.getValues=function(){var v=this.V();if(v instanceof PDFString_default||v instanceof PDFHexString_default)return[v];if(v instanceof PDFArray_default){var values3=[];for(var idx3=0,len2=v.size();idx3<len2;idx3++){var value=v.lookup(idx3);if(value instanceof PDFString_default||value instanceof PDFHexString_default)values3.push(value)}return values3}return[]},PDFAcroChoice2.prototype.Opt=function(){return this.dict.lookupMaybe(PDFName_default.of("Opt"),PDFString_default,PDFHexString_default,PDFArray_default)},PDFAcroChoice2.prototype.setOptions=function(options){var newOpt=new Array(options.length);for(var idx3=0,len2=options.length;idx3<len2;idx3++){var _a=options[idx3],value=_a.value,display=_a.display;newOpt[idx3]=this.dict.context.obj([value,display||value])}this.dict.set(PDFName_default.of("Opt"),this.dict.context.obj(newOpt))},PDFAcroChoice2.prototype.getOptions=function(){var Opt=this.Opt();if(Opt instanceof PDFString_default||Opt instanceof PDFHexString_default)return[{value:Opt,display:Opt}];if(Opt instanceof PDFArray_default){var res=[];for(var idx3=0,len2=Opt.size();idx3<len2;idx3++){var item=Opt.lookup(idx3);if(item instanceof PDFString_default||item instanceof PDFHexString_default)res.push({value:item,display:item});if(item instanceof PDFArray_default){if(item.size()>0){var first=item.lookup(0,PDFString_default,PDFHexString_default),second=item.lookupMaybe(1,PDFString_default,PDFHexString_default);res.push({value:first,display:second||first})}}}return res}return[]},PDFAcroChoice2}(PDFAcroTerminal_default),PDFAcroChoice_default=PDFAcroChoice;var PDFAcroComboBox=function(_super){__extends(PDFAcroComboBox2,_super);function PDFAcroComboBox2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroComboBox2.fromDict=function(dict,ref){return new PDFAcroComboBox2(dict,ref)},PDFAcroComboBox2.create=function(context){var dict=context.obj({FT:"Ch",Ff:AcroChoiceFlags.Combo,Kids:[]}),ref=context.register(dict);return new PDFAcroComboBox2(dict,ref)},PDFAcroComboBox2}(PDFAcroChoice_default),PDFAcroComboBox_default=PDFAcroComboBox;var PDFAcroNonTerminal=function(_super){__extends(PDFAcroNonTerminal2,_super);function PDFAcroNonTerminal2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroNonTerminal2.prototype.addField=function(field){var Kids=this.normalizedEntries().Kids;Kids===null||Kids===void 0||Kids.push(field)},PDFAcroNonTerminal2.prototype.normalizedEntries=function(){var Kids=this.Kids();if(!Kids)Kids=this.dict.context.obj([]),this.dict.set(PDFName_default.of("Kids"),Kids);return{Kids}},PDFAcroNonTerminal2.fromDict=function(dict,ref){return new PDFAcroNonTerminal2(dict,ref)},PDFAcroNonTerminal2.create=function(context){var dict=context.obj({}),ref=context.register(dict);return new PDFAcroNonTerminal2(dict,ref)},PDFAcroNonTerminal2}(PDFAcroField_default),PDFAcroNonTerminal_default=PDFAcroNonTerminal;var PDFAcroSignature=function(_super){__extends(PDFAcroSignature2,_super);function PDFAcroSignature2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroSignature2.fromDict=function(dict,ref){return new PDFAcroSignature2(dict,ref)},PDFAcroSignature2}(PDFAcroTerminal_default),PDFAcroSignature_default=PDFAcroSignature;var PDFAcroText=function(_super){__extends(PDFAcroText2,_super);function PDFAcroText2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroText2.prototype.MaxLen=function(){var maxLen=this.dict.lookup(PDFName_default.of("MaxLen"));if(maxLen instanceof PDFNumber_default)return maxLen;return},PDFAcroText2.prototype.Q=function(){var q=this.dict.lookup(PDFName_default.of("Q"));if(q instanceof PDFNumber_default)return q;return},PDFAcroText2.prototype.setMaxLength=function(maxLength){this.dict.set(PDFName_default.of("MaxLen"),PDFNumber_default.of(maxLength))},PDFAcroText2.prototype.removeMaxLength=function(){this.dict.delete(PDFName_default.of("MaxLen"))},PDFAcroText2.prototype.getMaxLength=function(){var _a;return(_a=this.MaxLen())===null||_a===void 0?void 0:_a.asNumber()},PDFAcroText2.prototype.setQuadding=function(quadding){this.dict.set(PDFName_default.of("Q"),PDFNumber_default.of(quadding))},PDFAcroText2.prototype.getQuadding=function(){var _a;return(_a=this.Q())===null||_a===void 0?void 0:_a.asNumber()},PDFAcroText2.prototype.setValue=function(value){this.dict.set(PDFName_default.of("V"),value)},PDFAcroText2.prototype.removeValue=function(){this.dict.delete(PDFName_default.of("V"))},PDFAcroText2.prototype.getValue=function(){var v=this.V();if(v instanceof PDFString_default||v instanceof PDFHexString_default)return v;return},PDFAcroText2.fromDict=function(dict,ref){return new PDFAcroText2(dict,ref)},PDFAcroText2.create=function(context){var dict=context.obj({FT:"Tx",Kids:[]}),ref=context.register(dict);return new PDFAcroText2(dict,ref)},PDFAcroText2}(PDFAcroTerminal_default),PDFAcroText_default=PDFAcroText;var PDFAcroPushButton=function(_super){__extends(PDFAcroPushButton2,_super);function PDFAcroPushButton2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroPushButton2.fromDict=function(dict,ref){return new PDFAcroPushButton2(dict,ref)},PDFAcroPushButton2.create=function(context){var dict=context.obj({FT:"Btn",Ff:AcroButtonFlags.PushButton,Kids:[]}),ref=context.register(dict);return new PDFAcroPushButton2(dict,ref)},PDFAcroPushButton2}(PDFAcroButton_default),PDFAcroPushButton_default=PDFAcroPushButton;var PDFAcroRadioButton=function(_super){__extends(PDFAcroRadioButton2,_super);function PDFAcroRadioButton2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroRadioButton2.prototype.setValue=function(value){var onValues=this.getOnValues();if(!onValues.includes(value)&&value!==PDFName_default.of("Off"))throw new InvalidAcroFieldValueError;this.dict.set(PDFName_default.of("V"),value);var widgets=this.getWidgets();for(var idx3=0,len2=widgets.length;idx3<len2;idx3++){var widget=widgets[idx3],state=widget.getOnValue()===value?value:PDFName_default.of("Off");widget.setAppearanceState(state)}},PDFAcroRadioButton2.prototype.getValue=function(){var v=this.V();if(v instanceof PDFName_default)return v;return PDFName_default.of("Off")},PDFAcroRadioButton2.prototype.getOnValues=function(){var widgets=this.getWidgets(),onValues=[];for(var idx3=0,len2=widgets.length;idx3<len2;idx3++){var onValue=widgets[idx3].getOnValue();if(onValue)onValues.push(onValue)}return onValues},PDFAcroRadioButton2.fromDict=function(dict,ref){return new PDFAcroRadioButton2(dict,ref)},PDFAcroRadioButton2.create=function(context){var dict=context.obj({FT:"Btn",Ff:AcroButtonFlags.Radio,Kids:[]}),ref=context.register(dict);return new PDFAcroRadioButton2(dict,ref)},PDFAcroRadioButton2}(PDFAcroButton_default),PDFAcroRadioButton_default=PDFAcroRadioButton;var PDFAcroListBox=function(_super){__extends(PDFAcroListBox2,_super);function PDFAcroListBox2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFAcroListBox2.fromDict=function(dict,ref){return new PDFAcroListBox2(dict,ref)},PDFAcroListBox2.create=function(context){var dict=context.obj({FT:"Ch",Kids:[]}),ref=context.register(dict);return new PDFAcroListBox2(dict,ref)},PDFAcroListBox2}(PDFAcroChoice_default),PDFAcroListBox_default=PDFAcroListBox;var createPDFAcroFields=function(kidDicts){if(!kidDicts)return[];var kids=[];for(var idx3=0,len2=kidDicts.size();idx3<len2;idx3++){var ref=kidDicts.get(idx3),dict=kidDicts.lookup(idx3);if(ref instanceof PDFRef_default&&dict instanceof PDFDict_default)kids.push([createPDFAcroField(dict,ref),ref])}return kids},createPDFAcroField=function(dict,ref){var isNonTerminal=isNonTerminalAcroField(dict);if(isNonTerminal)return PDFAcroNonTerminal_default.fromDict(dict,ref);return createPDFAcroTerminal(dict,ref)},isNonTerminalAcroField=function(dict){var kids=dict.lookup(PDFName_default.of("Kids"));if(kids instanceof PDFArray_default)for(var idx3=0,len2=kids.size();idx3<len2;idx3++){var kid=kids.lookup(idx3),kidIsField=kid instanceof PDFDict_default&&kid.has(PDFName_default.of("T"));if(kidIsField)return!0}return!1},createPDFAcroTerminal=function(dict,ref){var ftNameOrRef=getInheritableAttribute(dict,PDFName_default.of("FT")),type2=dict.context.lookup(ftNameOrRef,PDFName_default);if(type2===PDFName_default.of("Btn"))return createPDFAcroButton(dict,ref);if(type2===PDFName_default.of("Ch"))return createPDFAcroChoice(dict,ref);if(type2===PDFName_default.of("Tx"))return PDFAcroText_default.fromDict(dict,ref);if(type2===PDFName_default.of("Sig"))return PDFAcroSignature_default.fromDict(dict,ref);return PDFAcroTerminal_default.fromDict(dict,ref)},createPDFAcroButton=function(dict,ref){var _a,ffNumberOrRef=getInheritableAttribute(dict,PDFName_default.of("Ff")),ffNumber=dict.context.lookupMaybe(ffNumberOrRef,PDFNumber_default),flags=(_a=ffNumber===null||ffNumber===void 0?void 0:ffNumber.asNumber())!==null&&_a!==void 0?_a:0;if(flagIsSet(flags,AcroButtonFlags.PushButton))return PDFAcroPushButton_default.fromDict(dict,ref);else if(flagIsSet(flags,AcroButtonFlags.Radio))return PDFAcroRadioButton_default.fromDict(dict,ref);else return PDFAcroCheckBox_default.fromDict(dict,ref)},createPDFAcroChoice=function(dict,ref){var _a,ffNumberOrRef=getInheritableAttribute(dict,PDFName_default.of("Ff")),ffNumber=dict.context.lookupMaybe(ffNumberOrRef,PDFNumber_default),flags=(_a=ffNumber===null||ffNumber===void 0?void 0:ffNumber.asNumber())!==null&&_a!==void 0?_a:0;if(flagIsSet(flags,AcroChoiceFlags.Combo))return PDFAcroComboBox_default.fromDict(dict,ref);else return PDFAcroListBox_default.fromDict(dict,ref)},flagIsSet=function(flags,flag2){return(flags&flag2)!==0},getInheritableAttribute=function(startNode,name){var attribute;return ascend(startNode,function(node){if(!attribute)attribute=node.get(name)}),attribute},ascend=function(startNode,visitor){visitor(startNode);var Parent=startNode.lookupMaybe(PDFName_default.of("Parent"),PDFDict_default);if(Parent)ascend(Parent,visitor)};var PDFAcroForm=function(){function PDFAcroForm2(dict){this.dict=dict}return PDFAcroForm2.prototype.Fields=function(){var fields=this.dict.lookup(PDFName_default.of("Fields"));if(fields instanceof PDFArray_default)return fields;return},PDFAcroForm2.prototype.getFields=function(){var Fields=this.normalizedEntries().Fields,fields=new Array(Fields.size());for(var idx3=0,len2=Fields.size();idx3<len2;idx3++){var ref=Fields.get(idx3),dict=Fields.lookup(idx3,PDFDict_default);fields[idx3]=[createPDFAcroField(dict,ref),ref]}return fields},PDFAcroForm2.prototype.getAllFields=function(){var allFields=[],pushFields=function(fields){if(!fields)return;for(var idx3=0,len2=fields.length;idx3<len2;idx3++){var field=fields[idx3];allFields.push(field);var fieldModel=field[0];if(fieldModel instanceof PDFAcroNonTerminal_default)pushFields(createPDFAcroFields(fieldModel.Kids()))}};return pushFields(this.getFields()),allFields},PDFAcroForm2.prototype.addField=function(field){var Fields=this.normalizedEntries().Fields;Fields===null||Fields===void 0||Fields.push(field)},PDFAcroForm2.prototype.removeField=function(field){var parent=field.getParent(),fields=parent===void 0?this.normalizedEntries().Fields:parent.Kids(),index2=fields===null||fields===void 0?void 0:fields.indexOf(field.ref);if(fields===void 0||index2===void 0)throw new Error("Tried to remove inexistent field "+field.getFullyQualifiedName());if(fields.remove(index2),parent!==void 0&&fields.size()===0)this.removeField(parent)},PDFAcroForm2.prototype.normalizedEntries=function(){var Fields=this.Fields();if(!Fields)Fields=this.dict.context.obj([]),this.dict.set(PDFName_default.of("Fields"),Fields);return{Fields}},PDFAcroForm2.fromDict=function(dict){return new PDFAcroForm2(dict)},PDFAcroForm2.create=function(context){var dict=context.obj({Fields:[]});return new PDFAcroForm2(dict)},PDFAcroForm2}(),PDFAcroForm_default=PDFAcroForm;var PDFCatalog=function(_super){__extends(PDFCatalog2,_super);function PDFCatalog2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFCatalog2.prototype.Pages=function(){return this.lookup(PDFName_default.of("Pages"),PDFDict_default)},PDFCatalog2.prototype.AcroForm=function(){return this.lookupMaybe(PDFName_default.of("AcroForm"),PDFDict_default)},PDFCatalog2.prototype.getAcroForm=function(){var dict=this.AcroForm();if(!dict)return;return PDFAcroForm_default.fromDict(dict)},PDFCatalog2.prototype.getOrCreateAcroForm=function(){var acroForm=this.getAcroForm();if(!acroForm){acroForm=PDFAcroForm_default.create(this.context);var acroFormRef=this.context.register(acroForm.dict);this.set(PDFName_default.of("AcroForm"),acroFormRef)}return acroForm},PDFCatalog2.prototype.ViewerPreferences=function(){return this.lookupMaybe(PDFName_default.of("ViewerPreferences"),PDFDict_default)},PDFCatalog2.prototype.getViewerPreferences=function(){var dict=this.ViewerPreferences();if(!dict)return;return ViewerPreferences_default.fromDict(dict)},PDFCatalog2.prototype.getOrCreateViewerPreferences=function(){var viewerPrefs=this.getViewerPreferences();if(!viewerPrefs){viewerPrefs=ViewerPreferences_default.create(this.context);var viewerPrefsRef=this.context.register(viewerPrefs.dict);this.set(PDFName_default.of("ViewerPreferences"),viewerPrefsRef)}return viewerPrefs},PDFCatalog2.prototype.insertLeafNode=function(leafRef,index2){var pagesRef=this.get(PDFName_default.of("Pages")),maybeParentRef=this.Pages().insertLeafNode(leafRef,index2);return maybeParentRef||pagesRef},PDFCatalog2.prototype.removeLeafNode=function(index2){this.Pages().removeLeafNode(index2)},PDFCatalog2.withContextAndPages=function(context,pages){var dict=new Map;return dict.set(PDFName_default.of("Type"),PDFName_default.of("Catalog")),dict.set(PDFName_default.of("Pages"),pages),new PDFCatalog2(dict,context)},PDFCatalog2.fromMapWithContext=function(map3,context){return new PDFCatalog2(map3,context)},PDFCatalog2}(PDFDict_default),PDFCatalog_default=PDFCatalog;var PDFPageTree=function(_super){__extends(PDFPageTree2,_super);function PDFPageTree2(){return _super!==null&&_super.apply(this,arguments)||this}return PDFPageTree2.prototype.Parent=function(){return this.lookup(PDFName_default.of("Parent"))},PDFPageTree2.prototype.Kids=function(){return this.lookup(PDFName_default.of("Kids"),PDFArray_default)},PDFPageTree2.prototype.Count=function(){return this.lookup(PDFName_default.of("Count"),PDFNumber_default)},PDFPageTree2.prototype.pushTreeNode=function(treeRef){var Kids=this.Kids();Kids.push(treeRef)},PDFPageTree2.prototype.pushLeafNode=function(leafRef){var Kids=this.Kids();this.insertLeafKid(Kids.size(),leafRef)},PDFPageTree2.prototype.insertLeafNode=function(leafRef,targetIndex){var Kids=this.Kids(),Count=this.Count().asNumber();if(targetIndex>Count)throw new InvalidTargetIndexError(targetIndex,Count);var leafsRemainingUntilTarget=targetIndex;for(var idx3=0,len2=Kids.size();idx3<len2;idx3++){if(leafsRemainingUntilTarget===0){this.insertLeafKid(idx3,leafRef);return}var kidRef=Kids.get(idx3),kid=this.context.lookup(kidRef);if(kid instanceof PDFPageTree2)if(kid.Count().asNumber()>leafsRemainingUntilTarget)return kid.insertLeafNode(leafRef,leafsRemainingUntilTarget)||kidRef;else leafsRemainingUntilTarget-=kid.Count().asNumber();if(kid instanceof PDFPageLeaf_default)leafsRemainingUntilTarget-=1}if(leafsRemainingUntilTarget===0){this.insertLeafKid(Kids.size(),leafRef);return}throw new CorruptPageTreeError(targetIndex,"insertLeafNode")},PDFPageTree2.prototype.removeLeafNode=function(targetIndex,prune){if(prune===void 0)prune=!0;var Kids=this.Kids(),Count=this.Count().asNumber();if(targetIndex>=Count)throw new InvalidTargetIndexError(targetIndex,Count);var leafsRemainingUntilTarget=targetIndex;for(var idx3=0,len2=Kids.size();idx3<len2;idx3++){var kidRef=Kids.get(idx3),kid=this.context.lookup(kidRef);if(kid instanceof PDFPageTree2)if(kid.Count().asNumber()>leafsRemainingUntilTarget){if(kid.removeLeafNode(leafsRemainingUntilTarget,prune),prune&&kid.Kids().size()===0)Kids.remove(idx3);return}else leafsRemainingUntilTarget-=kid.Count().asNumber();if(kid instanceof PDFPageLeaf_default)if(leafsRemainingUntilTarget===0){this.removeKid(idx3);return}else leafsRemainingUntilTarget-=1}throw new CorruptPageTreeError(targetIndex,"removeLeafNode")},PDFPageTree2.prototype.ascend=function(visitor){visitor(this);var Parent=this.Parent();if(Parent)Parent.ascend(visitor)},PDFPageTree2.prototype.traverse=function(visitor){var Kids=this.Kids();for(var idx3=0,len2=Kids.size();idx3<len2;idx3++){var kidRef=Kids.get(idx3),kid=this.context.lookup(kidRef);if(kid instanceof PDFPageTree2)kid.traverse(visitor);visitor(kid,kidRef)}},PDFPageTree2.prototype.insertLeafKid=function(kidIdx,leafRef){var Kids=this.Kids();this.ascend(function(node){var newCount=node.Count().asNumber()+1;node.set(PDFName_default.of("Count"),PDFNumber_default.of(newCount))}),Kids.insert(kidIdx,leafRef)},PDFPageTree2.prototype.removeKid=function(kidIdx){var Kids=this.Kids(),kid=Kids.lookup(kidIdx);if(kid instanceof PDFPageLeaf_default)this.ascend(function(node){var newCount=node.Count().asNumber()-1;node.set(PDFName_default.of("Count"),PDFNumber_default.of(newCount))});Kids.remove(kidIdx)},PDFPageTree2.withContext=function(context,parent){var dict=new Map;if(dict.set(PDFName_default.of("Type"),PDFName_default.of("Pages")),dict.set(PDFName_default.of("Kids"),context.obj([])),dict.set(PDFName_default.of("Count"),context.obj(0)),parent)dict.set(PDFName_default.of("Parent"),parent);return new PDFPageTree2(dict,context)},PDFPageTree2.fromMapWithContext=function(map3,context){return new PDFPageTree2(map3,context)},PDFPageTree2}(PDFDict_default),PDFPageTree_default=PDFPageTree;var IsDigit=new Uint8Array(256);IsDigit[CharCodes_default.Zero]=1;IsDigit[CharCodes_default.One]=1;IsDigit[CharCodes_default.Two]=1;IsDigit[CharCodes_default.Three]=1;IsDigit[CharCodes_default.Four]=1;IsDigit[CharCodes_default.Five]=1;IsDigit[CharCodes_default.Six]=1;IsDigit[CharCodes_default.Seven]=1;IsDigit[CharCodes_default.Eight]=1;IsDigit[CharCodes_default.Nine]=1;var IsNumericPrefix=new Uint8Array(256);IsNumericPrefix[CharCodes_default.Period]=1;IsNumericPrefix[CharCodes_default.Plus]=1;IsNumericPrefix[CharCodes_default.Minus]=1;var IsNumeric=new Uint8Array(256);for(idx3=0,len2=256;idx3<len2;idx3++)IsNumeric[idx3]=IsDigit[idx3]||IsNumericPrefix[idx3]?1:0;var idx3,len2;var Newline=CharCodes_default.Newline,CarriageReturn=CharCodes_default.CarriageReturn,BaseParser=function(){function BaseParser2(bytes,capNumbers){if(capNumbers===void 0)capNumbers=!1;this.bytes=bytes,this.capNumbers=capNumbers}return BaseParser2.prototype.parseRawInt=function(){var value="";while(!this.bytes.done()){var byte2=this.bytes.peek();if(!IsDigit[byte2])break;value+=charFromCode(this.bytes.next())}var numberValue=Number(value);if(!value||!isFinite(numberValue))throw new NumberParsingError(this.bytes.position(),value);return numberValue},BaseParser2.prototype.parseRawNumber=function(){var value="";while(!this.bytes.done()){var byte2=this.bytes.peek();if(!IsNumeric[byte2])break;if(value+=charFromCode(this.bytes.next()),byte2===CharCodes_default.Period)break}while(!this.bytes.done()){var byte2=this.bytes.peek();if(!IsDigit[byte2])break;value+=charFromCode(this.bytes.next())}var numberValue=Number(value);if(!value||!isFinite(numberValue))throw new NumberParsingError(this.bytes.position(),value);if(numberValue>Number.MAX_SAFE_INTEGER)if(this.capNumbers){var msg="Parsed number that is too large for some PDF readers: "+value+", using Number.MAX_SAFE_INTEGER instead.";return console.warn(msg),Number.MAX_SAFE_INTEGER}else{var msg="Parsed number that is too large for some PDF readers: "+value+", not capping.";console.warn(msg)}return numberValue},BaseParser2.prototype.skipWhitespace=function(){while(!this.bytes.done()&&IsWhitespace[this.bytes.peek()])this.bytes.next()},BaseParser2.prototype.skipLine=function(){while(!this.bytes.done()){var byte2=this.bytes.peek();if(byte2===Newline||byte2===CarriageReturn)return;this.bytes.next()}},BaseParser2.prototype.skipComment=function(){if(this.bytes.peek()!==CharCodes_default.Percent)return!1;while(!this.bytes.done()){var byte2=this.bytes.peek();if(byte2===Newline||byte2===CarriageReturn)return!0;this.bytes.next()}return!0},BaseParser2.prototype.skipWhitespaceAndComments=function(){this.skipWhitespace();while(this.skipComment())this.skipWhitespace()},BaseParser2.prototype.matchKeyword=function(keyword){var initialOffset=this.bytes.offset();for(var idx4=0,len3=keyword.length;idx4<len3;idx4++)if(this.bytes.done()||this.bytes.next()!==keyword[idx4])return this.bytes.moveTo(initialOffset),!1;return!0},BaseParser2}(),BaseParser_default=BaseParser;var ByteStream=function(){function ByteStream2(bytes){this.idx=0,this.line=0,this.column=0,this.bytes=bytes,this.length=this.bytes.length}return ByteStream2.prototype.moveTo=function(offset){this.idx=offset},ByteStream2.prototype.next=function(){var byte2=this.bytes[this.idx++];if(byte2===CharCodes_default.Newline)this.line+=1,this.column=0;else this.column+=1;return byte2},ByteStream2.prototype.assertNext=function(expected){if(this.peek()!==expected)throw new NextByteAssertionError(this.position(),expected,this.peek());return this.next()},ByteStream2.prototype.peek=function(){return this.bytes[this.idx]},ByteStream2.prototype.peekAhead=function(steps){return this.bytes[this.idx+steps]},ByteStream2.prototype.peekAt=function(offset){return this.bytes[offset]},ByteStream2.prototype.done=function(){return this.idx>=this.length},ByteStream2.prototype.offset=function(){return this.idx},ByteStream2.prototype.slice=function(start,end){return this.bytes.slice(start,end)},ByteStream2.prototype.position=function(){return{line:this.line,column:this.column,offset:this.idx}},ByteStream2.of=function(bytes){return new ByteStream2(bytes)},ByteStream2.fromPDFRawStream=function(rawStream){return ByteStream2.of(decodePDFRawStream(rawStream).decode())},ByteStream2}(),ByteStream_default=ByteStream;var Space=CharCodes_default.Space,CarriageReturn2=CharCodes_default.CarriageReturn,Newline2=CharCodes_default.Newline,stream=[CharCodes_default.s,CharCodes_default.t,CharCodes_default.r,CharCodes_default.e,CharCodes_default.a,CharCodes_default.m],endstream=[CharCodes_default.e,CharCodes_default.n,CharCodes_default.d,CharCodes_default.s,CharCodes_default.t,CharCodes_default.r,CharCodes_default.e,CharCodes_default.a,CharCodes_default.m],Keywords={header:[CharCodes_default.Percent,CharCodes_default.P,CharCodes_default.D,CharCodes_default.F,CharCodes_default.Dash],eof:[CharCodes_default.Percent,CharCodes_default.Percent,CharCodes_default.E,CharCodes_default.O,CharCodes_default.F],obj:[CharCodes_default.o,CharCodes_default.b,CharCodes_default.j],endobj:[CharCodes_default.e,CharCodes_default.n,CharCodes_default.d,CharCodes_default.o,CharCodes_default.b,CharCodes_default.j],xref:[CharCodes_default.x,CharCodes_default.r,CharCodes_default.e,CharCodes_default.f],trailer:[CharCodes_default.t,CharCodes_default.r,CharCodes_default.a,CharCodes_default.i,CharCodes_default.l,CharCodes_default.e,CharCodes_default.r],startxref:[CharCodes_default.s,CharCodes_default.t,CharCodes_default.a,CharCodes_default.r,CharCodes_default.t,CharCodes_default.x,CharCodes_default.r,CharCodes_default.e,CharCodes_default.f],true:[CharCodes_default.t,CharCodes_default.r,CharCodes_default.u,CharCodes_default.e],false:[CharCodes_default.f,CharCodes_default.a,CharCodes_default.l,CharCodes_default.s,CharCodes_default.e],null:[CharCodes_default.n,CharCodes_default.u,CharCodes_default.l,CharCodes_default.l],stream,streamEOF1:__spreadArrays(stream,[Space,CarriageReturn2,Newline2]),streamEOF2:__spreadArrays(stream,[CarriageReturn2,Newline2]),streamEOF3:__spreadArrays(stream,[CarriageReturn2]),streamEOF4:__spreadArrays(stream,[Newline2]),endstream,EOF1endstream:__spreadArrays([CarriageReturn2,Newline2],endstream),EOF2endstream:__spreadArrays([CarriageReturn2],endstream),EOF3endstream:__spreadArrays([Newline2],endstream)};var PDFObjectParser=function(_super){__extends(PDFObjectParser2,_super);function PDFObjectParser2(byteStream,context,capNumbers){if(capNumbers===void 0)capNumbers=!1;var _this=_super.call(this,byteStream,capNumbers)||this;return _this.context=context,_this}return PDFObjectParser2.prototype.parseObject=function(){if(this.skipWhitespaceAndComments(),this.matchKeyword(Keywords.true))return PDFBool_default.True;if(this.matchKeyword(Keywords.false))return PDFBool_default.False;if(this.matchKeyword(Keywords.null))return PDFNull_default;var byte2=this.bytes.peek();if(byte2===CharCodes_default.LessThan&&this.bytes.peekAhead(1)===CharCodes_default.LessThan)return this.parseDictOrStream();if(byte2===CharCodes_default.LessThan)return this.parseHexString();if(byte2===CharCodes_default.LeftParen)return this.parseString();if(byte2===CharCodes_default.ForwardSlash)return this.parseName();if(byte2===CharCodes_default.LeftSquareBracket)return this.parseArray();if(IsNumeric[byte2])return this.parseNumberOrRef();throw new PDFObjectParsingError(this.bytes.position(),byte2)},PDFObjectParser2.prototype.parseNumberOrRef=function(){var firstNum=this.parseRawNumber();this.skipWhitespaceAndComments();var lookaheadStart=this.bytes.offset();if(IsDigit[this.bytes.peek()]){var secondNum=this.parseRawNumber();if(this.skipWhitespaceAndComments(),this.bytes.peek()===CharCodes_default.R)return this.bytes.assertNext(CharCodes_default.R),PDFRef_default.of(firstNum,secondNum)}return this.bytes.moveTo(lookaheadStart),PDFNumber_default.of(firstNum)},PDFObjectParser2.prototype.parseHexString=function(){var value="";this.bytes.assertNext(CharCodes_default.LessThan);while(!this.bytes.done()&&this.bytes.peek()!==CharCodes_default.GreaterThan)value+=charFromCode(this.bytes.next());return this.bytes.assertNext(CharCodes_default.GreaterThan),PDFHexString_default.of(value)},PDFObjectParser2.prototype.parseString=function(){var nestingLvl=0,isEscaped=!1,value="";while(!this.bytes.done()){var byte2=this.bytes.next();if(value+=charFromCode(byte2),!isEscaped){if(byte2===CharCodes_default.LeftParen)nestingLvl+=1;if(byte2===CharCodes_default.RightParen)nestingLvl-=1}if(byte2===CharCodes_default.BackSlash)isEscaped=!isEscaped;else if(isEscaped)isEscaped=!1;if(nestingLvl===0)return PDFString_default.of(value.substring(1,value.length-1))}throw new UnbalancedParenthesisError(this.bytes.position())},PDFObjectParser2.prototype.parseName=function(){this.bytes.assertNext(CharCodes_default.ForwardSlash);var name="";while(!this.bytes.done()){var byte2=this.bytes.peek();if(IsWhitespace[byte2]||IsDelimiter[byte2])break;name+=charFromCode(byte2),this.bytes.next()}return PDFName_default.of(name)},PDFObjectParser2.prototype.parseArray=function(){this.bytes.assertNext(CharCodes_default.LeftSquareBracket),this.skipWhitespaceAndComments();var pdfArray=PDFArray_default.withContext(this.context);while(this.bytes.peek()!==CharCodes_default.RightSquareBracket){var element=this.parseObject();pdfArray.push(element),this.skipWhitespaceAndComments()}return this.bytes.assertNext(CharCodes_default.RightSquareBracket),pdfArray},PDFObjectParser2.prototype.parseDict=function(){this.bytes.assertNext(CharCodes_default.LessThan),this.bytes.assertNext(CharCodes_default.LessThan),this.skipWhitespaceAndComments();var dict=new Map;while(!this.bytes.done()&&this.bytes.peek()!==CharCodes_default.GreaterThan&&this.bytes.peekAhead(1)!==CharCodes_default.GreaterThan){var key=this.parseName(),value=this.parseObject();dict.set(key,value),this.skipWhitespaceAndComments()}this.skipWhitespaceAndComments(),this.bytes.assertNext(CharCodes_default.GreaterThan),this.bytes.assertNext(CharCodes_default.GreaterThan);var Type3=dict.get(PDFName_default.of("Type"));if(Type3===PDFName_default.of("Catalog"))return PDFCatalog_default.fromMapWithContext(dict,this.context);else if(Type3===PDFName_default.of("Pages"))return PDFPageTree_default.fromMapWithContext(dict,this.context);else if(Type3===PDFName_default.of("Page"))return PDFPageLeaf_default.fromMapWithContext(dict,this.context);else return PDFDict_default.fromMapWithContext(dict,this.context)},PDFObjectParser2.prototype.parseDictOrStream=function(){var startPos=this.bytes.position(),dict=this.parseDict();if(this.skipWhitespaceAndComments(),!this.matchKeyword(Keywords.streamEOF1)&&!this.matchKeyword(Keywords.streamEOF2)&&!this.matchKeyword(Keywords.streamEOF3)&&!this.matchKeyword(Keywords.streamEOF4)&&!this.matchKeyword(Keywords.stream))return dict;var start=this.bytes.offset(),end,Length=dict.get(PDFName_default.of("Length"));if(Length instanceof PDFNumber_default){if(end=start+Length.asNumber(),this.bytes.moveTo(end),this.skipWhitespaceAndComments(),!this.matchKeyword(Keywords.endstream))this.bytes.moveTo(start),end=this.findEndOfStreamFallback(startPos)}else end=this.findEndOfStreamFallback(startPos);var contents=this.bytes.slice(start,end);return PDFRawStream_default.of(dict,contents)},PDFObjectParser2.prototype.findEndOfStreamFallback=function(startPos){var nestingLvl=1,end=this.bytes.offset();while(!this.bytes.done()){if(end=this.bytes.offset(),this.matchKeyword(Keywords.stream))nestingLvl+=1;else if(this.matchKeyword(Keywords.EOF1endstream)||this.matchKeyword(Keywords.EOF2endstream)||this.matchKeyword(Keywords.EOF3endstream)||this.matchKeyword(Keywords.endstream))nestingLvl-=1;else this.bytes.next();if(nestingLvl===0)break}if(nestingLvl!==0)throw new PDFStreamParsingError(startPos);return end},PDFObjectParser2.forBytes=function(bytes,context,capNumbers){return new PDFObjectParser2(ByteStream_default.of(bytes),context,capNumbers)},PDFObjectParser2.forByteStream=function(byteStream,context,capNumbers){if(capNumbers===void 0)capNumbers=!1;return new PDFObjectParser2(byteStream,context,capNumbers)},PDFObjectParser2}(BaseParser_default),PDFObjectParser_default=PDFObjectParser;var PDFObjectStreamParser=function(_super){__extends(PDFObjectStreamParser2,_super);function PDFObjectStreamParser2(rawStream,shouldWaitForTick){var _this=_super.call(this,ByteStream_default.fromPDFRawStream(rawStream),rawStream.dict.context)||this,dict=rawStream.dict;return _this.alreadyParsed=!1,_this.shouldWaitForTick=shouldWaitForTick||function(){return!1},_this.firstOffset=dict.lookup(PDFName_default.of("First"),PDFNumber_default).asNumber(),_this.objectCount=dict.lookup(PDFName_default.of("N"),PDFNumber_default).asNumber(),_this}return PDFObjectStreamParser2.prototype.parseIntoContext=function(){return __awaiter(this,void 0,void 0,function(){var offsetsAndObjectNumbers,idx4,len3,_a,objectNumber,offset,object,ref;return __generator(this,function(_b){switch(_b.label){case 0:if(this.alreadyParsed)throw new ReparseError("PDFObjectStreamParser","parseIntoContext");this.alreadyParsed=!0,offsetsAndObjectNumbers=this.parseOffsetsAndObjectNumbers(),idx4=0,len3=offsetsAndObjectNumbers.length,_b.label=1;case 1:if(!(idx4<len3))return[3,4];if(_a=offsetsAndObjectNumbers[idx4],objectNumber=_a.objectNumber,offset=_a.offset,this.bytes.moveTo(this.firstOffset+offset),object=this.parseObject(),ref=PDFRef_default.of(objectNumber,0),this.context.assign(ref,object),!this.shouldWaitForTick())return[3,3];return[4,waitForTick()];case 2:_b.sent(),_b.label=3;case 3:return idx4++,[3,1];case 4:return[2]}})})},PDFObjectStreamParser2.prototype.parseOffsetsAndObjectNumbers=function(){var offsetsAndObjectNumbers=[];for(var idx4=0,len3=this.objectCount;idx4<len3;idx4++){this.skipWhitespaceAndComments();var objectNumber=this.parseRawInt();this.skipWhitespaceAndComments();var offset=this.parseRawInt();offsetsAndObjectNumbers.push({objectNumber,offset})}return offsetsAndObjectNumbers},PDFObjectStreamParser2.forStream=function(rawStream,shouldWaitForTick){return new PDFObjectStreamParser2(rawStream,shouldWaitForTick)},PDFObjectStreamParser2}(PDFObjectParser_default),PDFObjectStreamParser_default=PDFObjectStreamParser;var PDFXRefStreamParser=function(){function PDFXRefStreamParser2(rawStream){this.alreadyParsed=!1,this.dict=rawStream.dict,this.bytes=ByteStream_default.fromPDFRawStream(rawStream),this.context=this.dict.context;var Size2=this.dict.lookup(PDFName_default.of("Size"),PDFNumber_default),Index4=this.dict.lookup(PDFName_default.of("Index"));if(Index4 instanceof PDFArray_default){this.subsections=[];for(var idx4=0,len3=Index4.size();idx4<len3;idx4+=2){var firstObjectNumber=Index4.lookup(idx4+0,PDFNumber_default).asNumber(),length_1=Index4.lookup(idx4+1,PDFNumber_default).asNumber();this.subsections.push({firstObjectNumber,length:length_1})}}else this.subsections=[{firstObjectNumber:0,length:Size2.asNumber()}];var W=this.dict.lookup(PDFName_default.of("W"),PDFArray_default);this.byteWidths=[-1,-1,-1];for(var idx4=0,len3=W.size();idx4<len3;idx4++)this.byteWidths[idx4]=W.lookup(idx4,PDFNumber_default).asNumber()}return PDFXRefStreamParser2.prototype.parseIntoContext=function(){if(this.alreadyParsed)throw new ReparseError("PDFXRefStreamParser","parseIntoContext");this.alreadyParsed=!0,this.context.trailerInfo={Root:this.dict.get(PDFName_default.of("Root")),Encrypt:this.dict.get(PDFName_default.of("Encrypt")),Info:this.dict.get(PDFName_default.of("Info")),ID:this.dict.get(PDFName_default.of("ID"))};var entries=this.parseEntries();return entries},PDFXRefStreamParser2.prototype.parseEntries=function(){var entries=[],_a=this.byteWidths,typeFieldWidth=_a[0],offsetFieldWidth=_a[1],genFieldWidth=_a[2];for(var subsectionIdx=0,subsectionLen=this.subsections.length;subsectionIdx<subsectionLen;subsectionIdx++){var _b=this.subsections[subsectionIdx],firstObjectNumber=_b.firstObjectNumber,length_2=_b.length;for(var objIdx=0;objIdx<length_2;objIdx++){var type2=0;for(var idx4=0,len3=typeFieldWidth;idx4<len3;idx4++)type2=type2<<8|this.bytes.next();var offset=0;for(var idx4=0,len3=offsetFieldWidth;idx4<len3;idx4++)offset=offset<<8|this.bytes.next();var generationNumber=0;for(var idx4=0,len3=genFieldWidth;idx4<len3;idx4++)generationNumber=generationNumber<<8|this.bytes.next();if(typeFieldWidth===0)type2=1;var objectNumber=firstObjectNumber+objIdx,entry={ref:PDFRef_default.of(objectNumber,generationNumber),offset,deleted:type2===0,inObjectStream:type2===2};entries.push(entry)}}return entries},PDFXRefStreamParser2.forStream=function(rawStream){return new PDFXRefStreamParser2(rawStream)},PDFXRefStreamParser2}(),PDFXRefStreamParser_default=PDFXRefStreamParser;var PDFParser=function(_super){__extends(PDFParser2,_super);function PDFParser2(pdfBytes,objectsPerTick,throwOnInvalidObject,capNumbers){if(objectsPerTick===void 0)objectsPerTick=1/0;if(throwOnInvalidObject===void 0)throwOnInvalidObject=!1;if(capNumbers===void 0)capNumbers=!1;var _this=_super.call(this,ByteStream_default.of(pdfBytes),PDFContext_default.create(),capNumbers)||this;return _this.alreadyParsed=!1,_this.parsedObjects=0,_this.shouldWaitForTick=function(){return _this.parsedObjects+=1,_this.parsedObjects%_this.objectsPerTick===0},_this.objectsPerTick=objectsPerTick,_this.throwOnInvalidObject=throwOnInvalidObject,_this}return PDFParser2.prototype.parseDocument=function(){return __awaiter(this,void 0,void 0,function(){var prevOffset,offset;return __generator(this,function(_a){switch(_a.label){case 0:if(this.alreadyParsed)throw new ReparseError("PDFParser","parseDocument");this.alreadyParsed=!0,this.context.header=this.parseHeader(),_a.label=1;case 1:if(this.bytes.done())return[3,3];return[4,this.parseDocumentSection()];case 2:if(_a.sent(),offset=this.bytes.offset(),offset===prevOffset)throw new StalledParserError(this.bytes.position());return prevOffset=offset,[3,1];case 3:if(this.maybeRecoverRoot(),this.context.lookup(PDFRef_default.of(0)))console.warn("Removing parsed object: 0 0 R"),this.context.delete(PDFRef_default.of(0));return[2,this.context]}})})},PDFParser2.prototype.maybeRecoverRoot=function(){var isValidCatalog=function(obj){return obj instanceof PDFDict_default&&obj.lookup(PDFName_default.of("Type"))===PDFName_default.of("Catalog")},catalog=this.context.lookup(this.context.trailerInfo.Root);if(!isValidCatalog(catalog)){var indirectObjects=this.context.enumerateIndirectObjects();for(var idx4=0,len3=indirectObjects.length;idx4<len3;idx4++){var _a=indirectObjects[idx4],ref=_a[0],object=_a[1];if(isValidCatalog(object))this.context.trailerInfo.Root=ref}}},PDFParser2.prototype.parseHeader=function(){while(!this.bytes.done()){if(this.matchKeyword(Keywords.header)){var major=this.parseRawInt();this.bytes.assertNext(CharCodes_default.Period);var minor=this.parseRawInt(),header=PDFHeader_default.forVersion(major,minor);return this.skipBinaryHeaderComment(),header}this.bytes.next()}throw new MissingPDFHeaderError(this.bytes.position())},PDFParser2.prototype.parseIndirectObjectHeader=function(){this.skipWhitespaceAndComments();var objectNumber=this.parseRawInt();this.skipWhitespaceAndComments();var generationNumber=this.parseRawInt();if(this.skipWhitespaceAndComments(),!this.matchKeyword(Keywords.obj))throw new MissingKeywordError(this.bytes.position(),Keywords.obj);return PDFRef_default.of(objectNumber,generationNumber)},PDFParser2.prototype.matchIndirectObjectHeader=function(){var initialOffset=this.bytes.offset();try{return this.parseIndirectObjectHeader(),!0}catch(e){return this.bytes.moveTo(initialOffset),!1}},PDFParser2.prototype.parseIndirectObject=function(){return __awaiter(this,void 0,void 0,function(){var ref,object;return __generator(this,function(_a){switch(_a.label){case 0:if(ref=this.parseIndirectObjectHeader(),this.skipWhitespaceAndComments(),object=this.parseObject(),this.skipWhitespaceAndComments(),this.matchKeyword(Keywords.endobj),!(object instanceof PDFRawStream_default&&object.dict.lookup(PDFName_default.of("Type"))===PDFName_default.of("ObjStm")))return[3,2];return[4,PDFObjectStreamParser_default.forStream(object,this.shouldWaitForTick).parseIntoContext()];case 1:return _a.sent(),[3,3];case 2:if(object instanceof PDFRawStream_default&&object.dict.lookup(PDFName_default.of("Type"))===PDFName_default.of("XRef"))PDFXRefStreamParser_default.forStream(object).parseIntoContext();else this.context.assign(ref,object);_a.label=3;case 3:return[2,ref]}})})},PDFParser2.prototype.tryToParseInvalidIndirectObject=function(){var startPos=this.bytes.position(),msg="Trying to parse invalid object: "+JSON.stringify(startPos)+")";if(this.throwOnInvalidObject)throw new Error(msg);console.warn(msg);var ref=this.parseIndirectObjectHeader();console.warn("Invalid object ref: "+ref),this.skipWhitespaceAndComments();var start=this.bytes.offset(),failed=!0;while(!this.bytes.done()){if(this.matchKeyword(Keywords.endobj))failed=!1;if(!failed)break;this.bytes.next()}if(failed)throw new PDFInvalidObjectParsingError(startPos);var end=this.bytes.offset()-Keywords.endobj.length,object=PDFInvalidObject_default.of(this.bytes.slice(start,end));return this.context.assign(ref,object),ref},PDFParser2.prototype.parseIndirectObjects=function(){return __awaiter(this,void 0,void 0,function(){var initialOffset,e_1;return __generator(this,function(_a){switch(_a.label){case 0:this.skipWhitespaceAndComments(),_a.label=1;case 1:if(!(!this.bytes.done()&&IsDigit[this.bytes.peek()]))return[3,8];initialOffset=this.bytes.offset(),_a.label=2;case 2:return _a.trys.push([2,4,,5]),[4,this.parseIndirectObject()];case 3:return _a.sent(),[3,5];case 4:return e_1=_a.sent(),this.bytes.moveTo(initialOffset),this.tryToParseInvalidIndirectObject(),[3,5];case 5:if(this.skipWhitespaceAndComments(),this.skipJibberish(),!this.shouldWaitForTick())return[3,7];return[4,waitForTick()];case 6:_a.sent(),_a.label=7;case 7:return[3,1];case 8:return[2]}})})},PDFParser2.prototype.maybeParseCrossRefSection=function(){if(this.skipWhitespaceAndComments(),!this.matchKeyword(Keywords.xref))return;this.skipWhitespaceAndComments();var objectNumber=-1,xref=PDFCrossRefSection_default.createEmpty();while(!this.bytes.done()&&IsDigit[this.bytes.peek()]){var firstInt=this.parseRawInt();this.skipWhitespaceAndComments();var secondInt=this.parseRawInt();this.skipWhitespaceAndComments();var byte2=this.bytes.peek();if(byte2===CharCodes_default.n||byte2===CharCodes_default.f){var ref=PDFRef_default.of(objectNumber,secondInt);if(this.bytes.next()===CharCodes_default.n)xref.addEntry(ref,firstInt);else xref.addDeletedEntry(ref,firstInt);objectNumber+=1}else objectNumber=firstInt;this.skipWhitespaceAndComments()}return xref},PDFParser2.prototype.maybeParseTrailerDict=function(){if(this.skipWhitespaceAndComments(),!this.matchKeyword(Keywords.trailer))return;this.skipWhitespaceAndComments();var dict=this.parseDict(),context=this.context;context.trailerInfo={Root:dict.get(PDFName_default.of("Root"))||context.trailerInfo.Root,Encrypt:dict.get(PDFName_default.of("Encrypt"))||context.trailerInfo.Encrypt,Info:dict.get(PDFName_default.of("Info"))||context.trailerInfo.Info,ID:dict.get(PDFName_default.of("ID"))||context.trailerInfo.ID}},PDFParser2.prototype.maybeParseTrailer=function(){if(this.skipWhitespaceAndComments(),!this.matchKeyword(Keywords.startxref))return;this.skipWhitespaceAndComments();var offset=this.parseRawInt();return this.skipWhitespace(),this.matchKeyword(Keywords.eof),this.skipWhitespaceAndComments(),this.matchKeyword(Keywords.eof),this.skipWhitespaceAndComments(),PDFTrailer_default.forLastCrossRefSectionOffset(offset)},PDFParser2.prototype.parseDocumentSection=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.parseIndirectObjects()];case 1:return _a.sent(),this.maybeParseCrossRefSection(),this.maybeParseTrailerDict(),this.maybeParseTrailer(),this.skipJibberish(),[2]}})})},PDFParser2.prototype.skipJibberish=function(){this.skipWhitespaceAndComments();while(!this.bytes.done()){var initialOffset=this.bytes.offset(),byte2=this.bytes.peek(),isAlphaNumeric=byte2>=CharCodes_default.Space&&byte2<=CharCodes_default.Tilde;if(isAlphaNumeric){if(this.matchKeyword(Keywords.xref)||this.matchKeyword(Keywords.trailer)||this.matchKeyword(Keywords.startxref)||this.matchIndirectObjectHeader()){this.bytes.moveTo(initialOffset);break}}this.bytes.next()}},PDFParser2.prototype.skipBinaryHeaderComment=function(){this.skipWhitespaceAndComments();try{var initialOffset=this.bytes.offset();this.parseIndirectObjectHeader(),this.bytes.moveTo(initialOffset)}catch(e){this.bytes.next(),this.skipWhitespaceAndComments()}},PDFParser2.forBytesWithOptions=function(pdfBytes,objectsPerTick,throwOnInvalidObject,capNumbers){return new PDFParser2(pdfBytes,objectsPerTick,throwOnInvalidObject,capNumbers)},PDFParser2}(PDFObjectParser_default),PDFParser_default=PDFParser;var flag2=function(bitIndex){return 1<<bitIndex},AnnotationFlags;(function(AnnotationFlags2){AnnotationFlags2[AnnotationFlags2.Invisible=flag2(0)]="Invisible",AnnotationFlags2[AnnotationFlags2.Hidden=flag2(1)]="Hidden",AnnotationFlags2[AnnotationFlags2.Print=flag2(2)]="Print",AnnotationFlags2[AnnotationFlags2.NoZoom=flag2(3)]="NoZoom",AnnotationFlags2[AnnotationFlags2.NoRotate=flag2(4)]="NoRotate",AnnotationFlags2[AnnotationFlags2.NoView=flag2(5)]="NoView",AnnotationFlags2[AnnotationFlags2.ReadOnly=flag2(6)]="ReadOnly",AnnotationFlags2[AnnotationFlags2.Locked=flag2(7)]="Locked",AnnotationFlags2[AnnotationFlags2.ToggleNoView=flag2(8)]="ToggleNoView",AnnotationFlags2[AnnotationFlags2.LockedContents=flag2(9)]="LockedContents"})(AnnotationFlags||(AnnotationFlags={}));var asPDFName=function(name){return name instanceof PDFName_default?name:PDFName_default.of(name)},asPDFNumber=function(num){return num instanceof PDFNumber_default?num:PDFNumber_default.of(num)},asNumber=function(num){return num instanceof PDFNumber_default?num.asNumber():num};var RotationTypes;(function(RotationTypes2){RotationTypes2.Degrees="degrees",RotationTypes2.Radians="radians"})(RotationTypes||(RotationTypes={}));var degrees=function(degreeAngle){return assertIs(degreeAngle,"degreeAngle",["number"]),{type:RotationTypes.Degrees,angle:degreeAngle}},Radians=RotationTypes.Radians,Degrees=RotationTypes.Degrees,degreesToRadians=function(degree){return degree*Math.PI/180},radiansToDegrees=function(radian){return radian*180/Math.PI},toRadians=function(rotation){return rotation.type===Radians?rotation.angle:rotation.type===Degrees?degreesToRadians(rotation.angle):error2("Invalid rotation: "+JSON.stringify(rotation))},toDegrees=function(rotation){return rotation.type===Radians?radiansToDegrees(rotation.angle):rotation.type===Degrees?rotation.angle:error2("Invalid rotation: "+JSON.stringify(rotation))},reduceRotation=function(degreeAngle){if(degreeAngle===void 0)degreeAngle=0;var quadrants=degreeAngle/90%4;if(quadrants===0)return 0;if(quadrants===1)return 90;if(quadrants===2)return 180;if(quadrants===3)return 270;return 0},adjustDimsForRotation=function(dims,degreeAngle){if(degreeAngle===void 0)degreeAngle=0;var rotation=reduceRotation(degreeAngle);return rotation===90||rotation===270?{width:dims.height,height:dims.width}:{width:dims.width,height:dims.height}},rotateRectangle=function(rectangle,borderWidth,degreeAngle){if(borderWidth===void 0)borderWidth=0;if(degreeAngle===void 0)degreeAngle=0;var{x,y,width:w,height:h}=rectangle,r=reduceRotation(degreeAngle),b2=borderWidth/2;if(r===0)return{x:x-b2,y:y-b2,width:w,height:h};else if(r===90)return{x:x-h+b2,y:y-b2,width:h,height:w};else if(r===180)return{x:x-w+b2,y:y-h+b2,width:w,height:h};else if(r===270)return{x:x-b2,y:y-w+b2,width:h,height:w};else return{x:x-b2,y:y-b2,width:w,height:h}};var clip=function(){return PDFOperator_default.of(PDFOperatorNames_default.ClipNonZero)};var{cos,sin,tan}=Math,concatTransformationMatrix=function(a,b2,c,d,e,f){return PDFOperator_default.of(PDFOperatorNames_default.ConcatTransformationMatrix,[asPDFNumber(a),asPDFNumber(b2),asPDFNumber(c),asPDFNumber(d),asPDFNumber(e),asPDFNumber(f)])},translate=function(xPos,yPos){return concatTransformationMatrix(1,0,0,1,xPos,yPos)},scale=function(xPos,yPos){return concatTransformationMatrix(xPos,0,0,yPos,0,0)},rotateRadians=function(angle){return concatTransformationMatrix(cos(asNumber(angle)),sin(asNumber(angle)),-sin(asNumber(angle)),cos(asNumber(angle)),0,0)},rotateDegrees=function(angle){return rotateRadians(degreesToRadians(asNumber(angle)))},skewRadians=function(xSkewAngle,ySkewAngle){return concatTransformationMatrix(1,tan(asNumber(xSkewAngle)),tan(asNumber(ySkewAngle)),1,0,0)};var setDashPattern=function(dashArray,dashPhase){return PDFOperator_default.of(PDFOperatorNames_default.SetLineDashPattern,["["+dashArray.map(asPDFNumber).join(" ")+"]",asPDFNumber(dashPhase)])};var LineCapStyle;(function(LineCapStyle2){LineCapStyle2[LineCapStyle2.Butt=0]="Butt",LineCapStyle2[LineCapStyle2.Round=1]="Round",LineCapStyle2[LineCapStyle2.Projecting=2]="Projecting"})(LineCapStyle||(LineCapStyle={}));var setLineCap=function(style){return PDFOperator_default.of(PDFOperatorNames_default.SetLineCapStyle,[asPDFNumber(style)])},LineJoinStyle;(function(LineJoinStyle2){LineJoinStyle2[LineJoinStyle2.Miter=0]="Miter",LineJoinStyle2[LineJoinStyle2.Round=1]="Round",LineJoinStyle2[LineJoinStyle2.Bevel=2]="Bevel"})(LineJoinStyle||(LineJoinStyle={}));var setGraphicsState=function(state){return PDFOperator_default.of(PDFOperatorNames_default.SetGraphicsStateParams,[asPDFName(state)])},pushGraphicsState=function(){return PDFOperator_default.of(PDFOperatorNames_default.PushGraphicsState)},popGraphicsState=function(){return PDFOperator_default.of(PDFOperatorNames_default.PopGraphicsState)},setLineWidth=function(width){return PDFOperator_default.of(PDFOperatorNames_default.SetLineWidth,[asPDFNumber(width)])},appendBezierCurve=function(x1,y1,x2,y2,x3,y3){return PDFOperator_default.of(PDFOperatorNames_default.AppendBezierCurve,[asPDFNumber(x1),asPDFNumber(y1),asPDFNumber(x2),asPDFNumber(y2),asPDFNumber(x3),asPDFNumber(y3)])},appendQuadraticCurve=function(x1,y1,x2,y2){return PDFOperator_default.of(PDFOperatorNames_default.CurveToReplicateInitialPoint,[asPDFNumber(x1),asPDFNumber(y1),asPDFNumber(x2),asPDFNumber(y2)])},closePath=function(){return PDFOperator_default.of(PDFOperatorNames_default.ClosePath)},moveTo=function(xPos,yPos){return PDFOperator_default.of(PDFOperatorNames_default.MoveTo,[asPDFNumber(xPos),asPDFNumber(yPos)])},lineTo=function(xPos,yPos){return PDFOperator_default.of(PDFOperatorNames_default.LineTo,[asPDFNumber(xPos),asPDFNumber(yPos)])};var stroke=function(){return PDFOperator_default.of(PDFOperatorNames_default.StrokePath)},fill=function(){return PDFOperator_default.of(PDFOperatorNames_default.FillNonZero)},fillAndStroke=function(){return PDFOperator_default.of(PDFOperatorNames_default.FillNonZeroAndStroke)},endPath=function(){return PDFOperator_default.of(PDFOperatorNames_default.EndPath)},nextLine=function(){return PDFOperator_default.of(PDFOperatorNames_default.NextLine)};var showText=function(text2){return PDFOperator_default.of(PDFOperatorNames_default.ShowText,[text2])},beginText=function(){return PDFOperator_default.of(PDFOperatorNames_default.BeginText)},endText=function(){return PDFOperator_default.of(PDFOperatorNames_default.EndText)},setFontAndSize=function(name,size){return PDFOperator_default.of(PDFOperatorNames_default.SetFontAndSize,[asPDFName(name),asPDFNumber(size)])};var setLineHeight=function(lineHeight){return PDFOperator_default.of(PDFOperatorNames_default.SetTextLineHeight,[asPDFNumber(lineHeight)])};var TextRenderingMode;(function(TextRenderingMode2){TextRenderingMode2[TextRenderingMode2.Fill=0]="Fill",TextRenderingMode2[TextRenderingMode2.Outline=1]="Outline",TextRenderingMode2[TextRenderingMode2.FillAndOutline=2]="FillAndOutline",TextRenderingMode2[TextRenderingMode2.Invisible=3]="Invisible",TextRenderingMode2[TextRenderingMode2.FillAndClip=4]="FillAndClip",TextRenderingMode2[TextRenderingMode2.OutlineAndClip=5]="OutlineAndClip",TextRenderingMode2[TextRenderingMode2.FillAndOutlineAndClip=6]="FillAndOutlineAndClip",TextRenderingMode2[TextRenderingMode2.Clip=7]="Clip"})(TextRenderingMode||(TextRenderingMode={}));var setTextMatrix=function(a,b2,c,d,e,f){return PDFOperator_default.of(PDFOperatorNames_default.SetTextMatrix,[asPDFNumber(a),asPDFNumber(b2),asPDFNumber(c),asPDFNumber(d),asPDFNumber(e),asPDFNumber(f)])},rotateAndSkewTextRadiansAndTranslate=function(rotationAngle,xSkewAngle,ySkewAngle,x,y){return setTextMatrix(cos(asNumber(rotationAngle)),sin(asNumber(rotationAngle))+tan(asNumber(xSkewAngle)),-sin(asNumber(rotationAngle))+tan(asNumber(ySkewAngle)),cos(asNumber(rotationAngle)),x,y)};var drawObject=function(name){return PDFOperator_default.of(PDFOperatorNames_default.DrawObject,[asPDFName(name)])},setFillingGrayscaleColor=function(gray){return PDFOperator_default.of(PDFOperatorNames_default.NonStrokingColorGray,[asPDFNumber(gray)])},setStrokingGrayscaleColor=function(gray){return PDFOperator_default.of(PDFOperatorNames_default.StrokingColorGray,[asPDFNumber(gray)])},setFillingRgbColor=function(red,green,blue){return PDFOperator_default.of(PDFOperatorNames_default.NonStrokingColorRgb,[asPDFNumber(red),asPDFNumber(green),asPDFNumber(blue)])},setStrokingRgbColor=function(red,green,blue){return PDFOperator_default.of(PDFOperatorNames_default.StrokingColorRgb,[asPDFNumber(red),asPDFNumber(green),asPDFNumber(blue)])},setFillingCmykColor=function(cyan,magenta,yellow,key){return PDFOperator_default.of(PDFOperatorNames_default.NonStrokingColorCmyk,[asPDFNumber(cyan),asPDFNumber(magenta),asPDFNumber(yellow),asPDFNumber(key)])},setStrokingCmykColor=function(cyan,magenta,yellow,key){return PDFOperator_default.of(PDFOperatorNames_default.StrokingColorCmyk,[asPDFNumber(cyan),asPDFNumber(magenta),asPDFNumber(yellow),asPDFNumber(key)])},beginMarkedContent=function(tag){return PDFOperator_default.of(PDFOperatorNames_default.BeginMarkedContent,[asPDFName(tag)])},endMarkedContent=function(){return PDFOperator_default.of(PDFOperatorNames_default.EndMarkedContent)};var ColorTypes;(function(ColorTypes2){ColorTypes2.Grayscale="Grayscale",ColorTypes2.RGB="RGB",ColorTypes2.CMYK="CMYK"})(ColorTypes||(ColorTypes={}));var grayscale=function(gray){return assertRange(gray,"gray",0,1),{type:ColorTypes.Grayscale,gray}},rgb=function(red,green,blue){return assertRange(red,"red",0,1),assertRange(green,"green",0,1),assertRange(blue,"blue",0,1),{type:ColorTypes.RGB,red,green,blue}},cmyk=function(cyan,magenta,yellow,key){return assertRange(cyan,"cyan",0,1),assertRange(magenta,"magenta",0,1),assertRange(yellow,"yellow",0,1),assertRange(key,"key",0,1),{type:ColorTypes.CMYK,cyan,magenta,yellow,key}},Grayscale=ColorTypes.Grayscale,RGB=ColorTypes.RGB,CMYK=ColorTypes.CMYK,setFillingColor=function(color){return color.type===Grayscale?setFillingGrayscaleColor(color.gray):color.type===RGB?setFillingRgbColor(color.red,color.green,color.blue):color.type===CMYK?setFillingCmykColor(color.cyan,color.magenta,color.yellow,color.key):error2("Invalid color: "+JSON.stringify(color))},setStrokingColor=function(color){return color.type===Grayscale?setStrokingGrayscaleColor(color.gray):color.type===RGB?setStrokingRgbColor(color.red,color.green,color.blue):color.type===CMYK?setStrokingCmykColor(color.cyan,color.magenta,color.yellow,color.key):error2("Invalid color: "+JSON.stringify(color))},componentsToColor=function(comps,scale2){if(scale2===void 0)scale2=1;return(comps===null||comps===void 0?void 0:comps.length)===1?grayscale(comps[0]*scale2):(comps===null||comps===void 0?void 0:comps.length)===3?rgb(comps[0]*scale2,comps[1]*scale2,comps[2]*scale2):(comps===null||comps===void 0?void 0:comps.length)===4?cmyk(comps[0]*scale2,comps[1]*scale2,comps[2]*scale2,comps[3]*scale2):void 0},colorToComponents=function(color){return color.type===Grayscale?[color.gray]:color.type===RGB?[color.red,color.green,color.blue]:color.type===CMYK?[color.cyan,color.magenta,color.yellow,color.key]:error2("Invalid color: "+JSON.stringify(color))};var cx=0,cy=0,px=0,py=0,sx=0,sy=0,parameters=new Map([["A",7],["a",7],["C",6],["c",6],["H",1],["h",1],["L",2],["l",2],["M",2],["m",2],["Q",4],["q",4],["S",4],["s",4],["T",2],["t",2],["V",1],["v",1],["Z",0],["z",0]]),parse4=function(path2){var cmd,ret=[],args=[],curArg="",foundDecimal=!1,params=0;for(var _i=0,path_1=path2;_i<path_1.length;_i++){var c=path_1[_i];if(parameters.has(c)){if(params=parameters.get(c),cmd){if(curArg.length>0)args[args.length]=+curArg;ret[ret.length]={cmd,args},args=[],curArg="",foundDecimal=!1}cmd=c}else if([" ",","].includes(c)||c==="-"&&curArg.length>0&&curArg[curArg.length-1]!=="e"||c==="."&&foundDecimal){if(curArg.length===0)continue;if(args.length===params){if(ret[ret.length]={cmd,args},args=[+curArg],cmd==="M")cmd="L";if(cmd==="m")cmd="l"}else args[args.length]=+curArg;foundDecimal=c===".",curArg=["-","."].includes(c)?c:""}else if(curArg+=c,c===".")foundDecimal=!0}if(curArg.length>0)if(args.length===params){if(ret[ret.length]={cmd,args},args=[+curArg],cmd==="M")cmd="L";if(cmd==="m")cmd="l"}else args[args.length]=+curArg;return ret[ret.length]={cmd,args},ret},apply=function(commands){cx=cy=px=py=sx=sy=0;var cmds=[];for(var i3=0;i3<commands.length;i3++){var c=commands[i3];if(c.cmd&&typeof runners[c.cmd]==="function"){var cmd=runners[c.cmd](c.args);if(Array.isArray(cmd))cmds=cmds.concat(cmd);else cmds.push(cmd)}}return cmds},runners={M:function(a){return cx=a[0],cy=a[1],px=py=null,sx=cx,sy=cy,moveTo(cx,cy)},m:function(a){return cx+=a[0],cy+=a[1],px=py=null,sx=cx,sy=cy,moveTo(cx,cy)},C:function(a){return cx=a[4],cy=a[5],px=a[2],py=a[3],appendBezierCurve(a[0],a[1],a[2],a[3],a[4],a[5])},c:function(a){var cmd=appendBezierCurve(a[0]+cx,a[1]+cy,a[2]+cx,a[3]+cy,a[4]+cx,a[5]+cy);return px=cx+a[2],py=cy+a[3],cx+=a[4],cy+=a[5],cmd},S:function(a){if(px===null||py===null)px=cx,py=cy;var cmd=appendBezierCurve(cx-(px-cx),cy-(py-cy),a[0],a[1],a[2],a[3]);return px=a[0],py=a[1],cx=a[2],cy=a[3],cmd},s:function(a){if(px===null||py===null)px=cx,py=cy;var cmd=appendBezierCurve(cx-(px-cx),cy-(py-cy),cx+a[0],cy+a[1],cx+a[2],cy+a[3]);return px=cx+a[0],py=cy+a[1],cx+=a[2],cy+=a[3],cmd},Q:function(a){return px=a[0],py=a[1],cx=a[2],cy=a[3],appendQuadraticCurve(a[0],a[1],cx,cy)},q:function(a){var cmd=appendQuadraticCurve(a[0]+cx,a[1]+cy,a[2]+cx,a[3]+cy);return px=cx+a[0],py=cy+a[1],cx+=a[2],cy+=a[3],cmd},T:function(a){if(px===null||py===null)px=cx,py=cy;else px=cx-(px-cx),py=cy-(py-cy);var cmd=appendQuadraticCurve(px,py,a[0],a[1]);return px=cx-(px-cx),py=cy-(py-cy),cx=a[0],cy=a[1],cmd},t:function(a){if(px===null||py===null)px=cx,py=cy;else px=cx-(px-cx),py=cy-(py-cy);var cmd=appendQuadraticCurve(px,py,cx+a[0],cy+a[1]);return cx+=a[0],cy+=a[1],cmd},A:function(a){var cmds=solveArc(cx,cy,a);return cx=a[5],cy=a[6],cmds},a:function(a){a[5]+=cx,a[6]+=cy;var cmds=solveArc(cx,cy,a);return cx=a[5],cy=a[6],cmds},L:function(a){return cx=a[0],cy=a[1],px=py=null,lineTo(cx,cy)},l:function(a){return cx+=a[0],cy+=a[1],px=py=null,lineTo(cx,cy)},H:function(a){return cx=a[0],px=py=null,lineTo(cx,cy)},h:function(a){return cx+=a[0],px=py=null,lineTo(cx,cy)},V:function(a){return cy=a[0],px=py=null,lineTo(cx,cy)},v:function(a){return cy+=a[0],px=py=null,lineTo(cx,cy)},Z:function(){var cmd=closePath();return cx=sx,cy=sy,cmd},z:function(){var cmd=closePath();return cx=sx,cy=sy,cmd}},solveArc=function(x,y,coords){var rx=coords[0],ry=coords[1],rot=coords[2],large=coords[3],sweep=coords[4],ex=coords[5],ey=coords[6],segs=arcToSegments(ex,ey,rx,ry,large,sweep,rot,x,y),cmds=[];for(var _i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i],bez=segmentToBezier.apply(void 0,seg);cmds.push(appendBezierCurve.apply(void 0,bez))}return cmds},arcToSegments=function(x,y,rx,ry,large,sweep,rotateX,ox,oy){var th=rotateX*(Math.PI/180),sinTh=Math.sin(th),cosTh=Math.cos(th);rx=Math.abs(rx),ry=Math.abs(ry),px=cosTh*(ox-x)*0.5+sinTh*(oy-y)*0.5,py=cosTh*(oy-y)*0.5-sinTh*(ox-x)*0.5;var pl=px*px/(rx*rx)+py*py/(ry*ry);if(pl>1)pl=Math.sqrt(pl),rx*=pl,ry*=pl;var a00=cosTh/rx,a01=sinTh/rx,a10=-sinTh/ry,a11=cosTh/ry,x0=a00*ox+a01*oy,y0=a10*ox+a11*oy,x1=a00*x+a01*y,y1=a10*x+a11*y,d=(x1-x0)*(x1-x0)+(y1-y0)*(y1-y0),sfactorSq=1/d-0.25;if(sfactorSq<0)sfactorSq=0;var sfactor=Math.sqrt(sfactorSq);if(sweep===large)sfactor=-sfactor;var xc=0.5*(x0+x1)-sfactor*(y1-y0),yc=0.5*(y0+y1)+sfactor*(x1-x0),th0=Math.atan2(y0-yc,x0-xc),th1=Math.atan2(y1-yc,x1-xc),thArc=th1-th0;if(thArc<0&&sweep===1)thArc+=2*Math.PI;else if(thArc>0&&sweep===0)thArc-=2*Math.PI;var segments=Math.ceil(Math.abs(thArc/(Math.PI*0.5+0.001))),result=[];for(var i3=0;i3<segments;i3++){var th2=th0+i3*thArc/segments,th3=th0+(i3+1)*thArc/segments;result[i3]=[xc,yc,th2,th3,rx,ry,sinTh,cosTh]}return result},segmentToBezier=function(cx1,cy1,th0,th1,rx,ry,sinTh,cosTh){var a00=cosTh*rx,a01=-sinTh*ry,a10=sinTh*rx,a11=cosTh*ry,thHalf=0.5*(th1-th0),t2=2.6666666666666665*Math.sin(thHalf*0.5)*Math.sin(thHalf*0.5)/Math.sin(thHalf),x1=cx1+Math.cos(th0)-t2*Math.sin(th0),y1=cy1+Math.sin(th0)+t2*Math.cos(th0),x3=cx1+Math.cos(th1),y3=cy1+Math.sin(th1),x2=x3+t2*Math.sin(th1),y2=y3-t2*Math.cos(th1),result=[a00*x1+a01*y1,a10*x1+a11*y1,a00*x2+a01*y2,a10*x2+a11*y2,a00*x3+a01*y3,a10*x3+a11*y3];return result},svgPathToOperators=function(path2){return apply(parse4(path2))};var drawLinesOfText=function(lines,options){var operators=[pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),beginText(),setFillingColor(options.color),setFontAndSize(options.font,options.size),setLineHeight(options.lineHeight),rotateAndSkewTextRadiansAndTranslate(toRadians(options.rotate),toRadians(options.xSkew),toRadians(options.ySkew),options.x,options.y)].filter(Boolean);for(var idx4=0,len3=lines.length;idx4<len3;idx4++)operators.push(showText(lines[idx4]),nextLine());return operators.push(endText(),popGraphicsState()),operators},drawImage=function(name,options){return[pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),translate(options.x,options.y),rotateRadians(toRadians(options.rotate)),scale(options.width,options.height),skewRadians(toRadians(options.xSkew),toRadians(options.ySkew)),drawObject(name),popGraphicsState()].filter(Boolean)},drawPage=function(name,options){return[pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),translate(options.x,options.y),rotateRadians(toRadians(options.rotate)),scale(options.xScale,options.yScale),skewRadians(toRadians(options.xSkew),toRadians(options.ySkew)),drawObject(name),popGraphicsState()].filter(Boolean)},drawLine=function(options){var _a,_b;return[pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),options.color&&setStrokingColor(options.color),setLineWidth(options.thickness),setDashPattern((_a=options.dashArray)!==null&&_a!==void 0?_a:[],(_b=options.dashPhase)!==null&&_b!==void 0?_b:0),moveTo(options.start.x,options.start.y),options.lineCap&&setLineCap(options.lineCap),moveTo(options.start.x,options.start.y),lineTo(options.end.x,options.end.y),stroke(),popGraphicsState()].filter(Boolean)},drawRectangle=function(options){var _a,_b;return[pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),options.color&&setFillingColor(options.color),options.borderColor&&setStrokingColor(options.borderColor),setLineWidth(options.borderWidth),options.borderLineCap&&setLineCap(options.borderLineCap),setDashPattern((_a=options.borderDashArray)!==null&&_a!==void 0?_a:[],(_b=options.borderDashPhase)!==null&&_b!==void 0?_b:0),translate(options.x,options.y),rotateRadians(toRadians(options.rotate)),skewRadians(toRadians(options.xSkew),toRadians(options.ySkew)),moveTo(0,0),lineTo(0,options.height),lineTo(options.width,options.height),lineTo(options.width,0),closePath(),options.color&&options.borderWidth?fillAndStroke():options.color?fill():options.borderColor?stroke():closePath(),popGraphicsState()].filter(Boolean)},KAPPA=4*((Math.sqrt(2)-1)/3),drawEllipsePath=function(config){var x=asNumber(config.x),y=asNumber(config.y),xScale=asNumber(config.xScale),yScale=asNumber(config.yScale);x-=xScale,y-=yScale;var ox=xScale*KAPPA,oy=yScale*KAPPA,xe=x+xScale*2,ye=y+yScale*2,xm=x+xScale,ym=y+yScale;return[pushGraphicsState(),moveTo(x,ym),appendBezierCurve(x,ym-oy,xm-ox,y,xm,y),appendBezierCurve(xm+ox,y,xe,ym-oy,xe,ym),appendBezierCurve(xe,ym+oy,xm+ox,ye,xm,ye),appendBezierCurve(xm-ox,ye,x,ym+oy,x,ym),popGraphicsState()]},drawEllipseCurves=function(config){var centerX=asNumber(config.x),centerY=asNumber(config.y),xScale=asNumber(config.xScale),yScale=asNumber(config.yScale),x=-xScale,y=-yScale,ox=xScale*KAPPA,oy=yScale*KAPPA,xe=x+xScale*2,ye=y+yScale*2,xm=x+xScale,ym=y+yScale;return[translate(centerX,centerY),rotateRadians(toRadians(config.rotate)),moveTo(x,ym),appendBezierCurve(x,ym-oy,xm-ox,y,xm,y),appendBezierCurve(xm+ox,y,xe,ym-oy,xe,ym),appendBezierCurve(xe,ym+oy,xm+ox,ye,xm,ye),appendBezierCurve(xm-ox,ye,x,ym+oy,x,ym)]},drawEllipse=function(options){var _a,_b,_c;return __spreadArrays([pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),options.color&&setFillingColor(options.color),options.borderColor&&setStrokingColor(options.borderColor),setLineWidth(options.borderWidth),options.borderLineCap&&setLineCap(options.borderLineCap),setDashPattern((_a=options.borderDashArray)!==null&&_a!==void 0?_a:[],(_b=options.borderDashPhase)!==null&&_b!==void 0?_b:0)],options.rotate===void 0?drawEllipsePath({x:options.x,y:options.y,xScale:options.xScale,yScale:options.yScale}):drawEllipseCurves({x:options.x,y:options.y,xScale:options.xScale,yScale:options.yScale,rotate:(_c=options.rotate)!==null&&_c!==void 0?_c:degrees(0)}),[options.color&&options.borderWidth?fillAndStroke():options.color?fill():options.borderColor?stroke():closePath(),popGraphicsState()]).filter(Boolean)},drawSvgPath=function(path2,options){var _a,_b,_c;return __spreadArrays([pushGraphicsState(),options.graphicsState&&setGraphicsState(options.graphicsState),translate(options.x,options.y),rotateRadians(toRadians((_a=options.rotate)!==null&&_a!==void 0?_a:degrees(0))),options.scale?scale(options.scale,-options.scale):scale(1,-1),options.color&&setFillingColor(options.color),options.borderColor&&setStrokingColor(options.borderColor),options.borderWidth&&setLineWidth(options.borderWidth),options.borderLineCap&&setLineCap(options.borderLineCap),setDashPattern((_b=options.borderDashArray)!==null&&_b!==void 0?_b:[],(_c=options.borderDashPhase)!==null&&_c!==void 0?_c:0)],svgPathToOperators(path2),[options.color&&options.borderWidth?fillAndStroke():options.color?fill():options.borderColor?stroke():closePath(),popGraphicsState()]).filter(Boolean)},drawCheckMark=function(options){var size=asNumber(options.size),p2x=-0.25,p2y=-0.49,p3y=0.475,p3x=0.69,p1x=-0.675,p1y=-((p1x-p2x)*(p3x-p2x))/(p3y-p2y)+p2y;return[pushGraphicsState(),options.color&&setStrokingColor(options.color),setLineWidth(options.thickness),translate(options.x,options.y),moveTo(p1x*size,p1y*size),lineTo(p2x*size,p2y*size),lineTo(p3x*size,p3y*size),stroke(),popGraphicsState()].filter(Boolean)},rotateInPlace=function(options){return options.rotation===0?[translate(0,0),rotateDegrees(0)]:options.rotation===90?[translate(options.width,0),rotateDegrees(90)]:options.rotation===180?[translate(options.width,options.height),rotateDegrees(180)]:options.rotation===270?[translate(0,options.height),rotateDegrees(270)]:[]},drawCheckBox=function(options){var outline=drawRectangle({x:options.x,y:options.y,width:options.width,height:options.height,borderWidth:options.borderWidth,color:options.color,borderColor:options.borderColor,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)});if(!options.filled)return outline;var width=asNumber(options.width),height=asNumber(options.height),checkMarkSize=Math.min(width,height)/2,checkMark=drawCheckMark({x:width/2,y:height/2,size:checkMarkSize,thickness:options.thickness,color:options.markColor});return __spreadArrays([pushGraphicsState()],outline,checkMark,[popGraphicsState()])},drawRadioButton=function(options){var width=asNumber(options.width),height=asNumber(options.height),outlineScale=Math.min(width,height)/2,outline=drawEllipse({x:options.x,y:options.y,xScale:outlineScale,yScale:outlineScale,color:options.color,borderColor:options.borderColor,borderWidth:options.borderWidth});if(!options.filled)return outline;var dot=drawEllipse({x:options.x,y:options.y,xScale:outlineScale*0.45,yScale:outlineScale*0.45,color:options.dotColor,borderColor:void 0,borderWidth:0});return __spreadArrays([pushGraphicsState()],outline,dot,[popGraphicsState()])},drawButton=function(options){var x=asNumber(options.x),y=asNumber(options.y),width=asNumber(options.width),height=asNumber(options.height),background=drawRectangle({x,y,width,height,borderWidth:options.borderWidth,color:options.color,borderColor:options.borderColor,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)}),lines=drawTextLines(options.textLines,{color:options.textColor,font:options.font,size:options.fontSize,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)});return __spreadArrays([pushGraphicsState()],background,lines,[popGraphicsState()])},drawTextLines=function(lines,options){var operators=[beginText(),setFillingColor(options.color),setFontAndSize(options.font,options.size)];for(var idx4=0,len3=lines.length;idx4<len3;idx4++){var _a=lines[idx4],encoded=_a.encoded,x=_a.x,y=_a.y;operators.push(rotateAndSkewTextRadiansAndTranslate(toRadians(options.rotate),toRadians(options.xSkew),toRadians(options.ySkew),x,y),showText(encoded))}return operators.push(endText()),operators},drawTextField=function(options){var x=asNumber(options.x),y=asNumber(options.y),width=asNumber(options.width),height=asNumber(options.height),borderWidth=asNumber(options.borderWidth),padding=asNumber(options.padding),clipX=x+borderWidth/2+padding,clipY=y+borderWidth/2+padding,clipWidth=width-(borderWidth/2+padding)*2,clipHeight=height-(borderWidth/2+padding)*2,clippingArea=[moveTo(clipX,clipY),lineTo(clipX,clipY+clipHeight),lineTo(clipX+clipWidth,clipY+clipHeight),lineTo(clipX+clipWidth,clipY),closePath(),clip(),endPath()],background=drawRectangle({x,y,width,height,borderWidth:options.borderWidth,color:options.color,borderColor:options.borderColor,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)}),lines=drawTextLines(options.textLines,{color:options.textColor,font:options.font,size:options.fontSize,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)}),markedContent=__spreadArrays([beginMarkedContent("Tx"),pushGraphicsState()],lines,[popGraphicsState(),endMarkedContent()]);return __spreadArrays([pushGraphicsState()],background,clippingArea,markedContent,[popGraphicsState()])},drawOptionList=function(options){var x=asNumber(options.x),y=asNumber(options.y),width=asNumber(options.width),height=asNumber(options.height),lineHeight=asNumber(options.lineHeight),borderWidth=asNumber(options.borderWidth),padding=asNumber(options.padding),clipX=x+borderWidth/2+padding,clipY=y+borderWidth/2+padding,clipWidth=width-(borderWidth/2+padding)*2,clipHeight=height-(borderWidth/2+padding)*2,clippingArea=[moveTo(clipX,clipY),lineTo(clipX,clipY+clipHeight),lineTo(clipX+clipWidth,clipY+clipHeight),lineTo(clipX+clipWidth,clipY),closePath(),clip(),endPath()],background=drawRectangle({x,y,width,height,borderWidth:options.borderWidth,color:options.color,borderColor:options.borderColor,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)}),highlights=[];for(var idx4=0,len3=options.selectedLines.length;idx4<len3;idx4++){var line2=options.textLines[options.selectedLines[idx4]];highlights.push.apply(highlights,drawRectangle({x:line2.x-padding,y:line2.y-(lineHeight-line2.height)/2,width:width-borderWidth,height:line2.height+(lineHeight-line2.height)/2,borderWidth:0,color:options.selectedColor,borderColor:void 0,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)}))}var lines=drawTextLines(options.textLines,{color:options.textColor,font:options.font,size:options.fontSize,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)}),markedContent=__spreadArrays([beginMarkedContent("Tx"),pushGraphicsState()],lines,[popGraphicsState(),endMarkedContent()]);return __spreadArrays([pushGraphicsState()],background,highlights,clippingArea,markedContent,[popGraphicsState()])};var EncryptedPDFError=function(_super){__extends(EncryptedPDFError2,_super);function EncryptedPDFError2(){var _this=this,msg="Input document to `PDFDocument.load` is encrypted. You can use `PDFDocument.load(..., { ignoreEncryption: true })` if you wish to load the document anyways.";return _this=_super.call(this,msg)||this,_this}return EncryptedPDFError2}(Error);var FontkitNotRegisteredError=function(_super){__extends(FontkitNotRegisteredError2,_super);function FontkitNotRegisteredError2(){var _this=this,msg="Input to `PDFDocument.embedFont` was a custom font, but no `fontkit` instance was found. You must register a `fontkit` instance with `PDFDocument.registerFontkit(...)` before embedding custom fonts.";return _this=_super.call(this,msg)||this,_this}return FontkitNotRegisteredError2}(Error);var ForeignPageError=function(_super){__extends(ForeignPageError2,_super);function ForeignPageError2(){var _this=this,msg="A `page` passed to `PDFDocument.addPage` or `PDFDocument.insertPage` was from a different (foreign) PDF document. If you want to copy pages from one PDFDocument to another, you must use `PDFDocument.copyPages(...)` to copy the pages before adding or inserting them.";return _this=_super.call(this,msg)||this,_this}return ForeignPageError2}(Error);var RemovePageFromEmptyDocumentError=function(_super){__extends(RemovePageFromEmptyDocumentError2,_super);function RemovePageFromEmptyDocumentError2(){var _this=this,msg="PDFDocument has no pages so `PDFDocument.removePage` cannot be called";return _this=_super.call(this,msg)||this,_this}return RemovePageFromEmptyDocumentError2}(Error);var NoSuchFieldError=function(_super){__extends(NoSuchFieldError2,_super);function NoSuchFieldError2(name){var _this=this,msg='PDFDocument has no form field with the name "'+name+'"';return _this=_super.call(this,msg)||this,_this}return NoSuchFieldError2}(Error);var UnexpectedFieldTypeError=function(_super){__extends(UnexpectedFieldTypeError2,_super);function UnexpectedFieldTypeError2(name,expected,actual){var _a,_b,_this=this,expectedType=expected===null||expected===void 0?void 0:expected.name,actualType=(_b=(_a=actual===null||actual===void 0?void 0:actual.constructor)===null||_a===void 0?void 0:_a.name)!==null&&_b!==void 0?_b:actual,msg='Expected field "'+name+'" to be of type '+expectedType+", "+("but it is actually of type "+actualType);return _this=_super.call(this,msg)||this,_this}return UnexpectedFieldTypeError2}(Error);var MissingOnValueCheckError=function(_super){__extends(MissingOnValueCheckError2,_super);function MissingOnValueCheckError2(onValue){var _this=this,msg='Failed to select check box due to missing onValue: "'+onValue+'"';return _this=_super.call(this,msg)||this,_this}return MissingOnValueCheckError2}(Error);var FieldAlreadyExistsError=function(_super){__extends(FieldAlreadyExistsError2,_super);function FieldAlreadyExistsError2(name){var _this=this,msg='A field already exists with the specified name: "'+name+'"';return _this=_super.call(this,msg)||this,_this}return FieldAlreadyExistsError2}(Error);var InvalidFieldNamePartError=function(_super){__extends(InvalidFieldNamePartError2,_super);function InvalidFieldNamePartError2(namePart){var _this=this,msg='Field name contains invalid component: "'+namePart+'"';return _this=_super.call(this,msg)||this,_this}return InvalidFieldNamePartError2}(Error);var FieldExistsAsNonTerminalError=function(_super){__extends(FieldExistsAsNonTerminalError2,_super);function FieldExistsAsNonTerminalError2(name){var _this=this,msg='A non-terminal field already exists with the specified name: "'+name+'"';return _this=_super.call(this,msg)||this,_this}return FieldExistsAsNonTerminalError2}(Error);var RichTextFieldReadError=function(_super){__extends(RichTextFieldReadError2,_super);function RichTextFieldReadError2(fieldName){var _this=this,msg="Reading rich text fields is not supported: Attempted to read rich text field: "+fieldName;return _this=_super.call(this,msg)||this,_this}return RichTextFieldReadError2}(Error);var CombedTextLayoutError=function(_super){__extends(CombedTextLayoutError2,_super);function CombedTextLayoutError2(lineLength,cellCount){var _this=this,msg="Failed to layout combed text as lineLength="+lineLength+" is greater than cellCount="+cellCount;return _this=_super.call(this,msg)||this,_this}return CombedTextLayoutError2}(Error);var ExceededMaxLengthError=function(_super){__extends(ExceededMaxLengthError2,_super);function ExceededMaxLengthError2(textLength,maxLength,name){var _this=this,msg="Attempted to set text with length="+textLength+" for TextField with maxLength="+maxLength+" and name="+name;return _this=_super.call(this,msg)||this,_this}return ExceededMaxLengthError2}(Error);var InvalidMaxLengthError=function(_super){__extends(InvalidMaxLengthError2,_super);function InvalidMaxLengthError2(textLength,maxLength,name){var _this=this,msg="Attempted to set maxLength="+maxLength+", which is less than "+textLength+", the length of this field's current value (name="+name+")";return _this=_super.call(this,msg)||this,_this}return InvalidMaxLengthError2}(Error);var TextAlignment;(function(TextAlignment2){TextAlignment2[TextAlignment2.Left=0]="Left",TextAlignment2[TextAlignment2.Center=1]="Center",TextAlignment2[TextAlignment2.Right=2]="Right"})(TextAlignment||(TextAlignment={}));var MIN_FONT_SIZE=4,MAX_FONT_SIZE=500,computeFontSize=function(lines,font,bounds,multiline){if(multiline===void 0)multiline=!1;var fontSize=MIN_FONT_SIZE;while(fontSize<MAX_FONT_SIZE){var linesUsed=0;for(var lineIdx=0,lineLen=lines.length;lineIdx<lineLen;lineIdx++){linesUsed+=1;var line2=lines[lineIdx],words=line2.split(" "),spaceInLineRemaining=bounds.width;for(var idx4=0,len3=words.length;idx4<len3;idx4++){var isLastWord=idx4===len3-1,word=isLastWord?words[idx4]:words[idx4]+" ",widthOfWord=font.widthOfTextAtSize(word,fontSize);if(spaceInLineRemaining-=widthOfWord,spaceInLineRemaining<=0)linesUsed+=1,spaceInLineRemaining=bounds.width-widthOfWord}}if(!multiline&&linesUsed>lines.length)return fontSize-1;var height=font.heightAtSize(fontSize),lineHeight=height+height*0.2,totalHeight=lineHeight*linesUsed;if(totalHeight>Math.abs(bounds.height))return fontSize-1;fontSize+=1}return fontSize},computeCombedFontSize=function(line2,font,bounds,cellCount){var cellWidth=bounds.width/cellCount,cellHeight=bounds.height,fontSize=MIN_FONT_SIZE,chars3=charSplit(line2);while(fontSize<MAX_FONT_SIZE){for(var idx4=0,len3=chars3.length;idx4<len3;idx4++){var c=chars3[idx4],tooLong=font.widthOfTextAtSize(c,fontSize)>cellWidth*0.75;if(tooLong)return fontSize-1}var height=font.heightAtSize(fontSize,{descender:!1});if(height>cellHeight)return fontSize-1;fontSize+=1}return fontSize},lastIndexOfWhitespace=function(line2){for(var idx4=line2.length;idx4>0;idx4--)if(/\s/.test(line2[idx4]))return idx4;return},splitOutLines=function(input,maxWidth,font,fontSize){var _a,lastWhitespaceIdx=input.length;while(lastWhitespaceIdx>0){var line2=input.substring(0,lastWhitespaceIdx),encoded=font.encodeText(line2),width=font.widthOfTextAtSize(line2,fontSize);if(width<maxWidth){var remainder=input.substring(lastWhitespaceIdx)||void 0;return{line:line2,encoded,width,remainder}}lastWhitespaceIdx=(_a=lastIndexOfWhitespace(line2))!==null&&_a!==void 0?_a:0}return{line:input,encoded:font.encodeText(input),width:font.widthOfTextAtSize(input,fontSize),remainder:void 0}},layoutMultilineText=function(text2,_a){var{alignment,fontSize,font,bounds}=_a,lines=lineSplit(cleanText(text2));if(fontSize===void 0||fontSize===0)fontSize=computeFontSize(lines,font,bounds,!0);var height=font.heightAtSize(fontSize),lineHeight=height+height*0.2,textLines=[],minX=bounds.x,minY=bounds.y,maxX=bounds.x+bounds.width,maxY=bounds.y+bounds.height,y=bounds.y+bounds.height;for(var idx4=0,len3=lines.length;idx4<len3;idx4++){var prevRemainder=lines[idx4];while(prevRemainder!==void 0){var _b=splitOutLines(prevRemainder,bounds.width,font,fontSize),line2=_b.line,encoded=_b.encoded,width=_b.width,remainder=_b.remainder,x=alignment===TextAlignment.Left?bounds.x:alignment===TextAlignment.Center?bounds.x+bounds.width/2-width/2:alignment===TextAlignment.Right?bounds.x+bounds.width-width:bounds.x;if(y-=lineHeight,x<minX)minX=x;if(y<minY)minY=y;if(x+width>maxX)maxX=x+width;if(y+height>maxY)maxY=y+height;textLines.push({text:line2,encoded,width,height,x,y}),prevRemainder=remainder===null||remainder===void 0?void 0:remainder.trim()}}return{fontSize,lineHeight,lines:textLines,bounds:{x:minX,y:minY,width:maxX-minX,height:maxY-minY}}},layoutCombedText=function(text2,_a){var{fontSize,font,bounds,cellCount}=_a,line2=mergeLines(cleanText(text2));if(line2.length>cellCount)throw new CombedTextLayoutError(line2.length,cellCount);if(fontSize===void 0||fontSize===0)fontSize=computeCombedFontSize(line2,font,bounds,cellCount);var cellWidth=bounds.width/cellCount,height=font.heightAtSize(fontSize,{descender:!1}),y=bounds.y+(bounds.height/2-height/2),cells=[],minX=bounds.x,minY=bounds.y,maxX=bounds.x+bounds.width,maxY=bounds.y+bounds.height,cellOffset=0,charOffset=0;while(cellOffset<cellCount){var _b=charAtIndex(line2,charOffset),char2=_b[0],charLength=_b[1],encoded=font.encodeText(char2),width=font.widthOfTextAtSize(char2,fontSize),cellCenter=bounds.x+(cellWidth*cellOffset+cellWidth/2),x=cellCenter-width/2;if(x<minX)minX=x;if(y<minY)minY=y;if(x+width>maxX)maxX=x+width;if(y+height>maxY)maxY=y+height;cells.push({text:line2,encoded,width,height,x,y}),cellOffset+=1,charOffset+=charLength}return{fontSize,cells,bounds:{x:minX,y:minY,width:maxX-minX,height:maxY-minY}}},layoutSinglelineText=function(text2,_a){var{alignment,fontSize,font,bounds}=_a,line2=mergeLines(cleanText(text2));if(fontSize===void 0||fontSize===0)fontSize=computeFontSize([line2],font,bounds);var encoded=font.encodeText(line2),width=font.widthOfTextAtSize(line2,fontSize),height=font.heightAtSize(fontSize,{descender:!1}),x=alignment===TextAlignment.Left?bounds.x:alignment===TextAlignment.Center?bounds.x+bounds.width/2-width/2:alignment===TextAlignment.Right?bounds.x+bounds.width-width:bounds.x,y=bounds.y+(bounds.height/2-height/2);return{fontSize,line:{text:line2,encoded,width,height,x,y},bounds:{x,y,width,height}}};var normalizeAppearance=function(appearance){if("normal"in appearance)return appearance;return{normal:appearance}},tfRegex2=/\/([^\0\t\n\f\r\ ]+)[\0\t\n\f\r\ ]+(\d*\.\d+|\d+)[\0\t\n\f\r\ ]+Tf/,getDefaultFontSize=function(field){var _a,_b,da=(_a=field.getDefaultAppearance())!==null&&_a!==void 0?_a:"",daMatch=(_b=findLastMatch(da,tfRegex2).match)!==null&&_b!==void 0?_b:[],defaultFontSize=Number(daMatch[2]);return isFinite(defaultFontSize)?defaultFontSize:void 0},colorRegex=/(\d*\.\d+|\d+)[\0\t\n\f\r\ ]*(\d*\.\d+|\d+)?[\0\t\n\f\r\ ]*(\d*\.\d+|\d+)?[\0\t\n\f\r\ ]*(\d*\.\d+|\d+)?[\0\t\n\f\r\ ]+(g|rg|k)/,getDefaultColor=function(field){var _a,da=(_a=field.getDefaultAppearance())!==null&&_a!==void 0?_a:"",daMatch=findLastMatch(da,colorRegex).match,_b=daMatch!==null&&daMatch!==void 0?daMatch:[],c1=_b[1],c2=_b[2],c3=_b[3],c4=_b[4],colorSpace=_b[5];if(colorSpace==="g"&&c1)return grayscale(Number(c1));if(colorSpace==="rg"&&c1&&c2&&c3)return rgb(Number(c1),Number(c2),Number(c3));if(colorSpace==="k"&&c1&&c2&&c3&&c4)return cmyk(Number(c1),Number(c2),Number(c3),Number(c4));return},updateDefaultAppearance=function(field,color,font,fontSize){var _a;if(fontSize===void 0)fontSize=0;var da=[setFillingColor(color).toString(),setFontAndSize((_a=font===null||font===void 0?void 0:font.name)!==null&&_a!==void 0?_a:"dummy__noop",fontSize).toString()].join(`
`);field.setDefaultAppearance(da)},defaultCheckBoxAppearanceProvider=function(checkBox,widget){var _a,_b,_c,widgetColor=getDefaultColor(widget),fieldColor=getDefaultColor(checkBox.acroField),rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),borderWidth=(_a=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_a!==void 0?_a:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),_d=adjustDimsForRotation(rectangle,rotation),width=_d.width,height=_d.height,rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),black=rgb(0,0,0),borderColor=(_b=componentsToColor(ap===null||ap===void 0?void 0:ap.getBorderColor()))!==null&&_b!==void 0?_b:black,normalBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor()),downBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor(),0.8),textColor=(_c=widgetColor!==null&&widgetColor!==void 0?widgetColor:fieldColor)!==null&&_c!==void 0?_c:black;if(widgetColor)updateDefaultAppearance(widget,textColor);else updateDefaultAppearance(checkBox.acroField,textColor);var options={x:0+borderWidth/2,y:0+borderWidth/2,width:width-borderWidth,height:height-borderWidth,thickness:1.5,borderWidth,borderColor,markColor:textColor};return{normal:{on:__spreadArrays(rotate,drawCheckBox(__assign(__assign({},options),{color:normalBackgroundColor,filled:!0}))),off:__spreadArrays(rotate,drawCheckBox(__assign(__assign({},options),{color:normalBackgroundColor,filled:!1})))},down:{on:__spreadArrays(rotate,drawCheckBox(__assign(__assign({},options),{color:downBackgroundColor,filled:!0}))),off:__spreadArrays(rotate,drawCheckBox(__assign(__assign({},options),{color:downBackgroundColor,filled:!1})))}}},defaultRadioGroupAppearanceProvider=function(radioGroup,widget){var _a,_b,_c,widgetColor=getDefaultColor(widget),fieldColor=getDefaultColor(radioGroup.acroField),rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),borderWidth=(_a=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_a!==void 0?_a:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),_d=adjustDimsForRotation(rectangle,rotation),width=_d.width,height=_d.height,rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),black=rgb(0,0,0),borderColor=(_b=componentsToColor(ap===null||ap===void 0?void 0:ap.getBorderColor()))!==null&&_b!==void 0?_b:black,normalBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor()),downBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor(),0.8),textColor=(_c=widgetColor!==null&&widgetColor!==void 0?widgetColor:fieldColor)!==null&&_c!==void 0?_c:black;if(widgetColor)updateDefaultAppearance(widget,textColor);else updateDefaultAppearance(radioGroup.acroField,textColor);var options={x:width/2,y:height/2,width:width-borderWidth,height:height-borderWidth,borderWidth,borderColor,dotColor:textColor};return{normal:{on:__spreadArrays(rotate,drawRadioButton(__assign(__assign({},options),{color:normalBackgroundColor,filled:!0}))),off:__spreadArrays(rotate,drawRadioButton(__assign(__assign({},options),{color:normalBackgroundColor,filled:!1})))},down:{on:__spreadArrays(rotate,drawRadioButton(__assign(__assign({},options),{color:downBackgroundColor,filled:!0}))),off:__spreadArrays(rotate,drawRadioButton(__assign(__assign({},options),{color:downBackgroundColor,filled:!1})))}}},defaultButtonAppearanceProvider=function(button,widget,font){var _a,_b,_c,_d,_e,widgetColor=getDefaultColor(widget),fieldColor=getDefaultColor(button.acroField),widgetFontSize=getDefaultFontSize(widget),fieldFontSize=getDefaultFontSize(button.acroField),rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),captions=ap===null||ap===void 0?void 0:ap.getCaptions(),normalText=(_a=captions===null||captions===void 0?void 0:captions.normal)!==null&&_a!==void 0?_a:"",downText=(_c=(_b=captions===null||captions===void 0?void 0:captions.down)!==null&&_b!==void 0?_b:normalText)!==null&&_c!==void 0?_c:"",borderWidth=(_d=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_d!==void 0?_d:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),_f=adjustDimsForRotation(rectangle,rotation),width=_f.width,height=_f.height,rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),black=rgb(0,0,0),borderColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBorderColor()),normalBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor()),downBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor(),0.8),bounds={x:borderWidth,y:borderWidth,width:width-borderWidth*2,height:height-borderWidth*2},normalLayout=layoutSinglelineText(normalText,{alignment:TextAlignment.Center,fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds}),downLayout=layoutSinglelineText(downText,{alignment:TextAlignment.Center,fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds}),fontSize=Math.min(normalLayout.fontSize,downLayout.fontSize),textColor=(_e=widgetColor!==null&&widgetColor!==void 0?widgetColor:fieldColor)!==null&&_e!==void 0?_e:black;if(widgetColor||widgetFontSize!==void 0)updateDefaultAppearance(widget,textColor,font,fontSize);else updateDefaultAppearance(button.acroField,textColor,font,fontSize);var options={x:0+borderWidth/2,y:0+borderWidth/2,width:width-borderWidth,height:height-borderWidth,borderWidth,borderColor,textColor,font:font.name,fontSize};return{normal:__spreadArrays(rotate,drawButton(__assign(__assign({},options),{color:normalBackgroundColor,textLines:[normalLayout.line]}))),down:__spreadArrays(rotate,drawButton(__assign(__assign({},options),{color:downBackgroundColor,textLines:[downLayout.line]})))}},defaultTextFieldAppearanceProvider=function(textField,widget,font){var _a,_b,_c,_d,widgetColor=getDefaultColor(widget),fieldColor=getDefaultColor(textField.acroField),widgetFontSize=getDefaultFontSize(widget),fieldFontSize=getDefaultFontSize(textField.acroField),rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),text2=(_a=textField.getText())!==null&&_a!==void 0?_a:"",borderWidth=(_b=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_b!==void 0?_b:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),_e=adjustDimsForRotation(rectangle,rotation),width=_e.width,height=_e.height,rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),black=rgb(0,0,0),borderColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBorderColor()),normalBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor()),textLines,fontSize,padding=textField.isCombed()?0:1,bounds={x:borderWidth+padding,y:borderWidth+padding,width:width-(borderWidth+padding)*2,height:height-(borderWidth+padding)*2};if(textField.isMultiline()){var layout=layoutMultilineText(text2,{alignment:textField.getAlignment(),fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds});textLines=layout.lines,fontSize=layout.fontSize}else if(textField.isCombed()){var layout=layoutCombedText(text2,{fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds,cellCount:(_c=textField.getMaxLength())!==null&&_c!==void 0?_c:0});textLines=layout.cells,fontSize=layout.fontSize}else{var layout=layoutSinglelineText(text2,{alignment:textField.getAlignment(),fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds});textLines=[layout.line],fontSize=layout.fontSize}var textColor=(_d=widgetColor!==null&&widgetColor!==void 0?widgetColor:fieldColor)!==null&&_d!==void 0?_d:black;if(widgetColor||widgetFontSize!==void 0)updateDefaultAppearance(widget,textColor,font,fontSize);else updateDefaultAppearance(textField.acroField,textColor,font,fontSize);var options={x:0+borderWidth/2,y:0+borderWidth/2,width:width-borderWidth,height:height-borderWidth,borderWidth:borderWidth!==null&&borderWidth!==void 0?borderWidth:0,borderColor,textColor,font:font.name,fontSize,color:normalBackgroundColor,textLines,padding};return __spreadArrays(rotate,drawTextField(options))},defaultDropdownAppearanceProvider=function(dropdown,widget,font){var _a,_b,_c,widgetColor=getDefaultColor(widget),fieldColor=getDefaultColor(dropdown.acroField),widgetFontSize=getDefaultFontSize(widget),fieldFontSize=getDefaultFontSize(dropdown.acroField),rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),text2=(_a=dropdown.getSelected()[0])!==null&&_a!==void 0?_a:"",borderWidth=(_b=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_b!==void 0?_b:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),_d=adjustDimsForRotation(rectangle,rotation),width=_d.width,height=_d.height,rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),black=rgb(0,0,0),borderColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBorderColor()),normalBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor()),padding=1,bounds={x:borderWidth+padding,y:borderWidth+padding,width:width-(borderWidth+padding)*2,height:height-(borderWidth+padding)*2},_e=layoutSinglelineText(text2,{alignment:TextAlignment.Left,fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds}),line2=_e.line,fontSize=_e.fontSize,textColor=(_c=widgetColor!==null&&widgetColor!==void 0?widgetColor:fieldColor)!==null&&_c!==void 0?_c:black;if(widgetColor||widgetFontSize!==void 0)updateDefaultAppearance(widget,textColor,font,fontSize);else updateDefaultAppearance(dropdown.acroField,textColor,font,fontSize);var options={x:0+borderWidth/2,y:0+borderWidth/2,width:width-borderWidth,height:height-borderWidth,borderWidth:borderWidth!==null&&borderWidth!==void 0?borderWidth:0,borderColor,textColor,font:font.name,fontSize,color:normalBackgroundColor,textLines:[line2],padding};return __spreadArrays(rotate,drawTextField(options))},defaultOptionListAppearanceProvider=function(optionList,widget,font){var _a,_b,widgetColor=getDefaultColor(widget),fieldColor=getDefaultColor(optionList.acroField),widgetFontSize=getDefaultFontSize(widget),fieldFontSize=getDefaultFontSize(optionList.acroField),rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),borderWidth=(_a=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_a!==void 0?_a:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),_c=adjustDimsForRotation(rectangle,rotation),width=_c.width,height=_c.height,rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),black=rgb(0,0,0),borderColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBorderColor()),normalBackgroundColor=componentsToColor(ap===null||ap===void 0?void 0:ap.getBackgroundColor()),options=optionList.getOptions(),selected=optionList.getSelected();if(optionList.isSorted())options.sort();var text2="";for(var idx4=0,len3=options.length;idx4<len3;idx4++)if(text2+=options[idx4],idx4<len3-1)text2+=`
`;var padding=1,bounds={x:borderWidth+padding,y:borderWidth+padding,width:width-(borderWidth+padding)*2,height:height-(borderWidth+padding)*2},_d=layoutMultilineText(text2,{alignment:TextAlignment.Left,fontSize:widgetFontSize!==null&&widgetFontSize!==void 0?widgetFontSize:fieldFontSize,font,bounds}),lines=_d.lines,fontSize=_d.fontSize,lineHeight=_d.lineHeight,selectedLines=[];for(var idx4=0,len3=lines.length;idx4<len3;idx4++){var line2=lines[idx4];if(selected.includes(line2.text))selectedLines.push(idx4)}var blue=rgb(0.6,0.7568627450980392,0.8549019607843137),textColor=(_b=widgetColor!==null&&widgetColor!==void 0?widgetColor:fieldColor)!==null&&_b!==void 0?_b:black;if(widgetColor||widgetFontSize!==void 0)updateDefaultAppearance(widget,textColor,font,fontSize);else updateDefaultAppearance(optionList.acroField,textColor,font,fontSize);return __spreadArrays(rotate,drawOptionList({x:0+borderWidth/2,y:0+borderWidth/2,width:width-borderWidth,height:height-borderWidth,borderWidth:borderWidth!==null&&borderWidth!==void 0?borderWidth:0,borderColor,textColor,font:font.name,fontSize,color:normalBackgroundColor,textLines:lines,lineHeight,selectedColor:blue,selectedLines,padding}))};var PDFEmbeddedPage=function(){function PDFEmbeddedPage2(ref,doc,embedder){this.alreadyEmbedded=!1,assertIs(ref,"ref",[[PDFRef_default,"PDFRef"]]),assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]),assertIs(embedder,"embedder",[[PDFPageEmbedder_default,"PDFPageEmbedder"]]),this.ref=ref,this.doc=doc,this.width=embedder.width,this.height=embedder.height,this.embedder=embedder}return PDFEmbeddedPage2.prototype.scale=function(factor){return assertIs(factor,"factor",["number"]),{width:this.width*factor,height:this.height*factor}},PDFEmbeddedPage2.prototype.size=function(){return this.scale(1)},PDFEmbeddedPage2.prototype.embed=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(this.alreadyEmbedded)return[3,2];return[4,this.embedder.embedIntoContext(this.doc.context,this.ref)];case 1:_a.sent(),this.alreadyEmbedded=!0,_a.label=2;case 2:return[2]}})})},PDFEmbeddedPage2.of=function(ref,doc,embedder){return new PDFEmbeddedPage2(ref,doc,embedder)},PDFEmbeddedPage2}(),PDFEmbeddedPage_default=PDFEmbeddedPage;var PDFFont=function(){function PDFFont2(ref,doc,embedder){this.modified=!0,assertIs(ref,"ref",[[PDFRef_default,"PDFRef"]]),assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]),assertIs(embedder,"embedder",[[CustomFontEmbedder_default,"CustomFontEmbedder"],[StandardFontEmbedder_default,"StandardFontEmbedder"]]),this.ref=ref,this.doc=doc,this.name=embedder.fontName,this.embedder=embedder}return PDFFont2.prototype.encodeText=function(text2){return assertIs(text2,"text",["string"]),this.modified=!0,this.embedder.encodeText(text2)},PDFFont2.prototype.widthOfTextAtSize=function(text2,size){return assertIs(text2,"text",["string"]),assertIs(size,"size",["number"]),this.embedder.widthOfTextAtSize(text2,size)},PDFFont2.prototype.heightAtSize=function(size,options){var _a;return assertIs(size,"size",["number"]),assertOrUndefined(options===null||options===void 0?void 0:options.descender,"options.descender",["boolean"]),this.embedder.heightOfFontAtSize(size,{descender:(_a=options===null||options===void 0?void 0:options.descender)!==null&&_a!==void 0?_a:!0})},PDFFont2.prototype.sizeAtHeight=function(height){return assertIs(height,"height",["number"]),this.embedder.sizeOfFontAtHeight(height)},PDFFont2.prototype.getCharacterSet=function(){if(this.embedder instanceof StandardFontEmbedder_default)return this.embedder.encoding.supportedCodePoints;else return this.embedder.font.characterSet},PDFFont2.prototype.embed=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(!this.modified)return[3,2];return[4,this.embedder.embedIntoContext(this.doc.context,this.ref)];case 1:_a.sent(),this.modified=!1,_a.label=2;case 2:return[2]}})})},PDFFont2.of=function(ref,doc,embedder){return new PDFFont2(ref,doc,embedder)},PDFFont2}(),PDFFont_default=PDFFont;var PDFImage=function(){function PDFImage2(ref,doc,embedder){assertIs(ref,"ref",[[PDFRef_default,"PDFRef"]]),assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]),assertIs(embedder,"embedder",[[JpegEmbedder_default,"JpegEmbedder"],[PngEmbedder_default,"PngEmbedder"]]),this.ref=ref,this.doc=doc,this.width=embedder.width,this.height=embedder.height,this.embedder=embedder}return PDFImage2.prototype.scale=function(factor){return assertIs(factor,"factor",["number"]),{width:this.width*factor,height:this.height*factor}},PDFImage2.prototype.scaleToFit=function(width,height){assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var imgWidthScale=width/this.width,imgHeightScale=height/this.height,scale2=Math.min(imgWidthScale,imgHeightScale);return this.scale(scale2)},PDFImage2.prototype.size=function(){return this.scale(1)},PDFImage2.prototype.embed=function(){return __awaiter(this,void 0,void 0,function(){var _a,doc,ref;return __generator(this,function(_b){switch(_b.label){case 0:if(!this.embedder)return[2];if(!this.embedTask)_a=this,doc=_a.doc,ref=_a.ref,this.embedTask=this.embedder.embedIntoContext(doc.context,ref);return[4,this.embedTask];case 1:return _b.sent(),this.embedder=void 0,[2]}})})},PDFImage2.of=function(ref,doc,embedder){return new PDFImage2(ref,doc,embedder)},PDFImage2}(),PDFImage_default=PDFImage;var ImageAlignment;(function(ImageAlignment2){ImageAlignment2[ImageAlignment2.Left=0]="Left",ImageAlignment2[ImageAlignment2.Center=1]="Center",ImageAlignment2[ImageAlignment2.Right=2]="Right"})(ImageAlignment||(ImageAlignment={}));var assertFieldAppearanceOptions=function(options){assertOrUndefined(options===null||options===void 0?void 0:options.x,"options.x",["number"]),assertOrUndefined(options===null||options===void 0?void 0:options.y,"options.y",["number"]),assertOrUndefined(options===null||options===void 0?void 0:options.width,"options.width",["number"]),assertOrUndefined(options===null||options===void 0?void 0:options.height,"options.height",["number"]),assertOrUndefined(options===null||options===void 0?void 0:options.textColor,"options.textColor",[[Object,"Color"]]),assertOrUndefined(options===null||options===void 0?void 0:options.backgroundColor,"options.backgroundColor",[[Object,"Color"]]),assertOrUndefined(options===null||options===void 0?void 0:options.borderColor,"options.borderColor",[[Object,"Color"]]),assertOrUndefined(options===null||options===void 0?void 0:options.borderWidth,"options.borderWidth",["number"]),assertOrUndefined(options===null||options===void 0?void 0:options.rotate,"options.rotate",[[Object,"Rotation"]])},PDFField=function(){function PDFField2(acroField,ref,doc){assertIs(acroField,"acroField",[[PDFAcroTerminal_default,"PDFAcroTerminal"]]),assertIs(ref,"ref",[[PDFRef_default,"PDFRef"]]),assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]),this.acroField=acroField,this.ref=ref,this.doc=doc}return PDFField2.prototype.getName=function(){var _a;return(_a=this.acroField.getFullyQualifiedName())!==null&&_a!==void 0?_a:""},PDFField2.prototype.isReadOnly=function(){return this.acroField.hasFlag(AcroFieldFlags.ReadOnly)},PDFField2.prototype.enableReadOnly=function(){this.acroField.setFlagTo(AcroFieldFlags.ReadOnly,!0)},PDFField2.prototype.disableReadOnly=function(){this.acroField.setFlagTo(AcroFieldFlags.ReadOnly,!1)},PDFField2.prototype.isRequired=function(){return this.acroField.hasFlag(AcroFieldFlags.Required)},PDFField2.prototype.enableRequired=function(){this.acroField.setFlagTo(AcroFieldFlags.Required,!0)},PDFField2.prototype.disableRequired=function(){this.acroField.setFlagTo(AcroFieldFlags.Required,!1)},PDFField2.prototype.isExported=function(){return!this.acroField.hasFlag(AcroFieldFlags.NoExport)},PDFField2.prototype.enableExporting=function(){this.acroField.setFlagTo(AcroFieldFlags.NoExport,!1)},PDFField2.prototype.disableExporting=function(){this.acroField.setFlagTo(AcroFieldFlags.NoExport,!0)},PDFField2.prototype.needsAppearancesUpdate=function(){throw new MethodNotImplementedError(this.constructor.name,"needsAppearancesUpdate")},PDFField2.prototype.defaultUpdateAppearances=function(_font){throw new MethodNotImplementedError(this.constructor.name,"defaultUpdateAppearances")},PDFField2.prototype.markAsDirty=function(){this.doc.getForm().markFieldAsDirty(this.ref)},PDFField2.prototype.markAsClean=function(){this.doc.getForm().markFieldAsClean(this.ref)},PDFField2.prototype.isDirty=function(){return this.doc.getForm().fieldIsDirty(this.ref)},PDFField2.prototype.createWidget=function(options){var _a,textColor=options.textColor,backgroundColor=options.backgroundColor,borderColor=options.borderColor,borderWidth=options.borderWidth,degreesAngle=toDegrees(options.rotate),caption=options.caption,x=options.x,y=options.y,width=options.width+borderWidth,height=options.height+borderWidth,hidden=Boolean(options.hidden),pageRef=options.page;assertMultiple(degreesAngle,"degreesAngle",90);var widget=PDFWidgetAnnotation_default.create(this.doc.context,this.ref),rect=rotateRectangle({x,y,width,height},borderWidth,degreesAngle);if(widget.setRectangle(rect),pageRef)widget.setP(pageRef);var ac=widget.getOrCreateAppearanceCharacteristics();if(backgroundColor)ac.setBackgroundColor(colorToComponents(backgroundColor));if(ac.setRotation(degreesAngle),caption)ac.setCaptions({normal:caption});if(borderColor)ac.setBorderColor(colorToComponents(borderColor));var bs=widget.getOrCreateBorderStyle();if(borderWidth!==void 0)bs.setWidth(borderWidth);if(widget.setFlagTo(AnnotationFlags.Print,!0),widget.setFlagTo(AnnotationFlags.Hidden,hidden),widget.setFlagTo(AnnotationFlags.Invisible,!1),textColor){var da=(_a=this.acroField.getDefaultAppearance())!==null&&_a!==void 0?_a:"",newDa=da+`
`+setFillingColor(textColor).toString();this.acroField.setDefaultAppearance(newDa)}return widget},PDFField2.prototype.updateWidgetAppearanceWithFont=function(widget,font,_a){var{normal,rollover,down}=_a;this.updateWidgetAppearances(widget,{normal:this.createAppearanceStream(widget,normal,font),rollover:rollover&&this.createAppearanceStream(widget,rollover,font),down:down&&this.createAppearanceStream(widget,down,font)})},PDFField2.prototype.updateOnOffWidgetAppearance=function(widget,onValue,_a){var{normal,rollover,down}=_a;this.updateWidgetAppearances(widget,{normal:this.createAppearanceDict(widget,normal,onValue),rollover:rollover&&this.createAppearanceDict(widget,rollover,onValue),down:down&&this.createAppearanceDict(widget,down,onValue)})},PDFField2.prototype.updateWidgetAppearances=function(widget,_a){var{normal,rollover,down}=_a;if(widget.setNormalAppearance(normal),rollover)widget.setRolloverAppearance(rollover);else widget.removeRolloverAppearance();if(down)widget.setDownAppearance(down);else widget.removeDownAppearance()},PDFField2.prototype.createAppearanceStream=function(widget,appearance,font){var _a,context=this.acroField.dict.context,_b=widget.getRectangle(),width=_b.width,height=_b.height,Resources=font&&{Font:(_a={},_a[font.name]=font.ref,_a)},stream2=context.formXObject(appearance,{Resources,BBox:context.obj([0,0,width,height]),Matrix:context.obj([1,0,0,1,0,0])}),streamRef=context.register(stream2);return streamRef},PDFField2.prototype.createImageAppearanceStream=function(widget,image,alignment2){var _a,_b,context=this.acroField.dict.context,rectangle=widget.getRectangle(),ap=widget.getAppearanceCharacteristics(),bs=widget.getBorderStyle(),borderWidth=(_b=bs===null||bs===void 0?void 0:bs.getWidth())!==null&&_b!==void 0?_b:0,rotation=reduceRotation(ap===null||ap===void 0?void 0:ap.getRotation()),rotate=rotateInPlace(__assign(__assign({},rectangle),{rotation})),adj=adjustDimsForRotation(rectangle,rotation),imageDims=image.scaleToFit(adj.width-borderWidth*2,adj.height-borderWidth*2),options={x:borderWidth,y:borderWidth,width:imageDims.width,height:imageDims.height,rotate:degrees(0),xSkew:degrees(0),ySkew:degrees(0)};if(alignment2===ImageAlignment.Center)options.x+=(adj.width-borderWidth*2)/2-imageDims.width/2,options.y+=(adj.height-borderWidth*2)/2-imageDims.height/2;else if(alignment2===ImageAlignment.Right)options.x=adj.width-borderWidth-imageDims.width,options.y=adj.height-borderWidth-imageDims.height;var imageName=this.doc.context.addRandomSuffix("Image",10),appearance=__spreadArrays(rotate,drawImage(imageName,options)),Resources={XObject:(_a={},_a[imageName]=image.ref,_a)},stream2=context.formXObject(appearance,{Resources,BBox:context.obj([0,0,rectangle.width,rectangle.height]),Matrix:context.obj([1,0,0,1,0,0])});return context.register(stream2)},PDFField2.prototype.createAppearanceDict=function(widget,appearance,onValue){var context=this.acroField.dict.context,onStreamRef=this.createAppearanceStream(widget,appearance.on),offStreamRef=this.createAppearanceStream(widget,appearance.off),appearanceDict=context.obj({});return appearanceDict.set(onValue,onStreamRef),appearanceDict.set(PDFName_default.of("Off"),offStreamRef),appearanceDict},PDFField2}(),PDFField_default=PDFField;var PDFCheckBox=function(_super){__extends(PDFCheckBox2,_super);function PDFCheckBox2(acroCheckBox,ref,doc){var _this=_super.call(this,acroCheckBox,ref,doc)||this;return assertIs(acroCheckBox,"acroCheckBox",[[PDFAcroCheckBox_default,"PDFAcroCheckBox"]]),_this.acroField=acroCheckBox,_this}return PDFCheckBox2.prototype.check=function(){var _a,onValue=(_a=this.acroField.getOnValue())!==null&&_a!==void 0?_a:PDFName_default.of("Yes");this.markAsDirty(),this.acroField.setValue(onValue)},PDFCheckBox2.prototype.uncheck=function(){this.markAsDirty(),this.acroField.setValue(PDFName_default.of("Off"))},PDFCheckBox2.prototype.isChecked=function(){var onValue=this.acroField.getOnValue();return!!onValue&&onValue===this.acroField.getValue()},PDFCheckBox2.prototype.addToPage=function(page,options){var _a,_b,_c,_d,_e,_f;if(assertIs(page,"page",[[PDFPage_default,"PDFPage"]]),assertFieldAppearanceOptions(options),!options)options={};if(!("textColor"in options))options.textColor=rgb(0,0,0);if(!("backgroundColor"in options))options.backgroundColor=rgb(1,1,1);if(!("borderColor"in options))options.borderColor=rgb(0,0,0);if(!("borderWidth"in options))options.borderWidth=1;var widget=this.createWidget({x:(_a=options.x)!==null&&_a!==void 0?_a:0,y:(_b=options.y)!==null&&_b!==void 0?_b:0,width:(_c=options.width)!==null&&_c!==void 0?_c:50,height:(_d=options.height)!==null&&_d!==void 0?_d:50,textColor:options.textColor,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:(_e=options.borderWidth)!==null&&_e!==void 0?_e:0,rotate:(_f=options.rotate)!==null&&_f!==void 0?_f:degrees(0),hidden:options.hidden,page:page.ref}),widgetRef=this.doc.context.register(widget.dict);this.acroField.addWidget(widgetRef),widget.setAppearanceState(PDFName_default.of("Off")),this.updateWidgetAppearance(widget,PDFName_default.of("Yes")),page.node.addAnnot(widgetRef)},PDFCheckBox2.prototype.needsAppearancesUpdate=function(){var _a,widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],state=widget.getAppearanceState(),normal=(_a=widget.getAppearances())===null||_a===void 0?void 0:_a.normal;if(!(normal instanceof PDFDict_default))return!0;if(state&&!normal.has(state))return!0}return!1},PDFCheckBox2.prototype.defaultUpdateAppearances=function(){this.updateAppearances()},PDFCheckBox2.prototype.updateAppearances=function(provider){var _a;assertOrUndefined(provider,"provider",[Function]);var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],onValue=(_a=widget.getOnValue())!==null&&_a!==void 0?_a:PDFName_default.of("Yes");if(!onValue)continue;this.updateWidgetAppearance(widget,onValue,provider)}this.markAsClean()},PDFCheckBox2.prototype.updateWidgetAppearance=function(widget,onValue,provider){var apProvider=provider!==null&&provider!==void 0?provider:defaultCheckBoxAppearanceProvider,appearances=normalizeAppearance(apProvider(this,widget));this.updateOnOffWidgetAppearance(widget,onValue,appearances)},PDFCheckBox2.of=function(acroCheckBox,ref,doc){return new PDFCheckBox2(acroCheckBox,ref,doc)},PDFCheckBox2}(PDFField_default),PDFCheckBox_default=PDFCheckBox;var PDFDropdown=function(_super){__extends(PDFDropdown2,_super);function PDFDropdown2(acroComboBox,ref,doc){var _this=_super.call(this,acroComboBox,ref,doc)||this;return assertIs(acroComboBox,"acroComboBox",[[PDFAcroComboBox_default,"PDFAcroComboBox"]]),_this.acroField=acroComboBox,_this}return PDFDropdown2.prototype.getOptions=function(){var rawOptions=this.acroField.getOptions(),options=new Array(rawOptions.length);for(var idx4=0,len3=options.length;idx4<len3;idx4++){var _a=rawOptions[idx4],display=_a.display,value=_a.value;options[idx4]=(display!==null&&display!==void 0?display:value).decodeText()}return options},PDFDropdown2.prototype.getSelected=function(){var values3=this.acroField.getValues(),selected=new Array(values3.length);for(var idx4=0,len3=values3.length;idx4<len3;idx4++)selected[idx4]=values3[idx4].decodeText();return selected},PDFDropdown2.prototype.setOptions=function(options){assertIs(options,"options",[Array]);var optionObjects=new Array(options.length);for(var idx4=0,len3=options.length;idx4<len3;idx4++)optionObjects[idx4]={value:PDFHexString_default.fromText(options[idx4])};this.acroField.setOptions(optionObjects)},PDFDropdown2.prototype.addOptions=function(options){assertIs(options,"options",["string",Array]);var optionsArr=Array.isArray(options)?options:[options],existingOptions=this.acroField.getOptions(),newOptions=new Array(optionsArr.length);for(var idx4=0,len3=optionsArr.length;idx4<len3;idx4++)newOptions[idx4]={value:PDFHexString_default.fromText(optionsArr[idx4])};this.acroField.setOptions(existingOptions.concat(newOptions))},PDFDropdown2.prototype.select=function(options,merge){if(merge===void 0)merge=!1;assertIs(options,"options",["string",Array]),assertIs(merge,"merge",["boolean"]);var optionsArr=Array.isArray(options)?options:[options],validOptions=this.getOptions(),hasCustomOption=optionsArr.find(function(option){return!validOptions.includes(option)});if(hasCustomOption)this.enableEditing();if(this.markAsDirty(),optionsArr.length>1||optionsArr.length===1&&merge)this.enableMultiselect();var values3=new Array(optionsArr.length);for(var idx4=0,len3=optionsArr.length;idx4<len3;idx4++)values3[idx4]=PDFHexString_default.fromText(optionsArr[idx4]);if(merge){var existingValues=this.acroField.getValues();this.acroField.setValues(existingValues.concat(values3))}else this.acroField.setValues(values3)},PDFDropdown2.prototype.clear=function(){this.markAsDirty(),this.acroField.setValues([])},PDFDropdown2.prototype.setFontSize=function(fontSize){assertPositive(fontSize,"fontSize"),this.acroField.setFontSize(fontSize),this.markAsDirty()},PDFDropdown2.prototype.isEditable=function(){return this.acroField.hasFlag(AcroChoiceFlags.Edit)},PDFDropdown2.prototype.enableEditing=function(){this.acroField.setFlagTo(AcroChoiceFlags.Edit,!0)},PDFDropdown2.prototype.disableEditing=function(){this.acroField.setFlagTo(AcroChoiceFlags.Edit,!1)},PDFDropdown2.prototype.isSorted=function(){return this.acroField.hasFlag(AcroChoiceFlags.Sort)},PDFDropdown2.prototype.enableSorting=function(){this.acroField.setFlagTo(AcroChoiceFlags.Sort,!0)},PDFDropdown2.prototype.disableSorting=function(){this.acroField.setFlagTo(AcroChoiceFlags.Sort,!1)},PDFDropdown2.prototype.isMultiselect=function(){return this.acroField.hasFlag(AcroChoiceFlags.MultiSelect)},PDFDropdown2.prototype.enableMultiselect=function(){this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect,!0)},PDFDropdown2.prototype.disableMultiselect=function(){this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect,!1)},PDFDropdown2.prototype.isSpellChecked=function(){return!this.acroField.hasFlag(AcroChoiceFlags.DoNotSpellCheck)},PDFDropdown2.prototype.enableSpellChecking=function(){this.acroField.setFlagTo(AcroChoiceFlags.DoNotSpellCheck,!1)},PDFDropdown2.prototype.disableSpellChecking=function(){this.acroField.setFlagTo(AcroChoiceFlags.DoNotSpellCheck,!0)},PDFDropdown2.prototype.isSelectOnClick=function(){return this.acroField.hasFlag(AcroChoiceFlags.CommitOnSelChange)},PDFDropdown2.prototype.enableSelectOnClick=function(){this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange,!0)},PDFDropdown2.prototype.disableSelectOnClick=function(){this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange,!1)},PDFDropdown2.prototype.addToPage=function(page,options){var _a,_b,_c,_d,_e,_f,_g;if(assertIs(page,"page",[[PDFPage_default,"PDFPage"]]),assertFieldAppearanceOptions(options),!options)options={};if(!("textColor"in options))options.textColor=rgb(0,0,0);if(!("backgroundColor"in options))options.backgroundColor=rgb(1,1,1);if(!("borderColor"in options))options.borderColor=rgb(0,0,0);if(!("borderWidth"in options))options.borderWidth=1;var widget=this.createWidget({x:(_a=options.x)!==null&&_a!==void 0?_a:0,y:(_b=options.y)!==null&&_b!==void 0?_b:0,width:(_c=options.width)!==null&&_c!==void 0?_c:200,height:(_d=options.height)!==null&&_d!==void 0?_d:50,textColor:options.textColor,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:(_e=options.borderWidth)!==null&&_e!==void 0?_e:0,rotate:(_f=options.rotate)!==null&&_f!==void 0?_f:degrees(0),hidden:options.hidden,page:page.ref}),widgetRef=this.doc.context.register(widget.dict);this.acroField.addWidget(widgetRef);var font=(_g=options.font)!==null&&_g!==void 0?_g:this.doc.getForm().getDefaultFont();this.updateWidgetAppearance(widget,font),page.node.addAnnot(widgetRef)},PDFDropdown2.prototype.needsAppearancesUpdate=function(){var _a;if(this.isDirty())return!0;var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],hasAppearances=((_a=widget.getAppearances())===null||_a===void 0?void 0:_a.normal)instanceof PDFStream_default;if(!hasAppearances)return!0}return!1},PDFDropdown2.prototype.defaultUpdateAppearances=function(font){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),this.updateAppearances(font)},PDFDropdown2.prototype.updateAppearances=function(font,provider){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),assertOrUndefined(provider,"provider",[Function]);var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4];this.updateWidgetAppearance(widget,font,provider)}this.markAsClean()},PDFDropdown2.prototype.updateWidgetAppearance=function(widget,font,provider){var apProvider=provider!==null&&provider!==void 0?provider:defaultDropdownAppearanceProvider,appearances=normalizeAppearance(apProvider(this,widget,font));this.updateWidgetAppearanceWithFont(widget,font,appearances)},PDFDropdown2.of=function(acroComboBox,ref,doc){return new PDFDropdown2(acroComboBox,ref,doc)},PDFDropdown2}(PDFField_default),PDFDropdown_default=PDFDropdown;var PDFOptionList=function(_super){__extends(PDFOptionList2,_super);function PDFOptionList2(acroListBox,ref,doc){var _this=_super.call(this,acroListBox,ref,doc)||this;return assertIs(acroListBox,"acroListBox",[[PDFAcroListBox_default,"PDFAcroListBox"]]),_this.acroField=acroListBox,_this}return PDFOptionList2.prototype.getOptions=function(){var rawOptions=this.acroField.getOptions(),options=new Array(rawOptions.length);for(var idx4=0,len3=options.length;idx4<len3;idx4++){var _a=rawOptions[idx4],display=_a.display,value=_a.value;options[idx4]=(display!==null&&display!==void 0?display:value).decodeText()}return options},PDFOptionList2.prototype.getSelected=function(){var values3=this.acroField.getValues(),selected=new Array(values3.length);for(var idx4=0,len3=values3.length;idx4<len3;idx4++)selected[idx4]=values3[idx4].decodeText();return selected},PDFOptionList2.prototype.setOptions=function(options){assertIs(options,"options",[Array]),this.markAsDirty();var optionObjects=new Array(options.length);for(var idx4=0,len3=options.length;idx4<len3;idx4++)optionObjects[idx4]={value:PDFHexString_default.fromText(options[idx4])};this.acroField.setOptions(optionObjects)},PDFOptionList2.prototype.addOptions=function(options){assertIs(options,"options",["string",Array]),this.markAsDirty();var optionsArr=Array.isArray(options)?options:[options],existingOptions=this.acroField.getOptions(),newOptions=new Array(optionsArr.length);for(var idx4=0,len3=optionsArr.length;idx4<len3;idx4++)newOptions[idx4]={value:PDFHexString_default.fromText(optionsArr[idx4])};this.acroField.setOptions(existingOptions.concat(newOptions))},PDFOptionList2.prototype.select=function(options,merge){if(merge===void 0)merge=!1;assertIs(options,"options",["string",Array]),assertIs(merge,"merge",["boolean"]);var optionsArr=Array.isArray(options)?options:[options],validOptions=this.getOptions();if(assertIsSubset(optionsArr,"option",validOptions),this.markAsDirty(),optionsArr.length>1||optionsArr.length===1&&merge)this.enableMultiselect();var values3=new Array(optionsArr.length);for(var idx4=0,len3=optionsArr.length;idx4<len3;idx4++)values3[idx4]=PDFHexString_default.fromText(optionsArr[idx4]);if(merge){var existingValues=this.acroField.getValues();this.acroField.setValues(existingValues.concat(values3))}else this.acroField.setValues(values3)},PDFOptionList2.prototype.clear=function(){this.markAsDirty(),this.acroField.setValues([])},PDFOptionList2.prototype.setFontSize=function(fontSize){assertPositive(fontSize,"fontSize"),this.acroField.setFontSize(fontSize),this.markAsDirty()},PDFOptionList2.prototype.isSorted=function(){return this.acroField.hasFlag(AcroChoiceFlags.Sort)},PDFOptionList2.prototype.enableSorting=function(){this.acroField.setFlagTo(AcroChoiceFlags.Sort,!0)},PDFOptionList2.prototype.disableSorting=function(){this.acroField.setFlagTo(AcroChoiceFlags.Sort,!1)},PDFOptionList2.prototype.isMultiselect=function(){return this.acroField.hasFlag(AcroChoiceFlags.MultiSelect)},PDFOptionList2.prototype.enableMultiselect=function(){this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect,!0)},PDFOptionList2.prototype.disableMultiselect=function(){this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect,!1)},PDFOptionList2.prototype.isSelectOnClick=function(){return this.acroField.hasFlag(AcroChoiceFlags.CommitOnSelChange)},PDFOptionList2.prototype.enableSelectOnClick=function(){this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange,!0)},PDFOptionList2.prototype.disableSelectOnClick=function(){this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange,!1)},PDFOptionList2.prototype.addToPage=function(page,options){var _a,_b,_c,_d,_e,_f,_g;if(assertIs(page,"page",[[PDFPage_default,"PDFPage"]]),assertFieldAppearanceOptions(options),!options)options={};if(!("textColor"in options))options.textColor=rgb(0,0,0);if(!("backgroundColor"in options))options.backgroundColor=rgb(1,1,1);if(!("borderColor"in options))options.borderColor=rgb(0,0,0);if(!("borderWidth"in options))options.borderWidth=1;var widget=this.createWidget({x:(_a=options.x)!==null&&_a!==void 0?_a:0,y:(_b=options.y)!==null&&_b!==void 0?_b:0,width:(_c=options.width)!==null&&_c!==void 0?_c:200,height:(_d=options.height)!==null&&_d!==void 0?_d:100,textColor:options.textColor,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:(_e=options.borderWidth)!==null&&_e!==void 0?_e:0,rotate:(_f=options.rotate)!==null&&_f!==void 0?_f:degrees(0),hidden:options.hidden,page:page.ref}),widgetRef=this.doc.context.register(widget.dict);this.acroField.addWidget(widgetRef);var font=(_g=options.font)!==null&&_g!==void 0?_g:this.doc.getForm().getDefaultFont();this.updateWidgetAppearance(widget,font),page.node.addAnnot(widgetRef)},PDFOptionList2.prototype.needsAppearancesUpdate=function(){var _a;if(this.isDirty())return!0;var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],hasAppearances=((_a=widget.getAppearances())===null||_a===void 0?void 0:_a.normal)instanceof PDFStream_default;if(!hasAppearances)return!0}return!1},PDFOptionList2.prototype.defaultUpdateAppearances=function(font){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),this.updateAppearances(font)},PDFOptionList2.prototype.updateAppearances=function(font,provider){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),assertOrUndefined(provider,"provider",[Function]);var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4];this.updateWidgetAppearance(widget,font,provider)}this.markAsClean()},PDFOptionList2.prototype.updateWidgetAppearance=function(widget,font,provider){var apProvider=provider!==null&&provider!==void 0?provider:defaultOptionListAppearanceProvider,appearances=normalizeAppearance(apProvider(this,widget,font));this.updateWidgetAppearanceWithFont(widget,font,appearances)},PDFOptionList2.of=function(acroListBox,ref,doc){return new PDFOptionList2(acroListBox,ref,doc)},PDFOptionList2}(PDFField_default),PDFOptionList_default=PDFOptionList;var PDFRadioGroup=function(_super){__extends(PDFRadioGroup2,_super);function PDFRadioGroup2(acroRadioButton,ref,doc){var _this=_super.call(this,acroRadioButton,ref,doc)||this;return assertIs(acroRadioButton,"acroRadioButton",[[PDFAcroRadioButton_default,"PDFAcroRadioButton"]]),_this.acroField=acroRadioButton,_this}return PDFRadioGroup2.prototype.getOptions=function(){var exportValues=this.acroField.getExportValues();if(exportValues){var exportOptions=new Array(exportValues.length);for(var idx4=0,len3=exportValues.length;idx4<len3;idx4++)exportOptions[idx4]=exportValues[idx4].decodeText();return exportOptions}var onValues=this.acroField.getOnValues(),onOptions=new Array(onValues.length);for(var idx4=0,len3=onOptions.length;idx4<len3;idx4++)onOptions[idx4]=onValues[idx4].decodeText();return onOptions},PDFRadioGroup2.prototype.getSelected=function(){var value=this.acroField.getValue();if(value===PDFName_default.of("Off"))return;var exportValues=this.acroField.getExportValues();if(exportValues){var onValues=this.acroField.getOnValues();for(var idx4=0,len3=onValues.length;idx4<len3;idx4++)if(onValues[idx4]===value)return exportValues[idx4].decodeText()}return value.decodeText()},PDFRadioGroup2.prototype.select=function(option){assertIs(option,"option",["string"]);var validOptions=this.getOptions();assertIsOneOf(option,"option",validOptions),this.markAsDirty();var onValues=this.acroField.getOnValues(),exportValues=this.acroField.getExportValues();if(exportValues){for(var idx4=0,len3=exportValues.length;idx4<len3;idx4++)if(exportValues[idx4].decodeText()===option)this.acroField.setValue(onValues[idx4])}else for(var idx4=0,len3=onValues.length;idx4<len3;idx4++){var value=onValues[idx4];if(value.decodeText()===option)this.acroField.setValue(value)}},PDFRadioGroup2.prototype.clear=function(){this.markAsDirty(),this.acroField.setValue(PDFName_default.of("Off"))},PDFRadioGroup2.prototype.isOffToggleable=function(){return!this.acroField.hasFlag(AcroButtonFlags.NoToggleToOff)},PDFRadioGroup2.prototype.enableOffToggling=function(){this.acroField.setFlagTo(AcroButtonFlags.NoToggleToOff,!1)},PDFRadioGroup2.prototype.disableOffToggling=function(){this.acroField.setFlagTo(AcroButtonFlags.NoToggleToOff,!0)},PDFRadioGroup2.prototype.isMutuallyExclusive=function(){return!this.acroField.hasFlag(AcroButtonFlags.RadiosInUnison)},PDFRadioGroup2.prototype.enableMutualExclusion=function(){this.acroField.setFlagTo(AcroButtonFlags.RadiosInUnison,!1)},PDFRadioGroup2.prototype.disableMutualExclusion=function(){this.acroField.setFlagTo(AcroButtonFlags.RadiosInUnison,!0)},PDFRadioGroup2.prototype.addOptionToPage=function(option,page,options){var _a,_b,_c,_d,_e,_f,_g,_h,_j;assertIs(option,"option",["string"]),assertIs(page,"page",[[PDFPage_default,"PDFPage"]]),assertFieldAppearanceOptions(options);var widget=this.createWidget({x:(_a=options===null||options===void 0?void 0:options.x)!==null&&_a!==void 0?_a:0,y:(_b=options===null||options===void 0?void 0:options.y)!==null&&_b!==void 0?_b:0,width:(_c=options===null||options===void 0?void 0:options.width)!==null&&_c!==void 0?_c:50,height:(_d=options===null||options===void 0?void 0:options.height)!==null&&_d!==void 0?_d:50,textColor:(_e=options===null||options===void 0?void 0:options.textColor)!==null&&_e!==void 0?_e:rgb(0,0,0),backgroundColor:(_f=options===null||options===void 0?void 0:options.backgroundColor)!==null&&_f!==void 0?_f:rgb(1,1,1),borderColor:(_g=options===null||options===void 0?void 0:options.borderColor)!==null&&_g!==void 0?_g:rgb(0,0,0),borderWidth:(_h=options===null||options===void 0?void 0:options.borderWidth)!==null&&_h!==void 0?_h:1,rotate:(_j=options===null||options===void 0?void 0:options.rotate)!==null&&_j!==void 0?_j:degrees(0),hidden:options===null||options===void 0?void 0:options.hidden,page:page.ref}),widgetRef=this.doc.context.register(widget.dict),apStateValue=this.acroField.addWidgetWithOpt(widgetRef,PDFHexString_default.fromText(option),!this.isMutuallyExclusive());widget.setAppearanceState(PDFName_default.of("Off")),this.updateWidgetAppearance(widget,apStateValue),page.node.addAnnot(widgetRef)},PDFRadioGroup2.prototype.needsAppearancesUpdate=function(){var _a,widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],state=widget.getAppearanceState(),normal=(_a=widget.getAppearances())===null||_a===void 0?void 0:_a.normal;if(!(normal instanceof PDFDict_default))return!0;if(state&&!normal.has(state))return!0}return!1},PDFRadioGroup2.prototype.defaultUpdateAppearances=function(){this.updateAppearances()},PDFRadioGroup2.prototype.updateAppearances=function(provider){assertOrUndefined(provider,"provider",[Function]);var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],onValue=widget.getOnValue();if(!onValue)continue;this.updateWidgetAppearance(widget,onValue,provider)}},PDFRadioGroup2.prototype.updateWidgetAppearance=function(widget,onValue,provider){var apProvider=provider!==null&&provider!==void 0?provider:defaultRadioGroupAppearanceProvider,appearances=normalizeAppearance(apProvider(this,widget));this.updateOnOffWidgetAppearance(widget,onValue,appearances)},PDFRadioGroup2.of=function(acroRadioButton,ref,doc){return new PDFRadioGroup2(acroRadioButton,ref,doc)},PDFRadioGroup2}(PDFField_default),PDFRadioGroup_default=PDFRadioGroup;var PDFSignature=function(_super){__extends(PDFSignature2,_super);function PDFSignature2(acroSignature,ref,doc){var _this=_super.call(this,acroSignature,ref,doc)||this;return assertIs(acroSignature,"acroSignature",[[PDFAcroSignature_default,"PDFAcroSignature"]]),_this.acroField=acroSignature,_this}return PDFSignature2.prototype.needsAppearancesUpdate=function(){return!1},PDFSignature2.of=function(acroSignature,ref,doc){return new PDFSignature2(acroSignature,ref,doc)},PDFSignature2}(PDFField_default),PDFSignature_default=PDFSignature;var PDFTextField=function(_super){__extends(PDFTextField2,_super);function PDFTextField2(acroText,ref,doc){var _this=_super.call(this,acroText,ref,doc)||this;return assertIs(acroText,"acroText",[[PDFAcroText_default,"PDFAcroText"]]),_this.acroField=acroText,_this}return PDFTextField2.prototype.getText=function(){var value=this.acroField.getValue();if(!value&&this.isRichFormatted())throw new RichTextFieldReadError(this.getName());return value===null||value===void 0?void 0:value.decodeText()},PDFTextField2.prototype.setText=function(text2){assertOrUndefined(text2,"text",["string"]);var maxLength=this.getMaxLength();if(maxLength!==void 0&&text2&&text2.length>maxLength)throw new ExceededMaxLengthError(text2.length,maxLength,this.getName());if(this.markAsDirty(),this.disableRichFormatting(),text2)this.acroField.setValue(PDFHexString_default.fromText(text2));else this.acroField.removeValue()},PDFTextField2.prototype.getAlignment=function(){var quadding=this.acroField.getQuadding();return quadding===0?TextAlignment.Left:quadding===1?TextAlignment.Center:quadding===2?TextAlignment.Right:TextAlignment.Left},PDFTextField2.prototype.setAlignment=function(alignment2){assertIsOneOf(alignment2,"alignment",TextAlignment),this.markAsDirty(),this.acroField.setQuadding(alignment2)},PDFTextField2.prototype.getMaxLength=function(){return this.acroField.getMaxLength()},PDFTextField2.prototype.setMaxLength=function(maxLength){if(assertRangeOrUndefined(maxLength,"maxLength",0,Number.MAX_SAFE_INTEGER),this.markAsDirty(),maxLength===void 0)this.acroField.removeMaxLength();else{var text2=this.getText();if(text2&&text2.length>maxLength)throw new InvalidMaxLengthError(text2.length,maxLength,this.getName());this.acroField.setMaxLength(maxLength)}},PDFTextField2.prototype.removeMaxLength=function(){this.markAsDirty(),this.acroField.removeMaxLength()},PDFTextField2.prototype.setImage=function(image){var fieldAlignment=this.getAlignment(),alignment2=fieldAlignment===TextAlignment.Center?ImageAlignment.Center:fieldAlignment===TextAlignment.Right?ImageAlignment.Right:ImageAlignment.Left,widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],streamRef=this.createImageAppearanceStream(widget,image,alignment2);this.updateWidgetAppearances(widget,{normal:streamRef})}this.markAsClean()},PDFTextField2.prototype.setFontSize=function(fontSize){assertPositive(fontSize,"fontSize"),this.acroField.setFontSize(fontSize),this.markAsDirty()},PDFTextField2.prototype.isMultiline=function(){return this.acroField.hasFlag(AcroTextFlags.Multiline)},PDFTextField2.prototype.enableMultiline=function(){this.markAsDirty(),this.acroField.setFlagTo(AcroTextFlags.Multiline,!0)},PDFTextField2.prototype.disableMultiline=function(){this.markAsDirty(),this.acroField.setFlagTo(AcroTextFlags.Multiline,!1)},PDFTextField2.prototype.isPassword=function(){return this.acroField.hasFlag(AcroTextFlags.Password)},PDFTextField2.prototype.enablePassword=function(){this.acroField.setFlagTo(AcroTextFlags.Password,!0)},PDFTextField2.prototype.disablePassword=function(){this.acroField.setFlagTo(AcroTextFlags.Password,!1)},PDFTextField2.prototype.isFileSelector=function(){return this.acroField.hasFlag(AcroTextFlags.FileSelect)},PDFTextField2.prototype.enableFileSelection=function(){this.acroField.setFlagTo(AcroTextFlags.FileSelect,!0)},PDFTextField2.prototype.disableFileSelection=function(){this.acroField.setFlagTo(AcroTextFlags.FileSelect,!1)},PDFTextField2.prototype.isSpellChecked=function(){return!this.acroField.hasFlag(AcroTextFlags.DoNotSpellCheck)},PDFTextField2.prototype.enableSpellChecking=function(){this.acroField.setFlagTo(AcroTextFlags.DoNotSpellCheck,!1)},PDFTextField2.prototype.disableSpellChecking=function(){this.acroField.setFlagTo(AcroTextFlags.DoNotSpellCheck,!0)},PDFTextField2.prototype.isScrollable=function(){return!this.acroField.hasFlag(AcroTextFlags.DoNotScroll)},PDFTextField2.prototype.enableScrolling=function(){this.acroField.setFlagTo(AcroTextFlags.DoNotScroll,!1)},PDFTextField2.prototype.disableScrolling=function(){this.acroField.setFlagTo(AcroTextFlags.DoNotScroll,!0)},PDFTextField2.prototype.isCombed=function(){return this.acroField.hasFlag(AcroTextFlags.Comb)&&!this.isMultiline()&&!this.isPassword()&&!this.isFileSelector()&&this.getMaxLength()!==void 0},PDFTextField2.prototype.enableCombing=function(){if(this.getMaxLength()===void 0){var msg="PDFTextFields must have a max length in order to be combed";console.warn(msg)}this.markAsDirty(),this.disableMultiline(),this.disablePassword(),this.disableFileSelection(),this.acroField.setFlagTo(AcroTextFlags.Comb,!0)},PDFTextField2.prototype.disableCombing=function(){this.markAsDirty(),this.acroField.setFlagTo(AcroTextFlags.Comb,!1)},PDFTextField2.prototype.isRichFormatted=function(){return this.acroField.hasFlag(AcroTextFlags.RichText)},PDFTextField2.prototype.enableRichFormatting=function(){this.acroField.setFlagTo(AcroTextFlags.RichText,!0)},PDFTextField2.prototype.disableRichFormatting=function(){this.acroField.setFlagTo(AcroTextFlags.RichText,!1)},PDFTextField2.prototype.addToPage=function(page,options){var _a,_b,_c,_d,_e,_f,_g;if(assertIs(page,"page",[[PDFPage_default,"PDFPage"]]),assertFieldAppearanceOptions(options),!options)options={};if(!("textColor"in options))options.textColor=rgb(0,0,0);if(!("backgroundColor"in options))options.backgroundColor=rgb(1,1,1);if(!("borderColor"in options))options.borderColor=rgb(0,0,0);if(!("borderWidth"in options))options.borderWidth=1;var widget=this.createWidget({x:(_a=options.x)!==null&&_a!==void 0?_a:0,y:(_b=options.y)!==null&&_b!==void 0?_b:0,width:(_c=options.width)!==null&&_c!==void 0?_c:200,height:(_d=options.height)!==null&&_d!==void 0?_d:50,textColor:options.textColor,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:(_e=options.borderWidth)!==null&&_e!==void 0?_e:0,rotate:(_f=options.rotate)!==null&&_f!==void 0?_f:degrees(0),hidden:options.hidden,page:page.ref}),widgetRef=this.doc.context.register(widget.dict);this.acroField.addWidget(widgetRef);var font=(_g=options.font)!==null&&_g!==void 0?_g:this.doc.getForm().getDefaultFont();this.updateWidgetAppearance(widget,font),page.node.addAnnot(widgetRef)},PDFTextField2.prototype.needsAppearancesUpdate=function(){var _a;if(this.isDirty())return!0;var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],hasAppearances=((_a=widget.getAppearances())===null||_a===void 0?void 0:_a.normal)instanceof PDFStream_default;if(!hasAppearances)return!0}return!1},PDFTextField2.prototype.defaultUpdateAppearances=function(font){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),this.updateAppearances(font)},PDFTextField2.prototype.updateAppearances=function(font,provider){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),assertOrUndefined(provider,"provider",[Function]);var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4];this.updateWidgetAppearance(widget,font,provider)}this.markAsClean()},PDFTextField2.prototype.updateWidgetAppearance=function(widget,font,provider){var apProvider=provider!==null&&provider!==void 0?provider:defaultTextFieldAppearanceProvider,appearances=normalizeAppearance(apProvider(this,widget,font));this.updateWidgetAppearanceWithFont(widget,font,appearances)},PDFTextField2.of=function(acroText,ref,doc){return new PDFTextField2(acroText,ref,doc)},PDFTextField2}(PDFField_default),PDFTextField_default=PDFTextField;var StandardFonts;(function(StandardFonts2){StandardFonts2.Courier="Courier",StandardFonts2.CourierBold="Courier-Bold",StandardFonts2.CourierOblique="Courier-Oblique",StandardFonts2.CourierBoldOblique="Courier-BoldOblique",StandardFonts2.Helvetica="Helvetica",StandardFonts2.HelveticaBold="Helvetica-Bold",StandardFonts2.HelveticaOblique="Helvetica-Oblique",StandardFonts2.HelveticaBoldOblique="Helvetica-BoldOblique",StandardFonts2.TimesRoman="Times-Roman",StandardFonts2.TimesRomanBold="Times-Bold",StandardFonts2.TimesRomanItalic="Times-Italic",StandardFonts2.TimesRomanBoldItalic="Times-BoldItalic",StandardFonts2.Symbol="Symbol",StandardFonts2.ZapfDingbats="ZapfDingbats"})(StandardFonts||(StandardFonts={}));var PDFForm=function(){function PDFForm2(acroForm,doc){var _this=this;this.embedDefaultFont=function(){return _this.doc.embedStandardFont(StandardFonts.Helvetica)},assertIs(acroForm,"acroForm",[[PDFAcroForm_default,"PDFAcroForm"]]),assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]),this.acroForm=acroForm,this.doc=doc,this.dirtyFields=new Set,this.defaultFontCache=Cache_default.populatedBy(this.embedDefaultFont)}return PDFForm2.prototype.hasXFA=function(){return this.acroForm.dict.has(PDFName_default.of("XFA"))},PDFForm2.prototype.deleteXFA=function(){this.acroForm.dict.delete(PDFName_default.of("XFA"))},PDFForm2.prototype.getFields=function(){var allFields=this.acroForm.getAllFields(),fields=[];for(var idx4=0,len3=allFields.length;idx4<len3;idx4++){var _a=allFields[idx4],acroField=_a[0],ref=_a[1],field=convertToPDFField(acroField,ref,this.doc);if(field)fields.push(field)}return fields},PDFForm2.prototype.getFieldMaybe=function(name){assertIs(name,"name",["string"]);var fields=this.getFields();for(var idx4=0,len3=fields.length;idx4<len3;idx4++){var field=fields[idx4];if(field.getName()===name)return field}return},PDFForm2.prototype.getField=function(name){assertIs(name,"name",["string"]);var field=this.getFieldMaybe(name);if(field)return field;throw new NoSuchFieldError(name)},PDFForm2.prototype.getButton=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFButton_default)return field;throw new UnexpectedFieldTypeError(name,PDFButton_default,field)},PDFForm2.prototype.getCheckBox=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFCheckBox_default)return field;throw new UnexpectedFieldTypeError(name,PDFCheckBox_default,field)},PDFForm2.prototype.getDropdown=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFDropdown_default)return field;throw new UnexpectedFieldTypeError(name,PDFDropdown_default,field)},PDFForm2.prototype.getOptionList=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFOptionList_default)return field;throw new UnexpectedFieldTypeError(name,PDFOptionList_default,field)},PDFForm2.prototype.getRadioGroup=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFRadioGroup_default)return field;throw new UnexpectedFieldTypeError(name,PDFRadioGroup_default,field)},PDFForm2.prototype.getSignature=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFSignature_default)return field;throw new UnexpectedFieldTypeError(name,PDFSignature_default,field)},PDFForm2.prototype.getTextField=function(name){assertIs(name,"name",["string"]);var field=this.getField(name);if(field instanceof PDFTextField_default)return field;throw new UnexpectedFieldTypeError(name,PDFTextField_default,field)},PDFForm2.prototype.createButton=function(name){assertIs(name,"name",["string"]);var nameParts=splitFieldName(name),parent=this.findOrCreateNonTerminals(nameParts.nonTerminal),button=PDFAcroPushButton_default.create(this.doc.context);return button.setPartialName(nameParts.terminal),addFieldToParent(parent,[button,button.ref],nameParts.terminal),PDFButton_default.of(button,button.ref,this.doc)},PDFForm2.prototype.createCheckBox=function(name){assertIs(name,"name",["string"]);var nameParts=splitFieldName(name),parent=this.findOrCreateNonTerminals(nameParts.nonTerminal),checkBox=PDFAcroCheckBox_default.create(this.doc.context);return checkBox.setPartialName(nameParts.terminal),addFieldToParent(parent,[checkBox,checkBox.ref],nameParts.terminal),PDFCheckBox_default.of(checkBox,checkBox.ref,this.doc)},PDFForm2.prototype.createDropdown=function(name){assertIs(name,"name",["string"]);var nameParts=splitFieldName(name),parent=this.findOrCreateNonTerminals(nameParts.nonTerminal),comboBox=PDFAcroComboBox_default.create(this.doc.context);return comboBox.setPartialName(nameParts.terminal),addFieldToParent(parent,[comboBox,comboBox.ref],nameParts.terminal),PDFDropdown_default.of(comboBox,comboBox.ref,this.doc)},PDFForm2.prototype.createOptionList=function(name){assertIs(name,"name",["string"]);var nameParts=splitFieldName(name),parent=this.findOrCreateNonTerminals(nameParts.nonTerminal),listBox=PDFAcroListBox_default.create(this.doc.context);return listBox.setPartialName(nameParts.terminal),addFieldToParent(parent,[listBox,listBox.ref],nameParts.terminal),PDFOptionList_default.of(listBox,listBox.ref,this.doc)},PDFForm2.prototype.createRadioGroup=function(name){assertIs(name,"name",["string"]);var nameParts=splitFieldName(name),parent=this.findOrCreateNonTerminals(nameParts.nonTerminal),radioButton=PDFAcroRadioButton_default.create(this.doc.context);return radioButton.setPartialName(nameParts.terminal),addFieldToParent(parent,[radioButton,radioButton.ref],nameParts.terminal),PDFRadioGroup_default.of(radioButton,radioButton.ref,this.doc)},PDFForm2.prototype.createTextField=function(name){assertIs(name,"name",["string"]);var nameParts=splitFieldName(name),parent=this.findOrCreateNonTerminals(nameParts.nonTerminal),text2=PDFAcroText_default.create(this.doc.context);return text2.setPartialName(nameParts.terminal),addFieldToParent(parent,[text2,text2.ref],nameParts.terminal),PDFTextField_default.of(text2,text2.ref,this.doc)},PDFForm2.prototype.flatten=function(options){if(options===void 0)options={updateFieldAppearances:!0};if(options.updateFieldAppearances)this.updateFieldAppearances();var fields=this.getFields();for(var i3=0,lenFields=fields.length;i3<lenFields;i3++){var field=fields[i3],widgets=field.acroField.getWidgets();for(var j=0,lenWidgets=widgets.length;j<lenWidgets;j++){var widget=widgets[j],page=this.findWidgetPage(widget),widgetRef=this.findWidgetAppearanceRef(field,widget),xObjectKey=page.node.newXObject("FlatWidget",widgetRef),rectangle=widget.getRectangle(),operators=__spreadArrays([pushGraphicsState(),translate(rectangle.x,rectangle.y)],rotateInPlace(__assign(__assign({},rectangle),{rotation:0})),[drawObject(xObjectKey),popGraphicsState()]).filter(Boolean);page.pushOperators.apply(page,operators)}this.removeField(field)}},PDFForm2.prototype.removeField=function(field){var widgets=field.acroField.getWidgets(),pages=new Set;for(var i3=0,len3=widgets.length;i3<len3;i3++){var widget=widgets[i3],widgetRef=this.findWidgetAppearanceRef(field,widget),page=this.findWidgetPage(widget);pages.add(page),page.node.removeAnnot(widgetRef)}pages.forEach(function(page2){return page2.node.removeAnnot(field.ref)}),this.acroForm.removeField(field.acroField);var fieldKids=field.acroField.normalizedEntries().Kids,kidsCount=fieldKids.size();for(var childIndex=0;childIndex<kidsCount;childIndex++){var child=fieldKids.get(childIndex);if(child instanceof PDFRef_default)this.doc.context.delete(child)}this.doc.context.delete(field.ref)},PDFForm2.prototype.updateFieldAppearances=function(font){assertOrUndefined(font,"font",[[PDFFont_default,"PDFFont"]]),font=font!==null&&font!==void 0?font:this.getDefaultFont();var fields=this.getFields();for(var idx4=0,len3=fields.length;idx4<len3;idx4++){var field=fields[idx4];if(field.needsAppearancesUpdate())field.defaultUpdateAppearances(font)}},PDFForm2.prototype.markFieldAsDirty=function(fieldRef){assertOrUndefined(fieldRef,"fieldRef",[[PDFRef_default,"PDFRef"]]),this.dirtyFields.add(fieldRef)},PDFForm2.prototype.markFieldAsClean=function(fieldRef){assertOrUndefined(fieldRef,"fieldRef",[[PDFRef_default,"PDFRef"]]),this.dirtyFields.delete(fieldRef)},PDFForm2.prototype.fieldIsDirty=function(fieldRef){return assertOrUndefined(fieldRef,"fieldRef",[[PDFRef_default,"PDFRef"]]),this.dirtyFields.has(fieldRef)},PDFForm2.prototype.getDefaultFont=function(){return this.defaultFontCache.access()},PDFForm2.prototype.findWidgetPage=function(widget){var pageRef=widget.P(),page=this.doc.getPages().find(function(x){return x.ref===pageRef});if(page===void 0){var widgetRef=this.doc.context.getObjectRef(widget.dict);if(widgetRef===void 0)throw new Error("Could not find PDFRef for PDFObject");if(page=this.doc.findPageForAnnotationRef(widgetRef),page===void 0)throw new Error("Could not find page for PDFRef "+widgetRef)}return page},PDFForm2.prototype.findWidgetAppearanceRef=function(field,widget){var _a,refOrDict=widget.getNormalAppearance();if(refOrDict instanceof PDFDict_default&&(field instanceof PDFCheckBox_default||field instanceof PDFRadioGroup_default)){var value=field.acroField.getValue(),ref=(_a=refOrDict.get(value))!==null&&_a!==void 0?_a:refOrDict.get(PDFName_default.of("Off"));if(ref instanceof PDFRef_default)refOrDict=ref}if(!(refOrDict instanceof PDFRef_default)){var name_1=field.getName();throw new Error("Failed to extract appearance ref for: "+name_1)}return refOrDict},PDFForm2.prototype.findOrCreateNonTerminals=function(partialNames){var nonTerminal=[this.acroForm];for(var idx4=0,len3=partialNames.length;idx4<len3;idx4++){var namePart=partialNames[idx4];if(!namePart)throw new InvalidFieldNamePartError(namePart);var parent_1=nonTerminal[0],parentRef=nonTerminal[1],res=this.findNonTerminal(namePart,parent_1);if(res)nonTerminal=res;else{var node=PDFAcroNonTerminal_default.create(this.doc.context);node.setPartialName(namePart),node.setParent(parentRef);var nodeRef=this.doc.context.register(node.dict);parent_1.addField(nodeRef),nonTerminal=[node,nodeRef]}}return nonTerminal},PDFForm2.prototype.findNonTerminal=function(partialName,parent){var fields=parent instanceof PDFAcroForm_default?this.acroForm.getFields():createPDFAcroFields(parent.Kids());for(var idx4=0,len3=fields.length;idx4<len3;idx4++){var _a=fields[idx4],field=_a[0],ref=_a[1];if(field.getPartialName()===partialName){if(field instanceof PDFAcroNonTerminal_default)return[field,ref];throw new FieldAlreadyExistsError(partialName)}}return},PDFForm2.of=function(acroForm,doc){return new PDFForm2(acroForm,doc)},PDFForm2}(),PDFForm_default=PDFForm,convertToPDFField=function(field,ref,doc){if(field instanceof PDFAcroPushButton_default)return PDFButton_default.of(field,ref,doc);if(field instanceof PDFAcroCheckBox_default)return PDFCheckBox_default.of(field,ref,doc);if(field instanceof PDFAcroComboBox_default)return PDFDropdown_default.of(field,ref,doc);if(field instanceof PDFAcroListBox_default)return PDFOptionList_default.of(field,ref,doc);if(field instanceof PDFAcroText_default)return PDFTextField_default.of(field,ref,doc);if(field instanceof PDFAcroRadioButton_default)return PDFRadioGroup_default.of(field,ref,doc);if(field instanceof PDFAcroSignature_default)return PDFSignature_default.of(field,ref,doc);return},splitFieldName=function(fullyQualifiedName){if(fullyQualifiedName.length===0)throw new Error("PDF field names must not be empty strings");var parts=fullyQualifiedName.split(".");for(var idx4=0,len3=parts.length;idx4<len3;idx4++)if(parts[idx4]==="")throw new Error('Periods in PDF field names must be separated by at least one character: "'+fullyQualifiedName+'"');if(parts.length===1)return{nonTerminal:[],terminal:parts[0]};return{nonTerminal:parts.slice(0,parts.length-1),terminal:parts[parts.length-1]}},addFieldToParent=function(_a,_b,partialName){var parent=_a[0],parentRef=_a[1],field=_b[0],fieldRef=_b[1],entries=parent.normalizedEntries(),fields=createPDFAcroFields("Kids"in entries?entries.Kids:entries.Fields);for(var idx4=0,len3=fields.length;idx4<len3;idx4++)if(fields[idx4][0].getPartialName()===partialName)throw new FieldAlreadyExistsError(partialName);parent.addField(fieldRef),field.setParent(parentRef)};var PageSizes={"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],Executive:[521.86,756],Folio:[612,936],Legal:[612,1008],Letter:[612,792],Tabloid:[792,1224]};var ParseSpeeds;(function(ParseSpeeds2){ParseSpeeds2[ParseSpeeds2.Fastest=1/0]="Fastest",ParseSpeeds2[ParseSpeeds2.Fast=1500]="Fast",ParseSpeeds2[ParseSpeeds2.Medium=500]="Medium",ParseSpeeds2[ParseSpeeds2.Slow=100]="Slow"})(ParseSpeeds||(ParseSpeeds={}));var PDFEmbeddedFile=function(){function PDFEmbeddedFile2(ref,doc,embedder){this.alreadyEmbedded=!1,this.ref=ref,this.doc=doc,this.embedder=embedder}return PDFEmbeddedFile2.prototype.embed=function(){return __awaiter(this,void 0,void 0,function(){var ref,Names,EmbeddedFiles,EFNames,AF;return __generator(this,function(_a){switch(_a.label){case 0:if(this.alreadyEmbedded)return[3,2];return[4,this.embedder.embedIntoContext(this.doc.context,this.ref)];case 1:if(ref=_a.sent(),!this.doc.catalog.has(PDFName_default.of("Names")))this.doc.catalog.set(PDFName_default.of("Names"),this.doc.context.obj({}));if(Names=this.doc.catalog.lookup(PDFName_default.of("Names"),PDFDict_default),!Names.has(PDFName_default.of("EmbeddedFiles")))Names.set(PDFName_default.of("EmbeddedFiles"),this.doc.context.obj({}));if(EmbeddedFiles=Names.lookup(PDFName_default.of("EmbeddedFiles"),PDFDict_default),!EmbeddedFiles.has(PDFName_default.of("Names")))EmbeddedFiles.set(PDFName_default.of("Names"),this.doc.context.obj([]));if(EFNames=EmbeddedFiles.lookup(PDFName_default.of("Names"),PDFArray_default),EFNames.push(PDFHexString_default.fromText(this.embedder.fileName)),EFNames.push(ref),!this.doc.catalog.has(PDFName_default.of("AF")))this.doc.catalog.set(PDFName_default.of("AF"),this.doc.context.obj([]));AF=this.doc.catalog.lookup(PDFName_default.of("AF"),PDFArray_default),AF.push(ref),this.alreadyEmbedded=!0,_a.label=2;case 2:return[2]}})})},PDFEmbeddedFile2.of=function(ref,doc,embedder){return new PDFEmbeddedFile2(ref,doc,embedder)},PDFEmbeddedFile2}(),PDFEmbeddedFile_default=PDFEmbeddedFile;var PDFJavaScript=function(){function PDFJavaScript2(ref,doc,embedder){this.alreadyEmbedded=!1,this.ref=ref,this.doc=doc,this.embedder=embedder}return PDFJavaScript2.prototype.embed=function(){return __awaiter(this,void 0,void 0,function(){var _a,catalog,context,ref,Names,Javascript,JSNames;return __generator(this,function(_b){switch(_b.label){case 0:if(this.alreadyEmbedded)return[3,2];return _a=this.doc,catalog=_a.catalog,context=_a.context,[4,this.embedder.embedIntoContext(this.doc.context,this.ref)];case 1:if(ref=_b.sent(),!catalog.has(PDFName_default.of("Names")))catalog.set(PDFName_default.of("Names"),context.obj({}));if(Names=catalog.lookup(PDFName_default.of("Names"),PDFDict_default),!Names.has(PDFName_default.of("JavaScript")))Names.set(PDFName_default.of("JavaScript"),context.obj({}));if(Javascript=Names.lookup(PDFName_default.of("JavaScript"),PDFDict_default),!Javascript.has(PDFName_default.of("Names")))Javascript.set(PDFName_default.of("Names"),context.obj([]));JSNames=Javascript.lookup(PDFName_default.of("Names"),PDFArray_default),JSNames.push(PDFHexString_default.fromText(this.embedder.scriptName)),JSNames.push(ref),this.alreadyEmbedded=!0,_b.label=2;case 2:return[2]}})})},PDFJavaScript2.of=function(ref,doc,embedder){return new PDFJavaScript2(ref,doc,embedder)},PDFJavaScript2}(),PDFJavaScript_default=PDFJavaScript;var JavaScriptEmbedder=function(){function JavaScriptEmbedder2(script,scriptName){this.script=script,this.scriptName=scriptName}return JavaScriptEmbedder2.for=function(script,scriptName){return new JavaScriptEmbedder2(script,scriptName)},JavaScriptEmbedder2.prototype.embedIntoContext=function(context,ref){return __awaiter(this,void 0,void 0,function(){var jsActionDict;return __generator(this,function(_a){if(jsActionDict=context.obj({Type:"Action",S:"JavaScript",JS:PDFHexString_default.fromText(this.script)}),ref)return context.assign(ref,jsActionDict),[2,ref];else return[2,context.register(jsActionDict)];return[2]})})},JavaScriptEmbedder2}(),JavaScriptEmbedder_default=JavaScriptEmbedder;var PDFDocument=function(){function PDFDocument2(context,ignoreEncryption,updateMetadata){var _this=this;if(this.defaultWordBreaks=[" "],this.computePages=function(){var pages=[];return _this.catalog.Pages().traverse(function(node,ref){if(node instanceof PDFPageLeaf_default){var page=_this.pageMap.get(node);if(!page)page=PDFPage_default.of(node,ref,_this),_this.pageMap.set(node,page);pages.push(page)}}),pages},this.getOrCreateForm=function(){var acroForm=_this.catalog.getOrCreateAcroForm();return PDFForm_default.of(acroForm,_this)},assertIs(context,"context",[[PDFContext_default,"PDFContext"]]),assertIs(ignoreEncryption,"ignoreEncryption",["boolean"]),this.context=context,this.catalog=context.lookup(context.trailerInfo.Root),this.isEncrypted=!!context.lookup(context.trailerInfo.Encrypt),this.pageCache=Cache_default.populatedBy(this.computePages),this.pageMap=new Map,this.formCache=Cache_default.populatedBy(this.getOrCreateForm),this.fonts=[],this.images=[],this.embeddedPages=[],this.embeddedFiles=[],this.javaScripts=[],!ignoreEncryption&&this.isEncrypted)throw new EncryptedPDFError;if(updateMetadata)this.updateInfoDict()}return PDFDocument2.load=function(pdf,options){if(options===void 0)options={};return __awaiter(this,void 0,void 0,function(){var _a,ignoreEncryption,_b,parseSpeed,_c,throwOnInvalidObject,_d,updateMetadata,_e,capNumbers,bytes,context;return __generator(this,function(_f){switch(_f.label){case 0:return _a=options.ignoreEncryption,ignoreEncryption=_a===void 0?!1:_a,_b=options.parseSpeed,parseSpeed=_b===void 0?ParseSpeeds.Slow:_b,_c=options.throwOnInvalidObject,throwOnInvalidObject=_c===void 0?!1:_c,_d=options.updateMetadata,updateMetadata=_d===void 0?!0:_d,_e=options.capNumbers,capNumbers=_e===void 0?!1:_e,assertIs(pdf,"pdf",["string",Uint8Array,ArrayBuffer]),assertIs(ignoreEncryption,"ignoreEncryption",["boolean"]),assertIs(parseSpeed,"parseSpeed",["number"]),assertIs(throwOnInvalidObject,"throwOnInvalidObject",["boolean"]),bytes=toUint8Array(pdf),[4,PDFParser_default.forBytesWithOptions(bytes,parseSpeed,throwOnInvalidObject,capNumbers).parseDocument()];case 1:return context=_f.sent(),[2,new PDFDocument2(context,ignoreEncryption,updateMetadata)]}})})},PDFDocument2.create=function(options){if(options===void 0)options={};return __awaiter(this,void 0,void 0,function(){var _a,updateMetadata,context,pageTree,pageTreeRef,catalog;return __generator(this,function(_b){return _a=options.updateMetadata,updateMetadata=_a===void 0?!0:_a,context=PDFContext_default.create(),pageTree=PDFPageTree_default.withContext(context),pageTreeRef=context.register(pageTree),catalog=PDFCatalog_default.withContextAndPages(context,pageTreeRef),context.trailerInfo.Root=context.register(catalog),[2,new PDFDocument2(context,!1,updateMetadata)]})})},PDFDocument2.prototype.registerFontkit=function(fontkit){this.fontkit=fontkit},PDFDocument2.prototype.getForm=function(){var form=this.formCache.access();if(form.hasXFA())console.warn("Removing XFA form data as pdf-lib does not support reading or writing XFA"),form.deleteXFA();return form},PDFDocument2.prototype.getTitle=function(){var title=this.getInfoDict().lookup(PDFName_default.Title);if(!title)return;return assertIsLiteralOrHexString(title),title.decodeText()},PDFDocument2.prototype.getAuthor=function(){var author=this.getInfoDict().lookup(PDFName_default.Author);if(!author)return;return assertIsLiteralOrHexString(author),author.decodeText()},PDFDocument2.prototype.getSubject=function(){var subject=this.getInfoDict().lookup(PDFName_default.Subject);if(!subject)return;return assertIsLiteralOrHexString(subject),subject.decodeText()},PDFDocument2.prototype.getKeywords=function(){var keywords=this.getInfoDict().lookup(PDFName_default.Keywords);if(!keywords)return;return assertIsLiteralOrHexString(keywords),keywords.decodeText()},PDFDocument2.prototype.getCreator=function(){var creator=this.getInfoDict().lookup(PDFName_default.Creator);if(!creator)return;return assertIsLiteralOrHexString(creator),creator.decodeText()},PDFDocument2.prototype.getProducer=function(){var producer=this.getInfoDict().lookup(PDFName_default.Producer);if(!producer)return;return assertIsLiteralOrHexString(producer),producer.decodeText()},PDFDocument2.prototype.getCreationDate=function(){var creationDate=this.getInfoDict().lookup(PDFName_default.CreationDate);if(!creationDate)return;return assertIsLiteralOrHexString(creationDate),creationDate.decodeDate()},PDFDocument2.prototype.getModificationDate=function(){var modificationDate=this.getInfoDict().lookup(PDFName_default.ModDate);if(!modificationDate)return;return assertIsLiteralOrHexString(modificationDate),modificationDate.decodeDate()},PDFDocument2.prototype.setTitle=function(title,options){assertIs(title,"title",["string"]);var key=PDFName_default.of("Title");if(this.getInfoDict().set(key,PDFHexString_default.fromText(title)),options===null||options===void 0?void 0:options.showInWindowTitleBar){var prefs=this.catalog.getOrCreateViewerPreferences();prefs.setDisplayDocTitle(!0)}},PDFDocument2.prototype.setAuthor=function(author){assertIs(author,"author",["string"]);var key=PDFName_default.of("Author");this.getInfoDict().set(key,PDFHexString_default.fromText(author))},PDFDocument2.prototype.setSubject=function(subject){assertIs(subject,"author",["string"]);var key=PDFName_default.of("Subject");this.getInfoDict().set(key,PDFHexString_default.fromText(subject))},PDFDocument2.prototype.setKeywords=function(keywords){assertIs(keywords,"keywords",[Array]);var key=PDFName_default.of("Keywords");this.getInfoDict().set(key,PDFHexString_default.fromText(keywords.join(" ")))},PDFDocument2.prototype.setCreator=function(creator){assertIs(creator,"creator",["string"]);var key=PDFName_default.of("Creator");this.getInfoDict().set(key,PDFHexString_default.fromText(creator))},PDFDocument2.prototype.setProducer=function(producer){assertIs(producer,"creator",["string"]);var key=PDFName_default.of("Producer");this.getInfoDict().set(key,PDFHexString_default.fromText(producer))},PDFDocument2.prototype.setLanguage=function(language){assertIs(language,"language",["string"]);var key=PDFName_default.of("Lang");this.catalog.set(key,PDFString_default.of(language))},PDFDocument2.prototype.setCreationDate=function(creationDate){assertIs(creationDate,"creationDate",[[Date,"Date"]]);var key=PDFName_default.of("CreationDate");this.getInfoDict().set(key,PDFString_default.fromDate(creationDate))},PDFDocument2.prototype.setModificationDate=function(modificationDate){assertIs(modificationDate,"modificationDate",[[Date,"Date"]]);var key=PDFName_default.of("ModDate");this.getInfoDict().set(key,PDFString_default.fromDate(modificationDate))},PDFDocument2.prototype.getPageCount=function(){if(this.pageCount===void 0)this.pageCount=this.getPages().length;return this.pageCount},PDFDocument2.prototype.getPages=function(){return this.pageCache.access()},PDFDocument2.prototype.getPage=function(index2){var pages=this.getPages();return assertRange(index2,"index",0,pages.length-1),pages[index2]},PDFDocument2.prototype.getPageIndices=function(){return range(0,this.getPageCount())},PDFDocument2.prototype.removePage=function(index2){var pageCount=this.getPageCount();if(this.pageCount===0)throw new RemovePageFromEmptyDocumentError;assertRange(index2,"index",0,pageCount-1),this.catalog.removeLeafNode(index2),this.pageCount=pageCount-1},PDFDocument2.prototype.addPage=function(page){return assertIs(page,"page",["undefined",[PDFPage_default,"PDFPage"],Array]),this.insertPage(this.getPageCount(),page)},PDFDocument2.prototype.insertPage=function(index2,page){var pageCount=this.getPageCount();if(assertRange(index2,"index",0,pageCount),assertIs(page,"page",["undefined",[PDFPage_default,"PDFPage"],Array]),!page||Array.isArray(page)){var dims=Array.isArray(page)?page:PageSizes.A4;page=PDFPage_default.create(this),page.setSize.apply(page,dims)}else if(page.doc!==this)throw new ForeignPageError;var parentRef=this.catalog.insertLeafNode(page.ref,index2);return page.node.setParent(parentRef),this.pageMap.set(page.node,page),this.pageCache.invalidate(),this.pageCount=pageCount+1,page},PDFDocument2.prototype.copyPages=function(srcDoc,indices){return __awaiter(this,void 0,void 0,function(){var copier,srcPages,copiedPages,idx4,len3,srcPage,copiedPage,ref;return __generator(this,function(_a){switch(_a.label){case 0:return assertIs(srcDoc,"srcDoc",[[PDFDocument2,"PDFDocument"]]),assertIs(indices,"indices",[Array]),[4,srcDoc.flush()];case 1:_a.sent(),copier=PDFObjectCopier_default.for(srcDoc.context,this.context),srcPages=srcDoc.getPages(),copiedPages=new Array(indices.length);for(idx4=0,len3=indices.length;idx4<len3;idx4++)srcPage=srcPages[indices[idx4]],copiedPage=copier.copy(srcPage.node),ref=this.context.register(copiedPage),copiedPages[idx4]=PDFPage_default.of(copiedPage,ref,this);return[2,copiedPages]}})})},PDFDocument2.prototype.copy=function(){return __awaiter(this,void 0,void 0,function(){var pdfCopy,contentPages,idx4,len3;return __generator(this,function(_a){switch(_a.label){case 0:return[4,PDFDocument2.create()];case 1:return pdfCopy=_a.sent(),[4,pdfCopy.copyPages(this,this.getPageIndices())];case 2:contentPages=_a.sent();for(idx4=0,len3=contentPages.length;idx4<len3;idx4++)pdfCopy.addPage(contentPages[idx4]);if(this.getAuthor()!==void 0)pdfCopy.setAuthor(this.getAuthor());if(this.getCreationDate()!==void 0)pdfCopy.setCreationDate(this.getCreationDate());if(this.getCreator()!==void 0)pdfCopy.setCreator(this.getCreator());if(this.getModificationDate()!==void 0)pdfCopy.setModificationDate(this.getModificationDate());if(this.getProducer()!==void 0)pdfCopy.setProducer(this.getProducer());if(this.getSubject()!==void 0)pdfCopy.setSubject(this.getSubject());if(this.getTitle()!==void 0)pdfCopy.setTitle(this.getTitle());return pdfCopy.defaultWordBreaks=this.defaultWordBreaks,[2,pdfCopy]}})})},PDFDocument2.prototype.addJavaScript=function(name,script){assertIs(name,"name",["string"]),assertIs(script,"script",["string"]);var embedder=JavaScriptEmbedder_default.for(script,name),ref=this.context.nextRef(),javaScript=PDFJavaScript_default.of(ref,this,embedder);this.javaScripts.push(javaScript)},PDFDocument2.prototype.attach=function(attachment,name,options){if(options===void 0)options={};return __awaiter(this,void 0,void 0,function(){var bytes,embedder,ref,embeddedFile;return __generator(this,function(_a){return assertIs(attachment,"attachment",["string",Uint8Array,ArrayBuffer]),assertIs(name,"name",["string"]),assertOrUndefined(options.mimeType,"mimeType",["string"]),assertOrUndefined(options.description,"description",["string"]),assertOrUndefined(options.creationDate,"options.creationDate",[Date]),assertOrUndefined(options.modificationDate,"options.modificationDate",[Date]),assertIsOneOfOrUndefined(options.afRelationship,"options.afRelationship",AFRelationship),bytes=toUint8Array(attachment),embedder=FileEmbedder_default.for(bytes,name,options),ref=this.context.nextRef(),embeddedFile=PDFEmbeddedFile_default.of(ref,this,embedder),this.embeddedFiles.push(embeddedFile),[2]})})},PDFDocument2.prototype.embedFont=function(font,options){if(options===void 0)options={};return __awaiter(this,void 0,void 0,function(){var _a,subset,customName,features,embedder,bytes,fontkit,_b,ref,pdfFont;return __generator(this,function(_c){switch(_c.label){case 0:if(_a=options.subset,subset=_a===void 0?!1:_a,customName=options.customName,features=options.features,assertIs(font,"font",["string",Uint8Array,ArrayBuffer]),assertIs(subset,"subset",["boolean"]),!isStandardFont(font))return[3,1];return embedder=StandardFontEmbedder_default.for(font,customName),[3,7];case 1:if(!canBeConvertedToUint8Array(font))return[3,6];if(bytes=toUint8Array(font),fontkit=this.assertFontkit(),!subset)return[3,3];return[4,CustomFontSubsetEmbedder_default.for(fontkit,bytes,customName,features)];case 2:return _b=_c.sent(),[3,5];case 3:return[4,CustomFontEmbedder_default.for(fontkit,bytes,customName,features)];case 4:_b=_c.sent(),_c.label=5;case 5:return embedder=_b,[3,7];case 6:throw new TypeError("`font` must be one of `StandardFonts | string | Uint8Array | ArrayBuffer`");case 7:return ref=this.context.nextRef(),pdfFont=PDFFont_default.of(ref,this,embedder),this.fonts.push(pdfFont),[2,pdfFont]}})})},PDFDocument2.prototype.embedStandardFont=function(font,customName){if(assertIs(font,"font",["string"]),!isStandardFont(font))throw new TypeError("`font` must be one of type `StandardFonts`");var embedder=StandardFontEmbedder_default.for(font,customName),ref=this.context.nextRef(),pdfFont=PDFFont_default.of(ref,this,embedder);return this.fonts.push(pdfFont),pdfFont},PDFDocument2.prototype.embedJpg=function(jpg){return __awaiter(this,void 0,void 0,function(){var bytes,embedder,ref,pdfImage;return __generator(this,function(_a){switch(_a.label){case 0:return assertIs(jpg,"jpg",["string",Uint8Array,ArrayBuffer]),bytes=toUint8Array(jpg),[4,JpegEmbedder_default.for(bytes)];case 1:return embedder=_a.sent(),ref=this.context.nextRef(),pdfImage=PDFImage_default.of(ref,this,embedder),this.images.push(pdfImage),[2,pdfImage]}})})},PDFDocument2.prototype.embedPng=function(png){return __awaiter(this,void 0,void 0,function(){var bytes,embedder,ref,pdfImage;return __generator(this,function(_a){switch(_a.label){case 0:return assertIs(png,"png",["string",Uint8Array,ArrayBuffer]),bytes=toUint8Array(png),[4,PngEmbedder_default.for(bytes)];case 1:return embedder=_a.sent(),ref=this.context.nextRef(),pdfImage=PDFImage_default.of(ref,this,embedder),this.images.push(pdfImage),[2,pdfImage]}})})},PDFDocument2.prototype.embedPdf=function(pdf,indices){if(indices===void 0)indices=[0];return __awaiter(this,void 0,void 0,function(){var srcDoc,_a,srcPages;return __generator(this,function(_b){switch(_b.label){case 0:if(assertIs(pdf,"pdf",["string",Uint8Array,ArrayBuffer,[PDFDocument2,"PDFDocument"]]),assertIs(indices,"indices",[Array]),!(pdf instanceof PDFDocument2))return[3,1];return _a=pdf,[3,3];case 1:return[4,PDFDocument2.load(pdf)];case 2:_a=_b.sent(),_b.label=3;case 3:return srcDoc=_a,srcPages=pluckIndices(srcDoc.getPages(),indices),[2,this.embedPages(srcPages)]}})})},PDFDocument2.prototype.embedPage=function(page,boundingBox,transformationMatrix){return __awaiter(this,void 0,void 0,function(){var embeddedPage;return __generator(this,function(_a){switch(_a.label){case 0:return assertIs(page,"page",[[PDFPage_default,"PDFPage"]]),[4,this.embedPages([page],[boundingBox],[transformationMatrix])];case 1:return embeddedPage=_a.sent()[0],[2,embeddedPage]}})})},PDFDocument2.prototype.embedPages=function(pages,boundingBoxes,transformationMatrices){if(boundingBoxes===void 0)boundingBoxes=[];if(transformationMatrices===void 0)transformationMatrices=[];return __awaiter(this,void 0,void 0,function(){var idx4,len3,currPage,nextPage,context,maybeCopyPage,embeddedPages,idx4,len3,page,box,matrix,embedder,ref,_a;return __generator(this,function(_b){switch(_b.label){case 0:if(pages.length===0)return[2,[]];for(idx4=0,len3=pages.length-1;idx4<len3;idx4++)if(currPage=pages[idx4],nextPage=pages[idx4+1],currPage.node.context!==nextPage.node.context)throw new PageEmbeddingMismatchedContextError;context=pages[0].node.context,maybeCopyPage=context===this.context?function(p){return p}:PDFObjectCopier_default.for(context,this.context).copy,embeddedPages=new Array(pages.length),idx4=0,len3=pages.length,_b.label=1;case 1:if(!(idx4<len3))return[3,4];return page=maybeCopyPage(pages[idx4].node),box=boundingBoxes[idx4],matrix=transformationMatrices[idx4],[4,PDFPageEmbedder_default.for(page,box,matrix)];case 2:embedder=_b.sent(),ref=this.context.nextRef(),embeddedPages[idx4]=PDFEmbeddedPage_default.of(ref,this,embedder),_b.label=3;case 3:return idx4++,[3,1];case 4:return(_a=this.embeddedPages).push.apply(_a,embeddedPages),[2,embeddedPages]}})})},PDFDocument2.prototype.flush=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.embedAll(this.fonts)];case 1:return _a.sent(),[4,this.embedAll(this.images)];case 2:return _a.sent(),[4,this.embedAll(this.embeddedPages)];case 3:return _a.sent(),[4,this.embedAll(this.embeddedFiles)];case 4:return _a.sent(),[4,this.embedAll(this.javaScripts)];case 5:return _a.sent(),[2]}})})},PDFDocument2.prototype.save=function(options){if(options===void 0)options={};return __awaiter(this,void 0,void 0,function(){var _a,useObjectStreams,_b,addDefaultPage,_c,objectsPerTick,_d,updateFieldAppearances,form,Writer;return __generator(this,function(_e){switch(_e.label){case 0:if(_a=options.useObjectStreams,useObjectStreams=_a===void 0?!0:_a,_b=options.addDefaultPage,addDefaultPage=_b===void 0?!0:_b,_c=options.objectsPerTick,objectsPerTick=_c===void 0?50:_c,_d=options.updateFieldAppearances,updateFieldAppearances=_d===void 0?!0:_d,assertIs(useObjectStreams,"useObjectStreams",["boolean"]),assertIs(addDefaultPage,"addDefaultPage",["boolean"]),assertIs(objectsPerTick,"objectsPerTick",["number"]),assertIs(updateFieldAppearances,"updateFieldAppearances",["boolean"]),addDefaultPage&&this.getPageCount()===0)this.addPage();if(updateFieldAppearances){if(form=this.formCache.getValue(),form)form.updateFieldAppearances()}return[4,this.flush()];case 1:return _e.sent(),Writer=useObjectStreams?PDFStreamWriter_default:PDFWriter_default,[2,Writer.forContext(this.context,objectsPerTick).serializeToBuffer()]}})})},PDFDocument2.prototype.saveAsBase64=function(options){if(options===void 0)options={};return __awaiter(this,void 0,void 0,function(){var _a,dataUri,otherOptions,bytes,base642;return __generator(this,function(_b){switch(_b.label){case 0:return _a=options.dataUri,dataUri=_a===void 0?!1:_a,otherOptions=__rest(options,["dataUri"]),assertIs(dataUri,"dataUri",["boolean"]),[4,this.save(otherOptions)];case 1:return bytes=_b.sent(),base642=encodeToBase64(bytes),[2,dataUri?"data:application/pdf;base64,"+base642:base642]}})})},PDFDocument2.prototype.findPageForAnnotationRef=function(ref){var pages=this.getPages();for(var idx4=0,len3=pages.length;idx4<len3;idx4++){var page=pages[idx4],annotations=page.node.Annots();if((annotations===null||annotations===void 0?void 0:annotations.indexOf(ref))!==void 0)return page}return},PDFDocument2.prototype.embedAll=function(embeddables){return __awaiter(this,void 0,void 0,function(){var idx4,len3;return __generator(this,function(_a){switch(_a.label){case 0:idx4=0,len3=embeddables.length,_a.label=1;case 1:if(!(idx4<len3))return[3,4];return[4,embeddables[idx4].embed()];case 2:_a.sent(),_a.label=3;case 3:return idx4++,[3,1];case 4:return[2]}})})},PDFDocument2.prototype.updateInfoDict=function(){var pdfLib="pdf-lib (https://github.com/Hopding/pdf-lib)",now=new Date,info=this.getInfoDict();if(this.setProducer(pdfLib),this.setModificationDate(now),!info.get(PDFName_default.of("Creator")))this.setCreator(pdfLib);if(!info.get(PDFName_default.of("CreationDate")))this.setCreationDate(now)},PDFDocument2.prototype.getInfoDict=function(){var existingInfo=this.context.lookup(this.context.trailerInfo.Info);if(existingInfo instanceof PDFDict_default)return existingInfo;var newInfo=this.context.obj({});return this.context.trailerInfo.Info=this.context.register(newInfo),newInfo},PDFDocument2.prototype.assertFontkit=function(){if(!this.fontkit)throw new FontkitNotRegisteredError;return this.fontkit},PDFDocument2}(),PDFDocument_default=PDFDocument;function assertIsLiteralOrHexString(pdfObject){if(!(pdfObject instanceof PDFHexString_default)&&!(pdfObject instanceof PDFString_default))throw new UnexpectedObjectTypeError([PDFHexString_default,PDFString_default],pdfObject)}var BlendMode;(function(BlendMode2){BlendMode2.Normal="Normal",BlendMode2.Multiply="Multiply",BlendMode2.Screen="Screen",BlendMode2.Overlay="Overlay",BlendMode2.Darken="Darken",BlendMode2.Lighten="Lighten",BlendMode2.ColorDodge="ColorDodge",BlendMode2.ColorBurn="ColorBurn",BlendMode2.HardLight="HardLight",BlendMode2.SoftLight="SoftLight",BlendMode2.Difference="Difference",BlendMode2.Exclusion="Exclusion"})(BlendMode||(BlendMode={}));var PDFPage=function(){function PDFPage2(leafNode,ref,doc){this.fontSize=24,this.fontColor=rgb(0,0,0),this.lineHeight=24,this.x=0,this.y=0,assertIs(leafNode,"leafNode",[[PDFPageLeaf_default,"PDFPageLeaf"]]),assertIs(ref,"ref",[[PDFRef_default,"PDFRef"]]),assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]),this.node=leafNode,this.ref=ref,this.doc=doc}return PDFPage2.prototype.setRotation=function(angle){var degreesAngle=toDegrees(angle);assertMultiple(degreesAngle,"degreesAngle",90),this.node.set(PDFName_default.of("Rotate"),this.doc.context.obj(degreesAngle))},PDFPage2.prototype.getRotation=function(){var Rotate=this.node.Rotate();return degrees(Rotate?Rotate.asNumber():0)},PDFPage2.prototype.setSize=function(width,height){assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var mediaBox=this.getMediaBox();this.setMediaBox(mediaBox.x,mediaBox.y,width,height);var cropBox=this.getCropBox(),bleedBox=this.getBleedBox(),trimBox=this.getTrimBox(),artBox=this.getArtBox(),hasCropBox=this.node.CropBox(),hasBleedBox=this.node.BleedBox(),hasTrimBox=this.node.TrimBox(),hasArtBox=this.node.ArtBox();if(hasCropBox&&rectanglesAreEqual(cropBox,mediaBox))this.setCropBox(mediaBox.x,mediaBox.y,width,height);if(hasBleedBox&&rectanglesAreEqual(bleedBox,mediaBox))this.setBleedBox(mediaBox.x,mediaBox.y,width,height);if(hasTrimBox&&rectanglesAreEqual(trimBox,mediaBox))this.setTrimBox(mediaBox.x,mediaBox.y,width,height);if(hasArtBox&&rectanglesAreEqual(artBox,mediaBox))this.setArtBox(mediaBox.x,mediaBox.y,width,height)},PDFPage2.prototype.setWidth=function(width){assertIs(width,"width",["number"]),this.setSize(width,this.getSize().height)},PDFPage2.prototype.setHeight=function(height){assertIs(height,"height",["number"]),this.setSize(this.getSize().width,height)},PDFPage2.prototype.setMediaBox=function(x,y,width,height){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var mediaBox=this.doc.context.obj([x,y,x+width,y+height]);this.node.set(PDFName_default.MediaBox,mediaBox)},PDFPage2.prototype.setCropBox=function(x,y,width,height){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var cropBox=this.doc.context.obj([x,y,x+width,y+height]);this.node.set(PDFName_default.CropBox,cropBox)},PDFPage2.prototype.setBleedBox=function(x,y,width,height){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var bleedBox=this.doc.context.obj([x,y,x+width,y+height]);this.node.set(PDFName_default.BleedBox,bleedBox)},PDFPage2.prototype.setTrimBox=function(x,y,width,height){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var trimBox=this.doc.context.obj([x,y,x+width,y+height]);this.node.set(PDFName_default.TrimBox,trimBox)},PDFPage2.prototype.setArtBox=function(x,y,width,height){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),assertIs(width,"width",["number"]),assertIs(height,"height",["number"]);var artBox=this.doc.context.obj([x,y,x+width,y+height]);this.node.set(PDFName_default.ArtBox,artBox)},PDFPage2.prototype.getSize=function(){var _a=this.getMediaBox(),width=_a.width,height=_a.height;return{width,height}},PDFPage2.prototype.getWidth=function(){return this.getSize().width},PDFPage2.prototype.getHeight=function(){return this.getSize().height},PDFPage2.prototype.getMediaBox=function(){var mediaBox=this.node.MediaBox();return mediaBox.asRectangle()},PDFPage2.prototype.getCropBox=function(){var _a,cropBox=this.node.CropBox();return(_a=cropBox===null||cropBox===void 0?void 0:cropBox.asRectangle())!==null&&_a!==void 0?_a:this.getMediaBox()},PDFPage2.prototype.getBleedBox=function(){var _a,bleedBox=this.node.BleedBox();return(_a=bleedBox===null||bleedBox===void 0?void 0:bleedBox.asRectangle())!==null&&_a!==void 0?_a:this.getCropBox()},PDFPage2.prototype.getTrimBox=function(){var _a,trimBox=this.node.TrimBox();return(_a=trimBox===null||trimBox===void 0?void 0:trimBox.asRectangle())!==null&&_a!==void 0?_a:this.getCropBox()},PDFPage2.prototype.getArtBox=function(){var _a,artBox=this.node.ArtBox();return(_a=artBox===null||artBox===void 0?void 0:artBox.asRectangle())!==null&&_a!==void 0?_a:this.getCropBox()},PDFPage2.prototype.translateContent=function(x,y){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),this.node.normalize(),this.getContentStream();var start=this.createContentStream(pushGraphicsState(),translate(x,y)),startRef=this.doc.context.register(start),end=this.createContentStream(popGraphicsState()),endRef=this.doc.context.register(end);this.node.wrapContentStreams(startRef,endRef)},PDFPage2.prototype.scale=function(x,y){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),this.setSize(this.getWidth()*x,this.getHeight()*y),this.scaleContent(x,y),this.scaleAnnotations(x,y)},PDFPage2.prototype.scaleContent=function(x,y){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),this.node.normalize(),this.getContentStream();var start=this.createContentStream(pushGraphicsState(),scale(x,y)),startRef=this.doc.context.register(start),end=this.createContentStream(popGraphicsState()),endRef=this.doc.context.register(end);this.node.wrapContentStreams(startRef,endRef)},PDFPage2.prototype.scaleAnnotations=function(x,y){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]);var annots=this.node.Annots();if(!annots)return;for(var idx4=0;idx4<annots.size();idx4++){var annot=annots.lookup(idx4);if(annot instanceof PDFDict_default)this.scaleAnnot(annot,x,y)}},PDFPage2.prototype.resetPosition=function(){this.getContentStream(!1),this.x=0,this.y=0},PDFPage2.prototype.setFont=function(font){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),this.font=font,this.fontKey=this.node.newFontDictionary(this.font.name,this.font.ref)},PDFPage2.prototype.setFontSize=function(fontSize){assertIs(fontSize,"fontSize",["number"]),this.fontSize=fontSize},PDFPage2.prototype.setFontColor=function(fontColor){assertIs(fontColor,"fontColor",[[Object,"Color"]]),this.fontColor=fontColor},PDFPage2.prototype.setLineHeight=function(lineHeight){assertIs(lineHeight,"lineHeight",["number"]),this.lineHeight=lineHeight},PDFPage2.prototype.getPosition=function(){return{x:this.x,y:this.y}},PDFPage2.prototype.getX=function(){return this.x},PDFPage2.prototype.getY=function(){return this.y},PDFPage2.prototype.moveTo=function(x,y){assertIs(x,"x",["number"]),assertIs(y,"y",["number"]),this.x=x,this.y=y},PDFPage2.prototype.moveDown=function(yDecrease){assertIs(yDecrease,"yDecrease",["number"]),this.y-=yDecrease},PDFPage2.prototype.moveUp=function(yIncrease){assertIs(yIncrease,"yIncrease",["number"]),this.y+=yIncrease},PDFPage2.prototype.moveLeft=function(xDecrease){assertIs(xDecrease,"xDecrease",["number"]),this.x-=xDecrease},PDFPage2.prototype.moveRight=function(xIncrease){assertIs(xIncrease,"xIncrease",["number"]),this.x+=xIncrease},PDFPage2.prototype.pushOperators=function(){var operator=[];for(var _i=0;_i<arguments.length;_i++)operator[_i]=arguments[_i];assertEachIs(operator,"operator",[[PDFOperator_default,"PDFOperator"]]);var contentStream=this.getContentStream();contentStream.push.apply(contentStream,operator)},PDFPage2.prototype.drawText=function(text2,options){var _a,_b,_c,_d,_e,_f,_g;if(options===void 0)options={};assertIs(text2,"text",["string"]),assertOrUndefined(options.color,"options.color",[[Object,"Color"]]),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertOrUndefined(options.font,"options.font",[[PDFFont_default,"PDFFont"]]),assertOrUndefined(options.size,"options.size",["number"]),assertOrUndefined(options.rotate,"options.rotate",[[Object,"Rotation"]]),assertOrUndefined(options.xSkew,"options.xSkew",[[Object,"Rotation"]]),assertOrUndefined(options.ySkew,"options.ySkew",[[Object,"Rotation"]]),assertOrUndefined(options.x,"options.x",["number"]),assertOrUndefined(options.y,"options.y",["number"]),assertOrUndefined(options.lineHeight,"options.lineHeight",["number"]),assertOrUndefined(options.maxWidth,"options.maxWidth",["number"]),assertOrUndefined(options.wordBreaks,"options.wordBreaks",[Array]),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var _h=this.setOrEmbedFont(options.font),oldFont=_h.oldFont,newFont=_h.newFont,newFontKey=_h.newFontKey,fontSize=options.size||this.fontSize,wordBreaks=options.wordBreaks||this.doc.defaultWordBreaks,textWidth=function(t2){return newFont.widthOfTextAtSize(t2,fontSize)},lines=options.maxWidth===void 0?lineSplit(cleanText(text2)):breakTextIntoLines(text2,wordBreaks,options.maxWidth,textWidth),encodedLines=new Array(lines.length);for(var idx4=0,len3=lines.length;idx4<len3;idx4++)encodedLines[idx4]=newFont.encodeText(lines[idx4]);var graphicsStateKey=this.maybeEmbedGraphicsState({opacity:options.opacity,blendMode:options.blendMode}),contentStream=this.getContentStream();if(contentStream.push.apply(contentStream,drawLinesOfText(encodedLines,{color:(_a=options.color)!==null&&_a!==void 0?_a:this.fontColor,font:newFontKey,size:fontSize,rotate:(_b=options.rotate)!==null&&_b!==void 0?_b:degrees(0),xSkew:(_c=options.xSkew)!==null&&_c!==void 0?_c:degrees(0),ySkew:(_d=options.ySkew)!==null&&_d!==void 0?_d:degrees(0),x:(_e=options.x)!==null&&_e!==void 0?_e:this.x,y:(_f=options.y)!==null&&_f!==void 0?_f:this.y,lineHeight:(_g=options.lineHeight)!==null&&_g!==void 0?_g:this.lineHeight,graphicsState:graphicsStateKey})),options.font)if(oldFont)this.setFont(oldFont);else this.resetFont()},PDFPage2.prototype.drawImage=function(image,options){var _a,_b,_c,_d,_e,_f,_g;if(options===void 0)options={};assertIs(image,"image",[[PDFImage_default,"PDFImage"]]),assertOrUndefined(options.x,"options.x",["number"]),assertOrUndefined(options.y,"options.y",["number"]),assertOrUndefined(options.width,"options.width",["number"]),assertOrUndefined(options.height,"options.height",["number"]),assertOrUndefined(options.rotate,"options.rotate",[[Object,"Rotation"]]),assertOrUndefined(options.xSkew,"options.xSkew",[[Object,"Rotation"]]),assertOrUndefined(options.ySkew,"options.ySkew",[[Object,"Rotation"]]),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var xObjectKey=this.node.newXObject("Image",image.ref),graphicsStateKey=this.maybeEmbedGraphicsState({opacity:options.opacity,blendMode:options.blendMode}),contentStream=this.getContentStream();contentStream.push.apply(contentStream,drawImage(xObjectKey,{x:(_a=options.x)!==null&&_a!==void 0?_a:this.x,y:(_b=options.y)!==null&&_b!==void 0?_b:this.y,width:(_c=options.width)!==null&&_c!==void 0?_c:image.size().width,height:(_d=options.height)!==null&&_d!==void 0?_d:image.size().height,rotate:(_e=options.rotate)!==null&&_e!==void 0?_e:degrees(0),xSkew:(_f=options.xSkew)!==null&&_f!==void 0?_f:degrees(0),ySkew:(_g=options.ySkew)!==null&&_g!==void 0?_g:degrees(0),graphicsState:graphicsStateKey}))},PDFPage2.prototype.drawPage=function(embeddedPage,options){var _a,_b,_c,_d,_e;if(options===void 0)options={};assertIs(embeddedPage,"embeddedPage",[[PDFEmbeddedPage_default,"PDFEmbeddedPage"]]),assertOrUndefined(options.x,"options.x",["number"]),assertOrUndefined(options.y,"options.y",["number"]),assertOrUndefined(options.xScale,"options.xScale",["number"]),assertOrUndefined(options.yScale,"options.yScale",["number"]),assertOrUndefined(options.width,"options.width",["number"]),assertOrUndefined(options.height,"options.height",["number"]),assertOrUndefined(options.rotate,"options.rotate",[[Object,"Rotation"]]),assertOrUndefined(options.xSkew,"options.xSkew",[[Object,"Rotation"]]),assertOrUndefined(options.ySkew,"options.ySkew",[[Object,"Rotation"]]),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var xObjectKey=this.node.newXObject("EmbeddedPdfPage",embeddedPage.ref),graphicsStateKey=this.maybeEmbedGraphicsState({opacity:options.opacity,blendMode:options.blendMode}),xScale=options.width!==void 0?options.width/embeddedPage.width:options.xScale!==void 0?options.xScale:1,yScale=options.height!==void 0?options.height/embeddedPage.height:options.yScale!==void 0?options.yScale:1,contentStream=this.getContentStream();contentStream.push.apply(contentStream,drawPage(xObjectKey,{x:(_a=options.x)!==null&&_a!==void 0?_a:this.x,y:(_b=options.y)!==null&&_b!==void 0?_b:this.y,xScale,yScale,rotate:(_c=options.rotate)!==null&&_c!==void 0?_c:degrees(0),xSkew:(_d=options.xSkew)!==null&&_d!==void 0?_d:degrees(0),ySkew:(_e=options.ySkew)!==null&&_e!==void 0?_e:degrees(0),graphicsState:graphicsStateKey}))},PDFPage2.prototype.drawSvgPath=function(path2,options){var _a,_b,_c,_d,_e,_f,_g,_h,_j;if(options===void 0)options={};assertIs(path2,"path",["string"]),assertOrUndefined(options.x,"options.x",["number"]),assertOrUndefined(options.y,"options.y",["number"]),assertOrUndefined(options.scale,"options.scale",["number"]),assertOrUndefined(options.rotate,"options.rotate",[[Object,"Rotation"]]),assertOrUndefined(options.borderWidth,"options.borderWidth",["number"]),assertOrUndefined(options.color,"options.color",[[Object,"Color"]]),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertOrUndefined(options.borderColor,"options.borderColor",[[Object,"Color"]]),assertOrUndefined(options.borderDashArray,"options.borderDashArray",[Array]),assertOrUndefined(options.borderDashPhase,"options.borderDashPhase",["number"]),assertIsOneOfOrUndefined(options.borderLineCap,"options.borderLineCap",LineCapStyle),assertRangeOrUndefined(options.borderOpacity,"options.borderOpacity",0,1),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var graphicsStateKey=this.maybeEmbedGraphicsState({opacity:options.opacity,borderOpacity:options.borderOpacity,blendMode:options.blendMode});if(!("color"in options)&&!("borderColor"in options))options.borderColor=rgb(0,0,0);var contentStream=this.getContentStream();contentStream.push.apply(contentStream,drawSvgPath(path2,{x:(_a=options.x)!==null&&_a!==void 0?_a:this.x,y:(_b=options.y)!==null&&_b!==void 0?_b:this.y,scale:options.scale,rotate:(_c=options.rotate)!==null&&_c!==void 0?_c:degrees(0),color:(_d=options.color)!==null&&_d!==void 0?_d:void 0,borderColor:(_e=options.borderColor)!==null&&_e!==void 0?_e:void 0,borderWidth:(_f=options.borderWidth)!==null&&_f!==void 0?_f:0,borderDashArray:(_g=options.borderDashArray)!==null&&_g!==void 0?_g:void 0,borderDashPhase:(_h=options.borderDashPhase)!==null&&_h!==void 0?_h:void 0,borderLineCap:(_j=options.borderLineCap)!==null&&_j!==void 0?_j:void 0,graphicsState:graphicsStateKey}))},PDFPage2.prototype.drawLine=function(options){var _a,_b,_c,_d,_e;assertIs(options.start,"options.start",[[Object,"{ x: number, y: number }"]]),assertIs(options.end,"options.end",[[Object,"{ x: number, y: number }"]]),assertIs(options.start.x,"options.start.x",["number"]),assertIs(options.start.y,"options.start.y",["number"]),assertIs(options.end.x,"options.end.x",["number"]),assertIs(options.end.y,"options.end.y",["number"]),assertOrUndefined(options.thickness,"options.thickness",["number"]),assertOrUndefined(options.color,"options.color",[[Object,"Color"]]),assertOrUndefined(options.dashArray,"options.dashArray",[Array]),assertOrUndefined(options.dashPhase,"options.dashPhase",["number"]),assertIsOneOfOrUndefined(options.lineCap,"options.lineCap",LineCapStyle),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var graphicsStateKey=this.maybeEmbedGraphicsState({borderOpacity:options.opacity,blendMode:options.blendMode});if(!("color"in options))options.color=rgb(0,0,0);var contentStream=this.getContentStream();contentStream.push.apply(contentStream,drawLine({start:options.start,end:options.end,thickness:(_a=options.thickness)!==null&&_a!==void 0?_a:1,color:(_b=options.color)!==null&&_b!==void 0?_b:void 0,dashArray:(_c=options.dashArray)!==null&&_c!==void 0?_c:void 0,dashPhase:(_d=options.dashPhase)!==null&&_d!==void 0?_d:void 0,lineCap:(_e=options.lineCap)!==null&&_e!==void 0?_e:void 0,graphicsState:graphicsStateKey}))},PDFPage2.prototype.drawRectangle=function(options){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o;if(options===void 0)options={};assertOrUndefined(options.x,"options.x",["number"]),assertOrUndefined(options.y,"options.y",["number"]),assertOrUndefined(options.width,"options.width",["number"]),assertOrUndefined(options.height,"options.height",["number"]),assertOrUndefined(options.rotate,"options.rotate",[[Object,"Rotation"]]),assertOrUndefined(options.xSkew,"options.xSkew",[[Object,"Rotation"]]),assertOrUndefined(options.ySkew,"options.ySkew",[[Object,"Rotation"]]),assertOrUndefined(options.borderWidth,"options.borderWidth",["number"]),assertOrUndefined(options.color,"options.color",[[Object,"Color"]]),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertOrUndefined(options.borderColor,"options.borderColor",[[Object,"Color"]]),assertOrUndefined(options.borderDashArray,"options.borderDashArray",[Array]),assertOrUndefined(options.borderDashPhase,"options.borderDashPhase",["number"]),assertIsOneOfOrUndefined(options.borderLineCap,"options.borderLineCap",LineCapStyle),assertRangeOrUndefined(options.borderOpacity,"options.borderOpacity",0,1),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var graphicsStateKey=this.maybeEmbedGraphicsState({opacity:options.opacity,borderOpacity:options.borderOpacity,blendMode:options.blendMode});if(!("color"in options)&&!("borderColor"in options))options.color=rgb(0,0,0);var contentStream=this.getContentStream();contentStream.push.apply(contentStream,drawRectangle({x:(_a=options.x)!==null&&_a!==void 0?_a:this.x,y:(_b=options.y)!==null&&_b!==void 0?_b:this.y,width:(_c=options.width)!==null&&_c!==void 0?_c:150,height:(_d=options.height)!==null&&_d!==void 0?_d:100,rotate:(_e=options.rotate)!==null&&_e!==void 0?_e:degrees(0),xSkew:(_f=options.xSkew)!==null&&_f!==void 0?_f:degrees(0),ySkew:(_g=options.ySkew)!==null&&_g!==void 0?_g:degrees(0),borderWidth:(_h=options.borderWidth)!==null&&_h!==void 0?_h:0,color:(_j=options.color)!==null&&_j!==void 0?_j:void 0,borderColor:(_k=options.borderColor)!==null&&_k!==void 0?_k:void 0,borderDashArray:(_l=options.borderDashArray)!==null&&_l!==void 0?_l:void 0,borderDashPhase:(_m=options.borderDashPhase)!==null&&_m!==void 0?_m:void 0,graphicsState:graphicsStateKey,borderLineCap:(_o=options.borderLineCap)!==null&&_o!==void 0?_o:void 0}))},PDFPage2.prototype.drawSquare=function(options){if(options===void 0)options={};var size=options.size;assertOrUndefined(size,"size",["number"]),this.drawRectangle(__assign(__assign({},options),{width:size,height:size}))},PDFPage2.prototype.drawEllipse=function(options){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;if(options===void 0)options={};assertOrUndefined(options.x,"options.x",["number"]),assertOrUndefined(options.y,"options.y",["number"]),assertOrUndefined(options.xScale,"options.xScale",["number"]),assertOrUndefined(options.yScale,"options.yScale",["number"]),assertOrUndefined(options.rotate,"options.rotate",[[Object,"Rotation"]]),assertOrUndefined(options.color,"options.color",[[Object,"Color"]]),assertRangeOrUndefined(options.opacity,"opacity.opacity",0,1),assertOrUndefined(options.borderColor,"options.borderColor",[[Object,"Color"]]),assertRangeOrUndefined(options.borderOpacity,"options.borderOpacity",0,1),assertOrUndefined(options.borderWidth,"options.borderWidth",["number"]),assertOrUndefined(options.borderDashArray,"options.borderDashArray",[Array]),assertOrUndefined(options.borderDashPhase,"options.borderDashPhase",["number"]),assertIsOneOfOrUndefined(options.borderLineCap,"options.borderLineCap",LineCapStyle),assertIsOneOfOrUndefined(options.blendMode,"options.blendMode",BlendMode);var graphicsStateKey=this.maybeEmbedGraphicsState({opacity:options.opacity,borderOpacity:options.borderOpacity,blendMode:options.blendMode});if(!("color"in options)&&!("borderColor"in options))options.color=rgb(0,0,0);var contentStream=this.getContentStream();contentStream.push.apply(contentStream,drawEllipse({x:(_a=options.x)!==null&&_a!==void 0?_a:this.x,y:(_b=options.y)!==null&&_b!==void 0?_b:this.y,xScale:(_c=options.xScale)!==null&&_c!==void 0?_c:100,yScale:(_d=options.yScale)!==null&&_d!==void 0?_d:100,rotate:(_e=options.rotate)!==null&&_e!==void 0?_e:void 0,color:(_f=options.color)!==null&&_f!==void 0?_f:void 0,borderColor:(_g=options.borderColor)!==null&&_g!==void 0?_g:void 0,borderWidth:(_h=options.borderWidth)!==null&&_h!==void 0?_h:0,borderDashArray:(_j=options.borderDashArray)!==null&&_j!==void 0?_j:void 0,borderDashPhase:(_k=options.borderDashPhase)!==null&&_k!==void 0?_k:void 0,borderLineCap:(_l=options.borderLineCap)!==null&&_l!==void 0?_l:void 0,graphicsState:graphicsStateKey}))},PDFPage2.prototype.drawCircle=function(options){if(options===void 0)options={};var _a=options.size,size=_a===void 0?100:_a;assertOrUndefined(size,"size",["number"]),this.drawEllipse(__assign(__assign({},options),{xScale:size,yScale:size}))},PDFPage2.prototype.setOrEmbedFont=function(font){var oldFont=this.font,oldFontKey=this.fontKey;if(font)this.setFont(font);else this.getFont();var newFont=this.font,newFontKey=this.fontKey;return{oldFont,oldFontKey,newFont,newFontKey}},PDFPage2.prototype.getFont=function(){if(!this.font||!this.fontKey){var font=this.doc.embedStandardFont(StandardFonts.Helvetica);this.setFont(font)}return[this.font,this.fontKey]},PDFPage2.prototype.resetFont=function(){this.font=void 0,this.fontKey=void 0},PDFPage2.prototype.getContentStream=function(useExisting){if(useExisting===void 0)useExisting=!0;if(useExisting&&this.contentStream)return this.contentStream;return this.contentStream=this.createContentStream(),this.contentStreamRef=this.doc.context.register(this.contentStream),this.node.addContentStream(this.contentStreamRef),this.contentStream},PDFPage2.prototype.createContentStream=function(){var operators=[];for(var _i=0;_i<arguments.length;_i++)operators[_i]=arguments[_i];var dict=this.doc.context.obj({}),contentStream=PDFContentStream_default.of(dict,operators);return contentStream},PDFPage2.prototype.maybeEmbedGraphicsState=function(options){var{opacity,borderOpacity,blendMode}=options;if(opacity===void 0&&borderOpacity===void 0&&blendMode===void 0)return;var graphicsState=this.doc.context.obj({Type:"ExtGState",ca:opacity,CA:borderOpacity,BM:blendMode}),key=this.node.newExtGState("GS",graphicsState);return key},PDFPage2.prototype.scaleAnnot=function(annot,x,y){var selectors=["RD","CL","Vertices","QuadPoints","L","Rect"];for(var idx4=0,len3=selectors.length;idx4<len3;idx4++){var list=annot.lookup(PDFName_default.of(selectors[idx4]));if(list instanceof PDFArray_default)list.scalePDFNumbers(x,y)}var inkLists=annot.lookup(PDFName_default.of("InkList"));if(inkLists instanceof PDFArray_default)for(var idx4=0,len3=inkLists.size();idx4<len3;idx4++){var arr=inkLists.lookup(idx4);if(arr instanceof PDFArray_default)arr.scalePDFNumbers(x,y)}},PDFPage2.of=function(leafNode,ref,doc){return new PDFPage2(leafNode,ref,doc)},PDFPage2.create=function(doc){assertIs(doc,"doc",[[PDFDocument_default,"PDFDocument"]]);var dummyRef=PDFRef_default.of(-1),pageLeaf=PDFPageLeaf_default.withContextAndParent(doc.context,dummyRef),pageRef=doc.context.register(pageLeaf);return new PDFPage2(pageLeaf,pageRef,doc)},PDFPage2}(),PDFPage_default=PDFPage;var PDFButton=function(_super){__extends(PDFButton2,_super);function PDFButton2(acroPushButton,ref,doc){var _this=_super.call(this,acroPushButton,ref,doc)||this;return assertIs(acroPushButton,"acroButton",[[PDFAcroPushButton_default,"PDFAcroPushButton"]]),_this.acroField=acroPushButton,_this}return PDFButton2.prototype.setImage=function(image,alignment2){if(alignment2===void 0)alignment2=ImageAlignment.Center;var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],streamRef=this.createImageAppearanceStream(widget,image,alignment2);this.updateWidgetAppearances(widget,{normal:streamRef})}this.markAsClean()},PDFButton2.prototype.setFontSize=function(fontSize){assertPositive(fontSize,"fontSize"),this.acroField.setFontSize(fontSize),this.markAsDirty()},PDFButton2.prototype.addToPage=function(text2,page,options){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;assertOrUndefined(text2,"text",["string"]),assertOrUndefined(page,"page",[[PDFPage_default,"PDFPage"]]),assertFieldAppearanceOptions(options);var widget=this.createWidget({x:((_a=options===null||options===void 0?void 0:options.x)!==null&&_a!==void 0?_a:0)-((_b=options===null||options===void 0?void 0:options.borderWidth)!==null&&_b!==void 0?_b:0)/2,y:((_c=options===null||options===void 0?void 0:options.y)!==null&&_c!==void 0?_c:0)-((_d=options===null||options===void 0?void 0:options.borderWidth)!==null&&_d!==void 0?_d:0)/2,width:(_e=options===null||options===void 0?void 0:options.width)!==null&&_e!==void 0?_e:100,height:(_f=options===null||options===void 0?void 0:options.height)!==null&&_f!==void 0?_f:50,textColor:(_g=options===null||options===void 0?void 0:options.textColor)!==null&&_g!==void 0?_g:rgb(0,0,0),backgroundColor:(_h=options===null||options===void 0?void 0:options.backgroundColor)!==null&&_h!==void 0?_h:rgb(0.75,0.75,0.75),borderColor:options===null||options===void 0?void 0:options.borderColor,borderWidth:(_j=options===null||options===void 0?void 0:options.borderWidth)!==null&&_j!==void 0?_j:0,rotate:(_k=options===null||options===void 0?void 0:options.rotate)!==null&&_k!==void 0?_k:degrees(0),caption:text2,hidden:options===null||options===void 0?void 0:options.hidden,page:page.ref}),widgetRef=this.doc.context.register(widget.dict);this.acroField.addWidget(widgetRef);var font=(_l=options===null||options===void 0?void 0:options.font)!==null&&_l!==void 0?_l:this.doc.getForm().getDefaultFont();this.updateWidgetAppearance(widget,font),page.node.addAnnot(widgetRef)},PDFButton2.prototype.needsAppearancesUpdate=function(){var _a;if(this.isDirty())return!0;var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4],hasAppearances=((_a=widget.getAppearances())===null||_a===void 0?void 0:_a.normal)instanceof PDFStream_default;if(!hasAppearances)return!0}return!1},PDFButton2.prototype.defaultUpdateAppearances=function(font){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),this.updateAppearances(font)},PDFButton2.prototype.updateAppearances=function(font,provider){assertIs(font,"font",[[PDFFont_default,"PDFFont"]]),assertOrUndefined(provider,"provider",[Function]);var widgets=this.acroField.getWidgets();for(var idx4=0,len3=widgets.length;idx4<len3;idx4++){var widget=widgets[idx4];this.updateWidgetAppearance(widget,font,provider)}},PDFButton2.prototype.updateWidgetAppearance=function(widget,font,provider){var apProvider=provider!==null&&provider!==void 0?provider:defaultButtonAppearanceProvider,appearances=normalizeAppearance(apProvider(this,widget,font));this.updateWidgetAppearanceWithFont(widget,font,appearances)},PDFButton2.of=function(acroPushButton,ref,doc){return new PDFButton2(acroPushButton,ref,doc)},PDFButton2}(PDFField_default),PDFButton_default=PDFButton;import_dotenv.default.config();var frontendURL=process.env.FRONTEND_URL_DEV,{JWT_TOKEN}=process.env;if(!JWT_TOKEN)throw new Error("Missing required environment variables!");var qrCodePlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_TOKEN})).get("/check-isQrCode",async({jwt:jwt2,cookie})=>{try{let{userId,shopId}=await extractId({jwt:jwt2,cookie});if(!shopId||!userId)return;if((await mainDb.select({isQrCode:products.isQRCode}).from(products).where(eq(products.isQRCode,!1))).length===0)return{success:!1,message:"Hakuna bidhaa ya kutengenezea QR Code"};return{success:!0,message:"Kuna bidhaa zimepatikana, zinahitaji QR Code"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Tatizo limetokea wakati wa kuangalia uhitaji wa QRCode"}}}).get("/generate-qrcode",async({jwt:jwt2,cookie,set:set2})=>{try{let{userId,shopId}=await extractId({jwt:jwt2,cookie});if(!shopId||!userId)return;let productList=await mainDb.select({id:products.id,name:products.name,priceSold:products.priceSold,supplierId:products.supplierId}).from(products).where(eq(products.isQRCode,!1)),shopName=await mainDb.select({name:shops.name}).from(shops).where(eq(shops.id,shopId)).then((res)=>res[0]?.name);if(!shopName)return{success:!1,message:"Duka halijapatikana."};let logoPath=process.env.QR_LOGO_PATH||"./default-path",tempFiles=[],pdfDoc=await PDFDocument_default.create(),MARGIN=50,GRID_COLS=3,GRID_ROWS=4,currentPage=pdfDoc.addPage([595,842]),currentRow=0,currentCol=0;await fs3.mkdir("./images",{recursive:!0});for(let product of productList){let priceBought=(await mainDb.select({priceBought:purchases.priceBought}).from(purchases).where(eq(purchases.productId,product.id)))[0]?.priceBought,sanitizedShopName=shopName.replace(/[^a-zA-Z0-9-_]/g,"_").slice(0,27),sanitizedName=product.name.replace(/[^a-zA-Z0-9-_]/g,"_").slice(0,27),outputPath=`./images/${`qrcode_${sanitizedShopName}_${sanitizedName}.png`}`,prodData={product:{productId:product.id,priceSold:product.priceSold,supplierId:product.supplierId,name:product.name,quantity:1,saleType:"cash",discount:0,customerId:null,description:"Matumizi ya nyumbani",priceBought,generatedAt:new Date().toISOString()}},url=new URL(`${frontendURL}/scan-qrcode`);Object.entries(prodData.product).forEach(([key,value])=>{if(value!==void 0&&value!==null)url.searchParams.append(key,value.toString())});let data=url.toString();if(!(await generateQRCodeWithLogo(data,logoPath,outputPath)).success)continue;let qrImage=await pdfDoc.embedPng(await fs3.readFile(outputPath)),QR_SIZE=Math.min((currentPage.getWidth()-(GRID_COLS+1)*MARGIN)/GRID_COLS,(currentPage.getHeight()-(GRID_ROWS+1)*MARGIN)/GRID_ROWS),x=MARGIN+currentCol*(QR_SIZE+MARGIN),y=currentPage.getHeight()-MARGIN-(currentRow+1)*(QR_SIZE+MARGIN);if(currentPage.drawImage(qrImage,{x,y,width:QR_SIZE,height:QR_SIZE}),currentPage.drawText(product.name,{x:x+10,y:y-20,size:10,color:rgb(0,0,0)}),currentCol++,currentCol>=GRID_COLS){if(currentCol=0,currentRow++,currentRow>=GRID_ROWS)currentPage=pdfDoc.addPage([595,842]),currentRow=0,currentCol=0}tempFiles.push(outputPath)}let pageCount=pdfDoc.getPageCount();for(let i3=0;i3<pageCount;i3++){let page=pdfDoc.getPage(i3);page.drawText(`Shop: ${shopName}`,{x:50,y:30,size:12}),page.drawText(`Page ${i3+1}/${pageCount}`,{x:500,y:30,size:10})}await mainDb.update(products).set({isQRCode:!0}).where(eq(products.isQRCode,!1));let pdfBytes=await pdfDoc.save();for(let path2 of tempFiles)await fs3.unlink(path2).catch((err)=>console.error(`Failed to delete ${path2}:`,err));return set2.headers["Content-Type"]="application/pdf",set2.headers["Content-Disposition"]=`attachment; filename="qrcodes_${Date.now()}.pdf"`,new Uint8Array(pdfBytes)}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Tatizo limetokea wakati wa kutengeneza QRCode"}}}),qrCode_default=qrCodePlugin;var import_argon2=__toESM(require_argon2(),1),hashPassword=async(password)=>{try{return await import_argon2.default.hash(password,{type:import_argon2.default.argon2id,memoryCost:65536,timeCost:12,parallelism:2})}catch(err){throw console.error("Error hashing password:",err),new Error("Failed to hash the password")}},verifyPassword=async(hashedPassword,inputPassword)=>{try{return await import_argon2.default.verify(hashedPassword,inputPassword)}catch(err){return!1}};var import_xss=__toESM(require_lib3(),1),sanitizeNumber=(input)=>{let num=Number(input);return isNaN(num)?0:num},sanitizeString=(input)=>input?import_xss.default(input):"";var byteToHex=[];for(let i3=0;i3<256;++i3)byteToHex.push((i3+256).toString(16).slice(1));function unsafeStringify(arr,offset=0){return(byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]).toLowerCase()}import{randomFillSync}from"crypto";var rnds8Pool=new Uint8Array(256),poolPtr=rnds8Pool.length;function rng(){if(poolPtr>rnds8Pool.length-16)randomFillSync(rnds8Pool),poolPtr=0;return rnds8Pool.slice(poolPtr,poolPtr+=16)}import{randomUUID}from"crypto";var native_default={randomUUID};function v4(options,buf,offset){if(native_default.randomUUID&&!buf&&!options)return native_default.randomUUID();options=options||{};let rnds=options.random??options.rng?.()??rng();if(rnds.length<16)throw new Error("Random bytes length must be >= 16");if(rnds[6]=rnds[6]&15|64,rnds[8]=rnds[8]&63|128,buf){if(offset=offset||0,offset<0||offset+16>buf.length)throw new RangeError(`UUID byte range ${offset}:${offset+15} is out of buffer bounds`);for(let i3=0;i3<16;++i3)buf[offset+i3]=rnds[i3];return buf}return unsafeStringify(rnds)}var v4_default=v4;var import_nodemailer=__toESM(require_nodemailer(),1),regPost=async({body,headers})=>{let frontendURL2=process.env.FRONTEND_URL_DEV,zohoEmail="huduma@mypostech.store",transporter=import_nodemailer.default.createTransport({host:"smtp.zoho.com",port:465,secure:!0,auth:{user:"huduma@mypostech.store",pass:process.env.ZOHO_APP_PASSWORD}});try{let{name,username,email,password,phoneNumber}=body;name=sanitizeString(name.trim().toLowerCase()),username=sanitizeString(username.trim().toLowerCase()),email=sanitizeString(email.trim()),password=sanitizeString(password.trim()),phoneNumber=sanitizeString(phoneNumber.trim());let[existingUserCached,existingShopCached]=await Promise.all([userCheckCache.get(`user:${email}`),shopCheckCache.get(`shop:${name}`)]);if(existingUserCached)return cacheStatsTracker.recordHit("userCheckCache"),{success:!1,message:"Email tayari imeshatumika"};if(existingShopCached)return cacheStatsTracker.recordHit("shopCheckCache"),{success:!1,message:"Duka tayari limesajiliwa"};cacheStatsTracker.recordMiss("userCheckCache"),cacheStatsTracker.recordMiss("shopCheckCache");let[existingUser,existingShop]=await Promise.all([mainDb.select({id:users.id}).from(users).where(eq(users.email,email)).limit(1),mainDb.select({id:shops.id}).from(shops).where(eq(shops.name,name)).limit(1)]);if(existingUser.length>0)return userCheckCache.set(`user:${email}`,{exists:!0}),{success:!1,message:"Email tayari imeshatumika"};if(existingShop.length>0)return shopCheckCache.set(`shop:${name}`,{exists:!0}),{success:!1,message:"Duka tayari limesajiliwa"};let token=v4_default(),hashedPassword=await hashPassword(password);await mainDb.insert(emailVerifications).values({token,email:body.email,password:hashedPassword,phone:body.phoneNumber,shopName:body.name,username:body.username,expiresAt:new Date(Date.now()+1200000),used:!1});let link=`${frontendURL2}/email?token=${token}`;return await transporter.sendMail({from:'"myPosTech" <huduma@mypostech.store>',to:body.email,subject:"Hakiki barua pepe",html:`
                <!DOCTYPE html>
                <html lang="sw">
                <head>
                <meta charset="UTF-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
                <title>Thibitisha Barua Pepe</title>
                <style>
                    body {
                    font-family: 'Quicksand', sans-serif;
                    background-color: #e2e8f0;
                    padding: 1rem;
                    color: #1f2937;
                    font-size: 14px;
                    margin: 0;
                    }
                    .container {
                    max-width: 28rem;
                    margin: 0 auto;
                    background: white;
                    border: 2px solid #334155;
                    border-radius: 1.5rem;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    overflow: hidden;
                    }
                    .header {
                    text-align: center;
                    padding: 2rem 1.5rem;
                    background: linear-gradient(to top, #8324f0, #163ce7);
                    }
                    .header img {
                    width: 5rem;
                    margin: 0 auto 1rem;
                    }
                    .header h2 {
                    color: white;
                    font-size: 1.5rem;
                    font-weight: 600;
                    margin: 0;
                    }
                    .content {
                    padding: 2rem 1.5rem;
                    text-align: center;
                    }
                    .content p {
                    margin-bottom: 1.5rem;
                    font-size: 14px;
                    }
                    .content a {
                    display: inline-block;
                    padding: 0.75rem 1.5rem;
                    border: 2px solid #334155;
                    background-color: #c7bbfc;
                    color: #111827;
                    font-weight: bold;
                    border-radius: 9999px;
                    text-decoration: none;
                    }
                    .footer {
                    margin-top: 2rem;
                    font-size: 12px;
                    color: #6b7280;
                    }
                </style>
                </head>
                <body>
                <div class="container">
                    <div class="header">
                        <img src="${frontendURL2}/thumbail.png" alt="App Logo">
                        <h2>Thibitisha Barua Pepe Yako</h2>
                    </div>
                    <div class="content">
                    <p>Habari! Tafadhali bonyeza kitufe hapa chini kuthibitisha anwani yako ya barua pepe 
                        <span style="color: #ef4444;">kabla ya dakika 20</span>.
                    </p>
                    <a href="${link}">Thibitisha Barua Pepe</a>
                    <div class="footer">
                        <p>Ikiwa hukutuma ombi la akaunti au ujumbe huu, tafadhali puuza barua pepe hii.</p>
                    </div>
                    </div>
                </div>
                </body>
                </html>
            `}),{success:!0,message:"Ingia kwenye email yako kuhakiki"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}};var categData=t.Object({generalName:t.String({minLength:3,maxLength:40,error(){return{success:!1,message:"Jina haliwezi kuwa chini ya herufi 3, na juu ya herufi 40"}}})}),suppData=t.Object({company:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa chini ya herufi 3, na juu ya herufi 40"}}}),contact:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Mawasiliano haliwezi kuwa chini ya herufi 3, na juu ya herufi 40"}}})}),prodData=t.Object({name:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa na herufi chini ya 3 na juu ya 40"}}}),unit:t.String({minLength:1,maxLength:20,error(){return{success:!1,message:"Jina haliwezi kuwa na herufi chini ya 3 na juu ya 40"}}}),priceBought:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Kiwango sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),priceSold:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Kiwango sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),stock:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Kiwango sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),minStock:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Kiwango sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),categoryId:t.String({minLength:3,maxLength:70,error(){return{success:!1,message:"ID haliwezi kuwa na herufi chini ya 3 na juu ya 70"}}}),supplierId:t.String({minLength:3,maxLength:70,error(){return{success:!1,message:"ID haliwezi kuwa na herufi chini ya 3 na juu ya 70"}}})}),prodUpdateValidation=t.Object({name:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa na herufi chini ya 3 na juu ya 40"}}}),unit:t.String({minLength:1,maxLength:20,error(){return{success:!1,message:"Jina haliwezi kuwa na herufi chini ya 3 na juu ya 40"}}}),priceBought:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Bei ya kununua sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),priceSold:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Bei ya kuuza sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),stock:t.Number({maximum:999999999999.99,minimum:0,error(){return{success:!1,message:"Hisa sio sahihi kama ni chini ya 0 au juu ya trillioni 100"}}})}),QrPostData=t.Object({customerId:t.String(),supplierId:t.String(),productId:t.String(),typeDetected:t.String(),description:t.String(),saleType:t.String(),calculatedTotal:t.Number({maximum:999999999999.99,minimum:0,error(){return{success:!1,message:"Mahesabu sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),quantity:t.Number({maximum:999999999999.99,minimum:0,error(){return{success:!1,message:"Hisa sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),discount:t.Number({maximum:999999999999.99,minimum:0,error(){return{success:!1,message:"Pungzo sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),priceBought:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Bei ya kununua sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}}),priceSold:t.Number({maximum:999999999999.99,minimum:1,error(){return{success:!1,message:"Bei ya kuuza sio sahihi kama ni chini ya 1 au juu ya trillioni 100"}}})}),customerData=t.Object({name:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa chini ya herufi 3, na juu ya herufi 40"}}}),contact:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Mawasiliano haliwezi kuwa chini ya herufi 3, na juu ya herufi 40"}}})}),salesQueryData=t.Object({search:t.Optional(t.String({maxLength:40,error(){return{success:!1,message:"Maneno mwisho ni 40 kwa ajili ya usalama"}}})),date:t.Optional(t.String()),page:t.Optional(t.String({pattern:"^[0-9]+$"})),limit:t.Optional(t.String({pattern:"^[0-9]+$"})),from:t.Optional(t.String({format:"date"})),to:t.Optional(t.String({format:"date"}))}),loginData=t.Object({username:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa chini ya herufi 3 na juu ya herufi 40"}}}),password:t.String({minLength:6,error(){return{success:!1,message:"Nenosiri haliwezi kuwa chini ya herufi 6 kwa ajili ya usalama"}}})}),registerData=t.Object({name:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina la Duka haliwezi kuwa chini ya herufi 3 na juu ya herufi 40"}}}),username:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa chini ya herufi 3 na juu ya herufi 40"}}}),email:t.String({format:"email",error(){return{success:!1,message:"Email/barua-pepe sio sahihi"}}}),password:t.String({maxLength:40,minLength:6,error(){return{success:!1,message:"Nenosiri haliwezi kuwa chini ya herufi 6 na juu ya herufi 40"}}}),phoneNumber:t.String({maxLength:15,minLength:9,error(){return{success:!1,message:"Namba ya simu sio sahihi"}}})}),shopPutData=t.Object({email:t.String({format:"email",error(){return{success:!1,message:"Email/barua-pepe sio sahihi"}}}),shopName:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina la duka haliwezi kuwa na herufi chini ya 3 au juu ya 40"}}})}),changePasswordData=t.Object({currentPassword:t.String({maxLength:40,minLength:6,error(){return{success:!1,message:"Nenosiri haliwezi kuwa na herufi chini ya 6 au juu ya 40"}}}),newPassword:t.String({maxLength:40,minLength:6,error(){return{success:!1,message:"Nenosiri haliwezi kuwa na herufi chini ya 6 au juu ya 40"}}})}),emailData=t.Object({email:t.String({format:"email",error(){return{success:!1,message:"Email/barua-pepe sio sahihi"}}}),name:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Jina haliwezi kuwa na herufi chini ya 3 au juu ya 40"}}}),message:t.String({maxLength:40,minLength:3,error(){return{success:!1,message:"Ujumbe hauwezi kuwa na herufi chini ya 5 au juu ya 40"}}})}),authToken=t.Object({token:t.String({minLength:3,error(){return{success:!1,message:"Tokeni sio sahihi"}}})}),debtQuery=t.Object({page:t.Number({maximum:1e4,minimum:0,error(){return{success:!1,message:"Ukurasa hauwezi kuwa chini ya 0 au juu ya 10,000"}}}),pageSize:t.Number({maximum:1e4,minimum:1,error(){return{success:!1,message:"Ukubwa wa ukurasa hauwezi kuwa chini ya 1 au juu ya 10,000"}}})}),askedData=t.Object({name:t.String({minLength:1,maxLength:50,error(){return{success:!1,message:"Jina haliwezi kuwa chini ya herufi moja au juu ya herufi 50"}}})}),updatedAskedData=t.Object({count:t.Number({minimum:0,maximum:50000,error(){return{success:!1,message:"Hesabu haliwezi kuwa chini 0 au juu ya 50,000"}}})}),payDebtData=t.Object({amountPaid:t.Number({minimum:0,maximum:999999999999.99,error(){return{success:!1,message:"Hesabu haliwezi kuwa chini 0 au juu ya trillioni 100"}}}),customerId:t.String({minLength:1,maxLength:50,error(){return{success:!1,message:"ID ya wateja haiwezi kuwa chini ya herufi moja au juu ya herufi 50"}}}),debtId:t.String({minLength:1,maxLength:50,error(){return{success:!1,message:"ID ya taarifa za deni haiwezi kuwa chini ya herufi moja au juu ya herufi 50"}}})});/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var $parse=parse5,$serialize=serialize2;var __toString=Object.prototype.toString,fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function parse5(str,options){if(typeof str!=="string")throw new TypeError("argument str must be a string");var obj={},opt=options||{},dec=opt.decode||decode4,index2=0;while(index2<str.length){var eqIdx=str.indexOf("=",index2);if(eqIdx===-1)break;var endIdx=str.indexOf(";",index2);if(endIdx===-1)endIdx=str.length;else if(endIdx<eqIdx){index2=str.lastIndexOf(";",eqIdx-1)+1;continue}var key=str.slice(index2,eqIdx).trim();if(obj[key]===void 0){var val=str.slice(eqIdx+1,endIdx).trim();if(val.charCodeAt(0)===34)val=val.slice(1,-1);obj[key]=tryDecode(val,dec)}index2=endIdx+1}return obj}function serialize2(name,val,options){var opt=options||{},enc=opt.encode||encode3;if(typeof enc!=="function")throw new TypeError("option encode is invalid");if(!fieldContentRegExp.test(name))throw new TypeError("argument name is invalid");var value=enc(val);if(value&&!fieldContentRegExp.test(value))throw new TypeError("argument val is invalid");var str=name+"="+value;if(opt.maxAge!=null){var maxAge=opt.maxAge-0;if(isNaN(maxAge)||!isFinite(maxAge))throw new TypeError("option maxAge is invalid");str+="; Max-Age="+Math.floor(maxAge)}if(opt.domain){if(!fieldContentRegExp.test(opt.domain))throw new TypeError("option domain is invalid");str+="; Domain="+opt.domain}if(opt.path){if(!fieldContentRegExp.test(opt.path))throw new TypeError("option path is invalid");str+="; Path="+opt.path}if(opt.expires){var expires=opt.expires;if(!isDate(expires)||isNaN(expires.valueOf()))throw new TypeError("option expires is invalid");str+="; Expires="+expires.toUTCString()}if(opt.httpOnly)str+="; HttpOnly";if(opt.secure)str+="; Secure";if(opt.priority){var priority=typeof opt.priority==="string"?opt.priority.toLowerCase():opt.priority;switch(priority){case"low":str+="; Priority=Low";break;case"medium":str+="; Priority=Medium";break;case"high":str+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(opt.sameSite){var sameSite=typeof opt.sameSite==="string"?opt.sameSite.toLowerCase():opt.sameSite;switch(sameSite){case!0:str+="; SameSite=Strict";break;case"lax":str+="; SameSite=Lax";break;case"strict":str+="; SameSite=Strict";break;case"none":str+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return str}function decode4(str){return str.indexOf("%")!==-1?decodeURIComponent(str):str}function encode3(val){return encodeURIComponent(val)}function isDate(val){return __toString.call(val)==="[object Date]"||val instanceof Date}function tryDecode(str,decode5){try{return decode5(str)}catch(e){return str}}var crypto3=__require("crypto");var $sign=function(val,secret){if(typeof val!="string")throw new TypeError("Cookie value must be provided as a string.");if(secret==null)throw new TypeError("Secret key must be provided.");return val+"."+crypto3.createHmac("sha256",secret).update(val).digest("base64").replace(/\=+$/,"")},$unsign=function(input,secret){if(typeof input!="string")throw new TypeError("Signed cookie string must be provided.");if(secret==null)throw new TypeError("Secret key must be provided.");var tentativeValue=input.slice(0,input.lastIndexOf(".")),expectedInput=$sign(tentativeValue,secret),expectedBuffer=Buffer.from(expectedInput),inputBuffer=Buffer.from(input);return expectedBuffer.length===inputBuffer.length&&crypto3.timingSafeEqual(expectedBuffer,inputBuffer)?tentativeValue:!1};var cookie=(options={})=>{let{signed,secret:secretKey,...defaultOptions}=options,secret=!secretKey?void 0:typeof secretKey==="string"?secretKey:secretKey[0],isStringKey=typeof secret==="string";return new Elysia({name:"@elysiajs/cookie",seed:options}).decorate("unsignCookie",(value)=>{if(!secret)throw new Error("No secret is provided to cookie plugin");let unsigned=isStringKey?$unsign(value,secret):!1;if(isStringKey===!1)for(let i3=0;i3<secret.length;i3++){let temp=$unsign(value,secret[i3]);if(temp){unsigned=temp;break}}return{valid:unsigned!==!1,value:unsigned||void 0}}).derive((context)=>{let _cookie,getCookie=()=>{if(_cookie)return _cookie;try{let headerCookie=context.request.headers.get("cookie");_cookie=headerCookie?$parse(headerCookie):{}}catch(error3){_cookie={}}return _cookie};return{get cookie(){return getCookie()},setCookie(name,value,{signed:signed2=!1,...options2}={}){if(signed2){if(!secret)throw new Error("No secret is provided to cookie plugin");value=$sign(value,secret)}if(!Array.isArray(context.set.headers["Set-Cookie"]))context.set.headers["Set-Cookie"]=[];if(context.set.headers["Set-Cookie"].push($serialize(name,value,{path:"/",...defaultOptions,...options2})),!_cookie)getCookie();_cookie[name]=value},removeCookie(name){if(!getCookie()[name])return;context.set.headers["Set-Cookie"]=$serialize(name,"",{expires:new Date("Thu, Jan 01 1970 00:00:00 UTC")}),delete _cookie[name]}}})},dist_default=cookie;var JWT_SECRET=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",frontendURL2=process.env.FRONTEND_URL_DEV,regPlugin=new Elysia().use(dist_default()).use(index_default({name:"jwt",secret:JWT_SECRET})).post("/register",regPost,{body:registerData}).get("/verify-email",async({headers,query,cookie:{auth_token},jwt:jwt2})=>{let token=query.token;if(!token)return{success:!1,message:"Huwezi kusajiliwa bila email na tokeni sahihi"};try{let result=await mainDb.select().from(emailVerifications).where(eq(emailVerifications.token,token));if(result.length===0)return{success:!1,message:"Token sio sahihi, fuata njia ya halali"};if(new Date>result[0].expiresAt)return{success:!1,message:"Token imeisha muda wake"};await mainDb.update(emailVerifications).set({used:!0}).where(eq(emailVerifications.token,token));let user=await mainDb.insert(users).values({username:result[0].username,email:result[0].email,password:result[0].password,phoneNumber:result[0].phone}).returning({id:users.id,username:users.username}).then((res)=>res[0]);if(!user)return{success:!1,message:"Mtumiaji hayupo!"};let shop=await mainDb.insert(shops).values({name:result[0].shopName,trialStart:new Date(Date.now()),trialEnd:new Date(Date.now()+1209600000)}).returning({id:shops.id}).then((res)=>res[0]);if(!shop)return{success:!1,message:"Duka halipo!"};let credetials=await mainDb.insert(shopUsers).values({shopId:shop.id,userId:user.id,role:"owner"}).returning({userId:shopUsers.userId,shopId:shopUsers.shopId});if(credetials.length===0)return;let{userId,shopId}=credetials[0];if(!await jwt2.sign({userId,shopId}))return{success:!1,message:"Hakuna tokeni"};return auth_token.set({value:token,httpOnly:!0,secure:!1,sameSite:"lax",maxAge:604800,path:"/",domain:void 0}),{success:!0,message:"\uD83C\uDF89 Email imehakikiwa kiukamilifu! inakupeleka ..."}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}}),registration_default=regPlugin;var isBun3=typeof new Headers()?.toJSON==="function",processHeaders=(headers)=>{if(isBun3)return Object.keys(headers.toJSON()).join(", ");let keys="";if(headers.forEach((_2,key)=>{keys+=key+", "}),keys)keys=keys.slice(0,-1);return keys},processOrigin=(origin,request,from)=>{if(Array.isArray(origin))return origin.some((o)=>processOrigin(o,request,from));switch(typeof origin){case"string":if(origin.indexOf("://")===-1)return from.includes(origin);return origin===from;case"function":return origin(request)===!0;case"object":if(origin instanceof RegExp)return origin.test(from)}return!1},cors=(config)=>{let{aot=!0,origin=!0,methods=!0,allowedHeaders=!0,exposeHeaders=!0,credentials=!0,maxAge=5,preflight=!0}=config??{};if(Array.isArray(allowedHeaders))allowedHeaders=allowedHeaders.join(", ");if(Array.isArray(exposeHeaders))exposeHeaders=exposeHeaders.join(", ");let origins=typeof origin==="boolean"?void 0:Array.isArray(origin)?origin:[origin],app=new Elysia({name:"@elysiajs/cors",seed:config,aot}),anyOrigin=origins?.some((o)=>o==="*"),handleOrigin=(set2,request)=>{if(origin===!0){set2.headers.vary="*",set2.headers["access-control-allow-origin"]=request.headers.get("Origin")||"*";return}if(anyOrigin){set2.headers.vary="*",set2.headers["access-control-allow-origin"]="*";return}if(!origins?.length)return;let headers=[];if(origins.length){let from=request.headers.get("Origin")??"";for(let i3=0;i3<origins.length;i3++){let value=processOrigin(origins[i3],request,from);if(value===!0){set2.headers.vary=origin?"Origin":"*",set2.headers["access-control-allow-origin"]=from||"*";return}if(value)headers.push(value)}}if(set2.headers.vary="Origin",headers.length)set2.headers["access-control-allow-origin"]=headers.join(", ")},handleMethod=(set2,method)=>{if(!method)return;if(methods===!0)return set2.headers["access-control-allow-methods"]=method??"*";if(methods===!1||!methods?.length)return;if(methods==="*")return set2.headers["access-control-allow-methods"]="*";if(!Array.isArray(methods))return set2.headers["access-control-allow-methods"]=methods;set2.headers["access-control-allow-methods"]=methods.join(", ")},defaultHeaders={};if(typeof exposeHeaders==="string")defaultHeaders["access-control-expose-headers"]=exposeHeaders;if(typeof allowedHeaders==="string")defaultHeaders["access-control-allow-headers"]=allowedHeaders;if(credentials===!0)defaultHeaders["access-control-allow-credentials"]="true";app.headers(defaultHeaders);function handleOption({set:set2,request,headers}){if(handleOrigin(set2,request),handleMethod(set2,request.headers.get("access-control-request-method")),allowedHeaders===!0||exposeHeaders===!0){if(allowedHeaders===!0)set2.headers["access-control-allow-headers"]=headers["access-control-request-headers"];if(exposeHeaders===!0)set2.headers["access-control-expose-headers"]=Object.keys(headers).join(",")}if(maxAge)set2.headers["access-control-max-age"]=maxAge.toString();return new Response(null,{status:204})}if(preflight)app.options("/",handleOption).options("/*",handleOption);return app.onRequest(function processCors({set:set2,request}){if(handleOrigin(set2,request),handleMethod(set2,request.method),allowedHeaders===!0||exposeHeaders===!0){let headers=processHeaders(request.headers);if(allowedHeaders===!0)set2.headers["access-control-allow-headers"]=headers;if(exposeHeaders===!0)set2.headers["access-control-expose-headers"]=headers}})};var import_xss3=__toESM(require_lib3(),1);var categPost=async({body,headers,shopId,userId})=>{try{if(!shopId||shopId.length<5)return{success:!1,message:sanitizeString("ID haipo!")};let{generalName}=body;if(generalName=import_xss3.default(generalName.trim().toLowerCase()),(await mainDb.select().from(categories).where(eq(categories.generalName,generalName))).length>0)return;return await mainDb.insert(categories).values({shopId,generalName}),{success:!0,message:"Umefanikiwa kuhifadhi taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},categGet=async({headers,shopId})=>{try{let allCateg=await mainDb.select().from(categories).where(eq(categories.shopId,shopId));if(allCateg.length===0)return{success:!1,message:"Hakuna taarifa iliyopatikana",data:[]};return{success:!0,message:"Umefanikiwa kupata taarifa",data:allCateg}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},categPut=async({body,headers,categoryId,shopId})=>{try{let{generalName}=body;if(generalName=import_xss3.default(generalName),!categoryId||categoryId.length<5)return{success:!1,message:"ID haipo"};if(!await mainDb.update(categories).set({generalName}).where(and(eq(categories.shopId,shopId),eq(categories.id,categoryId))))return{success:!1,message:"Hakuna taarifa iliyopatikana"};return{success:!0,message:"Umefanikiwa ku-update taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},categDel=async({headers,categoryId,shopId})=>{try{if(!categoryId||categoryId.length<5)return{success:!1,message:"ID haipo"};if(!await mainDb.delete(categories).where(and(eq(categories.id,categoryId),eq(categories.shopId,shopId))))return{success:!1,message:"Taarifa haipo!"};return{success:!0,message:"Umefanikiwa kufuta taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}};var maxTime=Math.pow(10,8)*24*60*60*1000,minTime=-maxTime;var millisecondsInDay=86400000,millisecondsInMinute=60000,millisecondsInHour=3600000;var minutesInMonth=43200,minutesInDay=1440;var constructFromSymbol=Symbol.for("constructDateFrom");function constructFrom(date3,value){if(typeof date3==="function")return date3(value);if(date3&&typeof date3==="object"&&constructFromSymbol in date3)return date3[constructFromSymbol](value);if(date3 instanceof Date)return new date3.constructor(value);return new Date(value)}function toDate(argument,context){return constructFrom(context||argument,argument)}var defaultOptions={};function getDefaultOptions(){return defaultOptions}function getTimezoneOffsetInMilliseconds(date3){let _date=toDate(date3),utcDate=new Date(Date.UTC(_date.getFullYear(),_date.getMonth(),_date.getDate(),_date.getHours(),_date.getMinutes(),_date.getSeconds(),_date.getMilliseconds()));return utcDate.setUTCFullYear(_date.getFullYear()),+date3-+utcDate}function normalizeDates(context,...dates){let normalize=constructFrom.bind(null,context||dates.find((date3)=>typeof date3==="object"));return dates.map(normalize)}function startOfDay(date3,options){let _date=toDate(date3,options?.in);return _date.setHours(0,0,0,0),_date}function differenceInCalendarDays(laterDate,earlierDate,options){let[laterDate_,earlierDate_]=normalizeDates(options?.in,laterDate,earlierDate),laterStartOfDay=startOfDay(laterDate_),earlierStartOfDay=startOfDay(earlierDate_),laterTimestamp=+laterStartOfDay-getTimezoneOffsetInMilliseconds(laterStartOfDay),earlierTimestamp=+earlierStartOfDay-getTimezoneOffsetInMilliseconds(earlierStartOfDay);return Math.round((laterTimestamp-earlierTimestamp)/millisecondsInDay)}function compareAsc(dateLeft,dateRight){let diff=+toDate(dateLeft)-+toDate(dateRight);if(diff<0)return-1;else if(diff>0)return 1;return diff}function constructNow(date3){return constructFrom(date3,Date.now())}function differenceInCalendarMonths(laterDate,earlierDate,options){let[laterDate_,earlierDate_]=normalizeDates(options?.in,laterDate,earlierDate),yearsDiff=laterDate_.getFullYear()-earlierDate_.getFullYear(),monthsDiff=laterDate_.getMonth()-earlierDate_.getMonth();return yearsDiff*12+monthsDiff}function differenceInDays(laterDate,earlierDate,options){let[laterDate_,earlierDate_]=normalizeDates(options?.in,laterDate,earlierDate),sign2=compareLocalAsc(laterDate_,earlierDate_),difference=Math.abs(differenceInCalendarDays(laterDate_,earlierDate_));laterDate_.setDate(laterDate_.getDate()-sign2*difference);let isLastDayNotFull=Number(compareLocalAsc(laterDate_,earlierDate_)===-sign2),result=sign2*(difference-isLastDayNotFull);return result===0?0:result}function compareLocalAsc(laterDate,earlierDate){let diff=laterDate.getFullYear()-earlierDate.getFullYear()||laterDate.getMonth()-earlierDate.getMonth()||laterDate.getDate()-earlierDate.getDate()||laterDate.getHours()-earlierDate.getHours()||laterDate.getMinutes()-earlierDate.getMinutes()||laterDate.getSeconds()-earlierDate.getSeconds()||laterDate.getMilliseconds()-earlierDate.getMilliseconds();if(diff<0)return-1;if(diff>0)return 1;return diff}function getRoundingMethod(method){return(number)=>{let result=(method?Math[method]:Math.trunc)(number);return result===0?0:result}}function differenceInHours(laterDate,earlierDate,options){let[laterDate_,earlierDate_]=normalizeDates(options?.in,laterDate,earlierDate),diff=(+laterDate_-+earlierDate_)/millisecondsInHour;return getRoundingMethod(options?.roundingMethod)(diff)}function differenceInMilliseconds(laterDate,earlierDate){return+toDate(laterDate)-+toDate(earlierDate)}function differenceInMinutes(dateLeft,dateRight,options){let diff=differenceInMilliseconds(dateLeft,dateRight)/millisecondsInMinute;return getRoundingMethod(options?.roundingMethod)(diff)}function endOfDay(date3,options){let _date=toDate(date3,options?.in);return _date.setHours(23,59,59,999),_date}function endOfMonth(date3,options){let _date=toDate(date3,options?.in),month=_date.getMonth();return _date.setFullYear(_date.getFullYear(),month+1,0),_date.setHours(23,59,59,999),_date}function isLastDayOfMonth(date3,options){let _date=toDate(date3,options?.in);return+endOfDay(_date,options)===+endOfMonth(_date,options)}function differenceInMonths(laterDate,earlierDate,options){let[laterDate_,workingLaterDate,earlierDate_]=normalizeDates(options?.in,laterDate,laterDate,earlierDate),sign2=compareAsc(workingLaterDate,earlierDate_),difference=Math.abs(differenceInCalendarMonths(workingLaterDate,earlierDate_));if(difference<1)return 0;if(workingLaterDate.getMonth()===1&&workingLaterDate.getDate()>27)workingLaterDate.setDate(30);workingLaterDate.setMonth(workingLaterDate.getMonth()-sign2*difference);let isLastMonthNotFull=compareAsc(workingLaterDate,earlierDate_)===-sign2;if(isLastDayOfMonth(laterDate_)&&difference===1&&compareAsc(laterDate_,earlierDate_)===1)isLastMonthNotFull=!1;let result=sign2*(difference-+isLastMonthNotFull);return result===0?0:result}function differenceInSeconds(laterDate,earlierDate,options){let diff=differenceInMilliseconds(laterDate,earlierDate)/1000;return getRoundingMethod(options?.roundingMethod)(diff)}var formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(token,count2,options)=>{let result,tokenValue=formatDistanceLocale[token];if(typeof tokenValue==="string")result=tokenValue;else if(count2===1)result=tokenValue.one;else result=tokenValue.other.replace("{{count}}",count2.toString());if(options?.addSuffix)if(options.comparison&&options.comparison>0)return"in "+result;else return result+" ago";return result};function buildFormatLongFn(args){return(options={})=>{let width=options.width?String(options.width):args.defaultWidth;return args.formats[width]||args.formats[args.defaultWidth]}}var dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})};var formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(token,_date,_baseDate,_options)=>formatRelativeLocale[token];function buildLocalizeFn(args){return(value,options)=>{let context=options?.context?String(options.context):"standalone",valuesArray;if(context==="formatting"&&args.formattingValues){let defaultWidth=args.defaultFormattingWidth||args.defaultWidth,width=options?.width?String(options.width):defaultWidth;valuesArray=args.formattingValues[width]||args.formattingValues[defaultWidth]}else{let defaultWidth=args.defaultWidth,width=options?.width?String(options.width):args.defaultWidth;valuesArray=args.values[width]||args.values[defaultWidth]}let index2=args.argumentCallback?args.argumentCallback(value):value;return valuesArray[index2]}}var eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(dirtyNumber,_options)=>{let number=Number(dirtyNumber),rem100=number%100;if(rem100>20||rem100<10)switch(rem100%10){case 1:return number+"st";case 2:return number+"nd";case 3:return number+"rd"}return number+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:(quarter)=>quarter-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(args){return(string,options={})=>{let width=options.width,matchPattern=width&&args.matchPatterns[width]||args.matchPatterns[args.defaultMatchWidth],matchResult=string.match(matchPattern);if(!matchResult)return null;let matchedString=matchResult[0],parsePatterns=width&&args.parsePatterns[width]||args.parsePatterns[args.defaultParseWidth],key=Array.isArray(parsePatterns)?findIndex(parsePatterns,(pattern)=>pattern.test(matchedString)):findKey(parsePatterns,(pattern)=>pattern.test(matchedString)),value;value=args.valueCallback?args.valueCallback(key):key,value=options.valueCallback?options.valueCallback(value):value;let rest=string.slice(matchedString.length);return{value,rest}}}function findKey(object,predicate){for(let key in object)if(Object.prototype.hasOwnProperty.call(object,key)&&predicate(object[key]))return key;return}function findIndex(array,predicate){for(let key=0;key<array.length;key++)if(predicate(array[key]))return key;return}function buildMatchPatternFn(args){return(string,options={})=>{let matchResult=string.match(args.matchPattern);if(!matchResult)return null;let matchedString=matchResult[0],parseResult=string.match(args.parsePattern);if(!parseResult)return null;let value=args.valueCallback?args.valueCallback(parseResult[0]):parseResult[0];value=options.valueCallback?options.valueCallback(value):value;let rest=string.slice(matchedString.length);return{value,rest}}}var matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:(value)=>parseInt(value,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:(index2)=>index2+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})};var enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};function formatDistance2(laterDate,earlierDate,options){let defaultOptions2=getDefaultOptions(),locale=options?.locale??defaultOptions2.locale??enUS,minutesInAlmostTwoDays=2520,comparison=compareAsc(laterDate,earlierDate);if(isNaN(comparison))throw new RangeError("Invalid time value");let localizeOptions=Object.assign({},options,{addSuffix:options?.addSuffix,comparison}),[laterDate_,earlierDate_]=normalizeDates(options?.in,...comparison>0?[earlierDate,laterDate]:[laterDate,earlierDate]),seconds=differenceInSeconds(earlierDate_,laterDate_),offsetInSeconds=(getTimezoneOffsetInMilliseconds(earlierDate_)-getTimezoneOffsetInMilliseconds(laterDate_))/1000,minutes=Math.round((seconds-offsetInSeconds)/60),months;if(minutes<2)if(options?.includeSeconds)if(seconds<5)return locale.formatDistance("lessThanXSeconds",5,localizeOptions);else if(seconds<10)return locale.formatDistance("lessThanXSeconds",10,localizeOptions);else if(seconds<20)return locale.formatDistance("lessThanXSeconds",20,localizeOptions);else if(seconds<40)return locale.formatDistance("halfAMinute",0,localizeOptions);else if(seconds<60)return locale.formatDistance("lessThanXMinutes",1,localizeOptions);else return locale.formatDistance("xMinutes",1,localizeOptions);else if(minutes===0)return locale.formatDistance("lessThanXMinutes",1,localizeOptions);else return locale.formatDistance("xMinutes",minutes,localizeOptions);else if(minutes<45)return locale.formatDistance("xMinutes",minutes,localizeOptions);else if(minutes<90)return locale.formatDistance("aboutXHours",1,localizeOptions);else if(minutes<minutesInDay){let hours=Math.round(minutes/60);return locale.formatDistance("aboutXHours",hours,localizeOptions)}else if(minutes<2520)return locale.formatDistance("xDays",1,localizeOptions);else if(minutes<minutesInMonth){let days=Math.round(minutes/minutesInDay);return locale.formatDistance("xDays",days,localizeOptions)}else if(minutes<minutesInMonth*2)return months=Math.round(minutes/minutesInMonth),locale.formatDistance("aboutXMonths",months,localizeOptions);if(months=differenceInMonths(earlierDate_,laterDate_),months<12){let nearestMonth=Math.round(minutes/minutesInMonth);return locale.formatDistance("xMonths",nearestMonth,localizeOptions)}else{let monthsSinceStartOfYear=months%12,years=Math.trunc(months/12);if(monthsSinceStartOfYear<3)return locale.formatDistance("aboutXYears",years,localizeOptions);else if(monthsSinceStartOfYear<9)return locale.formatDistance("overXYears",years,localizeOptions);else return locale.formatDistance("almostXYears",years+1,localizeOptions)}}function formatDistanceToNow(date3,options){return formatDistance2(date3,constructNow(date3),options)}var blockUsage=async({shopId})=>{let cacheKey=`shop:${shopId}:paid`,cachedIsPaid=isPaidCache.get(cacheKey);if(cachedIsPaid!==void 0){if(cachedIsPaid===!1)return{success:!1,message:"Kifurushi kimeisha, tafadhali lipia ili kuendelea."}}let isPaid=(await mainDb.select({isPaid:shopUsers.isPaid}).from(shopUsers).where(eq(shopUsers.shopId,shopId)))[0]?.isPaid??!1;if(isPaidCache.set(cacheKey,isPaid),!isPaid)return{success:!1,message:"Kifurushi kimeisha, tafadhali lipia ili kuendelea."};return{success:!0,message:"umelipia"}};function timeRemainingUntil(dateStr){let targetDate=new Date(dateStr),now=new Date;if(targetDate<now)return"Imepita";let minutes=differenceInMinutes(targetDate,now),hours=differenceInHours(targetDate,now),days=differenceInDays(targetDate,now),months=differenceInMonths(targetDate,now);if(minutes<60)return`Zimebaki dakika ${minutes}`;if(hours<24)return`Zimebaki saa ${hours}`;if(days<31)return`Zimebaki siku ${days}`;if(months<12)return`Zimebaki miezi ${months}`;return`Zimebaki: ${formatDistanceToNow(targetDate,{addSuffix:!0})}`}var JWT_SECRET2=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",categoriesPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET2})).post("/categories",async({jwt:jwt2,cookie:cookie2,body,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let result=await blockUsage({shopId});if(!result?.success)return{success:!1,message:result?.message||"Huduma haijalipiwa"};return await categPost({body,userId,shopId,headers})},{body:categData}).get("/categories",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await categGet({headers,shopId})}).put("/categories",async({jwt:jwt2,cookie:cookie2,headers,query,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let{categoryId}=query;return await categPut({headers,body,categoryId,shopId})},{body:categData}).delete("/categories",async({jwt:jwt2,cookie:cookie2,headers,query})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let{categoryId}=query;if(!categoryId)return{success:!1,message:"CategoryId lazima iwepo."};return await categDel({headers,categoryId,shopId})}),categories_default=categoriesPlugin;var suppPost=async({body,headers,shopId})=>{try{let{company,contact}=body;if(company=sanitizeString(company.trim().toLowerCase()),contact=sanitizeString(contact.trim()),(await mainDb.select().from(suppliers).where(eq(suppliers.company,company))).length>0)return{success:!1,message:"Tayari taarifa zipo"};return await mainDb.insert(suppliers).values({shopId,company,contact}),{success:!0,message:"Umefanikiwa kuhifadhi taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},suppGet=async({headers,shopId,userId,query})=>{console.time("start");try{let page=parseInt(query.page||"1"),limit=parseInt(query.limit||"10"),search=query.search||"",offset=(page-1)*limit,cacheKey=`suppliers:${shopId}:${search}:${page}:${limit}`,cached=supplierCache.get(cacheKey);if(cached&&isCachedSupplierResponse(cached))return cacheStatsTracker.recordHit("supplierCache"),{success:!0,test:"Is this Cached?",message:"Umefanikiwa kupata taarifa",...cached};cacheStatsTracker.recordMiss("supplierCache");let where=and(eq(suppliers.shopId,shopId),search?ilike(suppliers.company,`%${search}%`):void 0),total=await mainDb.select({count:sql`count(*)`}).from(suppliers).where(where||void 0).then((rows)=>Number(rows[0].count)),existingSuppliers=await mainDb.select().from(suppliers).where(where).orderBy(suppliers.createdAt).limit(limit).offset(offset);if(existingSuppliers.length===0)return{success:!1,message:"Hakuna kilichopatikana kwenye hifadhi",data:[],total};console.timeEnd("start"),supplierCache.set(cacheKey,{data:existingSuppliers,total,page,limit,pages:Math.ceil(total/limit)});let stats=supplierCache.getMemoryUsage(),cacheHits=0,cacheMisses=0;if(cached)cacheHits++;else cacheMisses++;return{success:!0,message:"umefanikiwa kupata taarifa",data:existingSuppliers,total,page,limit,pages:Math.ceil(total/limit),cacheUsedMB:stats.usedMB.toFixed(2),cacheFreeMB:stats.freeMB.toFixed(2),cacheUsedPercent:stats.usedPercent.toFixed(2)+"%",cacheHits,cacheMisses}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},suppPut=async({body,headers,supplierId})=>{try{let{company,contact}=body;if(company=sanitizeString(company.trim().toLowerCase()),contact=sanitizeString(contact),!supplierId||supplierId.length<5)return{success:!1,message:"ID sio sahihi"};let updateSupp=await mainDb.update(suppliers).set({company,contact}).where(eq(suppliers.id,supplierId)).returning({id:suppliers.id,company:suppliers.company,contact:suppliers.contact});if(!updateSupp)return{success:!1,message:"Hakuna taarifa iliyopatikana"};return{success:!0,data:updateSupp,message:"Umefainikiwa ku-update taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},suppDel=async({headers,supplierId,shopId})=>{try{if(!supplierId||supplierId.length<5)return{success:!1,message:"id ya msambazaji haipo!"};if(!await mainDb.delete(suppliers).where(and(eq(suppliers.id,supplierId),eq(suppliers.shopId,shopId))))return{success:!1,message:"Hakuna taarifa ya kufutwa"};return{success:!0,message:"umefanikiwa kufuta taarifa"}}catch(error3){if(error3 instanceof Error)return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}};var JWT_SECRET3=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",suppPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET3})).get("/suppliers",async({jwt:jwt2,cookie:cookie2,headers,query})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return suppGet({headers,shopId,userId,query})}).post("/suppliers",async({jwt:jwt2,cookie:cookie2,headers,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let result=await blockUsage({shopId});if(!result?.success)return{success:!1,message:result?.message||"Huduma haijalipiwa"};return suppPost({shopId,body,headers})},{body:suppData}).put("/suppliers/:id",async({jwt:jwt2,cookie:cookie2,headers,params,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2}),supplierId=params.id;if(!supplierId)return{success:!1,message:"Product ID is required."};return suppPut({body,headers,supplierId})},{body:suppData}).delete("/suppliers/:id",async({jwt:jwt2,cookie:cookie2,headers,params})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2}),supplierId=params.id;if(!supplierId)return{success:!1,message:"Product ID is required."};if(!shopId||!userId)return;return suppDel({supplierId,headers,shopId})}),supplier_default=suppPlugin;var import_argon22=__toESM(require_argon2(),1);var JWT_SECRET4=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",loginPlugin=new Elysia().use(cookie()).use(jwt({name:"jwt",secret:JWT_SECRET4})).post("/login",async({body,jwt:jwt2,cookie:{auth_token},headers})=>{try{let{username,password}=body;if(username=sanitizeString(username.trim().toLowerCase()),password=sanitizeString(password.trim()),!username||!password)return{success:!1,message:"Taarifa ulizoweka sio sahihi"};let cacheKey=`LoginData:${username}`,cached=loginCache.get(cacheKey);if(cached&&typeof cached==="object"){let token2=await jwt2.sign({userId:cached.payload.userId,shopId:cached.payload.shopId});if(!token2)return{success:!1,message:"Hakuna tokeni, hujaruhusiwa"};return auth_token.set({value:token2,httpOnly:!0,secure:!1,sameSite:"lax",maxAge:604800,path:"/",domain:void 0}),{success:!0,message:`Umefanikiwa kuingia kama ${username}`,...cached.payload}}let user=await mainDb.select({id:users.id,username:users.username,password:users.password}).from(users).where(eq(users.username,username)).limit(1);if(!user.length)return{success:!1,message:"Mtumiaji hayupo!"};let userData=user[0];if(!await import_argon22.default.verify(userData.password,password))return{success:!1,message:"Taarifa ulizoweka sio sahihi"};let shop=await mainDb.select({shopId:shopUsers.shopId}).from(shopUsers).where(eq(shopUsers.userId,userData.id)).limit(1);if(!shop.length)return{success:!1,message:"Hakuna duka lililosajiliwa kwa ajili yako"};let shopData=shop[0],token=await jwt2.sign({userId:userData.id,shopId:shopData.shopId});if(!token)return{success:!1,message:"Hakuna tokeni, hujaruhusiwa"};auth_token.set({value:token,httpOnly:!0,secure:!1,sameSite:"lax",maxAge:604800,path:"/",domain:void 0});let payload={userId:userData.id,shopId:shopData.shopId};return loginCache.set(cacheKey,{payload}),{success:!0,message:`Umefanikiwa kuingia kama ${username}`,...payload}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},{body:loginData});/*!
 *  decimal.js v10.5.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var EXP_LIMIT=9000000000000000,MAX_DIGITS=1e9,NUMERALS="0123456789abcdef",LN10="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",PI="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",DEFAULTS={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-EXP_LIMIT,maxE:EXP_LIMIT,crypto:!1},inexact,quadrant,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",precisionLimitExceeded=decimalError+"Precision limit exceeded",cryptoUnavailable=decimalError+"crypto unavailable",tag="[object Decimal]",mathfloor=Math.floor,mathpow=Math.pow,isBinary=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,isHex=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,isOctal=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,LN10_PRECISION=LN10.length-1,PI_PRECISION=PI.length-1,P={toStringTag:tag};P.absoluteValue=P.abs=function(){var x=new this.constructor(this);if(x.s<0)x.s=1;return finalise(x)};P.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)};P.clampedTo=P.clamp=function(min,max){var k2,x=this,Ctor=x.constructor;if(min=new Ctor(min),max=new Ctor(max),!min.s||!max.s)return new Ctor(NaN);if(min.gt(max))throw Error(invalidArgument+max);return k2=x.cmp(min),k2<0?min:x.cmp(max)>0?max:new Ctor(x)};P.comparedTo=P.cmp=function(y){var i3,j,xdL,ydL,x=this,xd=x.d,yd=(y=new x.constructor(y)).d,xs=x.s,ys=y.s;if(!xd||!yd)return!xs||!ys?NaN:xs!==ys?xs:xd===yd?0:!xd^xs<0?1:-1;if(!xd[0]||!yd[0])return xd[0]?xs:yd[0]?-ys:0;if(xs!==ys)return xs;if(x.e!==y.e)return x.e>y.e^xs<0?1:-1;xdL=xd.length,ydL=yd.length;for(i3=0,j=xdL<ydL?xdL:ydL;i3<j;++i3)if(xd[i3]!==yd[i3])return xd[i3]>yd[i3]^xs<0?1:-1;return xdL===ydL?0:xdL>ydL^xs<0?1:-1};P.cosine=P.cos=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.d)return new Ctor(NaN);if(!x.d[0])return new Ctor(1);return pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+Math.max(x.e,x.sd())+LOG_BASE,Ctor.rounding=1,x=cosine(Ctor,toLessThanHalfPi(Ctor,x)),Ctor.precision=pr,Ctor.rounding=rm,finalise(quadrant==2||quadrant==3?x.neg():x,pr,rm,!0)};P.cubeRoot=P.cbrt=function(){var e,m,n,r,rep,s,sd,t2,t3,t3plusx,x=this,Ctor=x.constructor;if(!x.isFinite()||x.isZero())return new Ctor(x);if(external=!1,s=x.s*mathpow(x.s*x,0.3333333333333333),!s||Math.abs(s)==1/0){if(n=digitsToString(x.d),e=x.e,s=(e-n.length+1)%3)n+=s==1||s==-2?"0":"00";if(s=mathpow(n,0.3333333333333333),e=mathfloor((e+1)/3)-(e%3==(e<0?-1:2)),s==1/0)n="5e"+e;else n=s.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e;r=new Ctor(n),r.s=x.s}else r=new Ctor(s.toString());sd=(e=Ctor.precision)+3;for(;;)if(t2=r,t3=t2.times(t2).times(t2),t3plusx=t3.plus(x),r=divide(t3plusx.plus(x).times(t2),t3plusx.plus(t3),sd+2,1),digitsToString(t2.d).slice(0,sd)===(n=digitsToString(r.d)).slice(0,sd))if(n=n.slice(sd-3,sd+1),n=="9999"||!rep&&n=="4999"){if(!rep){if(finalise(t2,e+1,0),t2.times(t2).times(t2).eq(x)){r=t2;break}}sd+=4,rep=1}else{if(!+n||!+n.slice(1)&&n.charAt(0)=="5")finalise(r,e+1,1),m=!r.times(r).times(r).eq(x);break}return external=!0,finalise(r,e,Ctor.rounding,m)};P.decimalPlaces=P.dp=function(){var w,d=this.d,n=NaN;if(d){if(w=d.length-1,n=(w-mathfloor(this.e/LOG_BASE))*LOG_BASE,w=d[w],w)for(;w%10==0;w/=10)n--;if(n<0)n=0}return n};P.dividedBy=P.div=function(y){return divide(this,new this.constructor(y))};P.dividedToIntegerBy=P.divToInt=function(y){var x=this,Ctor=x.constructor;return finalise(divide(x,new Ctor(y),0,1,1),Ctor.precision,Ctor.rounding)};P.equals=P.eq=function(y){return this.cmp(y)===0};P.floor=function(){return finalise(new this.constructor(this),this.e+1,3)};P.greaterThan=P.gt=function(y){return this.cmp(y)>0};P.greaterThanOrEqualTo=P.gte=function(y){var k2=this.cmp(y);return k2==1||k2===0};P.hyperbolicCosine=P.cosh=function(){var k2,n,pr,rm,len3,x=this,Ctor=x.constructor,one=new Ctor(1);if(!x.isFinite())return new Ctor(x.s?1/0:NaN);if(x.isZero())return one;if(pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+Math.max(x.e,x.sd())+4,Ctor.rounding=1,len3=x.d.length,len3<32)k2=Math.ceil(len3/3),n=(1/tinyPow(4,k2)).toString();else k2=16,n="2.3283064365386962890625e-10";x=taylorSeries(Ctor,1,x.times(n),new Ctor(1),!0);var cosh2_x,i3=k2,d8=new Ctor(8);for(;i3--;)cosh2_x=x.times(x),x=one.minus(cosh2_x.times(d8.minus(cosh2_x.times(d8))));return finalise(x,Ctor.precision=pr,Ctor.rounding=rm,!0)};P.hyperbolicSine=P.sinh=function(){var k2,pr,rm,len3,x=this,Ctor=x.constructor;if(!x.isFinite()||x.isZero())return new Ctor(x);if(pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+Math.max(x.e,x.sd())+4,Ctor.rounding=1,len3=x.d.length,len3<3)x=taylorSeries(Ctor,2,x,x,!0);else{k2=1.4*Math.sqrt(len3),k2=k2>16?16:k2|0,x=x.times(1/tinyPow(5,k2)),x=taylorSeries(Ctor,2,x,x,!0);var sinh2_x,d5=new Ctor(5),d16=new Ctor(16),d20=new Ctor(20);for(;k2--;)sinh2_x=x.times(x),x=x.times(d5.plus(sinh2_x.times(d16.times(sinh2_x).plus(d20))))}return Ctor.precision=pr,Ctor.rounding=rm,finalise(x,pr,rm,!0)};P.hyperbolicTangent=P.tanh=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(x.s);if(x.isZero())return new Ctor(x);return pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+7,Ctor.rounding=1,divide(x.sinh(),x.cosh(),Ctor.precision=pr,Ctor.rounding=rm)};P.inverseCosine=P.acos=function(){var x=this,Ctor=x.constructor,k2=x.abs().cmp(1),pr=Ctor.precision,rm=Ctor.rounding;if(k2!==-1)return k2===0?x.isNeg()?getPi(Ctor,pr,rm):new Ctor(0):new Ctor(NaN);if(x.isZero())return getPi(Ctor,pr+4,rm).times(0.5);return Ctor.precision=pr+6,Ctor.rounding=1,x=new Ctor(1).minus(x).div(x.plus(1)).sqrt().atan(),Ctor.precision=pr,Ctor.rounding=rm,x.times(2)};P.inverseHyperbolicCosine=P.acosh=function(){var pr,rm,x=this,Ctor=x.constructor;if(x.lte(1))return new Ctor(x.eq(1)?0:NaN);if(!x.isFinite())return new Ctor(x);return pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+Math.max(Math.abs(x.e),x.sd())+4,Ctor.rounding=1,external=!1,x=x.times(x).minus(1).sqrt().plus(x),external=!0,Ctor.precision=pr,Ctor.rounding=rm,x.ln()};P.inverseHyperbolicSine=P.asinh=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite()||x.isZero())return new Ctor(x);return pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+2*Math.max(Math.abs(x.e),x.sd())+6,Ctor.rounding=1,external=!1,x=x.times(x).plus(1).sqrt().plus(x),external=!0,Ctor.precision=pr,Ctor.rounding=rm,x.ln()};P.inverseHyperbolicTangent=P.atanh=function(){var pr,rm,wpr,xsd,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(NaN);if(x.e>=0)return new Ctor(x.abs().eq(1)?x.s/0:x.isZero()?x:NaN);if(pr=Ctor.precision,rm=Ctor.rounding,xsd=x.sd(),Math.max(xsd,pr)<2*-x.e-1)return finalise(new Ctor(x),pr,rm,!0);return Ctor.precision=wpr=xsd-x.e,x=divide(x.plus(1),new Ctor(1).minus(x),wpr+pr,1),Ctor.precision=pr+4,Ctor.rounding=1,x=x.ln(),Ctor.precision=pr,Ctor.rounding=rm,x.times(0.5)};P.inverseSine=P.asin=function(){var halfPi,k2,pr,rm,x=this,Ctor=x.constructor;if(x.isZero())return new Ctor(x);if(k2=x.abs().cmp(1),pr=Ctor.precision,rm=Ctor.rounding,k2!==-1){if(k2===0)return halfPi=getPi(Ctor,pr+4,rm).times(0.5),halfPi.s=x.s,halfPi;return new Ctor(NaN)}return Ctor.precision=pr+6,Ctor.rounding=1,x=x.div(new Ctor(1).minus(x.times(x)).sqrt().plus(1)).atan(),Ctor.precision=pr,Ctor.rounding=rm,x.times(2)};P.inverseTangent=P.atan=function(){var i3,j,k2,n,px2,t2,r,wpr,x2,x=this,Ctor=x.constructor,pr=Ctor.precision,rm=Ctor.rounding;if(!x.isFinite()){if(!x.s)return new Ctor(NaN);if(pr+4<=PI_PRECISION)return r=getPi(Ctor,pr+4,rm).times(0.5),r.s=x.s,r}else if(x.isZero())return new Ctor(x);else if(x.abs().eq(1)&&pr+4<=PI_PRECISION)return r=getPi(Ctor,pr+4,rm).times(0.25),r.s=x.s,r;Ctor.precision=wpr=pr+10,Ctor.rounding=1,k2=Math.min(28,wpr/LOG_BASE+2|0);for(i3=k2;i3;--i3)x=x.div(x.times(x).plus(1).sqrt().plus(1));external=!1,j=Math.ceil(wpr/LOG_BASE),n=1,x2=x.times(x),r=new Ctor(x),px2=x;for(;i3!==-1;)if(px2=px2.times(x2),t2=r.minus(px2.div(n+=2)),px2=px2.times(x2),r=t2.plus(px2.div(n+=2)),r.d[j]!==void 0)for(i3=j;r.d[i3]===t2.d[i3]&&i3--;);if(k2)r=r.times(2<<k2-1);return external=!0,finalise(r,Ctor.precision=pr,Ctor.rounding=rm,!0)};P.isFinite=function(){return!!this.d};P.isInteger=P.isInt=function(){return!!this.d&&mathfloor(this.e/LOG_BASE)>this.d.length-2};P.isNaN=function(){return!this.s};P.isNegative=P.isNeg=function(){return this.s<0};P.isPositive=P.isPos=function(){return this.s>0};P.isZero=function(){return!!this.d&&this.d[0]===0};P.lessThan=P.lt=function(y){return this.cmp(y)<0};P.lessThanOrEqualTo=P.lte=function(y){return this.cmp(y)<1};P.logarithm=P.log=function(base){var isBase10,d,denominator,k2,inf,num,sd,r,arg=this,Ctor=arg.constructor,pr=Ctor.precision,rm=Ctor.rounding,guard2=5;if(base==null)base=new Ctor(10),isBase10=!0;else{if(base=new Ctor(base),d=base.d,base.s<0||!d||!d[0]||base.eq(1))return new Ctor(NaN);isBase10=base.eq(10)}if(d=arg.d,arg.s<0||!d||!d[0]||arg.eq(1))return new Ctor(d&&!d[0]?-1/0:arg.s!=1?NaN:d?0:1/0);if(isBase10)if(d.length>1)inf=!0;else{for(k2=d[0];k2%10===0;)k2/=10;inf=k2!==1}if(external=!1,sd=pr+guard2,num=naturalLogarithm(arg,sd),denominator=isBase10?getLn10(Ctor,sd+10):naturalLogarithm(base,sd),r=divide(num,denominator,sd,1),checkRoundingDigits(r.d,k2=pr,rm))do if(sd+=10,num=naturalLogarithm(arg,sd),denominator=isBase10?getLn10(Ctor,sd+10):naturalLogarithm(base,sd),r=divide(num,denominator,sd,1),!inf){if(+digitsToString(r.d).slice(k2+1,k2+15)+1==100000000000000)r=finalise(r,pr+1,0);break}while(checkRoundingDigits(r.d,k2+=10,rm));return external=!0,finalise(r,pr,rm)};P.minus=P.sub=function(y){var d,e,i3,j,k2,len3,pr,rm,xd,xe,xLTy,yd,x=this,Ctor=x.constructor;if(y=new Ctor(y),!x.d||!y.d){if(!x.s||!y.s)y=new Ctor(NaN);else if(x.d)y.s=-y.s;else y=new Ctor(y.d||x.s!==y.s?x:NaN);return y}if(x.s!=y.s)return y.s=-y.s,x.plus(y);if(xd=x.d,yd=y.d,pr=Ctor.precision,rm=Ctor.rounding,!xd[0]||!yd[0]){if(yd[0])y.s=-y.s;else if(xd[0])y=new Ctor(x);else return new Ctor(rm===3?-0:0);return external?finalise(y,pr,rm):y}if(e=mathfloor(y.e/LOG_BASE),xe=mathfloor(x.e/LOG_BASE),xd=xd.slice(),k2=xe-e,k2){if(xLTy=k2<0,xLTy)d=xd,k2=-k2,len3=yd.length;else d=yd,e=xe,len3=xd.length;if(i3=Math.max(Math.ceil(pr/LOG_BASE),len3)+2,k2>i3)k2=i3,d.length=1;d.reverse();for(i3=k2;i3--;)d.push(0);d.reverse()}else{if(i3=xd.length,len3=yd.length,xLTy=i3<len3,xLTy)len3=i3;for(i3=0;i3<len3;i3++)if(xd[i3]!=yd[i3]){xLTy=xd[i3]<yd[i3];break}k2=0}if(xLTy)d=xd,xd=yd,yd=d,y.s=-y.s;len3=xd.length;for(i3=yd.length-len3;i3>0;--i3)xd[len3++]=0;for(i3=yd.length;i3>k2;){if(xd[--i3]<yd[i3]){for(j=i3;j&&xd[--j]===0;)xd[j]=BASE-1;--xd[j],xd[i3]+=BASE}xd[i3]-=yd[i3]}for(;xd[--len3]===0;)xd.pop();for(;xd[0]===0;xd.shift())--e;if(!xd[0])return new Ctor(rm===3?-0:0);return y.d=xd,y.e=getBase10Exponent(xd,e),external?finalise(y,pr,rm):y};P.modulo=P.mod=function(y){var q,x=this,Ctor=x.constructor;if(y=new Ctor(y),!x.d||!y.s||y.d&&!y.d[0])return new Ctor(NaN);if(!y.d||x.d&&!x.d[0])return finalise(new Ctor(x),Ctor.precision,Ctor.rounding);if(external=!1,Ctor.modulo==9)q=divide(x,y.abs(),0,3,1),q.s*=y.s;else q=divide(x,y,0,Ctor.modulo,1);return q=q.times(y),external=!0,x.minus(q)};P.naturalExponential=P.exp=function(){return naturalExponential(this)};P.naturalLogarithm=P.ln=function(){return naturalLogarithm(this)};P.negated=P.neg=function(){var x=new this.constructor(this);return x.s=-x.s,finalise(x)};P.plus=P.add=function(y){var carry,d,e,i3,k2,len3,pr,rm,xd,yd,x=this,Ctor=x.constructor;if(y=new Ctor(y),!x.d||!y.d){if(!x.s||!y.s)y=new Ctor(NaN);else if(!x.d)y=new Ctor(y.d||x.s===y.s?x:NaN);return y}if(x.s!=y.s)return y.s=-y.s,x.minus(y);if(xd=x.d,yd=y.d,pr=Ctor.precision,rm=Ctor.rounding,!xd[0]||!yd[0]){if(!yd[0])y=new Ctor(x);return external?finalise(y,pr,rm):y}if(k2=mathfloor(x.e/LOG_BASE),e=mathfloor(y.e/LOG_BASE),xd=xd.slice(),i3=k2-e,i3){if(i3<0)d=xd,i3=-i3,len3=yd.length;else d=yd,e=k2,len3=xd.length;if(k2=Math.ceil(pr/LOG_BASE),len3=k2>len3?k2+1:len3+1,i3>len3)i3=len3,d.length=1;d.reverse();for(;i3--;)d.push(0);d.reverse()}if(len3=xd.length,i3=yd.length,len3-i3<0)i3=len3,d=yd,yd=xd,xd=d;for(carry=0;i3;)carry=(xd[--i3]=xd[i3]+yd[i3]+carry)/BASE|0,xd[i3]%=BASE;if(carry)xd.unshift(carry),++e;for(len3=xd.length;xd[--len3]==0;)xd.pop();return y.d=xd,y.e=getBase10Exponent(xd,e),external?finalise(y,pr,rm):y};P.precision=P.sd=function(z){var k2,x=this;if(z!==void 0&&z!==!!z&&z!==1&&z!==0)throw Error(invalidArgument+z);if(x.d){if(k2=getPrecision(x.d),z&&x.e+1>k2)k2=x.e+1}else k2=NaN;return k2};P.round=function(){var x=this,Ctor=x.constructor;return finalise(new Ctor(x),x.e+1,Ctor.rounding)};P.sine=P.sin=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(NaN);if(x.isZero())return new Ctor(x);return pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+Math.max(x.e,x.sd())+LOG_BASE,Ctor.rounding=1,x=sine(Ctor,toLessThanHalfPi(Ctor,x)),Ctor.precision=pr,Ctor.rounding=rm,finalise(quadrant>2?x.neg():x,pr,rm,!0)};P.squareRoot=P.sqrt=function(){var m,n,sd,r,rep,t2,x=this,d=x.d,e=x.e,s=x.s,Ctor=x.constructor;if(s!==1||!d||!d[0])return new Ctor(!s||s<0&&(!d||d[0])?NaN:d?x:1/0);if(external=!1,s=Math.sqrt(+x),s==0||s==1/0){if(n=digitsToString(d),(n.length+e)%2==0)n+="0";if(s=Math.sqrt(n),e=mathfloor((e+1)/2)-(e<0||e%2),s==1/0)n="5e"+e;else n=s.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e;r=new Ctor(n)}else r=new Ctor(s.toString());sd=(e=Ctor.precision)+3;for(;;)if(t2=r,r=t2.plus(divide(x,t2,sd+2,1)).times(0.5),digitsToString(t2.d).slice(0,sd)===(n=digitsToString(r.d)).slice(0,sd))if(n=n.slice(sd-3,sd+1),n=="9999"||!rep&&n=="4999"){if(!rep){if(finalise(t2,e+1,0),t2.times(t2).eq(x)){r=t2;break}}sd+=4,rep=1}else{if(!+n||!+n.slice(1)&&n.charAt(0)=="5")finalise(r,e+1,1),m=!r.times(r).eq(x);break}return external=!0,finalise(r,e,Ctor.rounding,m)};P.tangent=P.tan=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(NaN);if(x.isZero())return new Ctor(x);return pr=Ctor.precision,rm=Ctor.rounding,Ctor.precision=pr+10,Ctor.rounding=1,x=x.sin(),x.s=1,x=divide(x,new Ctor(1).minus(x.times(x)).sqrt(),pr+10,0),Ctor.precision=pr,Ctor.rounding=rm,finalise(quadrant==2||quadrant==4?x.neg():x,pr,rm,!0)};P.times=P.mul=function(y){var carry,e,i3,k2,r,rL,t2,xdL,ydL,x=this,Ctor=x.constructor,xd=x.d,yd=(y=new Ctor(y)).d;if(y.s*=x.s,!xd||!xd[0]||!yd||!yd[0])return new Ctor(!y.s||xd&&!xd[0]&&!yd||yd&&!yd[0]&&!xd?NaN:!xd||!yd?y.s/0:y.s*0);if(e=mathfloor(x.e/LOG_BASE)+mathfloor(y.e/LOG_BASE),xdL=xd.length,ydL=yd.length,xdL<ydL)r=xd,xd=yd,yd=r,rL=xdL,xdL=ydL,ydL=rL;r=[],rL=xdL+ydL;for(i3=rL;i3--;)r.push(0);for(i3=ydL;--i3>=0;){carry=0;for(k2=xdL+i3;k2>i3;)t2=r[k2]+yd[i3]*xd[k2-i3-1]+carry,r[k2--]=t2%BASE|0,carry=t2/BASE|0;r[k2]=(r[k2]+carry)%BASE|0}for(;!r[--rL];)r.pop();if(carry)++e;else r.shift();return y.d=r,y.e=getBase10Exponent(r,e),external?finalise(y,Ctor.precision,Ctor.rounding):y};P.toBinary=function(sd,rm){return toStringBinary(this,2,sd,rm)};P.toDecimalPlaces=P.toDP=function(dp,rm){var x=this,Ctor=x.constructor;if(x=new Ctor(x),dp===void 0)return x;if(checkInt32(dp,0,MAX_DIGITS),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);return finalise(x,dp+x.e+1,rm)};P.toExponential=function(dp,rm){var str,x=this,Ctor=x.constructor;if(dp===void 0)str=finiteToString(x,!0);else{if(checkInt32(dp,0,MAX_DIGITS),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);x=finalise(new Ctor(x),dp+1,rm),str=finiteToString(x,!0,dp+1)}return x.isNeg()&&!x.isZero()?"-"+str:str};P.toFixed=function(dp,rm){var str,y,x=this,Ctor=x.constructor;if(dp===void 0)str=finiteToString(x);else{if(checkInt32(dp,0,MAX_DIGITS),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);y=finalise(new Ctor(x),dp+x.e+1,rm),str=finiteToString(y,!1,dp+y.e+1)}return x.isNeg()&&!x.isZero()?"-"+str:str};P.toFraction=function(maxD){var d,d0,d1,d2,e,k2,n,n0,n1,pr,q,r,x=this,xd=x.d,Ctor=x.constructor;if(!xd)return new Ctor(x);if(n1=d0=new Ctor(1),d1=n0=new Ctor(0),d=new Ctor(d1),e=d.e=getPrecision(xd)-x.e-1,k2=e%LOG_BASE,d.d[0]=mathpow(10,k2<0?LOG_BASE+k2:k2),maxD==null)maxD=e>0?d:n1;else{if(n=new Ctor(maxD),!n.isInt()||n.lt(n1))throw Error(invalidArgument+n);maxD=n.gt(d)?e>0?d:n1:n}external=!1,n=new Ctor(digitsToString(xd)),pr=Ctor.precision,Ctor.precision=e=xd.length*LOG_BASE*2;for(;;){if(q=divide(n,d,0,1,1),d2=d0.plus(q.times(d1)),d2.cmp(maxD)==1)break;d0=d1,d1=d2,d2=n1,n1=n0.plus(q.times(d2)),n0=d2,d2=d,d=n.minus(q.times(d2)),n=d2}return d2=divide(maxD.minus(d0),d1,0,1,1),n0=n0.plus(d2.times(n1)),d0=d0.plus(d2.times(d1)),n0.s=n1.s=x.s,r=divide(n1,d1,e,1).minus(x).abs().cmp(divide(n0,d0,e,1).minus(x).abs())<1?[n1,d1]:[n0,d0],Ctor.precision=pr,external=!0,r};P.toHexadecimal=P.toHex=function(sd,rm){return toStringBinary(this,16,sd,rm)};P.toNearest=function(y,rm){var x=this,Ctor=x.constructor;if(x=new Ctor(x),y==null){if(!x.d)return x;y=new Ctor(1),rm=Ctor.rounding}else{if(y=new Ctor(y),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);if(!x.d)return y.s?x:y;if(!y.d){if(y.s)y.s=x.s;return y}}if(y.d[0])external=!1,x=divide(x,y,0,rm,1).times(y),external=!0,finalise(x);else y.s=x.s,x=y;return x};P.toNumber=function(){return+this};P.toOctal=function(sd,rm){return toStringBinary(this,8,sd,rm)};P.toPower=P.pow=function(y){var e,k2,pr,r,rm,s,x=this,Ctor=x.constructor,yn=+(y=new Ctor(y));if(!x.d||!y.d||!x.d[0]||!y.d[0])return new Ctor(mathpow(+x,yn));if(x=new Ctor(x),x.eq(1))return x;if(pr=Ctor.precision,rm=Ctor.rounding,y.eq(1))return finalise(x,pr,rm);if(e=mathfloor(y.e/LOG_BASE),e>=y.d.length-1&&(k2=yn<0?-yn:yn)<=MAX_SAFE_INTEGER)return r=intPow(Ctor,x,k2,pr),y.s<0?new Ctor(1).div(r):finalise(r,pr,rm);if(s=x.s,s<0){if(e<y.d.length-1)return new Ctor(NaN);if((y.d[e]&1)==0)s=1;if(x.e==0&&x.d[0]==1&&x.d.length==1)return x.s=s,x}if(k2=mathpow(+x,yn),e=k2==0||!isFinite(k2)?mathfloor(yn*(Math.log("0."+digitsToString(x.d))/Math.LN10+x.e+1)):new Ctor(k2+"").e,e>Ctor.maxE+1||e<Ctor.minE-1)return new Ctor(e>0?s/0:0);if(external=!1,Ctor.rounding=x.s=1,k2=Math.min(12,(e+"").length),r=naturalExponential(y.times(naturalLogarithm(x,pr+k2)),pr),r.d){if(r=finalise(r,pr+5,1),checkRoundingDigits(r.d,pr,rm)){if(e=pr+10,r=finalise(naturalExponential(y.times(naturalLogarithm(x,e+k2)),e),e+5,1),+digitsToString(r.d).slice(pr+1,pr+15)+1==100000000000000)r=finalise(r,pr+1,0)}}return r.s=s,external=!0,Ctor.rounding=rm,finalise(r,pr,rm)};P.toPrecision=function(sd,rm){var str,x=this,Ctor=x.constructor;if(sd===void 0)str=finiteToString(x,x.e<=Ctor.toExpNeg||x.e>=Ctor.toExpPos);else{if(checkInt32(sd,1,MAX_DIGITS),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);x=finalise(new Ctor(x),sd,rm),str=finiteToString(x,sd<=x.e||x.e<=Ctor.toExpNeg,sd)}return x.isNeg()&&!x.isZero()?"-"+str:str};P.toSignificantDigits=P.toSD=function(sd,rm){var x=this,Ctor=x.constructor;if(sd===void 0)sd=Ctor.precision,rm=Ctor.rounding;else if(checkInt32(sd,1,MAX_DIGITS),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);return finalise(new Ctor(x),sd,rm)};P.toString=function(){var x=this,Ctor=x.constructor,str=finiteToString(x,x.e<=Ctor.toExpNeg||x.e>=Ctor.toExpPos);return x.isNeg()&&!x.isZero()?"-"+str:str};P.truncated=P.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)};P.valueOf=P.toJSON=function(){var x=this,Ctor=x.constructor,str=finiteToString(x,x.e<=Ctor.toExpNeg||x.e>=Ctor.toExpPos);return x.isNeg()?"-"+str:str};function digitsToString(d){var i3,k2,ws,indexOfLastWord=d.length-1,str="",w=d[0];if(indexOfLastWord>0){str+=w;for(i3=1;i3<indexOfLastWord;i3++){if(ws=d[i3]+"",k2=LOG_BASE-ws.length,k2)str+=getZeroString(k2);str+=ws}if(w=d[i3],ws=w+"",k2=LOG_BASE-ws.length,k2)str+=getZeroString(k2)}else if(w===0)return"0";for(;w%10===0;)w/=10;return str+w}function checkInt32(i3,min,max){if(i3!==~~i3||i3<min||i3>max)throw Error(invalidArgument+i3)}function checkRoundingDigits(d,i3,rm,repeating){var di,k2,r,rd;for(k2=d[0];k2>=10;k2/=10)--i3;if(--i3<0)i3+=LOG_BASE,di=0;else di=Math.ceil((i3+1)/LOG_BASE),i3%=LOG_BASE;if(k2=mathpow(10,LOG_BASE-i3),rd=d[di]%k2|0,repeating==null)if(i3<3){if(i3==0)rd=rd/100|0;else if(i3==1)rd=rd/10|0;r=rm<4&&rd==99999||rm>3&&rd==49999||rd==50000||rd==0}else r=(rm<4&&rd+1==k2||rm>3&&rd+1==k2/2)&&(d[di+1]/k2/100|0)==mathpow(10,i3-2)-1||(rd==k2/2||rd==0)&&(d[di+1]/k2/100|0)==0;else if(i3<4){if(i3==0)rd=rd/1000|0;else if(i3==1)rd=rd/100|0;else if(i3==2)rd=rd/10|0;r=(repeating||rm<4)&&rd==9999||!repeating&&rm>3&&rd==4999}else r=((repeating||rm<4)&&rd+1==k2||!repeating&&rm>3&&rd+1==k2/2)&&(d[di+1]/k2/1000|0)==mathpow(10,i3-3)-1;return r}function convertBase(str,baseIn,baseOut){var j,arr=[0],arrL,i3=0,strL=str.length;for(;i3<strL;){for(arrL=arr.length;arrL--;)arr[arrL]*=baseIn;arr[0]+=NUMERALS.indexOf(str.charAt(i3++));for(j=0;j<arr.length;j++)if(arr[j]>baseOut-1){if(arr[j+1]===void 0)arr[j+1]=0;arr[j+1]+=arr[j]/baseOut|0,arr[j]%=baseOut}}return arr.reverse()}function cosine(Ctor,x){var k2,len3,y;if(x.isZero())return x;if(len3=x.d.length,len3<32)k2=Math.ceil(len3/3),y=(1/tinyPow(4,k2)).toString();else k2=16,y="2.3283064365386962890625e-10";Ctor.precision+=k2,x=taylorSeries(Ctor,1,x.times(y),new Ctor(1));for(var i3=k2;i3--;){var cos2x=x.times(x);x=cos2x.times(cos2x).minus(cos2x).times(8).plus(1)}return Ctor.precision-=k2,x}var divide=function(){function multiplyInteger(x,k2,base){var temp,carry=0,i3=x.length;for(x=x.slice();i3--;)temp=x[i3]*k2+carry,x[i3]=temp%base|0,carry=temp/base|0;if(carry)x.unshift(carry);return x}function compare(a,b2,aL,bL){var i3,r;if(aL!=bL)r=aL>bL?1:-1;else for(i3=r=0;i3<aL;i3++)if(a[i3]!=b2[i3]){r=a[i3]>b2[i3]?1:-1;break}return r}function subtract(a,b2,aL,base){var i3=0;for(;aL--;)a[aL]-=i3,i3=a[aL]<b2[aL]?1:0,a[aL]=i3*base+a[aL]-b2[aL];for(;!a[0]&&a.length>1;)a.shift()}return function(x,y,pr,rm,dp,base){var cmp,e,i3,k2,logBase,more,prod,prodL,q,qd,rem,remL,rem0,sd,t2,xi,xL,yd0,yL,yz,Ctor=x.constructor,sign2=x.s==y.s?1:-1,xd=x.d,yd=y.d;if(!xd||!xd[0]||!yd||!yd[0])return new Ctor(!x.s||!y.s||(xd?yd&&xd[0]==yd[0]:!yd)?NaN:xd&&xd[0]==0||!yd?sign2*0:sign2/0);if(base)logBase=1,e=x.e-y.e;else base=BASE,logBase=LOG_BASE,e=mathfloor(x.e/logBase)-mathfloor(y.e/logBase);yL=yd.length,xL=xd.length,q=new Ctor(sign2),qd=q.d=[];for(i3=0;yd[i3]==(xd[i3]||0);i3++);if(yd[i3]>(xd[i3]||0))e--;if(pr==null)sd=pr=Ctor.precision,rm=Ctor.rounding;else if(dp)sd=pr+(x.e-y.e)+1;else sd=pr;if(sd<0)qd.push(1),more=!0;else{if(sd=sd/logBase+2|0,i3=0,yL==1){k2=0,yd=yd[0],sd++;for(;(i3<xL||k2)&&sd--;i3++)t2=k2*base+(xd[i3]||0),qd[i3]=t2/yd|0,k2=t2%yd|0;more=k2||i3<xL}else{if(k2=base/(yd[0]+1)|0,k2>1)yd=multiplyInteger(yd,k2,base),xd=multiplyInteger(xd,k2,base),yL=yd.length,xL=xd.length;xi=yL,rem=xd.slice(0,yL),remL=rem.length;for(;remL<yL;)rem[remL++]=0;if(yz=yd.slice(),yz.unshift(0),yd0=yd[0],yd[1]>=base/2)++yd0;do{if(k2=0,cmp=compare(yd,rem,yL,remL),cmp<0){if(rem0=rem[0],yL!=remL)rem0=rem0*base+(rem[1]||0);if(k2=rem0/yd0|0,k2>1){if(k2>=base)k2=base-1;if(prod=multiplyInteger(yd,k2,base),prodL=prod.length,remL=rem.length,cmp=compare(prod,rem,prodL,remL),cmp==1)k2--,subtract(prod,yL<prodL?yz:yd,prodL,base)}else{if(k2==0)cmp=k2=1;prod=yd.slice()}if(prodL=prod.length,prodL<remL)prod.unshift(0);if(subtract(rem,prod,remL,base),cmp==-1){if(remL=rem.length,cmp=compare(yd,rem,yL,remL),cmp<1)k2++,subtract(rem,yL<remL?yz:yd,remL,base)}remL=rem.length}else if(cmp===0)k2++,rem=[0];if(qd[i3++]=k2,cmp&&rem[0])rem[remL++]=xd[xi]||0;else rem=[xd[xi]],remL=1}while((xi++<xL||rem[0]!==void 0)&&sd--);more=rem[0]!==void 0}if(!qd[0])qd.shift()}if(logBase==1)q.e=e,inexact=more;else{for(i3=1,k2=qd[0];k2>=10;k2/=10)i3++;q.e=i3+e*logBase-1,finalise(q,dp?pr+q.e+1:pr,rm,more)}return q}}();function finalise(x,sd,rm,isTruncated){var digits,i3,j,k2,rd,roundUp,w,xd,xdi,Ctor=x.constructor;out:if(sd!=null){if(xd=x.d,!xd)return x;for(digits=1,k2=xd[0];k2>=10;k2/=10)digits++;if(i3=sd-digits,i3<0)i3+=LOG_BASE,j=sd,w=xd[xdi=0],rd=w/mathpow(10,digits-j-1)%10|0;else if(xdi=Math.ceil((i3+1)/LOG_BASE),k2=xd.length,xdi>=k2)if(isTruncated){for(;k2++<=xdi;)xd.push(0);w=rd=0,digits=1,i3%=LOG_BASE,j=i3-LOG_BASE+1}else break out;else{w=k2=xd[xdi];for(digits=1;k2>=10;k2/=10)digits++;i3%=LOG_BASE,j=i3-LOG_BASE+digits,rd=j<0?0:w/mathpow(10,digits-j-1)%10|0}if(isTruncated=isTruncated||sd<0||xd[xdi+1]!==void 0||(j<0?w:w%mathpow(10,digits-j-1)),roundUp=rm<4?(rd||isTruncated)&&(rm==0||rm==(x.s<0?3:2)):rd>5||rd==5&&(rm==4||isTruncated||rm==6&&(i3>0?j>0?w/mathpow(10,digits-j):0:xd[xdi-1])%10&1||rm==(x.s<0?8:7)),sd<1||!xd[0]){if(xd.length=0,roundUp)sd-=x.e+1,xd[0]=mathpow(10,(LOG_BASE-sd%LOG_BASE)%LOG_BASE),x.e=-sd||0;else xd[0]=x.e=0;return x}if(i3==0)xd.length=xdi,k2=1,xdi--;else xd.length=xdi+1,k2=mathpow(10,LOG_BASE-i3),xd[xdi]=j>0?(w/mathpow(10,digits-j)%mathpow(10,j)|0)*k2:0;if(roundUp)for(;;)if(xdi==0){for(i3=1,j=xd[0];j>=10;j/=10)i3++;j=xd[0]+=k2;for(k2=1;j>=10;j/=10)k2++;if(i3!=k2){if(x.e++,xd[0]==BASE)xd[0]=1}break}else{if(xd[xdi]+=k2,xd[xdi]!=BASE)break;xd[xdi--]=0,k2=1}for(i3=xd.length;xd[--i3]===0;)xd.pop()}if(external){if(x.e>Ctor.maxE)x.d=null,x.e=NaN;else if(x.e<Ctor.minE)x.e=0,x.d=[0]}return x}function finiteToString(x,isExp,sd){if(!x.isFinite())return nonFiniteToString(x);var k2,e=x.e,str=digitsToString(x.d),len3=str.length;if(isExp){if(sd&&(k2=sd-len3)>0)str=str.charAt(0)+"."+str.slice(1)+getZeroString(k2);else if(len3>1)str=str.charAt(0)+"."+str.slice(1);str=str+(x.e<0?"e":"e+")+x.e}else if(e<0){if(str="0."+getZeroString(-e-1)+str,sd&&(k2=sd-len3)>0)str+=getZeroString(k2)}else if(e>=len3){if(str+=getZeroString(e+1-len3),sd&&(k2=sd-e-1)>0)str=str+"."+getZeroString(k2)}else{if((k2=e+1)<len3)str=str.slice(0,k2)+"."+str.slice(k2);if(sd&&(k2=sd-len3)>0){if(e+1===len3)str+=".";str+=getZeroString(k2)}}return str}function getBase10Exponent(digits,e){var w=digits[0];for(e*=LOG_BASE;w>=10;w/=10)e++;return e}function getLn10(Ctor,sd,pr){if(sd>LN10_PRECISION){if(external=!0,pr)Ctor.precision=pr;throw Error(precisionLimitExceeded)}return finalise(new Ctor(LN10),sd,1,!0)}function getPi(Ctor,sd,rm){if(sd>PI_PRECISION)throw Error(precisionLimitExceeded);return finalise(new Ctor(PI),sd,rm,!0)}function getPrecision(digits){var w=digits.length-1,len3=w*LOG_BASE+1;if(w=digits[w],w){for(;w%10==0;w/=10)len3--;for(w=digits[0];w>=10;w/=10)len3++}return len3}function getZeroString(k2){var zs="";for(;k2--;)zs+="0";return zs}function intPow(Ctor,x,n,pr){var isTruncated,r=new Ctor(1),k2=Math.ceil(pr/LOG_BASE+4);external=!1;for(;;){if(n%2){if(r=r.times(x),truncate(r.d,k2))isTruncated=!0}if(n=mathfloor(n/2),n===0){if(n=r.d.length-1,isTruncated&&r.d[n]===0)++r.d[n];break}x=x.times(x),truncate(x.d,k2)}return external=!0,r}function isOdd(n){return n.d[n.d.length-1]&1}function maxOrMin(Ctor,args,n){var k2,y,x=new Ctor(args[0]),i3=0;for(;++i3<args.length;){if(y=new Ctor(args[i3]),!y.s){x=y;break}if(k2=x.cmp(y),k2===n||k2===0&&x.s===n)x=y}return x}function naturalExponential(x,sd){var denominator,guard2,j,pow,sum2,t2,wpr,rep=0,i3=0,k2=0,Ctor=x.constructor,rm=Ctor.rounding,pr=Ctor.precision;if(!x.d||!x.d[0]||x.e>17)return new Ctor(x.d?!x.d[0]?1:x.s<0?0:1/0:x.s?x.s<0?0:x:NaN);if(sd==null)external=!1,wpr=pr;else wpr=sd;t2=new Ctor(0.03125);while(x.e>-2)x=x.times(t2),k2+=5;guard2=Math.log(mathpow(2,k2))/Math.LN10*2+5|0,wpr+=guard2,denominator=pow=sum2=new Ctor(1),Ctor.precision=wpr;for(;;){if(pow=finalise(pow.times(x),wpr,1),denominator=denominator.times(++i3),t2=sum2.plus(divide(pow,denominator,wpr,1)),digitsToString(t2.d).slice(0,wpr)===digitsToString(sum2.d).slice(0,wpr)){j=k2;while(j--)sum2=finalise(sum2.times(sum2),wpr,1);if(sd==null)if(rep<3&&checkRoundingDigits(sum2.d,wpr-guard2,rm,rep))Ctor.precision=wpr+=10,denominator=pow=t2=new Ctor(1),i3=0,rep++;else return finalise(sum2,Ctor.precision=pr,rm,external=!0);else return Ctor.precision=pr,sum2}sum2=t2}}function naturalLogarithm(y,sd){var c,c0,denominator,e,numerator,rep,sum2,t2,wpr,x1,x2,n=1,guard2=10,x=y,xd=x.d,Ctor=x.constructor,rm=Ctor.rounding,pr=Ctor.precision;if(x.s<0||!xd||!xd[0]||!x.e&&xd[0]==1&&xd.length==1)return new Ctor(xd&&!xd[0]?-1/0:x.s!=1?NaN:xd?0:x);if(sd==null)external=!1,wpr=pr;else wpr=sd;if(Ctor.precision=wpr+=guard2,c=digitsToString(xd),c0=c.charAt(0),Math.abs(e=x.e)<1500000000000000){while(c0<7&&c0!=1||c0==1&&c.charAt(1)>3)x=x.times(y),c=digitsToString(x.d),c0=c.charAt(0),n++;if(e=x.e,c0>1)x=new Ctor("0."+c),e++;else x=new Ctor(c0+"."+c.slice(1))}else return t2=getLn10(Ctor,wpr+2,pr).times(e+""),x=naturalLogarithm(new Ctor(c0+"."+c.slice(1)),wpr-guard2).plus(t2),Ctor.precision=pr,sd==null?finalise(x,pr,rm,external=!0):x;x1=x,sum2=numerator=x=divide(x.minus(1),x.plus(1),wpr,1),x2=finalise(x.times(x),wpr,1),denominator=3;for(;;){if(numerator=finalise(numerator.times(x2),wpr,1),t2=sum2.plus(divide(numerator,new Ctor(denominator),wpr,1)),digitsToString(t2.d).slice(0,wpr)===digitsToString(sum2.d).slice(0,wpr)){if(sum2=sum2.times(2),e!==0)sum2=sum2.plus(getLn10(Ctor,wpr+2,pr).times(e+""));if(sum2=divide(sum2,new Ctor(n),wpr,1),sd==null)if(checkRoundingDigits(sum2.d,wpr-guard2,rm,rep))Ctor.precision=wpr+=guard2,t2=numerator=x=divide(x1.minus(1),x1.plus(1),wpr,1),x2=finalise(x.times(x),wpr,1),denominator=rep=1;else return finalise(sum2,Ctor.precision=pr,rm,external=!0);else return Ctor.precision=pr,sum2}sum2=t2,denominator+=2}}function nonFiniteToString(x){return String(x.s*x.s/0)}function parseDecimal(x,str){var e,i3,len3;if((e=str.indexOf("."))>-1)str=str.replace(".","");if((i3=str.search(/e/i))>0){if(e<0)e=i3;e+=+str.slice(i3+1),str=str.substring(0,i3)}else if(e<0)e=str.length;for(i3=0;str.charCodeAt(i3)===48;i3++);for(len3=str.length;str.charCodeAt(len3-1)===48;--len3);if(str=str.slice(i3,len3),str){if(len3-=i3,x.e=e=e-i3-1,x.d=[],i3=(e+1)%LOG_BASE,e<0)i3+=LOG_BASE;if(i3<len3){if(i3)x.d.push(+str.slice(0,i3));for(len3-=LOG_BASE;i3<len3;)x.d.push(+str.slice(i3,i3+=LOG_BASE));str=str.slice(i3),i3=LOG_BASE-str.length}else i3-=len3;for(;i3--;)str+="0";if(x.d.push(+str),external){if(x.e>x.constructor.maxE)x.d=null,x.e=NaN;else if(x.e<x.constructor.minE)x.e=0,x.d=[0]}}else x.e=0,x.d=[0];return x}function parseOther(x,str){var base,Ctor,divisor,i3,isFloat,len3,p,xd,xe;if(str.indexOf("_")>-1){if(str=str.replace(/(\d)_(?=\d)/g,"$1"),isDecimal.test(str))return parseDecimal(x,str)}else if(str==="Infinity"||str==="NaN"){if(!+str)x.s=NaN;return x.e=NaN,x.d=null,x}if(isHex.test(str))base=16,str=str.toLowerCase();else if(isBinary.test(str))base=2;else if(isOctal.test(str))base=8;else throw Error(invalidArgument+str);if(i3=str.search(/p/i),i3>0)p=+str.slice(i3+1),str=str.substring(2,i3);else str=str.slice(2);if(i3=str.indexOf("."),isFloat=i3>=0,Ctor=x.constructor,isFloat)str=str.replace(".",""),len3=str.length,i3=len3-i3,divisor=intPow(Ctor,new Ctor(base),i3,i3*2);xd=convertBase(str,base,BASE),xe=xd.length-1;for(i3=xe;xd[i3]===0;--i3)xd.pop();if(i3<0)return new Ctor(x.s*0);if(x.e=getBase10Exponent(xd,xe),x.d=xd,external=!1,isFloat)x=divide(x,divisor,len3*4);if(p)x=x.times(Math.abs(p)<54?mathpow(2,p):Decimal.pow(2,p));return external=!0,x}function sine(Ctor,x){var k2,len3=x.d.length;if(len3<3)return x.isZero()?x:taylorSeries(Ctor,2,x,x);k2=1.4*Math.sqrt(len3),k2=k2>16?16:k2|0,x=x.times(1/tinyPow(5,k2)),x=taylorSeries(Ctor,2,x,x);var sin2_x,d5=new Ctor(5),d16=new Ctor(16),d20=new Ctor(20);for(;k2--;)sin2_x=x.times(x),x=x.times(d5.plus(sin2_x.times(d16.times(sin2_x).minus(d20))));return x}function taylorSeries(Ctor,n,x,y,isHyperbolic){var j,t2,u,x2,i3=1,pr=Ctor.precision,k2=Math.ceil(pr/LOG_BASE);external=!1,x2=x.times(x),u=new Ctor(y);for(;;){if(t2=divide(u.times(x2),new Ctor(n++*n++),pr,1),u=isHyperbolic?y.plus(t2):y.minus(t2),y=divide(t2.times(x2),new Ctor(n++*n++),pr,1),t2=u.plus(y),t2.d[k2]!==void 0){for(j=k2;t2.d[j]===u.d[j]&&j--;);if(j==-1)break}j=u,u=y,y=t2,t2=j,i3++}return external=!0,t2.d.length=k2+1,t2}function tinyPow(b2,e){var n=b2;while(--e)n*=b2;return n}function toLessThanHalfPi(Ctor,x){var t2,isNeg=x.s<0,pi=getPi(Ctor,Ctor.precision,1),halfPi=pi.times(0.5);if(x=x.abs(),x.lte(halfPi))return quadrant=isNeg?4:1,x;if(t2=x.divToInt(pi),t2.isZero())quadrant=isNeg?3:2;else{if(x=x.minus(t2.times(pi)),x.lte(halfPi))return quadrant=isOdd(t2)?isNeg?2:3:isNeg?4:1,x;quadrant=isOdd(t2)?isNeg?1:4:isNeg?3:2}return x.minus(pi).abs()}function toStringBinary(x,baseOut,sd,rm){var base,e,i3,k2,len3,roundUp,str,xd,y,Ctor=x.constructor,isExp=sd!==void 0;if(isExp)if(checkInt32(sd,1,MAX_DIGITS),rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);else sd=Ctor.precision,rm=Ctor.rounding;if(!x.isFinite())str=nonFiniteToString(x);else{if(str=finiteToString(x),i3=str.indexOf("."),isExp){if(base=2,baseOut==16)sd=sd*4-3;else if(baseOut==8)sd=sd*3-2}else base=baseOut;if(i3>=0)str=str.replace(".",""),y=new Ctor(1),y.e=str.length-i3,y.d=convertBase(finiteToString(y),10,base),y.e=y.d.length;xd=convertBase(str,10,base),e=len3=xd.length;for(;xd[--len3]==0;)xd.pop();if(!xd[0])str=isExp?"0p+0":"0";else{if(i3<0)e--;else x=new Ctor(x),x.d=xd,x.e=e,x=divide(x,y,sd,rm,0,base),xd=x.d,e=x.e,roundUp=inexact;if(i3=xd[sd],k2=base/2,roundUp=roundUp||xd[sd+1]!==void 0,roundUp=rm<4?(i3!==void 0||roundUp)&&(rm===0||rm===(x.s<0?3:2)):i3>k2||i3===k2&&(rm===4||roundUp||rm===6&&xd[sd-1]&1||rm===(x.s<0?8:7)),xd.length=sd,roundUp){for(;++xd[--sd]>base-1;)if(xd[sd]=0,!sd)++e,xd.unshift(1)}for(len3=xd.length;!xd[len3-1];--len3);for(i3=0,str="";i3<len3;i3++)str+=NUMERALS.charAt(xd[i3]);if(isExp){if(len3>1)if(baseOut==16||baseOut==8){i3=baseOut==16?4:3;for(--len3;len3%i3;len3++)str+="0";xd=convertBase(str,base,baseOut);for(len3=xd.length;!xd[len3-1];--len3);for(i3=1,str="1.";i3<len3;i3++)str+=NUMERALS.charAt(xd[i3])}else str=str.charAt(0)+"."+str.slice(1);str=str+(e<0?"p":"p+")+e}else if(e<0){for(;++e;)str="0"+str;str="0."+str}else if(++e>len3)for(e-=len3;e--;)str+="0";else if(e<len3)str=str.slice(0,e)+"."+str.slice(e)}str=(baseOut==16?"0x":baseOut==2?"0b":baseOut==8?"0o":"")+str}return x.s<0?"-"+str:str}function truncate(arr,len3){if(arr.length>len3)return arr.length=len3,!0}function abs(x){return new this(x).abs()}function acos(x){return new this(x).acos()}function acosh(x){return new this(x).acosh()}function add(x,y){return new this(x).plus(y)}function asin(x){return new this(x).asin()}function asinh(x){return new this(x).asinh()}function atan(x){return new this(x).atan()}function atanh(x){return new this(x).atanh()}function atan2(y,x){y=new this(y),x=new this(x);var r,pr=this.precision,rm=this.rounding,wpr=pr+4;if(!y.s||!x.s)r=new this(NaN);else if(!y.d&&!x.d)r=getPi(this,wpr,1).times(x.s>0?0.25:0.75),r.s=y.s;else if(!x.d||y.isZero())r=x.s<0?getPi(this,pr,rm):new this(0),r.s=y.s;else if(!y.d||x.isZero())r=getPi(this,wpr,1).times(0.5),r.s=y.s;else if(x.s<0)this.precision=wpr,this.rounding=1,r=this.atan(divide(y,x,wpr,1)),x=getPi(this,wpr,1),this.precision=pr,this.rounding=rm,r=y.s<0?r.minus(x):r.plus(x);else r=this.atan(divide(y,x,wpr,1));return r}function cbrt(x){return new this(x).cbrt()}function ceil(x){return finalise(x=new this(x),x.e+1,2)}function clamp(x,min,max){return new this(x).clamp(min,max)}function config(obj){if(!obj||typeof obj!=="object")throw Error(decimalError+"Object expected");var i3,p,v,useDefaults=obj.defaults===!0,ps=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-EXP_LIMIT,0,"toExpPos",0,EXP_LIMIT,"maxE",0,EXP_LIMIT,"minE",-EXP_LIMIT,0,"modulo",0,9];for(i3=0;i3<ps.length;i3+=3){if(p=ps[i3],useDefaults)this[p]=DEFAULTS[p];if((v=obj[p])!==void 0)if(mathfloor(v)===v&&v>=ps[i3+1]&&v<=ps[i3+2])this[p]=v;else throw Error(invalidArgument+p+": "+v)}if(p="crypto",useDefaults)this[p]=DEFAULTS[p];if((v=obj[p])!==void 0)if(v===!0||v===!1||v===0||v===1)if(v)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[p]=!0;else throw Error(cryptoUnavailable);else this[p]=!1;else throw Error(invalidArgument+p+": "+v);return this}function cos2(x){return new this(x).cos()}function cosh(x){return new this(x).cosh()}function clone2(obj){var i3,p,ps;function Decimal(v){var e,i4,t2,x=this;if(!(x instanceof Decimal))return new Decimal(v);if(x.constructor=Decimal,isDecimalInstance(v)){if(x.s=v.s,external)if(!v.d||v.e>Decimal.maxE)x.e=NaN,x.d=null;else if(v.e<Decimal.minE)x.e=0,x.d=[0];else x.e=v.e,x.d=v.d.slice();else x.e=v.e,x.d=v.d?v.d.slice():v.d;return}if(t2=typeof v,t2==="number"){if(v===0){x.s=1/v<0?-1:1,x.e=0,x.d=[0];return}if(v<0)v=-v,x.s=-1;else x.s=1;if(v===~~v&&v<1e7){for(e=0,i4=v;i4>=10;i4/=10)e++;if(external)if(e>Decimal.maxE)x.e=NaN,x.d=null;else if(e<Decimal.minE)x.e=0,x.d=[0];else x.e=e,x.d=[v];else x.e=e,x.d=[v];return}if(v*0!==0){if(!v)x.s=NaN;x.e=NaN,x.d=null;return}return parseDecimal(x,v.toString())}if(t2==="string"){if((i4=v.charCodeAt(0))===45)v=v.slice(1),x.s=-1;else{if(i4===43)v=v.slice(1);x.s=1}return isDecimal.test(v)?parseDecimal(x,v):parseOther(x,v)}if(t2==="bigint"){if(v<0)v=-v,x.s=-1;else x.s=1;return parseDecimal(x,v.toString())}throw Error(invalidArgument+v)}if(Decimal.prototype=P,Decimal.ROUND_UP=0,Decimal.ROUND_DOWN=1,Decimal.ROUND_CEIL=2,Decimal.ROUND_FLOOR=3,Decimal.ROUND_HALF_UP=4,Decimal.ROUND_HALF_DOWN=5,Decimal.ROUND_HALF_EVEN=6,Decimal.ROUND_HALF_CEIL=7,Decimal.ROUND_HALF_FLOOR=8,Decimal.EUCLID=9,Decimal.config=Decimal.set=config,Decimal.clone=clone2,Decimal.isDecimal=isDecimalInstance,Decimal.abs=abs,Decimal.acos=acos,Decimal.acosh=acosh,Decimal.add=add,Decimal.asin=asin,Decimal.asinh=asinh,Decimal.atan=atan,Decimal.atanh=atanh,Decimal.atan2=atan2,Decimal.cbrt=cbrt,Decimal.ceil=ceil,Decimal.clamp=clamp,Decimal.cos=cos2,Decimal.cosh=cosh,Decimal.div=div,Decimal.exp=exp,Decimal.floor=floor,Decimal.hypot=hypot,Decimal.ln=ln,Decimal.log=log,Decimal.log10=log10,Decimal.log2=log2,Decimal.max=max,Decimal.min=min,Decimal.mod=mod,Decimal.mul=mul,Decimal.pow=pow,Decimal.random=random,Decimal.round=round,Decimal.sign=sign2,Decimal.sin=sin2,Decimal.sinh=sinh,Decimal.sqrt=sqrt,Decimal.sub=sub,Decimal.sum=sum2,Decimal.tan=tan2,Decimal.tanh=tanh,Decimal.trunc=trunc,obj===void 0)obj={};if(obj){if(obj.defaults!==!0){ps=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"];for(i3=0;i3<ps.length;)if(!obj.hasOwnProperty(p=ps[i3++]))obj[p]=this[p]}}return Decimal.config(obj),Decimal}function div(x,y){return new this(x).div(y)}function exp(x){return new this(x).exp()}function floor(x){return finalise(x=new this(x),x.e+1,3)}function hypot(){var i3,n,t2=new this(0);external=!1;for(i3=0;i3<arguments.length;)if(n=new this(arguments[i3++]),!n.d){if(n.s)return external=!0,new this(1/0);t2=n}else if(t2.d)t2=t2.plus(n.times(n));return external=!0,t2.sqrt()}function isDecimalInstance(obj){return obj instanceof Decimal||obj&&obj.toStringTag===tag||!1}function ln(x){return new this(x).ln()}function log(x,y){return new this(x).log(y)}function log2(x){return new this(x).log(2)}function log10(x){return new this(x).log(10)}function max(){return maxOrMin(this,arguments,-1)}function min(){return maxOrMin(this,arguments,1)}function mod(x,y){return new this(x).mod(y)}function mul(x,y){return new this(x).mul(y)}function pow(x,y){return new this(x).pow(y)}function random(sd){var d,e,k2,n,i3=0,r=new this(1),rd=[];if(sd===void 0)sd=this.precision;else checkInt32(sd,1,MAX_DIGITS);if(k2=Math.ceil(sd/LOG_BASE),!this.crypto)for(;i3<k2;)rd[i3++]=Math.random()*1e7|0;else if(crypto.getRandomValues){d=crypto.getRandomValues(new Uint32Array(k2));for(;i3<k2;)if(n=d[i3],n>=4290000000)d[i3]=crypto.getRandomValues(new Uint32Array(1))[0];else rd[i3++]=n%1e7}else if(crypto.randomBytes){d=crypto.randomBytes(k2*=4);for(;i3<k2;)if(n=d[i3]+(d[i3+1]<<8)+(d[i3+2]<<16)+((d[i3+3]&127)<<24),n>=2140000000)crypto.randomBytes(4).copy(d,i3);else rd.push(n%1e7),i3+=4;i3=k2/4}else throw Error(cryptoUnavailable);if(k2=rd[--i3],sd%=LOG_BASE,k2&&sd)n=mathpow(10,LOG_BASE-sd),rd[i3]=(k2/n|0)*n;for(;rd[i3]===0;i3--)rd.pop();if(i3<0)e=0,rd=[0];else{e=-1;for(;rd[0]===0;e-=LOG_BASE)rd.shift();for(k2=1,n=rd[0];n>=10;n/=10)k2++;if(k2<LOG_BASE)e-=LOG_BASE-k2}return r.e=e,r.d=rd,r}function round(x){return finalise(x=new this(x),x.e+1,this.rounding)}function sign2(x){return x=new this(x),x.d?x.d[0]?x.s:0*x.s:x.s||NaN}function sin2(x){return new this(x).sin()}function sinh(x){return new this(x).sinh()}function sqrt(x){return new this(x).sqrt()}function sub(x,y){return new this(x).sub(y)}function sum2(){var i3=0,args=arguments,x=new this(args[i3]);external=!1;for(;x.s&&++i3<args.length;)x=x.plus(args[i3]);return external=!0,finalise(x,this.precision,this.rounding)}function tan2(x){return new this(x).tan()}function tanh(x){return new this(x).tanh()}function trunc(x){return finalise(x=new this(x),x.e+1,1)}P[Symbol.for("nodejs.util.inspect.custom")]=P.toString;P[Symbol.toStringTag]="Decimal";var Decimal=P.constructor=clone2(DEFAULTS);LN10=new Decimal(LN10);PI=new Decimal(PI);var decimal_default=Decimal;function calculateTotal(price,quantity){return new decimal_default(price).times(quantity).toFixed(2)}function formatFloatToFixed(value){return new decimal_default(value).toFixed(2)}var subscriptionLimits={Trial:50,Msingi:50,Lite:300,Business:1/0,Pro:1500,AI:1/0};var prodCheck=async({shopId})=>{let[productsResult,subscriptionResult]=await Promise.all([mainDb.select({total:count()}).from(products).where(eq(products.shopId,shopId)),mainDb.select({subscrib:shops.subscription,trialEnd:shops.trialEnd}).from(shops).where(eq(shops.id,shopId))]),prodCount=productsResult[0]?.total,shopSubscription=subscriptionResult[0]?.subscrib||"Trial",trialEnd=subscriptionResult[0]?.trialEnd,limit=subscriptionLimits[shopSubscription];if(prodCount>limit)return{success:!1,message:`Aina za bidhaa ulizosajili zimetosha, ongeza kifurushi cha juu kufungua aina zaidi ya ${limit}`};return{success:!0,data:{shopSubscription,trialEnd},message:`Umesajili bidhaa ${prodCount} kati ya ${limit}`}},serviceAccessRules={customers:{minLevel:"Lite",message:"Huwezi kuchagua wateja, chagua kifurushi cha Lite au zaidi"},prdFreqCheck:{minLevel:"Business",message:"Ukaguzi wa mara kwa mara unahitaji kifurushi cha Business au juu"},assistant:{minLevel:"Lite",message:"Kusajili msaidizi au mfanyakazi, chagua kifurushi cha Lite au zaidi"},exportCSV:{minLevel:"Lite",message:"Kuhamisha Taarifa kunahitaji kifurushi cha Lite au juu"}},subscriptionHierarchy={Msingi:0,Lite:1,Business:2,Pro:3,AI:4,Trial:1},checkServiceAccess=async({shopId,service})=>{let[shop]=await mainDb.select({subscription:shops.subscription}).from(shops).where(eq(shops.id,shopId));if(!shop)return{success:!1,message:"Duka halijapatikana"};let currentSubscription=shop.subscription,requiredLevel=serviceAccessRules[service].minLevel;if(subscriptionHierarchy[currentSubscription]<subscriptionHierarchy[requiredLevel])return{success:!1,message:serviceAccessRules[service].message};return{success:!0,message:"done!"}};var prodPost=async({body,headers,shopId,userId,supplierId,categoryId})=>{try{let{name,priceBought,priceSold,stock,minStock,unit}=body;name=sanitizeString(name),priceBought=sanitizeNumber(priceBought),priceSold=sanitizeNumber(priceSold),stock=sanitizeNumber(stock),minStock=sanitizeNumber(minStock),unit=sanitizeString(unit);let prdResult=await prodCheck({shopId});if(!prdResult.success)return{success:!1,message:prdResult.message};let[insertedProduct]=await mainDb.insert(products).values({name,categoryId,priceSold:formatFloatToFixed(priceSold),stock,supplierId,shopId,minStock,unit}).returning({id:products.id}),productId=insertedProduct.id;if(!insertedProduct||!insertedProduct.id)return{success:!1,message:"Hakuna bidhaa kwa jina hili"};return await mainDb.insert(purchases).values({supplierId,productId,shopId,quantity:stock,priceBought:formatFloatToFixed(priceBought),totalCost:calculateTotal(String(priceBought),stock)}),await mainDb.insert(supplierPriceHistory).values({supplierId,productId,shopId,price:formatFloatToFixed(priceBought)}),{success:!0,data:{name,priceBought,priceSold,stock,minStock,shopId,userId,categoryId,supplierId,unit},message:"Umefanikiwa kusajili bidhaa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},prodGet=async({userId,shopId,query,set:set2,headers})=>{let page=parseInt(query.page||"1"),limit=parseInt(query.limit||"10"),search=query.search||"",offset=(page-1)*limit,where=and(eq(products.shopId,shopId),search?ilike(products.name,`%${search}%`):void 0);try{let latestPurchase=mainDb.select({productId:purchases.productId,priceBought:purchases.priceBought,rowNumber:sql`ROW_NUMBER() OVER (PARTITION BY ${purchases.productId} ORDER BY ${purchases.createdAt} DESC)`}).from(purchases).where(eq(purchases.shopId,shopId)).as("latestPurchase"),latestOnly=mainDb.select({productId:latestPurchase.productId,priceBought:latestPurchase.priceBought}).from(latestPurchase).where(sql`row_number = 1`).as("latestOnly"),total=await mainDb.select({count:sql`count(*)`}).from(products).where(where).then((rows2)=>Number(rows2[0].count)),rows=await mainDb.select({id:products.id,name:products.name,categoryId:products.categoryId,priceSold:products.priceSold,stock:products.stock,shopId:products.shopId,supplierId:products.supplierId,minStock:products.minStock,status:products.status,unit:products.unit,createdAt:products.createdAt,updatedAt:products.updatedAt,isQRCode:products.isQRCode,priceBought:latestOnly.priceBought}).from(products).where(where).leftJoin(latestOnly,eq(products.id,latestOnly.productId)).orderBy(desc(products.createdAt)).limit(limit).offset(offset);if(rows.length===0)return set2.status=204,{success:!1,data:[],total};return set2.status=200,{success:!0,data:rows.map((row)=>({...row,priceSold:Number(row.priceSold),priceBought:row.priceBought!==null?Number(row.priceBought):null})),total}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},prodDel=async({userId,shopId,productId,headers})=>{try{if(!await mainDb.select().from(products).where(and(eq(products.id,productId),eq(products.shopId,shopId))).then((rows)=>rows[0]))return{success:!1,message:"Hakuna bidhaa kwa jina hili"};return await mainDb.delete(products).where(eq(products.id,productId)),{success:!0,message:"Bidhaa imeondolewa kwa mafanikio"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},prodUpdate=async({userId,shopId,productId,body,headers})=>{try{let{name,priceBought,priceSold,stock,minStock,unit}=body;if(name=sanitizeString(name),priceBought=sanitizeNumber(priceBought),priceSold=sanitizeNumber(priceSold),stock=sanitizeNumber(stock),minStock=sanitizeNumber(minStock),unit=sanitizeString(unit),!await mainDb.select().from(products).where(and(eq(products.id,productId),eq(products.shopId,shopId))).then((rows)=>rows[0]))return{success:!1,message:"Hakuna bidhaa kwa jina hili"};let sanitizedStock=Math.max(0,stock);await mainDb.update(products).set({name,stock:sanitizedStock,minStock,unit,status:sanitizedStock<=0?"finished":"available",priceSold:formatFloatToFixed(priceSold),updatedAt:new Date,isQRCode:!1}).where(eq(products.id,productId)),await mainDb.update(purchases).set({quantity:sanitizedStock,priceBought:formatFloatToFixed(priceBought),totalCost:calculateTotal(String(priceBought),sanitizedStock)}).where(eq(purchases.productId,productId)),await mainDb.update(supplierPriceHistory).set({price:formatFloatToFixed(priceBought)}).where(eq(supplierPriceHistory.productId,productId)),await mainDb.update(products).set({isQRCode:!1}).where(eq(products.id,productId));let updatedProduct=await mainDb.select({id:products.id,name:products.name,stock:products.stock,minStock:products.minStock,unit:products.unit,status:products.status,priceSold:products.priceSold,isQRCode:products.isQRCode,updatedAt:products.updatedAt,priceBought:purchases.priceBought}).from(products).leftJoin(purchases,eq(products.id,purchases.productId)).where(eq(products.id,productId)).limit(1).then((rows)=>rows[0]);if(!updatedProduct)throw new Error("Hakuna bidhaa kwa jina hili");return{success:!0,data:updatedProduct,message:"Umefanikiwa ku-update bidhaa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},QrPost=async({body,headers,userId,shopId})=>{try{let{calculatedTotal,quantity,saleType,discount,description,typeDetected,productId,priceSold,priceBought,supplierId,customerId}=body;switch(saleType=sanitizeString(saleType),calculatedTotal=sanitizeNumber(calculatedTotal),quantity=sanitizeNumber(quantity),discount=sanitizeNumber(discount),typeDetected=sanitizeString(typeDetected),description=sanitizeString(description),productId=sanitizeString(productId),priceSold=sanitizeNumber(priceSold),priceBought=sanitizeNumber(priceBought),supplierId=sanitizeString(supplierId),customerId=sanitizeString(customerId),typeDetected){case"expenses":return await mainDb.insert(expenses).values({description,amount:formatFloatToFixed(calculatedTotal),shopId}),{success:!0,message:"Matumizi yamehifadhiwa kikamilifu"};case"sales":{let current=await mainDb.select({stock:products.stock}).from(products).where(eq(products.id,productId)).then((res)=>res[0]);if(!current||current.stock<quantity)return{success:!1,message:"Bidhaa haina stock ya kutosha"};if(await mainDb.update(products).set({stock:sql`${products.stock} - ${quantity}`}).where(eq(products.id,productId)),current.stock-quantity<=0)await mainDb.update(products).set({status:"finished"}).where(eq(products.id,productId));if(saleType==="cash")await mainDb.insert(sales).values({productId,quantity,priceSold:formatFloatToFixed(priceSold),totalSales:formatFloatToFixed(calculatedTotal),discount,shopId,saleType:"cash",customerId:null});else await mainDb.insert(debts).values({customerId,productId,quantity,priceSold:formatFloatToFixed(priceSold),totalSales:formatFloatToFixed(calculatedTotal),totalAmount:formatFloatToFixed(calculatedTotal),remainingAmount:formatFloatToFixed(calculatedTotal),shopId});return{success:!0,message:"Mauzo yamehifadhiwa kiukamilifu"}}case"purchases":return await mainDb.update(products).set({stock:sql`${products.stock} + ${quantity}`}).where(eq(products.id,productId)),await mainDb.insert(purchases).values({productId,supplierId,shopId,quantity,priceBought:formatFloatToFixed(priceBought),totalCost:formatFloatToFixed(calculatedTotal)}),{success:!0,message:"Manunuzi yamehifadhiwa kiukamilifu"};default:return{success:!1,message:"Aina ya muamala haijatambuliwa"}}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}};var JWT_SECRET5=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",prodPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET5})).get("/products",async({jwt:jwt2,cookie:cookie2,headers,query})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await prodGet({userId,shopId,headers,query,set:{status:200}})}).post("/products",async({jwt:jwt2,cookie:cookie2,body,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;if(!body.categoryId||!body.supplierId)return{success:!1,message:"Category Id and supplier Id zinatakiwa"};let result=await blockUsage({shopId});if(!result?.success)return{success:!1,message:result?.message||"Huduma haijalipiwa"};return await prodPost({body,userId,shopId,headers,categoryId:body.categoryId||"",supplierId:body.supplierId||""})},{body:prodData}).delete("/products/:id",async({jwt:jwt2,cookie:cookie2,set:set2,params,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let productId=params.id;if(!productId)return set2.status=400,{success:!1,message:"Product ID is required."};return await prodDel({userId,shopId,headers,productId})}).put("/products/:id",async({jwt:jwt2,cookie:cookie2,set:set2,params,body,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let productId=params.id;if(!productId)return set2.status=400,{success:!1,message:"Product ID is required."};return await prodUpdate({body,userId,shopId,headers,productId})},{body:prodUpdateValidation}).post("/get-data",async({jwt:jwt2,cookie:cookie2,body,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let result=await blockUsage({shopId});if(!result.success)return{success:!1,message:result.message||"Huduma haijalipiwa"};return await QrPost({body,userId,shopId,headers})},{body:QrPostData});var JWT_SECRET6=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",automateTasks=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET6})).get("/scan-qrcode",async({query})=>{try{let{priceSold,shopId,productId,userId,quantity,saleType,discount,customerId,description,amount,supplierId,priceBought}=query,parsedQuantity=Number(quantity),parsedPriceSold=Number(priceSold),parsedPriceBought=Number(priceBought||0),parsedDiscount=Number(discount||0);if(isNaN(parsedQuantity)||parsedQuantity<=0)throw new Error("Invalid quantity");if(isNaN(parsedPriceSold)||parsedPriceSold<=0)throw new Error("Invalid priceSold");switch(saleType.trim().toLowerCase()){case"cash":await mainDb.insert(sales).values({productId,quantity:parsedQuantity,discount:parsedDiscount,shopId,priceSold:formatFloatToFixed(parsedPriceSold),totalSales:calculateTotal(String(parsedPriceSold),parsedQuantity),saleType,customerId}),await mainDb.update(products).set({stock:sql`GREATEST(${products.stock} - ${parsedQuantity}, 0)`}).where(eq(products.id,productId));break;case"debt":if(!customerId)return{success:!1,message:"ID ya mteja lazima iwepo!"};let[{id:debtId}]=await mainDb.insert(debts).values({customerId,totalAmount:sql`${parsedQuantity} * ${parsedPriceSold}`,remainingAmount:sql`${parsedQuantity} * ${parsedPriceSold}`,shopId}).returning({id:debts.id});await mainDb.insert(sales).values({productId,quantity:parsedQuantity,discount:parsedDiscount,shopId,priceSold:formatFloatToFixed(parsedPriceSold),totalSales:sql`${parsedQuantity} * ${parsedPriceSold}`,saleType:"debt",customerId});break;case"purchases":if(!supplierId||!parsedPriceBought)return{success:!1,message:"ID ya supplier na bei ya kununua ni lazima"};await mainDb.insert(purchases).values({productId,supplierId,shopId,quantity:parsedQuantity,priceBought:formatFloatToFixed(parsedPriceBought),totalCost:sql`${parsedPriceBought} * ${parsedQuantity}`}),await mainDb.update(products).set({stock:sql`${products.stock} + ${parsedQuantity}`}).where(eq(products.id,productId));break;default:throw new Error(`Invalid saleType provided: "${saleType}"`)}return{success:!0,message:"Success"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Seva imeshindwa kutoa majibu ya scan-QRCode"}}}),autoSales_default=automateTasks;var import_nodemailer2=__toESM(require_nodemailer(),1),import_config2=__toESM(require_config(),1);var zohoEmail="huduma@mypostech.store",transporter=import_nodemailer2.default.createTransport({host:"smtp.zoho.com",port:465,secure:!0,auth:{user:zohoEmail,pass:process.env.ZOHO_APP_PASSWORD}}),mailPlugin=new Elysia;mailPlugin.post("/sendMail",async({body})=>{try{let{name,email,message:message2}=body;if(name=sanitizeString(name),email=sanitizeString(email),message2=sanitizeString(message2),!name||!email||!message2)return new Response(JSON.stringify({success:!1,message:"Sehemu zote zinahitajika"}),{status:400});return await transporter.sendMail({from:`"${name}" <${zohoEmail}>`,to:process.env.TO_EMAIL,subject:"myPosTech message",html:`
            <!DOCTYPE html>
            <html lang="sw">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Contact Form Submission</title>
            </head>
            <body>
                <div style="font-family: Arial, sans-serif; font-size: 14px; color: #333333; line-height: 1.6; padding: 20px; background-color: #f4f4f4;">
                    <h2 style="color: #0056b3; font-size: 18px; margin-bottom: 20px;">New Contact Form Submission</h2>
                    <p style="margin: 0 0 10px 0;">
                        <strong style="font-weight: bold; color: #555555;">Name:</strong> <span style="font-weight: normal;">${name}</span>
                    </p>
                    <p style="margin: 0 0 10px 0;">
                        <strong style="font-weight: bold; color: #555555;">Email:</strong> <span style="font-weight: normal; color: #007bff;"><a href="mailto:${email}" style="color: #007bff; text-decoration: none;">${email}</a></span>
                    </p>
                    <p style="margin: 0 0 10px 0;">
                        <strong style="font-weight: bold; color: #555555;">Message:</strong>
                    </p>
                    <p style="margin: 0 0 10px 0; padding: 10px; border: 1px solid #dddddd; background-color: #ffffff;">
                        ${message2}
                    </p>
                    <p style="font-size: 12px; color: #888888; margin-top: 20px;">
                        This email was sent from your website's contact form.
                    </p>
                </div>
            </body>
            </html>
            `}),new Response(JSON.stringify({success:!0,message:"Ujumbe wako umetumwa kiukamilifu!"}),{status:200})}catch(error3){return console.error("Email Error:",error3),new Response(JSON.stringify({success:!1,error:"Imeshindwa kutuma barua pepe"}),{status:500})}},{body:emailData});var customerPost=async({body,userId,shopId,headers})=>{let{name,contact}=body;if(name=sanitizeString(name.trim().toLowerCase()),contact=sanitizeString(contact.trim().toLowerCase()),(await mainDb.select().from(customers).where(eq(customers.name,name))).length>0)return{success:!1,message:"Mteja huyu tayari yupo"};return{success:!0,message:"Umefanikiwa kuingiza mteja",data:(await mainDb.insert(customers).values({name,contact,shopId}).returning())[0]}},customerGet=async({userId,shopId,headers,query})=>{let page=parseInt(query.page||"1"),limit=parseInt(query.limit||"10"),search=query.search||"",offset=(page-1)*limit;try{let where=and(eq(customers.shopId,shopId),search?ilike(customers.name,`%${search}%`):void 0),total=await mainDb.select({count:sql`count(*)`}).from(customers).where(where||void 0).then((rows)=>Number(rows[0].count)),existingCustomer=await mainDb.select().from(customers).where(where).orderBy(customers.createdAt).limit(limit).offset(offset);if(existingCustomer.length===0)return{success:!1,message:"Hakuna mteja aliyeingizwa",data:[],total};return{success:!0,message:"Umefanikiwa kupata taarifa",data:existingCustomer,total,page,limit,pages:Math.ceil(total/limit)}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},customerFetch=async({userId,shopId,headers})=>{try{let existingCustomer=await mainDb.select().from(customers).where(eq(customers.shopId,shopId));if(existingCustomer.length===0)return{success:!1,message:"Hakuna mteja aliyeingizwa",data:[]};return{success:!0,data:existingCustomer}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},CustomerDel=async({userId,shopId,customerId,headers})=>{try{if(!await mainDb.select().from(customers).where(eq(customers.id,customerId)).then((rows)=>rows[0]))return{success:!1,message:"Hakuna bidhaa kwa jina hili"};return await mainDb.delete(customers).where(eq(customers.id,customerId)),{success:!0,message:"Mteja ameondolewa kwa mafanikio"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}},customerUpdate=async({userId,shopId,customerId,body,headers})=>{try{let{name,contact}=body;if(name=sanitizeString(name),contact=sanitizeString(contact),!await mainDb.select().from(customers).where(eq(customers.id,customerId)).then((rows)=>rows[0]))return{success:!1,message:"Hakuna mteja kwa jina hili"};return{success:!0,data:await mainDb.update(customers).set({name,contact}).where(eq(customers.id,customerId)),message:"Umefanikiwa ku-update taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:sanitizeString("Hitilafu imetokea kwenye seva")}}};var JWT_SECRET7=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",CustomersPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET7})).get("/customers",async({jwt:jwt2,cookie:cookie2,headers,query})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await customerGet({userId,shopId,headers,query})}).get("/getCustomers",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let customerCheck=await checkServiceAccess({shopId,service:"customers"});if(!customerCheck.success)return{success:!1,message:customerCheck.message};return await customerFetch({userId,shopId,headers})}).post("/customers",async({jwt:jwt2,cookie:cookie2,body,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let result=await blockUsage({shopId});if(!result?.success)return{success:!1,message:result?.message||"Huduma haijalipiwa"};return await customerPost({body,userId,shopId,headers})},{body:customerData}).delete("/customers/:id",async({jwt:jwt2,cookie:cookie2,set:set2,params,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let customerId=params.id;if(!customerId)return set2.status=400,{success:!1,message:"Mteja anahitajika."};return await CustomerDel({userId,shopId,headers,customerId})}).put("/customers/:id",async({jwt:jwt2,cookie:cookie2,set:set2,params,body,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let customerId=params.id;if(!customerId)return set2.status=400,{success:!1,message:"Mteja anahitajika."};return await customerUpdate({body,userId,shopId,headers,customerId})},{body:customerData});var getAnalytics=async({userId,shopId})=>{try{let[profitData,lowestStockProductResult,lowStockProductsResult,mostSoldByQuantityProductResult,debtorData,weeklySummaryData]=await Promise.all([mainDb.execute(sql`
            SELECT
                p.id AS productId,
                p.name AS productName,
                COALESCE(s.totalSales, 0) AS totalSales,
                COALESCE(pur.totalCost, 0) AS totalCost,
                COALESCE(s.totalSales, 0) - COALESCE(pur.totalCost, 0) AS profit
            FROM products p
            LEFT JOIN (
                SELECT product_id, SUM(quantity * price_sold) AS totalSales
                FROM sales
                WHERE shop_id = ${shopId}
                GROUP BY product_id
            ) s ON s.product_id = p.id
            LEFT JOIN (
                SELECT product_id, SUM(quantity * price_bought) AS totalCost
                FROM purchases
                WHERE shop_id = ${shopId}
                GROUP BY product_id
            ) pur ON pur.product_id = p.id
            WHERE p.shop_id = ${shopId}
            ORDER BY profit DESC
        `),mainDb.select().from(products).where(and(eq(products.shopId,shopId),lte(products.stock,products.minStock))).orderBy(asc(products.stock)).limit(1),mainDb.select().from(products).where(and(eq(products.shopId,shopId),lte(products.stock,products.minStock))).orderBy(asc(products.stock)),mainDb.execute(sql`
                SELECT
                    p.id AS productId,
                    p.name AS productName,
                    p.unit AS unit,
                    SUM(s.quantity) AS totalQuantitySold,
                    COUNT(*) AS timesSold
                FROM sales s
                INNER JOIN products p ON s.product_id = p.id
                WHERE s.shop_id = ${shopId}
                GROUP BY p.id, p.name, p.unit
                ORDER BY totalQuantitySold DESC
                LIMIT 1
            `),Promise.all([mainDb.select({debtId:debts.id,customerId:debts.customerId,remainingAmount:debts.remainingAmount,createdAt:debts.createdAt,name:customers.name}).from(debts).where(eq(debts.shopId,shopId)).innerJoin(customers,eq(customers.id,debts.customerId)).orderBy(asc(debts.createdAt)).limit(1),mainDb.select({debtId:debts.id,customerId:debts.customerId,remainingAmount:debts.remainingAmount,createdAt:debts.createdAt,name:customers.name}).from(debts).where(eq(debts.shopId,shopId)).innerJoin(customers,eq(customers.id,debts.customerId)).orderBy(desc(debts.remainingAmount)).limit(1)]),mainDb.execute(sql`
                WITH sales_data AS (
                    SELECT
                        TO_CHAR(created_at, 'Dy') AS day,
                        SUM(total_sales) AS daily_sales
                    FROM sales
                    WHERE shop_id = ${shopId} AND created_at >= NOW() - INTERVAL '7 days'
                    GROUP BY 1
                ),
                expenses_data AS (
                    SELECT
                        TO_CHAR(date, 'Dy') AS day,
                        SUM(amount) AS daily_expenses
                    FROM expenses
                    WHERE shop_id = ${shopId} AND date >= NOW() - INTERVAL '7 days'
                    GROUP BY 1
                ),
                purchases_data AS (
                    SELECT
                        TO_CHAR(created_at, 'Dy') AS day,
                        SUM(quantity * price_bought) AS daily_purchases
                    FROM purchases
                    WHERE shop_id = ${shopId} AND created_at >= NOW() - INTERVAL '7 days'
                    GROUP BY 1
                )
                SELECT
                    COALESCE(sd.day, ed.day, pd.day) AS day,
                    COALESCE(sd.daily_sales, 0) AS sales,
                    COALESCE(ed.daily_expenses, 0) AS expenses,
                    COALESCE(pd.daily_purchases, 0) AS purchases
                FROM sales_data sd
                FULL OUTER JOIN expenses_data ed ON sd.day = ed.day
                FULL OUTER JOIN purchases_data pd ON COALESCE(sd.day, ed.day) = pd.day
                ORDER BY
                    CASE COALESCE(sd.day, ed.day, pd.day)
                        WHEN 'Mon' THEN 1
                        WHEN 'Tue' THEN 2
                        WHEN 'Wed' THEN 3
                        WHEN 'Thu' THEN 4
                        WHEN 'Fri' THEN 5
                        WHEN 'Sat' THEN 6
                        WHEN 'Sun' THEN 7
                    END
            `)]),profitPerProduct=profitData||[],highestProfitProduct=profitPerProduct[0]||null,totalProfitFromProducts=profitPerProduct.reduce((sum3,item)=>{return sum3+Number(item.profit||0)},0),totalSalesFromProducts=profitPerProduct.reduce((sum3,item)=>{return sum3+Number(item.totalsales||0)},0),totalPurchasesFromProducts=profitPerProduct.reduce((sum3,item)=>{return sum3+Number(item.totalcost||0)},0),expenseResult=await mainDb.execute(sql`
            SELECT COALESCE(SUM(e.amount), 0) AS totalExpenses
            FROM expenses e
            WHERE e.shop_id = ${shopId}
        `),totalExpenses=Number(expenseResult?.[0]?.totalexpenses||0),netProfit={totalExpenses,totalSales:totalSalesFromProducts,totalPurchases:totalPurchasesFromProducts,netProfit:totalProfitFromProducts-totalExpenses},lowestProduct=lowestStockProductResult[0]||null,lowStockProducts=lowStockProductsResult||[],mostSoldProductByQuantity=mostSoldByQuantityProductResult?.[0]?{...mostSoldByQuantityProductResult[0],timesSold:Number(mostSoldByQuantityProductResult[0].timessold||0),unit:mostSoldByQuantityProductResult[0].unit||"kipimo"}:null,[longTermDebtUserArray,mostDebtUserArray]=debtorData,longTermDebtUser=longTermDebtUserArray[0]||null,mostDebtUser=mostDebtUserArray[0]||null,daysSinceDebt="Haijulikani";if(longTermDebtUser?.createdAt){let rawDate=new Date(longTermDebtUser.createdAt);rawDate.setHours(rawDate.getHours()-3),daysSinceDebt=formatDistanceToNow(rawDate,{addSuffix:!0})}let salesByDay=[],expensesByDay=[],purchasesPerDay=[],netSalesByDay=[],weekDaysOrder=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],dailyDataMap=new Map;weekDaysOrder.forEach((day)=>dailyDataMap.set(day,{sales:0,expenses:0,purchases:0}));for(let row of weeklySummaryData){let day=row.day;if(dailyDataMap.has(day))dailyDataMap.get(day).sales=Number(row.sales||0),dailyDataMap.get(day).expenses=Number(row.expenses||0),dailyDataMap.get(day).purchases=Number(row.purchases||0)}for(let[day,data]of dailyDataMap.entries()){salesByDay.push({day,sales:data.sales}),expensesByDay.push({day,expenses:data.expenses}),purchasesPerDay.push({day,purchases:data.purchases});let netSales=data.sales-data.expenses-data.purchases;netSalesByDay.push({day,netSales})}let result=await prodCheck({shopId}),trialData=result.data?.trialEnd?.toString();if(!trialData)return;let trialEnd=timeRemainingUntil(trialData);return{success:!0,data:[{profitPerProduct,highestProfitProduct,netProfit,lowestProduct,lowStockProducts,mostSoldProductByQuantity,longTermDebtUser,mostDebtUser,daysSinceDebt,salesByDay,expensesByDay,netSalesByDay,purchasesPerDay,prodMessage:result.message,subscription:result.data?.shopSubscription,trialEnd}]}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},salesAnalytics=async({userId,shopId,query})=>{try{let{search="",date:date3="Leo",from="",to="",page="1",limit="10"}=query,pageNum=parseInt(page)||1,perPage=parseInt(limit)||10,offset=(pageNum-1)*perPage,filters=[];filters.push(eq(sales.shopId,shopId));let searchTrimmed=search.trim();if(searchTrimmed)filters.push(or(ilike(customers.name,`%${searchTrimmed}%`),ilike(products.name,`%${searchTrimmed}%`)));if(date3&&date3!=="Tarehe_maalumu"){let today=new Date;today.setHours(today.getHours()+3);let start,end;switch(date3){case"Leo":start=new Date(today.toDateString()),end=new Date(start),end.setDate(end.getDate()+1);break;case"Wiki_hii":start=new Date(today),start.setDate(start.getDate()-7),end=today;break;case"Mwezi_huu":start=new Date(today.getFullYear(),today.getMonth(),1),end=today;break;case"Jana":start=new Date(today),start.setDate(today.getDate()-1),end=new Date(start),end.setDate(end.getDate()+1);break;default:start=end=today}filters.push(and(gte(sales.createdAt,start),lte(sales.createdAt,end)))}if(date3==="Tarehe_maalumu"&&from&&to)filters.push(and(gte(sales.createdAt,new Date(from)),lte(sales.createdAt,new Date(to))));let whereClause=filters.length?and(...filters):void 0,total=(await mainDb.select({count:sql`COUNT(*)`}).from(sales).leftJoin(customers,eq(sales.customerId,customers.id)).leftJoin(products,eq(sales.productId,products.id)).where(whereClause))[0].count;return{success:!0,data:await mainDb.select({date:sales.createdAt,name:products.name,total:sales.totalSales,priceBought:purchases.priceBought,quantity:sales.quantity}).from(sales).leftJoin(customers,eq(sales.customerId,customers.id)).leftJoin(products,eq(sales.productId,products.id)).leftJoin(purchases,eq(sales.productId,purchases.productId)).where(whereClause).limit(perPage).offset(offset).orderBy(desc(sales.createdAt)),total}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}},exportSales=async({userId,shopId,set:set2})=>{try{let salesData=await mainDb.select({date:sales.createdAt,productName:products.name,total:sales.totalSales,priceBought:purchases.priceBought,quantity:sales.quantity}).from(sales).leftJoin(customers,eq(sales.customerId,customers.id)).leftJoin(products,eq(sales.productId,products.id)).leftJoin(purchases,eq(sales.productId,purchases.productId)).where(eq(sales.shopId,shopId)).orderBy(desc(sales.createdAt)),csvHeader=`Tarehe,Jina la Bidhaa,Jumla,Faida,Idadi
`,csvContent=`Tarehe,Jina la Bidhaa,Jumla,Faida,Idadi
`+salesData.map((row)=>{let dateObj=new Date(row.date),formattedDate=`${String(dateObj.getDate()).padStart(2,"0")}/${String(dateObj.getMonth()+1).padStart(2,"0")}/${dateObj.getFullYear()} ${String(dateObj.getHours()).padStart(2,"0")}:${String(dateObj.getMinutes()).padStart(2,"0")}:${String(dateObj.getSeconds()).padStart(2,"0")}`,profit=Number(row.total)-Number(row.priceBought)*row.quantity;return`${formattedDate},"${row.productName}",${row.total},${profit},"${row.quantity}"`}).join(`
`);return set2.headers={"Content-Type":"text/csv","Content-Disposition":'attachment; filename="Mauzo.csv"'},new Response(csvContent)}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}},graphFunc=async({shopId,userId})=>{try{let weekDaysOrder=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],stocksByDay=await mainDb.select({day:sql`TO_CHAR(${products.createdAt}, 'Dy')`.as("day_of_week"),totalStock:sql`SUM(${products.stock})`.as("total_stock")}).from(products).where(eq(products.shopId,shopId)).groupBy(sql`day_of_week`).orderBy(sql`day_of_week`),stocksByDayMap=new Map;weekDaysOrder.forEach((day)=>stocksByDayMap.set(day,0));for(let row of stocksByDay){let day=row.day;if(stocksByDayMap.has(day))stocksByDayMap.set(day,Number(row.totalStock||0))}let dailyStockTrend=Array.from(stocksByDayMap).map(([day,totalStock])=>({day,totalStock})),DebtsByCustomer=await mainDb.select({customerName:customers.name,totalDebts:sql`SUM(${debts.remainingAmount})`.as("total_debts")}).from(debts).innerJoin(customers,eq(debts.customerId,customers.id)).where(eq(debts.shopId,shopId)).groupBy(customers.name).orderBy(sql`total_debts DESC`),cashDebtData=await mainDb.select({type:sales.saleType,amount:sql`SUM(${sales.priceSold} * ${sales.quantity})`.as("amount")}).from(sales).where(eq(sales.shopId,shopId)).groupBy(sales.saleType);return{success:!0,data:[{stockTrend:dailyStockTrend,DebtsByCustomer,cashDebtData}],message:"Taarifa za mauzo zimepatikana kwa mafanikio"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}};var JWT_SECRET8=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",analyticsRoute=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET8})).get("/analytics",async({jwt:jwt2,cookie:cookie2})=>{let t0=Date.now(),{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let result=await getAnalytics({userId,shopId});return console.log(`analytics get takes ${Date.now()-t0} ms`),result}).get("/sales",async({jwt:jwt2,cookie:cookie2,query})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await salesAnalytics({userId,shopId,query})},{query:salesQueryData}).get("/export-sales",async({jwt:jwt2,cookie:cookie2,set:set2})=>{let{shopId,userId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let serviceResult=await checkServiceAccess({shopId,service:"exportCSV"});if(!serviceResult.success)return{success:!1,message:serviceResult.message};return await exportSales({shopId,userId,set:set2})}).get("/graph",async({jwt:jwt2,cookie:cookie2})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await graphFunc({userId,shopId})}),analytics_default=analyticsRoute;var JWT_SECRET9=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",authPlugin=new Elysia().use(dist_default()).use(index_default({name:"jwt",secret:JWT_SECRET9})).post("/verify-cookie",async({jwt:jwt2,body,headers})=>{try{let token=body.token,decoded=await jwt2.verify(token);if(!isDecodedToken(decoded))return{success:!1,message:"Huna ruhusa! - Token sio sahihi"};return{success:!0,message:"Umefanikiwa kukaguliwa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},{body:authToken}).get("/delete-cookie",async({headers,cookie:cookie2})=>{try{return cookie2.auth_token.set({value:"",httpOnly:!0,secure:!1,sameSite:"lax",maxAge:0,path:"/",domain:void 0}),{success:!0,message:"umefanikiwa kutoka"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}}).get("/me",async({jwt:jwt2,cookie:cookie2,headers})=>{try{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!userId)return;let username=(await mainDb.select({username:users.username}).from(users).where(eq(users.id,userId)))[0].username;return cookie2.username.set({value:username,httpOnly:!0,secure:!1,sameSite:"lax",maxAge:604800,path:"/",domain:void 0}),{success:!0,data:[{username}],message:"successful"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}});var shopSettingsFunc=async({shopId,userId,headers})=>{try{let fetchShop=await mainDb.select({shopName:shops.name}).from(shops).where(eq(shops.id,shopId)),fetchEmail=await mainDb.select({email:users.email}).from(users).where(eq(users.id,userId));if(fetchShop.length===0||fetchEmail.length===0)return{success:!1,message:"Hakuna kilichopatikana"};return{success:!0,data:[{shopName:fetchShop[0],email:fetchEmail[0]}],message:"Umefanikiwa kupata taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}},shopSettingsPut=async({shopId,userId,headers,body})=>{try{let{email,shopName}=body;return email=sanitizeString(email),shopName=sanitizeString(shopName),await mainDb.update(users).set({email}).where(eq(users.id,userId)),await mainDb.update(shops).set({name:shopName}).where(eq(shops.id,shopId)),{success:!0,message:"Umefanikiwa kubadili taarifa zako kiukamilifu"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}},updatePassword=async({shopId,userId,headers,body})=>{try{let{currentPassword,newPassword}=body;currentPassword=sanitizeString(currentPassword),newPassword=sanitizeString(newPassword);let fetchedPswd=(await mainDb.select({pswd:users.password}).from(users).where(eq(users.id,userId)))[0].pswd;if(!await verifyPassword(fetchedPswd,currentPassword))return{success:!1,message:"Nenosiri la zamani sio sahihi, jaribu tena"};let hashedNewPassword=await hashPassword(newPassword);return await mainDb.update(users).set({password:hashedNewPassword}).where(eq(users.id,userId)).returning(),{success:!0,message:"Umefanikiwa kubadili nenosiri, tafadhali itunze"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}},deleteShop=async({shopId,userId,cookie:cookie2})=>{try{if((await mainDb.select({role:users.role}).from(users).where(eq(users.id,userId)))[0].role!=="owner")return{success:!1,message:"Hauna mamlaka ya kufuta duka"};let tables=[askedProducts,supplierPriceHistory,debtPayments,debts,sales,purchases,returns,expenses,products,suppliers,customers,categories];return await mainDb.transaction(async(tx)=>{for(let table of tables)await tx.delete(table).where(eq(table.shopId,shopId))}),cookie2.auth_token.set({value:"",httpOnly:!0,secure:!1,sameSite:"lax",maxAge:0,path:"/",domain:void 0}),cookie2.username.set({value:"",httpOnly:!0,secure:!1,sameSite:"lax",maxAge:0,path:"/",domain:void 0}),{success:!0,message:"Umefanikiwa kufuta duka"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}};var JWT_SECRET10=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",settingsPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET10})).get("/shop",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await shopSettingsFunc({shopId,userId,headers})}).put("/shop",async({jwt:jwt2,cookie:cookie2,headers,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await shopSettingsPut({shopId,userId,headers,body})},{body:shopPutData}).put("/update-password",async({jwt:jwt2,cookie:cookie2,headers,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await updatePassword({shopId,userId,headers,body})},{body:changePasswordData}).delete("/delete-shop",async({jwt:jwt2,cookie:cookie2})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await deleteShop({shopId,userId,cookie:cookie2})}),settings_default=settingsPlugin;import{randomBytes}from"crypto";var generateUsername=async(name)=>{let base=name.trim().split(" ")[0].toLowerCase().replace(/[^a-z0-9]/g,""),suffix=Math.floor(Math.random()*1000),newUser=`${base}_${suffix}`,attempts=0,maxAttempts=5;while(attempts<maxAttempts){if((await mainDb.select({usr:users.username}).from(users).where(eq(users.username,newUser))).length===0)return newUser;suffix=Math.floor(Math.random()*1000),newUser=`${base}_${suffix}`,attempts++}return`${base}_${Date.now()}`},generateShopName=async(name)=>{let base=name.trim().split(" ")[0].toLowerCase().replace(/[^a-z0-9]/g,""),suffix=Math.floor(Math.random()*1e4),newShop=`${base}'s Shop_${suffix}`,attempts=0,maxAttempts=5;while(attempts<maxAttempts){if((await mainDb.select({shop:shops.name}).from(shops).where(eq(shops.name,newShop))).length===0)return newShop;suffix=Math.floor(Math.random()*1e4),newShop=`${base}_${suffix}`,attempts++}return`${base}'s Shop_${Date.now()}`},createUser=async(anyName,type2)=>{try{let name=type2==="user"?await generateUsername(anyName):await generateShopName(anyName);if(typeof name!=="string")return{success:!1,message:"username sio string, haifai"};return{success:!0,data:name}}catch(err){return{success:!1,message:err instanceof Error?err.message:" \u274C Tatizo wakati wa kutengeneza username"}}};var GOOGLE_CLIENT_ID=process.env.GOOGLE_CLIENT_ID,GOOGLE_CLIENT_SECRET=process.env.GOOGLE_CLIENT_SECRET,backendURL=process.env.BACKEND_URL_DEV,frontendURL3=process.env.FRONTEND_URL_DEV,REDIRECT_URI=`${backendURL}/auth/google/callback`,JWT_SECRET11=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",googlePlugin=new Elysia().use(dist_default()).use(index_default({name:"jwt",secret:JWT_SECRET11})).get("/auth/google",()=>{let url=new URL("https://accounts.google.com/o/oauth2/v2/auth");return url.searchParams.set("client_id",GOOGLE_CLIENT_ID),url.searchParams.set("redirect_uri",REDIRECT_URI),url.searchParams.set("response_type","code"),url.searchParams.set("scope","email profile openid"),redirect(url.toString(),302)}).get("/auth/google/callback",async({query,headers,jwt:jwt2,cookie:{auth_token}})=>{let code=query.code,tokenRes=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code,client_id:GOOGLE_CLIENT_ID,client_secret:GOOGLE_CLIENT_SECRET,redirect_uri:REDIRECT_URI,grant_type:"authorization_code"})});try{let{access_token,id_token}=await tokenRes.json(),userInfo=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${access_token}`}}).then((res)=>res.json()),{email,name,picture,sub:googleId}=userInfo;if((await mainDb.select({email:users.email}).from(users).where(eq(users.email,email))).length===0){let generatePassword=()=>randomBytes(6).toString("base64").slice(0,7),generatePhone=()=>{return"255"+(()=>{let usedNumbers=new Set;return()=>{let num;do num=(Math.floor(Math.random()*9000000000)+1e9).toString();while(usedNumbers.has(num));return usedNumbers.add(num),num}})()()},password=generatePassword(),hashedPassword=await hashPassword(password),usernameRes=await createUser(name,"user"),shopNameRes=await createUser(name,"shop"),username=usernameRes.success?usernameRes.data:void 0,shopName=shopNameRes.success?shopNameRes.data:void 0;if(!username||!shopName)return;let phoneNumber=generatePhone(),user=await mainDb.insert(users).values({username,email,password:hashedPassword,phoneNumber}).returning({id:users.id,username:users.username}).then((res)=>res[0]);if(!user)return{success:!1,message:"Mtumiaji hayupo!"};let shop=await mainDb.insert(shops).values({name:shopName,trialStart:new Date(Date.now()),trialEnd:new Date(Date.now()+1209600000)}).returning({id:shops.id}).then((res)=>res[0]);if(!shop)return{success:!1,message:"Duka lililosajiliwa kwa ajili yako halipo!"};let credetials=await mainDb.insert(shopUsers).values({shopId:shop.id,userId:user.id,role:"owner"}).returning({userId:shopUsers.userId,shopId:shopUsers.shopId});if(credetials.length===0)return;let{userId,shopId}=credetials[0],jwtToken=await jwt2.sign({userId,shopId});if(!jwtToken)return{success:!1,message:"hakuna tokeni, hujaruhusiwa"};return auth_token.set({value:jwtToken,httpOnly:!0,secure:!1,sameSite:"lax",maxAge:604800,path:"/",domain:void 0}),redirect(`${frontendURL3}/private`,302)}else{let userId=(await mainDb.select({userId:users.id,username:users.username}).from(users).where(eq(users.email,email)))[0].userId,shopId=(await mainDb.select({shopId:shopUsers.shopId}).from(shopUsers).where(eq(shopUsers.userId,userId)))[0].shopId,jwtToken=await jwt2.sign({userId,shopId});if(!jwtToken)return{success:!1,message:"hakuna tokeni, hujaruhusiwa"};return auth_token.set({value:jwtToken,httpOnly:!0,secure:!1,sameSite:"lax",maxAge:604800,path:"/",domain:void 0}),redirect(`${frontendURL3}/private`,302)}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Google failed"}}}).post("/verify-captcha",async({body})=>{let token=body.token;if(!token)return{success:!1,message:"Tokeni ya reCAPTCHA haipo! jaribu tena"};try{let result=await(await fetch("https://www.google.com/recaptcha/api/siteverify",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({secret:process.env.GOOGLE_RECAPTCHA_SECRET_KEY,response:token}).toString()})).json();if(result.success)return{success:!0,message:"Success"};else return{success:!1,message:result["error-codes"]}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Imeshindwa kuhakiki reCAPTCHA!"}}}),google_default=googlePlugin;import{randomBytes as randomBytes2,createCipheriv,createDecipheriv}from"crypto";var createPayloadChecksum=async(checksumKey,payload)=>{let sortedPayload=Object.keys(payload).sort().reduce((acc,key)=>{return acc[key]=payload[key],acc},{}),payloadString=Object.values(sortedPayload).join(""),encoder3=new TextEncoder,keyData=encoder3.encode(checksumKey),data=encoder3.encode(payloadString),cryptoKey=await crypto.subtle.importKey("raw",keyData,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),signature=await crypto.subtle.sign("HMAC",cryptoKey,data);return Array.from(new Uint8Array(signature)).map((b2)=>b2.toString(16).padStart(2,"0")).join("")};var generateOrderRef=()=>{let timestamp2=Date.now().toString(36).toUpperCase(),random2=Math.random().toString(36).substring(2,8).toUpperCase();return`ORD${timestamp2}${random2}`},ENCRYPTION_KEY=process.env.CLICKPESA_ENCRYPT;if(!ENCRYPTION_KEY)throw new Error("encryption key is not available");var key=Buffer.from(ENCRYPTION_KEY,"base64"),encrypt=(data)=>{let iv=randomBytes2(12),cipher=createCipheriv("aes-256-gcm",key,iv),encrypted=Buffer.concat([cipher.update(data,"utf8"),cipher.final()]),authTag=cipher.getAuthTag();return Buffer.concat([iv,authTag,encrypted]).toString("base64")},decrypt=(encryptedData)=>{let buffer2=Buffer.from(encryptedData,"base64"),iv=buffer2.subarray(0,12),authTag=buffer2.subarray(12,28),encrypted=buffer2.subarray(28),decipher=createDecipheriv("aes-256-gcm",key,iv);return decipher.setAuthTag(authTag),Buffer.concat([decipher.update(encrypted),decipher.final()]).toString("utf8")};var clientID=process.env.CLICKPESA_CLIENT_ID,apiKey=process.env.CLICKPESA_API_KEY,genToken=async({userId,shopId,headers})=>{try{let result=await(await fetch("https://api.clickpesa.com/third-parties/generate-token",{method:"POST",headers:{"client-id":clientID,"api-key":apiKey}})).json().catch((err)=>{return{success:!1,message:err instanceof Error?err.message:"Seva ya malipo imefeli"}});if(!result.token||!result.success)return{success:!1,message:"API-key ya malipo imeisha muda au sio sahihi"};let clickpesaBearer=result.token,encryptedToken=encrypt(clickpesaBearer);return await mainDb.insert(paymentSaaS).values({token:encryptedToken,shopId}),{success:!0,message:"API-Key ipo sahihi, umepata tokeni ya malipo"}}catch(err){return{success:!1,message:err instanceof Error?err.message:"Hitilafu imetokea kwenye seva"}}},checkUSSD=async({userId,shopId,headers})=>{try{let value=(await mainDb.select({token:paymentSaaS.token}).from(paymentSaaS).where(eq(paymentSaaS.shopId,shopId)))[0].token,resultToken=decrypt(value),orderReference=generateOrderRef();await mainDb.update(paymentSaaS).set({orderId:orderReference}).where(eq(paymentSaaS.shopId,shopId));let checksumKey=process.env.CLICKPESA_CHECKSUMKEY;if(!checksumKey)return;let payload={amount:"10000",currency:"TZS",orderReference},checksum2=await createPayloadChecksum(checksumKey,payload),USSDpayload={...payload,checksum:checksum2},options2={method:"POST",headers:{Authorization:`${resultToken}`,"Content-Type":"application/json"},body:JSON.stringify(USSDpayload)};return{checkUSSDResult:await(await fetch("https://api.clickpesa.com/third-parties/payments/preview-ussd-push-request",options2)).json().catch((err)=>{return{success:!1,message:err instanceof Error?err.message:"Seva ya malipo imefeli"}})}}catch(err){return{success:!1,message:err instanceof Error?err.message:"Hitilafu imetokea kwenye seva"}}},USSDPush=async({userId,shopId,headers})=>{try{let value=(await mainDb.select({token:paymentSaaS.token}).from(paymentSaaS).where(eq(paymentSaaS.shopId,shopId)))[0].token,resultToken=decrypt(value),orderId=(await mainDb.select({orderId:paymentSaaS.orderId}).from(paymentSaaS).where(eq(paymentSaaS.shopId,shopId)))[0].orderId;if(!orderId)return{success:!1,message:"orderId haipo kwenye database"};let checksumKey=process.env.CLICKPESA_CHECKSUMKEY;if(!checksumKey)return;let payload={amount:"10000",currency:"TZS",orderReference:orderId},checksum2=await createPayloadChecksum(checksumKey,payload),phoneNumber=(await mainDb.select({phoneNumber:users.phoneNumber}).from(users).where(eq(users.id,userId)))[0].phoneNumber,USSDpayload={...payload,checksum:checksum2,phoneNumber},options={method:"POST",headers:{Authorization:`${resultToken}`,"Content-Type":"application/json"},body:JSON.stringify(USSDpayload)};return{ussdPush:await(await fetch("https://api.clickpesa.com/third-parties/payments/initiate-ussd-push-request",options)).json().catch((err)=>{return{success:!1,message:err instanceof Error?err.message:"Seva ya malipo imefeli"}})}}catch(err){return{success:!1,message:err instanceof Error?err.message:"Hitilafu imetokea kwenye seva"}}},PayStatus=async({userId,shopId,headers})=>{try{let value=(await mainDb.select({token:paymentSaaS.token}).from(paymentSaaS).where(eq(paymentSaaS.shopId,shopId)))[0].token,resultToken=decrypt(value),orderId=(await mainDb.select({orderId:paymentSaaS.orderId}).from(paymentSaaS).where(eq(paymentSaaS.shopId,shopId)))[0].orderId;if(!orderId)return;let options={method:"GET",headers:{Authorization:`${resultToken}`}};return{checkStatus:await(await fetch(`https://api.clickpesa.com/third-parties/payments/{${orderId}}`,options)).json().catch((err)=>{return{success:!1,message:err instanceof Error?err.message:"Seva ya malipo imefeli"}})}}catch(err){return{success:!1,message:err instanceof Error?err.message:"Hitilafu imetokea kwenye seva"}}};var JWT_SECRET12=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",paymentPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET12})).get("/mobile/generate-token",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!userId||!shopId)return{success:!1,message:"Imeshindwa ku extract tokeni, jaribu tena baadae"};return await genToken({userId,shopId,headers})}).get("/mobile/check-USSD",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!userId||!shopId)return{success:!1,message:"Imeshindwa ku extract tokeni, jaribu tena baadae"};return await checkUSSD({userId,shopId,headers})}).get("/mobile/USSD-push",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!userId||!shopId)return{success:!1,message:"Imeshindwa ku extract tokeni, jaribu tena baadae"};return await USSDPush({userId,shopId,headers})}).get("/mobile/payment-status",async({jwt:jwt2,cookie:cookie2,headers})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!userId||!shopId)return{success:!1,message:"Imeshindwa ku extract tokeni, jaribu tena baadae"};return await PayStatus({userId,shopId,headers})}),payment_default=paymentPlugin;var notifyCount=async({userId,shopId})=>{try{return{success:!0,data:[{count:(await mainDb.select({count:count()}).from(notifications).where(and(eq(notifications.isRead,!1),eq(notifications.shopId,shopId))))[0]?.count??0}],message:"Kuna message hazijasomwa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}};var JWT_SECRET13=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",notifyPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET13})).get("/notifyCount",async({jwt:jwt2,cookie:cookie2})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await notifyCount({userId,shopId})}),notifications_default=notifyPlugin;var expFunc=async({shopId,userId,page=1,limit=5})=>{try{let totalAmountResult=await mainDb.select({totalAmount:sql`SUM(${expenses.amount})`.as("total")}).from(expenses).where(eq(expenses.shopId,shopId)),totalAmount=Number(totalAmountResult[0]?.totalAmount??0),[{count:count2}]=await mainDb.select({count:sql`COUNT(*)`}).from(expenses).where(eq(expenses.shopId,shopId)),totalPages=Math.ceil((count2??0)/limit),expenseItems=await mainDb.select({description:expenses.description,amount:expenses.amount,date:expenses.date,id:expenses.id}).from(expenses).where(eq(expenses.shopId,shopId)).orderBy(desc(expenses.date)).offset((page-1)*limit).limit(limit);return{success:!0,message:"Umefanikiwa kupata taarifa",data:[{totalAmount,currentPage:page,totalPages,itemsPerPage:limit,items:expenseItems}]}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}},delExp=async({shopId,userId,expenseId})=>{try{return await mainDb.delete(expenses).where(eq(expenses.id,expenseId)),{success:!0,message:"Umefanikiwa kufuta taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu imetokea kwenye seva"}}};var JWT_SECRET14=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",expensesPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET14})).get("/expenses",async({cookie:cookie2,jwt:jwt2})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await expFunc({shopId,userId})}).delete("/expenses/:id",async({cookie:cookie2,jwt:jwt2,params})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;let expenseId=params.id;return await delExp({shopId,userId,expenseId})});async function debtFunc({shopId,userId,query}){try{let{page,pageSize}=query,[stats]=await mainDb.select({totalDebts:sql`SUM(${debts.totalAmount})`,totalDebters:sql`COUNT(DISTINCT ${debts.customerId})`,totalRemaining:sql`SUM(${debts.remainingAmount})`,lastPayment:sql`MAX(${debts.lastPaymentDate})`}).from(debts).where(eq(debts.shopId,shopId)),customerDebts=await mainDb.select({debtId:debts.id,customerId:debts.customerId,name:customers.name,totalDebt:debts.totalAmount,remainingAmount:debts.remainingAmount,lastPaymentDate:debts.lastPaymentDate,createdAt:debts.createdAt}).from(debts).innerJoin(customers,eq(debts.customerId,customers.id)).where(and(eq(debts.shopId,shopId),eq(customers.shopId,shopId))).orderBy(desc(debts.remainingAmount)).limit(pageSize).offset((page-1)*pageSize),paymentHistory=await mainDb.select({customerId:customers.id,name:customers.name,totalPaid:sql`SUM(${debtPayments.amountPaid})`,paymentDate:sql`MAX(${debtPayments.paymentDate})`}).from(debtPayments).innerJoin(customers,eq(debtPayments.customerId,customers.id)).where(and(eq(debtPayments.shopId,shopId),eq(customers.shopId,shopId))).groupBy(customers.id,customers.name).orderBy(desc(sql`MAX(${debtPayments.paymentDate})`)).limit(5);return{success:!0,data:[{statistics:stats,customerDebts,recentPayments:paymentHistory,pagination:{currentPage:page,pageSize,totalCount:await getTotalDebtersCount(shopId)}}],message:"Madeni ya wateja yamepatikana kwa mafanikio."}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Seva imeshindwa."}}}async function getTotalDebtersCount(shopId){let[result]=await mainDb.select({count:sql`COUNT(DISTINCT ${debts.customerId})`}).from(debts).where(eq(debts.shopId,shopId));return result.count}var payDebt=async({shopId,userId,body})=>{try{let{amountPaid,customerId,debtId}=body;amountPaid=sanitizeNumber(amountPaid),await mainDb.insert(debtPayments).values({customerId,amountPaid:amountPaid.toString().trim(),debtId,shopId});let[remainingAmount]=await mainDb.select({remainingAmount:debts.remainingAmount}).from(debts).where(and(eq(debts.id,debtId),eq(debts.shopId,shopId)));console.log(remainingAmount.remainingAmount,typeof remainingAmount.remainingAmount);let newAmount=new decimal_default(remainingAmount.remainingAmount).minus(amountPaid).toFixed(2);return await mainDb.update(debts).set({remainingAmount:newAmount.toString(),lastPaymentDate:new Date(Date.now())}).where(and(eq(debts.id,debtId),eq(debts.shopId,shopId))),{success:!0,message:"Taarifa zimebadilishwa kwa mafanikio"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Seva imeshindwa."}}};var JWT_SECRET15=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",debtPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET15})).get("/get-debts",async({jwt:jwt2,cookie:cookie2,query})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await debtFunc({userId,shopId,query})},{query:debtQuery}).post("/pay-debt",async({jwt:jwt2,cookie:cookie2,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await payDebt({userId,shopId,body})},{body:payDebtData});var trackingVisitors=new Elysia().get("/check-visitor",async({request})=>{try{let ip=request.headers.get("x-forwarded-for")||request.headers.get("x-real-ip")||"127.0.0.1",userAgent=request.headers.get("user-agent")||"",referer=request.headers.get("referer")||"",refererDomain=referer.split("/").slice(2).join("/"),testIp2="196.249.93.101",testIp="185.252.220.151",data4=await(await fetch("https://proxycheck.io/v2/185.252.220.151?vpn=1&asn=1")).json();return console.log("Data4: ",data4),{success:!0,ip,userAgent,referer,refererDomain,date:new Date(Date.now())}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Hitilafu kwenye seva"}}});var askedFunc=async({shopId,userId})=>{try{let data=await mainDb.select({name:askedProducts.productName,count:askedProducts.quantityRequested}).from(askedProducts).where(eq(askedProducts.shopId,shopId));if(data.length===0)return{success:!1,message:"hakuna chochote, tafadhali ongeza kwanza"};return{success:!0,message:"taarifa zimepatikana",data:[{data}]}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Tatizo limetokea wakati wa kupata data"}}},askedFuncPost=async({shopId,userId,body})=>{try{let{name}=body;if(name=sanitizeString(name),(await mainDb.select({name:askedProducts.productName}).from(askedProducts).where(eq(askedProducts.shopId,shopId))).length>0)return{success:!1,message:"Jina tayari lipo, tumia jingine"};return await mainDb.insert(askedProducts).values({productName:name,shopId}),{success:!0,message:"Taarifa zimehifadhiwa kwa mafanikio"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Tatizo limetokea wakati wa kutuma data"}}},deleteAsked=async({userId,shopId,id})=>{try{return await mainDb.delete(askedProducts).where(eq(askedProducts.id,id)),{success:!0,message:"Umefanikiwa kufuta taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Tatizo limetokea wakati wa kutuma data"}}},updateAsked=async({userId,shopId,id,body})=>{try{return await mainDb.update(askedProducts).set({quantityRequested:body.count}).where(eq(askedProducts.id,id)),{success:!0,message:"Umefanikiwa ku-edit taarifa"}}catch(error3){return{success:!1,message:error3 instanceof Error?error3.message:"Tatizo limetokea wakati wa kutuma data"}}};var JWT_SECRET16=process.env.JWT_TOKEN||"something@#morecomplicated<>es>??><Ess5%",askedPlugin=new Elysia().use(index_default({name:"jwt",secret:JWT_SECRET16})).get("/asked",async({cookie:cookie2,jwt:jwt2})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await askedFunc({shopId,userId})}).post("/asked",async({cookie:cookie2,jwt:jwt2,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||!userId)return;return await askedFuncPost({shopId,userId,body})},{body:askedData}).delete("/asked/:id",async({cookie:cookie2,jwt:jwt2,params})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||userId)return;let{id}=params;return await deleteAsked({shopId,userId,id})}).put("/asked/:id",async({cookie:cookie2,jwt:jwt2,params,body})=>{let{userId,shopId}=await extractId({jwt:jwt2,cookie:cookie2});if(!shopId||userId)return;let{id}=params;return await updateAsked({shopId,userId,id,body})},{body:updatedAskedData});var startTime=Date.now(),frontendURL4=process.env.FRONTEND_URL_DEV;new Elysia().use(dist_default()).use(cors({allowedHeaders:["Content-Type","Authorization","Accept-Language"],credentials:!0,methods:["GET","POST","PUT","DELETE","OPTIONS"],maxAge:3600,origin:frontendURL4})).onRequest(({set:set2})=>{set2.headers["Content-Security-Policy"]="default-src 'self'; script-src 'self'",set2.headers["X-Frame-Options"]="DENY",set2.headers["X-Content-Type-Options"]="nosniff"}).use(home_default).use(registration_default).use(loginPlugin).use(categories_default).use(supplier_default).use(prodPlugin).use(qrCode_default).use(autoSales_default).use(mailPlugin).use(CustomersPlugin).use(analytics_default).use(authPlugin).use(settings_default).use(google_default).use(payment_default).use(notifications_default).use(expensesPlugin).use(debtPlugin).use(trackingVisitors).use(askedPlugin).listen(process.env.PORT??3000);var endTime=Date.now();console.log(`Server Execution Time: ${endTime-startTime}ms`);console.log("Server is running ... ");

//# debugId=1FE85FD96CAABFDC64756E2164756E21
//# sourceMappingURL=server.map
